!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;"undefined"!=typeof window?b=window:"undefined"!=typeof global?b=global:"undefined"!=typeof self&&(b=self),b.imtables=a()}}(function(){var a;return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c||a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){(function(){var b,d,e,f,g,h,i;f=a("es6-promise").Promise,i=a("underscore"),b=a("jquery"),e=a("./options"),d={server:"http://cdn.intermine.org",imtables:"/js/intermine/im-tables/2.0.0-beta/",tests:{fontawesome:/font-awesome/,glyphicons:/bootstrap-icons/},resources:{prettify:["/js/google-code-prettify/latest/prettify.js"],d3:"/js/d3/3.0.6/d3.v3.min.js",glyphicons:"/css/bootstrap/2.3.2/css/bootstrap-icons.css",fontawesome:"/css/font-awesome/4.x/css/font-awesome.min.css",filesaver:"/js/filesaver.js/FileSaver.min.js"}},e.set("CDN",d),g=function(a){var b;return null!=a&&(b=i.asArray(document.querySelectorAll('link[rel="stylesheet"]')),i.any(b,function(b){return a.test(b.href)}))},h=function(a){return function(c,d){var e,h,j;return j=new f(function(a){return i.delay(a,50,!0)}),/\.css$/.test(c)?g(d)?j:(h=b('<link type="text/css" rel="stylesheet">'),h.appendTo("head").attr({href:a+c}),j):(e=b.ajax({url:a+c,cache:!0,dataType:"script"}),e.then(function(){return j}))}},c.load=function(a){var b,c,d,g,j;return g=e.get("CDN.server"),c=e.get(["CDN","resources",a]),j=e.get(["CDN","tests",a]),d=h(g),c?i.isArray(c)?f.all(function(){var a,e,f;for(f=[],a=0,e=c.length;a<e;a++)b=c[a],f.push(d(b));return f}()):d(c,j):f.reject("No resource is configured for "+a)}}).call(this)},{"./options":63,"es6-promise":257,jquery:288,underscore:310}],2:[function(a,b,c){(function(){var c,d,e={}.hasOwnProperty,f=function(a,b){function c(){this.constructor=a}for(var d in b)e.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},g=[].slice;c=a("backbone"),d=function(a){return!a},b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return f(b,a),b.prototype.destroyed=!1,b.prototype.toggle=function(a){return this.swap(a,d)},b.prototype.swap=function(a,b){return this.set(a,b(this.get(a)))},b.prototype.toJSON=function(){return this.destroyed?"DESTROYED":b.__super__.toJSON.apply(this,arguments)},b.prototype.destroy=function(){if(!this.destroyed)return this.stopListening(),this.destroyed=!0,this.trigger("destroy",this,this.collection),this._frozen=[],this.clear(),this.off()},b.prototype._frozen=[],b.prototype._validate=function(a,c){var d,e,f,g,h;for(h=this._frozen,f=0,g=h.length;f<g;f++)if((e=h[f])in a&&a[e]!==this.get(e)){if(d=e+" is frozen (trying to set it to "+a[e]+" - is "+this.get(e)+")",!c.merge)throw new Error(d);a[e]=this.get(e)}return b.__super__._validate.apply(this,arguments)},b.prototype.freeze=function(){var a;return a=1<=arguments.length?g.call(arguments,0):[],this._frozen=this._frozen.concat(a),this},b}(c.Model)}).call(this)},{backbone:236}],3:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t={}.hasOwnProperty,u=function(a,b){function c(){this.constructor=a}for(var d in b)t.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},v=[].slice;a("./shim"),d=a("backbone"),s=a("underscore"),c=a("jquery"),e=a("./core-model"),i=a("./messages"),j=a("./templates"),g=a("./icons"),f=a("./event"),l=a("./templates/helpers"),r=a("./utils/on-change"),h=j.template("progress-bar")({doneness:1}),m=0,k=function(){return m++},o=function(){return q.call(this,"model")},p=function(){return q.call(this,"state")},n=function(){return q.call(this,"collection")},q=function(a){var b,c,d,e;if(b=s.result(this,a+"Events"),s.size(b)){if(null==this[a])throw new Error("Cannot listen to "+a+" - it is null.");e=[];for(c in b){if(d=b[c],null==(d=s.isFunction(d)?d:this[d]))throw new Error("No handler for "+a+":"+c);e.push(this.listenTo(this[a],c,d))}return e}},b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}var d;return u(b,a),b.include=function(a){return s.extend(this.prototype,a)},b.prototype.hasOwnModel=!0,b.prototype.parameters=[],b.prototype.optionalParameters=[],b.prototype.parameterTypes={},b.prototype.initState=function(){},b.prototype.initialize=function(a){var b,c,d,f,h,i,j,k,l;for(null==a&&(a={}),this.state=a.state,f=null!=(j=s.result(this,"parameters"))?j:[],c=null!=(k=s.result(this,"optionalParameters"))?k:[],s.extend(this,s.pick.apply(s,[a].concat(v.call(f)))),h=0,i=c.length;h<i;h++)d=c[h],null!=a[d]&&(this[d]=a[d]);return this.children={},b=this.Model||e,null!=(null!=(l=this.model)?l.toJSON:void 0)&&(this.hasOwnModel=!1),null==this.model&&(this.model=new b),null==this.model.toJSON&&(this.model=new b(this.model)),null==this.state&&(this.state=new e),null==this.state.toJSON&&(this.state=new e(this.state)),null!=this.RERENDER_EVENT&&this.listenTo(this.model,this.RERENDER_EVENT,this.reRender),this.on("rendering",this.preRender),this.on("rendered",this.postRender),this.assertInvariants(),this.initState(),o.call(this),p.call(this),n.call(this),this.listenTo(g,this.ICONS,function(){if(this.template)return this.reRender()}),this.listenTo(this.model,"destroy",function(){return this.remove()})},b.prototype.ICONS="change",b.prototype.stopListeningTo=function(a){return this.stopListening(a)},b.prototype.renderRequires=[],b.prototype.modelEvents={},b.prototype.stateEvents={},b.prototype.collectionEvents={},b.prototype.listenForChange=function(){var a,b,c;if(a=arguments[0],b=arguments[1],c=3<=arguments.length?v.call(arguments,2):[],!(null!=c?c.length:void 0))throw new Error("No properties listed");return this.listenTo(a,r(c),b)},b.prototype.renderError=function(a){return renderError(this.el)(a)},b.prototype.helpers=function(){return s.extend({IndeterminateProgressBar:h},l)},b.prototype.getBaseData=function(){var a;return l=s.result(this,"helpers"),a=s.result(this,"labels"),s.extend({state:this.state.toJSON(),Messages:i,Icons:g,labels:a},l)},b.prototype.getData=function(){var a,b;return s.extend(this.getBaseData(),this.model.toJSON(),{collection:null!=(a=null!=(b=this.collection)?b.toJSON():void 0)?a:[]})},b.prototype.reRender=function(){return this.rendered&&!this.removed&&this.render(),this},b.prototype.postRender=function(){},b.prototype.preRender=function(){},d=function(a,b){return s.all(b,function(b){return a.has(b)})},b.prototype.onRenderError=function(a){return console.error("RENDER FAILED",this,a),this.state.set({error:a})},b.prototype.render=function(){var a,b,c,e;if(!this.removed){if(e=s.result(this,"renderRequires"),(null!=e?e.length:void 0)&&!d(this.model,e))return b=r(e),this.listenToOnce(this.model,b,this.render),this;if(c=new f(this.rendered),this.trigger("rendering",c),c.cancelled)return this;if(this.removeAllChildren(),null!=this.template)try{this.$el.html(this.template(this.getData()))}catch(b){a=b,this.onRenderError(a)}return this.renderChildren(),this.trigger("rendered",this.rendered=!0),this}},b.prototype.renderChildren=function(){},b.prototype.renderChild=function(a,b,c,d){if(null==c&&(c=this.el),null==d&&(d="append"),null==a&&(a=k()),this.removeChild(a),this.children[a]=b,null==b)return this;switch(d){case"append":b.$el.appendTo(c);break;case"prepend":b.$el.prependTo(c);break;case"at":b.setElement(c[0]||c);break;default:throw new Error("Unknown position: "+d)}return b.render(),this},b.prototype.renderChildAt=function(a,b,c){return null==c&&(c=this.$(a)),this.renderChild(a,b,c,"at")},b.prototype.removeChild=function(a){var b;return null!=(b=this.children[a])&&b.remove(),delete this.children[a]},b.prototype.removeAllChildren=function(){var a,b,c,d,e;if(null!=this.children){for(d=s.keys(this.children),e=[],b=0,c=d.length;b<c;b++)a=d[b],e.push(this.removeChild(a));return e}},b.prototype.removed=!1,b.prototype.remove=function(){if(!this.removed)return this.stopListening(),this.removed=!0,this.$el.parent().trigger("childremoved",this),this.trigger("remove",this),this.hasOwnModel&&this.model.destroy(),this.removeAllChildren(),this.off(),b.__super__.remove.apply(this,arguments),this},b.prototype.make=function(a,b,d){var e,f,g,h,i,j,k;if(f=document.createElement(a),e=c(f),null!=b)for(g in b)h=b[g],"class"===g||"className"===g?e.addClass(h):e.attr(g,h);if(null!=d)if(s.isArray(d))for(j=0,k=d.length;j<k;j++)i=d[j],e.append(i);else e.append(d);return f},b.prototype.invariants=function(){return{}},b.prototype.assertInvariant=function(a,b){if(!a)throw new Error(b)},b.prototype.assertInvariants=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,t;for(g=null!=(n=s.result(this,"parameters"))?n:[],d=null!=(o=s.result(this,"optionalParameters"))?o:[],f=null!=(p=s.result(this,"parameterTypes"))?p:{},j=0,l=g.length;j<l;j++)e=g[j],i=this[e],this.assertInvariant(null!=i,"Missing required option: "+e);for(q=g.concat(d),k=0,m=q.length;k<m;k++)e=q[k],null!=(h=f[e])&&(i=this[e],a=h.test(i),c=h.message(e),this.assertInvariant(a,c));r=this.invariants(),t=[];for(b in r)c=r[b],t.push(this.assertInvariant(s.result(this,b),c));return t},b}(d.View)}).call(this)},{"./core-model":2,"./event":11,"./icons":14,"./messages":16,"./shim":66,"./templates":67,"./templates/helpers":68,"./utils/on-change":93,backbone:236,jquery:288,underscore:310}],4:[function(a,b,c){(function(){var c,d,e,f={}.hasOwnProperty,g=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};c=a("../core-view"),e=a("../templates"),d=a("../messages"),b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return g(b,a),b.prototype.class="checkbox",b.prototype.template=e.template("checkbox"),b.prototype.getData=function(){return{checked:this.checked(),label:this.label?d.getText(this.label):null}},b.prototype.initialize=function(a){return this.attr=a.attr,this.label=a.label,b.__super__.initialize.apply(this,arguments)},b.prototype.checked=function(){return this.model.get(this.attr)},b.prototype.toggle=function(a){return null!=a&&a.stopPropagation(),this.model.toggle(this.attr)},b.prototype.events=function(){return{click:"toggle"}},b.prototype.modelEvents=function(){var a;return a={},a["change:"+this.attr]=this.setCheckboxState,a},b.prototype.setCheckboxState=function(){return null==this.cb&&(this.cb=this.$("input")[0]),this.cb.checked=this.model.get(this.attr)},b}(c)}).call(this)},{"../core-view":3,"../messages":16,"../templates":67}],5:[function(a,b,c){(function(){var c,d,e={}.hasOwnProperty,f=function(a,b){function c(){this.constructor=a}for(var d in b)e.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};c=a("backbone"),d=a("../core-model"),b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return f(b,a),b.prototype.model=d,b.prototype.close=function(){var a;for(this.trigger("close",this),this.off();a=this.pop();)a.collection===this&&(delete a.collection,a.destroy());return this.reset(),this.stopListening()},b}(c.Collection)}).call(this)},{"../core-model":2,backbone:236}],6:[function(a,b,c){(function(){var c,d,e,f={}.hasOwnProperty,g=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};e=a("underscore"),c=a("../core-view"),d=a("../templates"),b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return g(b,a),b.prototype.className="input-group",b.prototype.template=d.template("input-with-button"),b.prototype.getData=function(){return e.extend(this.getBaseData(),{value:this.model.get(this.sets),placeholder:this.placeholder,button:this.button})},b.prototype.initialize=function(a){return this.placeholder=a.placeholder,this.button=a.button,this.sets=a.sets,b.__super__.initialize.apply(this,arguments),null!=this.sets?this.sets:this.sets="value"},b.prototype.postRender=function(){return this.$el.addClass(this.className)},b.prototype.modelEvents=function(){var a;return a={},a["change:"+this.sets]=this.setDomValue,a},b.prototype.events=function(){return{"keyup input":"setModelValue","click button":"act"}},b.prototype.setModelValue=function(a){return this.model.set(this.sets,a.target.value)},b.prototype.setDomValue=function(){var a,b;if(b=this.model.get(this.sets),a=this.$("input"),a.val()!==b)return a.val(b)},b.prototype.act=function(){return this.trigger("act",this.model.get(this.sets))},b}(c)}).call(this)},{"../core-view":3,"../templates":67,underscore:310}],7:[function(a,b,c){(function(){var c,d,e,f={}.hasOwnProperty,g=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};e=a("underscore"),c=a("../core-view"),d=a("../templates"),b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return g(b,a),b.prototype.className="form-group",b.prototype.template=d.template("input-with-label"),b.prototype.parameters=function(){return["attr","placeholder","label"]},b.prototype.optionalParameters=function(){return["getProblem","helpMessage"]},b.prototype.getProblem=function(a){return null},b.prototype.helpMessage=null,b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this.setValidity()},b.prototype.setValidity=function(){return this.state.set({problem:this.getProblem(this.model.get(this.attr))})},b.prototype.getData=function(){return e.extend(this.getBaseData(),{value:this.model.get(this.attr),label:this.label,placeholder:this.placeholder,helpMessage:this.helpMessage,hasProblem:this.state.get("problem")})},b.prototype.postRender=function(){return this.$el.addClass(this.className),this.onChangeValidity()},b.prototype.events=function(){return{"keyup input":"setModelValue"}},b.prototype.stateEvents=function(){return{"change:problem":this.onChangeValidity}},b.prototype.modelEvents=function(){var a;return a={},a["change:"+this.attr]=this.onChangeValue,a},b.prototype.onChangeValue=function(){return this.setValidity(),this.setDOMValue()},b.prototype.onChangeValidity=function(){var a,b;return b=this.state.get("problem"),a=this.$(".help-block"),b?(this.$el.toggleClass("has-warning","warning"===b.level),this.$el.toggleClass("has-error","warning"!==b.level),null!=b.message&&a.text(Messages.getText(b.message)),a.slideDown()):(this.$el.removeClass("has-warning has-error"),a.slideUp())},b.prototype.setModelValue=function(a){return this.model.set(this.attr,this.$(a.target).val())},b.prototype.setDOMValue=function(){var a,b,c;if(a=this.$("input"),b=a.val(),(c=this.model.get(this.attr))!==b)return a.val(c)},b}(c)}).call(this)},{"../core-view":3,"../templates":67,underscore:310}],8:[function(a,b,c){(function(){var c,d,e,f,g={}.hasOwnProperty,h=function(a,b){function c(){this.constructor=a}for(var d in b)g.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},i=[].slice;f=a("underscore"),c=a("../core-model"),e=function(a,b){var c;return c=a[b],f.isObject(c)?c:a[b]={}},d=function(a){return f.isObject(a)&&!f.isFunction(a)&&!f.isArray(a)},b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return h(b,a),b.prototype._triggerChangeRecursively=function(a,b){var c,d,e,g;g=[];for(c in b)e=b[c],d=a+"."+c,f.isObject(e)?g.push(this._triggerChangeRecursively(d,e)):g.push(this.trigger("change:"+d,this,this.get(d)));return g},b.prototype.get=function(a){var c,d;return f.isArray(a)?(c=a[0],d=2<=a.length?i.call(a,1):[],d.reduce(function(a,b){return a&&a[b]},b.__super__.get.call(this,c))):/\w+\.\w+/.test(a)?this.get(a.split(/\./)):b.__super__.get.call(this,a)},b.prototype.pick=function(){var a;return a=1<=arguments.length?i.call(arguments,0):[],f.object(f.flatten(a).map(function(a){return function(b){return[b,a.get(b)]}}(this)))},b.prototype._triggerPathChange=function(a,b){var c,d,e,f,g;for(c=[],this.trigger("change",this,a.join("."),b),g=[],e=0,f=a.length;e<f;e++)d=a[e],c.push(d),g.push(this.trigger("change:"+c.join("."),this,this.get(c)));return g},b.prototype._triggerUnsetPath=function(a,b){var c,d,e;if(f.isObject(b)){e=[];for(c in b)d=b[c],e.push(this._triggerUnsetPath(a.concat([c]),d));return e}return this.trigger("change:"+a.join("."))},b.prototype.set=function(a,c){var g,h,j,k,l,m,n,o,p,q,r;if(null==a)throw new Error("No key");if(!f.isArray(a)){if(f.isString(a))return/\w+\.\w+/.test(a)?this.set(a.split(/\./),c):f.isObject(c)&&!f.isArray(c)?this.set([a],c):b.__super__.set.apply(this,arguments);r=[];for(l in a)p=a[l],r.push(this.set(l,p));return r}if(d(c))for(l in c)p=c[l],this.set(a.concat([l]),p);else if(j=a[0],m=3<=a.length?i.call(a,1,q=a.length-1):(q=1,[]),h=a[q++],k=this.get(j),!k||!f.isFunction(k)&&f.isObject(k)||this.unset(j),o=null!=k?k:{},g=m.reduce(e,o),n=g[h],g[h]=c,b.__super__.set.call(this,j,o),this._triggerPathChange(a,c),null!=n&&null==c)return this._triggerUnsetPath(a,n)},b}(c)}).call(this)},{"../core-model":2,underscore:310}],9:[function(a,b,c){(function(){var c,d,e,f={}.hasOwnProperty,g=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};e=a("underscore"),d=a("../templates"),c=a("./input-with-label"),b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return g(b,a),b.prototype.parameters=function(){return["model","collection","attr","label","optionLabel"]},b.prototype.optionalParameters=function(){return["noOptionsMessage"].concat(b.__super__.optionalParameters.apply(this,arguments))},b.prototype.template=d.template("select-with-label"),b.prototype.noOptionsMessage="core.NoOptions",b.prototype.events=function(){return{"change select":"setModelValue"}},b.prototype.collectionEvents=function(){return{"add remove reset change":this.reRender}},b.prototype.getData=function(){var a;return a=this.model.get(this.attr),e.extend(this.getBaseData(),{label:this.label,model:this.model.toJSON(),selected:function(b){return b.name===a},options:this.collection.toJSON(),optionLabel:this.optionLabel,helpMessage:this.helpMessage,noOptionsMessage:this.noOptionsMessage,hasProblem:this.state.get("problem")})},b}(c)}).call(this)},{"../templates":67,"./input-with-label":7,underscore:310}],10:[function(a,b,c){(function(){var b,d,e,f,g,h,i,j,k,l,m,n,o=[].slice;n=a("underscore"),d=a("backbone"),g=a("../core-model"),f=a("./collection"),c.assertMatch=function(a,b,c){if(null==c&&(c="value"),!a.test(b))throw new Error(a.message(c))},i=function(){function a(b,c){if(this.type=b,this.name=c,!(this instanceof a))return new a(this.type,this.name)}return a.prototype.test=function(a){return a instanceof this.type},a.prototype.message=function(a){return a+" is not an instance of "+this.name},a}(),m=function(){function a(a,b){this.name=a,this.structure=b,this._msg=null}return a.prototype.failValidation=function(a){return this._msg=a,!1},a.prototype.test=function(a){var b,c,d,e;if(this._msg=null,null==a)return this.failValidation("it is null");if(null==a)return!1;e=this.structure;for(c in e)if(d=e[c],b=a[c],!d.test(b))return this.failValidation(d.message("."+c));return!0},a.prototype.message=function(a){return a+" failed "+this.name+" validation, because "+this._msg},a}(),c.InstanceOf=i,c.Structure=m,c.Model=new i(d.Model,"Backbone.Model"),c.CoreModel=new i(g,"core-model"),c.CoreCollection=new i(f,"core/collection"),c.Array=k={name:"array",test:n.isArray,message:function(a){return a+" is not an array"}},c.ArrayOf=b=function(a){return{name:"array of "+a.name,test:function(b){return this.passed=k.test(b)&&n.all(b,a.test)},message:function(b){var c;return b+" is not an array of "+(null!=(c=a.name)?c:"the correct type")}}},c.Function={name:"function",test:n.isFunction,message:function(a){return a+" is not a function"}},c.Number={name:"number",test:n.isNumber,message:function(a){return a+" is not a number"}},c.String=l={name:"string",test:n.isString,message:function(a){return a+" is not a string"}},c.Maybe=function(a){return{name:"maybe "+a.name,test:function(b){return null==b||a.test(b)},message:function(b){return a.message(b)}}},c.Callable=e={name:"callable",test:function(a){return null!=a&&n.isFunction(a.call)},message:function(a){return a+" is not callable"}},c.HasProperty=function(a){return{name:"has-property("+a+")",test:function(b){return null!=b&&a in b},message:function(b){return b+"."+a+" not found"}}},c.UnionOf=function(){var a;return a=1<=arguments.length?o.call(arguments,0):[],{name:function(){return"Union of "+a.map(function(a){return a.name}).join(", ")},test:function(b){return n.all(a,function(a){return function(c){return a._t=c,c.test(b)}}(this))},message:function(a){var b;return null!=(b=this._t)?b.message(a):void 0}}},c.Listenable=new m("Listenable",{on:c.Function,off:c.Function}),c.Service=j=new m("Service",{root:l,query:e,fetchModel:e,fetchLists:e,count:e,whoami:e}),c.DataModel=h=new m("imjs.Model",{name:l,makePath:e,findCommonType:e}),c.Query=new m("Query",{service:j,model:h,rows:e,count:e,toXML:e,root:l,views:b(l)})}).call(this)},{"../core-model":2,"./collection":5,backbone:236,underscore:310}],11:[function(a,b,c){(function(){b.exports=function(){function a(a,b){this.data=a,this.target=b}return a.prototype.cancel=function(){return this.cancelled=!0},a.prototype.preventDefault=function(){return this.cancel()},a.prototype.stopPropagation=function(){},a}()}).call(this)},{}],12:[function(a,b,c){(function(){c.suppress=function(a){return null!=a&&a.preventDefault(),null!=a?a.stopPropagation():void 0}}).call(this)},{}],13:[function(a,b,c){(function(){var b,d,e,f,g,h,i,j,k;k=a("underscore"),d=a("./templates"),b=a("./core/nested-model"),j=function(a){return a.isAttribute()?a.getParent().getType():a.getType()},h=function(a){var b;return b=j(a),[b.name].concat(a.model.getAncestorsOf(b))},e=function(a){return!!a},g=new b,c.getFormatter=i=function(a){var b,c,d,e,f,i,j,k,l;if(null==a||a.isRoot())throw new Error("No path or path is root");for(i=a.model,f=null!=(l=g.get([i.name]))?l:{},c=h(a),d=a.end.name,j=0,k=c.length;j<k;j++)if(b=c[j],e=f[b+"."+d]||f[b+".*"],!0===e&&(e=f[b]),null!=e)return e;return null},c.shouldFormat=function(a){if(null==a)throw new Error("no path");return!!a.isAttribute()&&e(i(a))},c.registerFormatter=function(a,b,c,d){if(null==d&&(d=["*"]),null==(null!=a?a.call:void 0))throw new Error("formatter is not a function");return 1===d.length&&"*"!==d[0]?g.set([b,c+"."+d[0]],a):(g.set([b,c],a),f(b,c,d))},c.disableFormatter=function(a,b,c){var d,e,f,h;for(null==c&&(c=["*"]),h=[],e=0,f=c.length;e<f;e++)d=c[e],h.push(g.set([a,b+"."+d],!1));return h},c.list=function(a){var b,c,d;c=g.get([a]),d=[];for(b in c)c[b]&&d.push(b);return d},c.enableFormatter=f=function(a,b,c){var d,e,f,h;for(null==c&&(c=["*"]),h=[],e=0,f=c.length;e<f;e++)d=c[e],h.push(g.set([a,b+"."+d],!0));return h},c.defaultFormatter=function(a,b,c){return null!=c?k.escape(c):d.null_value},c.reset=function(){return g.clear(),g.trigger("reset")}}).call(this)},{"./core/nested-model":8,"./templates":67,underscore:310}],14:[function(a,b,c){(function(){var c,d,e,f,g,h,i={}.hasOwnProperty,j=function(a,b){function c(){this.constructor=a}for(var d in b)i.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};h=a("underscore"),e=a("./core-model"),f=a("./options"),c={},g=function(a,b){return c[a]=h.extend({},b)},d=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return j(b,a),b.prototype.icon=function(a,b,c){var d,e,f,g;return null==c&&(c={}),d=[],g=function(){var a;a=[];for(e in c)f=c[e],"className"!==e&&a.push(e+'="'+h.escape(f)+'"');return a}(),"className"in c&&d.push(h.escape(c.className)),d.push(this.iconClasses(a)),b&&d.push(this.getSize(b)),'<i class="'+d.join(" ")+'" '+g.join(" ")+"></i>"},b.prototype.iconWithProps=function(a,b){return this.icon(a,null,b)},b.prototype.getSize=function(a){var b;return null!=(b=this.get("size"+a.toUpperCase()))?b:""},b.prototype.iconClasses=function(a){return this.get("Base")+" "+this.get(a)},b.prototype._loadIconSet=function(){var a;if((a=c[this.options.get("icons")])&&(this.clear({silent:!0}),null!=a))return this.set(a)},b.prototype.initialize=function(a){return this.options=null!=a?a:f,this._loadIconSet(),this.listenTo(this.options,"change:icons",this._loadIconSet)},b}(e),c.glyphicons={Base:"glyphicon",unsorted:"glyphicon-resize-vertical",ASC:"glyphicon-arrow-up",DESC:"glyphicon-arrow-down",headerIcon:"icon",headerIconRemove:"glyphicon-remove",headerIconHide:"glyphicon-minus",headerIconReveal:"glyphicon-fullscreen",SortStringASC:"glyphicon-sort-by-alphabet",SortStringDESC:"glyphicon-sort-by-alphabet-alt",SortNumericASC:"glyphicon-sort-by-order",SortNumericDESC:"glyphicon-sort-by-order-alt",RootClass:"glyphicon-stop",Yes:"glyphicon-star",No:"glyphicon-star-empty",Table:"glyphicon-list",Script:"glyphicon-console",Export:"glyphicon-cloud-download",Error:"glyphicon-warning-sign",Info:"glyphicon-info-sign",Warning:"glyphicon-warning-sign",Remove:"glyphicon-minus-sign",OK:"glyphicon-ok",Cancel:"glyphicon-remove",Check:"glyphicon-check",UnCheck:"glyphicon-unchecked",CheckUnCheck:"glyphicon-ok-none",Add:"glyphicon-plus-sign",Move:"glyphicon-move",More:"glyphicon-plus-sign",Filter:"glyphicon-filter",Summary:"glyphicon-stats",Undo:"glyphicon-refresh",Refresh:"glyphicon-refresh",Columns:"glyphicon-pause",Collapsed:"glyphicon-chevron-right",Expanded:"glyphicon-chevron-down",CollapsedSection:"glyphicon-triangle-right",ExpandedSection:"glyphicon-triangle-bottom",MoveDown:"glyphicon-chevron-down",GoBack:"glyphicon-chevron-left",GoForward:"glyphicon-chevron-right",MoveUp:"glyphicon-chevron-up",Toggle:"glyphicon-random",ExpandCollapse:"glyphicon-chevron-right icon-chevron-down",Help:"glyphicon-question-sign",ReverseRef:"glyphicon-retweet",Reorder:"glyphicon-menu-hamburger",Edit:"glyphicon-edit",ExtraValue:"glyphicon-map-marker",Tree:"glyphicon-plus",Download:"glyphicon-save-file",download:"glyphicon-cloud-download",Options:"glyphicon-tasks",ClipBoard:"glyphicon-paperclip",Composed:"glyphicon-tags",RemoveConstraint:"glyphicon-remove-sign",Dismiss:"glyphicon-remove-sign",ClosedReference:"glyphicon-expand",OpenReference:"glyphicon-collapse-down",Lock:"glyphicon-lock",Lists:"glyphicon-list-alt",Attribute:"glyphicon-unchecked",ExternalLink:"glyphicon-globe",tsv:"glyphicon-list",csv:"glyphicon-list",xml:"glyphicon-xml",json:"glyphicon-json",fake:"glyphicon-bug",Bug:"glyphicon-bug",Rubbish:"glyphicon-trash",RubbishFull:"glyphicon-trash",Joins:"glyphicon-link",Mail:"glyphicon-envelope"},c.fontawesome={Base:"fa",unsorted:"fa-unsorted",ASC:"fa-sort-up",DESC:"fa-sort-down",SortStringASC:"fa-sort-alpha-asc",SortStringDESC:"fa-sort-alpha-desc",SortNumericASC:"fa-sort-numeric-asc",SortNumericDESC:"fa-sort-numeric-desc",headerIcon:"fa",headerIconRemove:"fa-times",headerIconHide:"fa-ellipsis-h",headerIconReveal:"fa-arrows-h",sizeLG:"fa-2x",Yes:"fa-star",No:"fa-star-o",Table:"fa-list",EmptyTable:"fa-table",Script:"fa-file-code-o",Export:"fa-cloud-download",Remove:"fa-minus-circle",OK:"fa-check",Cancel:"fa-remove",Check:"fa-toggle-on",UnCheck:"fa-toggle-off",CheckUnCheck:"fa-toggle-on fa-toggle-off",Add:"fa-plus",Move:"fa-arrows",More:"fa-plus",Dropbox:"fa-dropbox",Drive:"fa-google",download:"fa-cloud-download",Galaxy:"fa-cloud-upload",GenomeSpace:"fa-cloud-upload",Filter:"fa-filter",Summary:"fa-bar-chart-o",Undo:"fa-undo",Refresh:"fa-refresh",Columns:"fa-columns",Collapsed:"fa-chevron-right",Expanded:"fa-chevron-down",CollapsedSection:"fa-caret-right",ExpandedSection:"fa-caret-down",MoveDown:"fa-chevron-down",GoBack:"fa-chevron-left",GoForward:"fa-chevron-right",MoveUp:"fa-chevron-up",Toggle:"fa-retweet",ExpandCollapse:"fa-chevron-right fa-chevron-down",Help:"fa-question-circle",Tree:"fa-sitemap",ReverseRef:"fa-retweet",Reorder:"fa-reorder",Options:"fa-tasks",Edit:"fa-edit",ExtraValue:"fa-database",Download:"fa-file-archive-o",ClipBoard:"fa-paperclip",Composed:"fa-tags",RemoveConstraint:"fa-times-circle",Dismiss:"fa-times-circle",Error:"fa-warning",Info:"fa-info-circle",Warning:"fa-warning",Lock:"fa-lock",RootClass:"fa-square",Attribute:"fa-tag",ClosedReference:"fa-plus-square",OpenReference:"fa-plus-square-o",CodeFile:"fa-file-code-o",Rubbish:"fa-trash-o",RubbishFull:"fa-trash",Joins:"fa-share-alt",ExternalLink:"fa-globe",Lists:"fa-cloud-upload",tsv:"fa-file-excel-o",csv:"fa-file-excel-o",xml:"fa-code",json:"fa-json",fake:"fa-bug",Bug:"fa-bug",Mail:"fa-envelope"},b.exports=new d,b.exports.Icons=d,b.exports.registerIconSet=g,b.exports.names=function(){var a,b,d;return a=function(){var a;a=[];for(b in c)d=c[b],a.push(h.keys(d));return a}(),h.union.apply(null,a)}}).call(this)},{"./core-model":2,"./options":63,underscore:310}],15:[function(a,b,c){(function(){var b,d,e,f,g,h,i,j,k,l,m,n,o,p;p=a("underscore"),a("./shim"),k=a("imjs").Service.connect,g=a("es6-promise").Promise,o=a("./version"),i=a("./core/type-assertions"),b=a("./views/dashboard"),h=a("./views/table"),f=a("./options"),e=a("./messages"),d=a("./formatting"),n=a("./utils/simple-formatter"),m=function(a){var b;return b=function(c,d,e){var f,h,j;return i.Query.test(e)?new g(l(a,c,e,d)):(j=e.service,h=e.query,f=i.Service.test(j)?j:k(j),f.query(h).then(p.partial(b,c,d)))}},l=function(a,b,c,d){return null==d&&(d={}),function(e){var g,h,i,k,l,m,n;for(h=j(b),i="undefined"!=typeof page&&null!==page?p.pick(d,"start","size"):null,d=p.extend(p.omit(d,"start","size"),{model:i,query:c}),k=a(d),k.setElement(h),n=p.result(k,"className").split(" "),l=0,m=n.length;l<m;l++)g=n[l],h.classList.add(g);return h.classList.add(f.get("StylePrefix")),k.render(),e(k)}},j=function(a){var b,c;if(null==a)throw new Error("No target element provided");if(null==(b=p.isString(a)?document.querySelector(a):null!=(c=a[0])?c:a))throw new Error("Target("+a+") not found on page");return b},c.version=o,c.setMessages=e.set.bind(e),c.configure=f.set.bind(f),c.loadTable=m(h.create),c.loadDash=m(function(a){return new b(a)}),c.createFormatter=n,c.formatting=p.omit(d,"getFormatter","shouldFormat","reset")}).call(this)},{"./core/type-assertions":10,"./formatting":13,"./messages":16,"./options":63,"./shim":66,"./utils/simple-formatter":104,"./version":111,"./views/dashboard":136,"./views/table":209,"es6-promise":257,imjs:271,underscore:310}],16:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l,m=function(a,b){return function(){return a.apply(b,arguments)}},n={}.hasOwnProperty,o=function(a,b){function c(){this.constructor=a}for(var d in b)n.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};c=a("backbone"),k=a("underscore"),g=a("./messages/actions"),h=a("./messages/common"),l=a("./templates/helpers"),i=l.numToString,j=l.pluralise,d=[h,g],e={formatNumber:i,pluralise:j},f=function(a){function b(){return this.getText=m(this.getText,this),b.__super__.constructor.apply(this,arguments)}return o(b,a),b.prototype.initialize=function(){return this.cache={},this.on("change",function(a){return function(){return a.cache={}}}(this))},b.prototype.destroy=function(){var a,b;this.off(),b=[];for(a in this)b.push(delete this[a]);return b},b.prototype.getTemplate=function(a){var b,c;return b=null!=(c=this.cache[a])?c:this.get(a),null!=b&&null==b.call&&(b=k.template(b)),this.cache[a]=b},b.prototype.getText=function(a,b){var c,d;return null==b&&(b={}),c=this.getTemplate(a),null!=(d="function"==typeof c?c(k.extend({Messages:this},e,b)):void 0)?d:"!!!No message for "+a+"!!!"},
b.prototype.setWithPrefix=function(a,b){var c,d,e;e=[];for(c in b)d=b[c],e.push(this.set(a+"."+c,d));return e},b.prototype.defaults=function(){return k.extend.apply(null,[{}].concat(d))},b}(c.Model),b.exports=new f,b.exports.Messages=f}).call(this)},{"./messages/actions":17,"./messages/common":20,"./templates/helpers":68,backbone:236,underscore:310}],17:[function(a,b,c){(function(){b.exports={"export.Export":"Export","export.ExportQuery":"Export","export.DialogueTitle":"Export","export.category.Format":"<%= format.EXT %> Format","export.category.Columns":"<%= columns %> Columns","export.category.Preview":"Preview","export.preview.Limit":"Preview is limited to at most 3 results.","export.heading.Columns":"Columns","export.category.Rows":"<% if (rowCount === max) { %>\n  All\n<% } else { %>\n  <%= rowCount %> of <%= max %>\n<% } %>\nRows","export.category.Compression":"<% if (compression) { %>\n  <%= compression.toUpperCase() %>\n<% } else { %>\n  No\n<% } %> Compression","export.category.Options":"Options","export.category.JsonFormat":"As <%= (jsonFormat === 'objects') ? 'Objects' : 'Rows' %>","export.category.FastaFormat":"FASTA options","export.category.ColumnHeaders":"<% if (headers) { %>\n  <%= {friendly: 'Formatted', path: 'Raw'}[headerType] %>\n<% } else { %>\n  No\n<% } %>\nColumn Headers","export.category.Destination":"<% if (dest === 'download') { %>\n  Download <%= format.EXT %> file\n<% } else { %>\n  Send <%= format.EXT %> to <%= dest %>\n<% } %>","export.galaxy.name":["<% if (orgs.length === 1) { %><%= orgs[0] %> <% } %>","<%= cls %> data","<% if (branding) { %> from <%= branding.name %><% } %>"].join(""),"export.galaxy.info":"<%= query.root %> data from <%= query.service.root %>.\nUploaded from <%= currentLocation %>.\n<% if (lists.length) { %>source: <%= lists.join(', ') %><% } %>\n<% if (orgs.length)  { %>organisms: <%= orgs.join(', ') %><% } %>","export.format.description.TSV":"A flat file format suitable for spreadsheet programmes","export.format.name.TSV":"Tab separated values.","export.format.description.CSV":"A flat file format, suitable for spreadsheet programmes","export.format.name.CSV":"Comma separated values.","export.format.description.XML":"A text format suitable for machine processing.","export.format.name.XML":"XML","export.format.name.JSON":"JSON","export.format.description.JSON":"A text format suitable for machine processing.","export.format.name.FASTA":"FASTA sequence.","export.format.description.FASTA":"FASTA output for sequence data.","export.format.name.GFF3":"GFF3 features.","export.format.description.GFF3":"GFF3 output for sequence features.","export.format.name.BED":"BED locations.","export.format.description.BED":"BED output for sequence feature locations.","export.format.name.FAKE":"Fake","export.format.description.FAKE":"Fake format for testing. Should only appear if the\nquery has departments in the view.","export.format.name.FAKE_2":"Also Fake","export.format.description.FAKE_2":"Fake format for testing. Should only appear if the\nquery has companies in the view.","export.param.Size":"Size: <%= size %>","export.param.Format":"Format","export.param.Start":"Offset: <%= start %>","export.param.Destination":"Destination","export.param.Name":"File name","export.help.AdditionalCols":"You can add any attributes of objects which are already\nin the query.","rows.All":"No limit","export.cloud.FileLocation":"Upload to <%- cloud %> successful. Your file is available at:","export.UseCompression":"Compress results","export.UseGZIP":"Use GZIP compression (produces a .gzip archive)","export.UseZIP":"Use Zip compression (produces a .zip archive)","export.AddHeaders":"Add column headers","export.json.Rows":"Return results as rows - each row is an Array of JSON values, e.g.:","export.SetTablePage":"Select rows in table","export.ResetRowSelection":"Select all rows","export.json.RowsExample":'["eve", "2R", 5866824, 5868300]',"export.json.ObjExample":'{\n  "class": "Gene",\n  "symbol": "eve",\n  "chromosomeLocation": {\n    "class": "ChromosomeLocation",\n    "start": 5866824,\n    "end": 5868300\n    "locatedOn": {\n      "class": "Chromosome",\n      "primaryIdentifier": "2R"\n    }\n  }\n}',"export.json.Objects":"Return results as objects - each result is a nested graph of\ndata, e.g.:","export.json.ObjWarning":"Please note that it is not recommended to set the size parameters\nwhen requesting object results, since the size of the result\nset, and the position of the offsets will differ when multiple\nrows are replaced by a single object with a collection.","export.ff.FriendlyHeaders":'Human readable headers (eg. "Gene > Organism Name")',"export.ff.PathHeaders":'Raw path headers (eg. "Gene.organism.shortName)',"export.error.NoColumnsSelected":"No columns selected","export.error.OffsetOutOfBounds":"The offset is greater than the total number of results.",ListNameDuplicate:"List names must be unique. This name is already taken",ListNameEmpty:"Lists must have names. Please enter one",ListNameIllegal:"Some characters are not allowed in list names. This name contains the following\nillegal characters: <%- illegals.join(', ') %>. Please remove them.",ExportTitle:"Download results for <%= name || 'query' %>",ConfigureExport:"Configure Export",GetData:"Download Data",ExportHelp:"Download file containing results to your computer",ExportButton:"Download","download-file":"Download File",download:"Download file",Galaxy:"Send to Galaxy",GenomeSpace:"Upload to Genomespace",Drive:"Save to Google Drive",Dropbox:"Save to Dropbox","Destdownload-file":"File",DestGalaxy:"Galaxy",DestGenomespace:"Genomespace",ExportAlt:"Send Data Somewhere Else",ExportLong:'<span class="hidden-tablet">Download</span>\nFile\n<span class="im-only-widescreen">to your Computer</span>',SendToGalaxy:'<span class="hidden-tablet">Send to</span>\nGalaxy\n<span class="im-only-widescreen">for analysis</span>',SendToGenomespace:'<span class="hidden-tablet">Upload to</span>\n<span class="im-only-widescreen">your</span>\nGenomespace\n<span class="im-only-widescreen">account</span>',MyGalaxy:"Send to your Galaxy",ForgetGalaxy:"Clear this galaxy URL",GalaxyHelp:"Start a file upload job within Galaxy",GalaxyURILabel:"Galaxy Location:",GalaxyAlt:"Send to a specific Galaxy",SaveGalaxyURL:"Make this my default Galaxy",WhatIsGalaxy:"What is Galaxy?",WhatIsGalaxyURL:"http://wiki.g2.bx.psu.edu/",GalaxyAuthExplanation:"If you have already logged into Galaxy with this browser, then the data\nwill be sent into your active account. Otherwise it will appear in a \ntemporary anonymous account.",CopyToClipBoard:"Copy to clipboard: <CTL>+C, <ENTER>",IsPrivateData:"This link provides access to data stored in your private lists. In order to do so\nit uses the API access token provided on initialisation. If this is your permanent\nAPI token you should be as careful of this link as you would of the data is provides\naccess to. If this is just a 24 hour access token, then you will need to replace it\nonce it becomes invalid.",LongURI:"The normal URI for this query (which includes the full query XML in the \nparameters) is too long for a GET request. The URI you can see here uses a\nquery-id, which has a limited validity. You should not store this URI for long\nterm use.",SendToOtherGalaxy:"Send",AllRows:"Whole Result Set",SomeRows:"Specific Range",WhichRows:"Rows to Export",RowsHelp:"Export all rows, or define a range of rows to export.",AllColumns:"All Current Columns",SomeColumns:"Choose Columns",CompressResults:"Compress results",NoCompression:"No compression",GZIPCompression:"GZIP",ZIPCompression:"ZIP",Copy:"copy to clip-board",ResultsPermaLink:"Perma-link to results",ResultsPermaLinkText:"Results URI",QueryXML:"Query XML",ResultsPermaLinkTitle:"Get a permanent URL for these results, suitable for your own use",ResultsPermaLinkShareTitle:"Get a permanent URL for these results, suitable for sharing with others",ColumnsHelp:"Export all columns, or choose specific columns to export.",WhichColumns:"Columns to Export",ResetColumns:"Reset Columns.",FirstRow:"From",LastRow:"To",SpreadsheetOptions:"Spreadsheet Options",ColumnHeaders:"Include Column Headers",PossibleColumns:"You can add any attribute from these nodes without changing your results:",ExportedColumns:"Exported Columns (drag to reorder)",ChangeColumns:"You may add any of the columns in the right hand box by clicking on the\nplus sign. You may remove unwanted columns by clicking on the minus signs\nin the left hand box. Note that while adding these columns will not alter your query,\nif you remove all the attributes from an item, then you <b>may change</b> the results\nyou receive.",OuterJoinWarning:"This query has outer-joined collections. This means that the number of rows in \nthe table is likely to be different from the number of rows in the exported results.\n<b>You are strongly discouraged from specifying specific ranges for export</b>. If\nyou do specify a certain range, please check that you did in fact get all the \nresults you wanted.",IncludedFeatures:"Exportable parts of this Query - <strong>choose at least one</strong>:",FastaFeatures:"Features with Sequences in this Query - <strong>select one</strong>:",FastaOptions:"FASTA Specific Options",FastaExtension:"Extension (eg: 100/100bp/5kbp/0.5mbp):",ExtraAttributes:"Columns to include as extra attributes on each exported record:",NoSuitableColumns:"There are no columns of a suitable type for this format.",BEDOptions:"BED Specific Options",Gff3Options:"GFF3 Specific Options",ChrPrefix:'Prefix "chr" to the chromosome identifier as per UCSC convention (eg: chr2)',ConfigureExportHelp:"Configure the export options in these categories","largetable.ok":"Set page size to <%- size %>","largetable.abort":"Cancel","largetable.appeal":"You have requested a very large table size (<%= size %> rows per page). Your\nbrowser may struggle to render such a large table,\nand the page could become unresponsive. In any case,\nwill be very difficult for you to read the whole table\nin the page. We suggest the following alternatives:"}}).call(this)},{}],18:[function(a,b,c){(function(){var b;b=a("../messages"),b.setWithPrefix("codegen",{AsHTML:"As HTML page",DialogueTitle:'Generated <%= Messages.getText("codegen.Lang", {lang: lang}) %>\nCode for <%= query.name || "Query" %>',CannotExportXML:"You cannot save the XML as a file directly. Please use your browser's cut\nand paste functionality.",PrimaryAction:"Save",ChooseLang:"Choose Language",ShowBoilerPlate:"Show comments",HighlightSyntax:"Highlight Syntax",GenerateCodeIn:function(a){var c;return c=a.lang,"Generate "+b.getText("codegen.Lang",{lang:c})+"\n"+("xml"!==c?"code":"")},Lang:function(a){var b;switch(b=a.lang){case"py":return"Python";case"pl":return"Perl";case"java":return"Java";case"rb":return"Ruby";case"js":return"JavaScript";case"xml":return"XML";default:throw new Error("Unknown language "+b)}}})}).call(this)},{"../messages":16}],19:[function(a,b,c){(function(){var b;b=a("../messages"),b.setWithPrefix("columns",{DialogueTitle:"Manage Columns",ApplyChanges:"Apply Changes",FindColumnToAdd:"Add a Column",AddColumn:"<% if (num < 1) { %>\n  No columns chosen\n<% } else { %>\n  Add <%= num %> new <%= pluralise('column', num) %>\n<% } %>",AddColumnToSortOrder:"Sort by this column",NoChangesToApply:"There are no changes to apply.",OrderVerb:"Add / Remove / Re-Arrange",OrderTitle:"Columns",SortVerb:"Configure",SortTitle:"Sort-Order",OnlyColsInView:"Only show columns in the table:",SortingHelpTitle:"What Columns Can I Sort by?",ViewTabTitle:"Selected Columns",SortOrderTabTitle:"Sort Order",CurrentView:"Current Columns",CurrentViewHelp:"Re-arrange or remove columns by dragging, or by using the buttons",CurrentSortOrder:"<% if (oes.length) { %>\n  <%= oes.length %> Order <%= pluralise('Elements', oes.length) %>\n<% } else { %>\n  Not sorted.\n<% } %>",NoSortOrder:"No sort order. Drop columns here to sort the table.",RemoveOrderElement:"Remove this column from the sort-order",CurrentSortOrderHelp:"Re-arrange, add or remove columns. The full set of available\ncolumns is listed below.",ColumnsSelected:'<%= columns.length %> <%= pluralise("Column", columns.length) %>\nSelected<% if (removed) { %>, <%= removed %> Removed<% } %>',ChooseAPathFrom:"Choose a path from <%= root %>",RemoveColumn:"Remove this column",MoveUp:"Move this column up",MoveDown:"Move this column down",ColumnWillBeRemoved:"This column will be removed",RestoreColumn:"Add this column back to the table",ChangeDirection:"Change sort direction",CurrentDirection:"Sorted in\n<%= (dir === 'DESC') ? 'reverse' : void 0 %>\n<%= numeric ? 'numerical' : 'alphabetical' %>\norder.",ManageColumns:"Manage Columns",ManageColumnsShort:"Columns"})}).call(this)},{"../messages":16}],20:[function(a,b,c){(function(){b.exports={All:"All",Reset:"Reset",Export:"Download",Clear:"Clear",Cancel:"Cancel",Complete:"Complete",Error:"Error",Warning:"Warning",Filter:"Filter",Loading:"Loading",Undo:"Undo",and:"and",or:"or",comma:",",Number:"<%= formatNumber(n) %>","modal.DefaultTitle":"Excuse me...","modal.Dismiss":"Close","modal.OK":"OK","modal.ApplyChanges":"Apply Changes","core.NoOptions":"There are no options to select from.",ErrorTitle:function(a){switch(a.level){case"Error":return"Error";case"Warning":return"Warning";case"Info":return"nb";case"Positive":return"Success";default:return"Error"}}}}).call(this)},{}],21:[function(a,b,c){(function(){var b;b=a("../messages"),b.setWithPrefix("constraints",{Heading:'<%= n %> Active <%= pluralise("Filter", n) %>',AddNewFilter:"Add New Filter",AddFilter:"Add filter",AddNew:"Add Filter",DefineNew:"Define a new filter",EditOrRemove:"edit or remove the currently active filters",None:"No active filters",NoOfValues:'<%= (n === 1) ? "one" : formatNumber(n) %> <%= pluralise("value", n) %>',NoOfIds:'<%= (n === 1) ? "one" : formatNumber(n) %> <%= pluralise("ID", n) %>',ISA:"is a",LookupIn:"in",AddConFor:"Add filter to\n<% if (isAttribute && !hideType) { %><%= typeName %><% } %>\n<%= _.last(parts) %>",ManageFilters:"Manage Filters",ManageFiltersShort:"Filters"})}).call(this)},{"../messages":16}],22:[function(a,b,c){(function(){var b;b=a("../messages"),b.setWithPrefix("error",{Oops:"Oops! - Sorry we cannot get that table for you.",EmailHelp:"Send a bug report",ShowQuery:"Show query",ShowError:"Show error",ConnectionError:"Could not connect to server"}),b.setWithPrefix("error.mail",{Subject:"[IMTABLES] - Error running query."}),b.setWithPrefix("error.client",{Heading:"Application error.",Body:"This is due to an unexpected error in the tables\napplication - this is our fault, and we are sorry for the\ninconvenience. Please send us the pre-filled bug report so\nwe can fix this as soon as possible."}),b.setWithPrefix("error.server",{Heading:"Server error - our bad!",Body:"This is most likely related to the query that was just run. If you have\ntwo minutes, please send us an email with details of this query to help us\ndiagnose and fix this bug - we have already pre-filled the bug report,\nyou just need to hit send (and maybe give us some extra details).\nAlternatively, you might be able to fix this query by changing its column, \nfilters or joins; use the tools above to do so."})}).call(this)},{"../messages":16}],23:[function(a,b,c){(function(){var b;b=a("../messages"),b.setWithPrefix("joins",{Heading:"Manage Relationships",Manage:function(){return b.getText("joins.Heading")},ManageShort:"Relationships",Inner:"Required",Outer:"Optional",ExplanationTitle:"What does this do?",Explanation:"You can specify the entity relationships within the query here. This\nhas a couple of effects - one is to exclude a class of matched results, the\nother is to change the way the results are presented in the table.\nIf set to required, then an entity which matches the filters\nbut lacks the given relationship will not be returned in the results,\nwhereas if set to optional it will. This also has an effect on the\nway that results are laid out: required collection relationships\nare returned inline, whereas optional collection relationships are\nreturned as nested sub-tables within the main result set."})}).call(this)},{"../messages":16}],24:[function(a,b,c){(function(){var b;b=a("../messages"),b.setWithPrefix("lists",{DefaultName:"<%= typeName %> List (<%= new Date() %>)",Create:"Create List",Append:"Add to List",SaveAsList:"Save as List",CreateListTitle:"Create a new List\n<% if (state.count) { %>\n  of <%= formatNumber(state.count) %>\n  <%= pluralise(state.typeName, (state.count || 0)) %>\n<% } %>",AppendToListTitle:"Add\n<% if (state.count) { %>\n  <%= formatNumber(state.count) %>\n  <%= pluralise(state.typeName, (state.count || 0)) %>\n<% } %>\nto\n<%= target || 'a List' %>",NoTags:"No tags",AddTag:"Add a new tag",AddTagBtn:"add",RemoveTag:"Remove this tag",ShowExtraOptions:"<% if (minimised) { %>Show <% } %>Optional attributes",TargetDoesNotExist:"Your target list does not exist.",NoTargetSelected:"Please select a target list.",PossibleAppendTarget:"<%= name %> (<%= formatNumber(size) %> <%= pluralise((typeName || 'item'), size) %>)",NoObjectsSelected:"No objects selected. Choose objects from the table beneath. You can\ndrag this dialog around if it is in the way.",StartPicking:"Pick items from the table",NoCommonType:"There is no common type for these objects."}),b.setWithPrefix("lists.error",{MustBeLoggedIn:"You are not logged in. Anonymous users cannot create lists."}),b.setWithPrefix("lists.params",{Name:"List Name",NamePlaceholder:"List name is required",Desc:"List Description",DescPlaceholder:"Enter a description",Target:"Choose list to append items to"}),b.setWithPrefix("lists.params.help",{Name:"You must provide a unique list name",Target:"You must select a target list"}),b.setWithPrefix("lists.picker",{Expand:"show more options",Collapse:"show fewer options"}),b.setWithPrefix("lists.append",{NoSuitableLists:"No suitable lists were found\n<% if (model.type) { %>\n  for <%- model.type %>.\n<% } else { %>\n  because no items are selected, or they have no common type.\n<% } %>"})}).call(this)},{"../messages":16}],25:[function(a,b,c){(function(){var b;b=a("../messages"),b.setWithPrefix("logic",{Heading:"Manage Constraint Logic",Manage:function(){return b.getText("logic.Heading")},ManageShort:"Constraint Logic",LogicLabel:function(){return b.getText("logic.ManageShort")},ApplyLogic:"Change logic"})}).call(this)},{"../messages":16}],26:[function(a,b,c){(function(){var b;b=a("../messages"),b.setWithPrefix("subtables",{OpenHint:"Click to view/hide rows",RemoveColumn:"Remove this column"})}).call(this)},{"../messages":16}],27:[function(a,b,c){(function(){var b;b=a("../messages"),b.setWithPrefix("summary",{Got:"<% if (available > got) { %>Showing <%= formatNumber(got) %> of<% } %>",Max:"Maximum",Min:"Minimum",Bucket:"<%= range.min %> to <%= range.max %>: <%= count %> values",Count:"Count",Item:"Item",Average:"Average",StdDev:"Standard Deviation",OnlyOne:"There is only one <%- names.typeName %> <%- names.endName %>:\n<strong><%- item.item %></strong>, which occurs\n<strong>\n  <% if (item.count === 1) { %>\n    once\n  <% } else if (item.count === 2) { %>\n    twice\n  <% } else { %>\n    <%- formatNumber(item.count) %> times\n  <% } %>\n</strong>",NumericDistribution:"Showing distribution of <%= formatNumber(n) %>",FilterValuesPlaceholder:"Filter values",DownloadData:"Download data",DownloadFormat:"As",MoreItems:"Load more items",Include:"Restrict table to matching rows",Exclude:"Exclude matching rows from table",Reset:"Reset selection",Toggle:"Toggle selection",SelectFilter:"Select filter type",FacetBar:"rgba(206, 210, 222, <%= opacity %>)",NoResults:"No results for <%= path %>",SelectedCount:"<%= isApprox ? \"ca. \" : void 0 %><%= formatNumber(selectedCount) %>\n<%= pluralise('Item', selectedCount) %> Selected",Total:"<% if (filtered) { %>(filtered from <%= formatNumber(total) %>)<% } %>"})}).call(this)},{"../messages":16}],28:[function(a,b,c){(function(){var b;b=a("../messages"),b.setWithPrefix("table",{Building:"Loading Table ...",OverlayText:"Requesting data...",Empty:"No Results",EmptyWhy:"This query returns no results. You may wish to change its filters"}),b.setWithPrefix("table.lg",{ShowingAll:"Showing all <%= formatNumber(count) %> rows",ShowingRange:'Showing <%= formatNumber(first) %> to <%= formatNumber(last) %>\nof <%= formatNumber(count) %> <%= pluralise("row", count) %>'}),b.setWithPrefix("table.md",{ShowingAll:"All <%= formatNumber(count) %> rows",ShowingRange:"Showing rows <%= formatNumber(first) %> to <%= formatNumber(last) %>\nof <%= formatNumber(count) %>"}),b.setWithPrefix("table.sm",{ShowingAll:"All rows",ShowingRange:"Rows <%= formatNumber(first) %> to <%= formatNumber(last) %>\nof <%= formatNumber(count) %>"}),b.setWithPrefix("table.xs",{ShowingAll:"All rows",ShowingRange:"<%= formatNumber(first) %> to <%= formatNumber(last) %>\nof <%= formatNumber(count) %>"}),b.setWithPrefix("table.header",{FailedToInitSortMenu:"Could not initialise the sorting menu.",FailedToInitFilter:"Could not initialise the filter menu.",FailedToInitSummary:"Could not intitialise the column summary.",ViewSummary:"View column summary",ToggleColumn:"Toggle column visibility",RemoveColumn:"Remove this column",SortColumn:"<% if (dir === 'ASC') { %>\n  Sorted in ascending order.\n<% } else if (dir === 'DESC') { %>\n  Sorted in descending order.\n<% } else { %>\n  Sort this column.\n<% } %>",ToggleTables:"Expand/collapse all sub-tables",Composed:"This column replaces <%= replaces.length %> others. Click here\nto show the individual columns separately.",FilterTitle:"<% if (count > 0) { %>\n  <%= count %> active filters.\n<% } else { %>\n  Filter by values in this column.\n<% } %>"})}).call(this)},{"../messages":16}],29:[function(a,b,c){(function(){var b;b=a("../messages"),b.setWithPrefix("undo",{StepTitle:"<% if (label === 'Initial') { %>\n  Initial State\n<% } else if (verb === 'Added') { %>\n  <% if (label === 'sort order element') { %>\n    Added <%= formatNumber(number) %> <%= pluralise('column', number) %> to the sort order\n  <% } else if (label === 'column') { %>\n    Selected <%= formatNumber(number) %> <%= pluralise('column', number) %>\n  <% } else { %>\n    Added <%= formatNumber(number) %> <%= pluralise(label, number) %>\n  <% } %>\n<% } else if (verb === 'Removed') { %>\n  <% if (label === 'sort order element') { %>\n    Removed <%= formatNumber(number) %> <%= pluralise('column', number) %> from the sort order\n  <% } else if (label === 'column') { %>\n    Unselected <%= formatNumber(number) %> <%= pluralise('column', number) %>\n  <% } else { %>\n    Removed <%= formatNumber(number) %> <%= pluralise(label, number) %>\n  <% } %>\n<% } else if (verb === 'Changed') { %>\n  <% if (label === 'sort order element') { %>\n    Changed sort order\n  <% } else { %>\n    Changed <%= pluralise(label, 2) %>\n  <% } %>\n<% } else if (verb === 'Rearranged') { %>\n  Rearranged <%= pluralise(label, 2) %>\n<% } else { %>\n  !!!Cannot handle <%= verb %> <%= label %>!!!\n<% } %>",StepCount:'<%= formatNumber(count) %> <%= pluralise("row", count) %>',RevertToState:"Revert to this state",IsCurrentState:"This is the current state",ViewCount:'<%= n %> <%= pluralise("column", n) %> selected',ConstraintCount:"<% if (n) { %>\n  <%= n %> <%= pluralise('filter', n) %>\n<% } else { %>\n  No filters\n<% } %>",OrderElemCount:"<% if (n) { %>\n  Sorted on <%= n %> <%= pluralise('column', n) %>\n<% } else { %>\n  Not sorted\n<% } %>",ShowAllStates:"Show <%= n %> hidden <%= pluralise('state', n) %>",ToggleTrivial:'<%= hideTrivial ? "Hiding" : "Hide" %> minor steps',ToggleTrivialTitle:'<%= hideTrivial ? "Hiding" : "Hide" %> steps that did not change the row count',Revision:"no. <%= v %>",RevisionTitle:"revision <%= v %>",MoreSteps:'<%= more %> more <%= pluralise("step", more) %>'})}).call(this)},{"../messages":16}],30:[function(a,b,c){(function(){var b,d;b=a("jquery"),d=function(a){var c,d,e;return c=b("body"),d=c.width(),e=a.width(),a.css({left:(d-e)/2,top:50})},c._showModal=function(){var a;return a=this.$el,a.modal({show:!1}).addClass("im-floating").draggable({handle:".modal-header"}).show(function(){return d(a),a.animate({opacity:1},{complete:function(){return a.addClass("in")}})}),this.listenToOnce(this,"remove",function(a){return function(){return a.$el.draggable("destroy")}}(this))},c._hideModal=function(){return this.$el.removeClass("in"),this.onHidden()}}).call(this)},{jquery:288}],31:[function(a,b,c){(function(){var b;b=a("underscore"),c.setChildIndices=function(a,c,d){var e,f,g,h,i,j,k,l,m;for(null==c&&(c="top"),null==d&&(d="collection"),g=this.children,e=this[d],j=b.compact(e.map(function(b){return g[a(b)]})),h=b.sortBy(j,function(a){return a.el.getBoundingClientRect()[c]}),m=[],f=k=0,l=h.length;k<l;f=++k)i=h[f],m.push(i.model.set({index:f}));return m}}).call(this)},{underscore:310}],32:[function(a,b,c){(function(){var b;b=a("underscore"),c.initTypeaheads=function(){return null!=this._typeaheads?this._typeaheads:this._typeaheads=[]},c.removeTypeAheads=function(){var a,b;if(null!=this._typeaheads){for(b=[];a=this._typeaheads.shift();)a.off("typeahead:select"),a.off("typeahead:selected"),a.off("typeahead:autocompleted"),a.off("typeahead:close"),b.push(a.typeahead("destroy"));return b}},c.lastTypeahead=function(){var a;return b.last(null!=(a=this._typeaheads)?a:[])},c.activateTypeahead=function(a,b,c,d,e,f){return a.attr({placeholder:d}).typeahead(b,c),a.on("typeahead:selected",e),a.on("typeahead:select",e),a.on("typeahead:autocompleted",e),null!=f&&a.on("typeahead:close",f),this.initTypeaheads().push(a),a.focus(),this}}).call(this)},{underscore:310}],33:[function(a,b,c){(function(){var b,d;d=a("underscore"),b={},c.runQuery=function(a){var c,d,e,f,g;return null==a&&(a={}),f=this.getExportParameters(a),e="results:"+this.query.service.root+":"+JSON.stringify(f),c="query/results",d=this.model.get("format"),(null!=(g=d.needs)?g.length:void 0)&&(c+="/"+d.id),null!=b[e]?b[e]:b[e]=this.query.service.post(c,f)},c.getEstimatedSize=function(){var a,c;return c=this.getExportQuery(),a="count:"+c.service.root+":"+c.toXML(),null!=b[a]?b[a]:b[a]=c.count()},c.getExportQuery=function(){var a,b;return b=this.query.clone(),a=this.model.get("columns"),(null!=a?a.length:void 0)&&b.select(a),b},c.getExportURI=function(a){return this.getExportQuery().getExportURI(this.model.get("format").id,this.getExportParameters(a))},c.getFileName=function(){return this.getBaseName()+"."+this.getFileExtension()},c.getBaseName=function(){return this.model.get("filename")},c.getFileExtension=function(){return this.model.get("format").ext},c.getExportParameters=function(a){var b;return null==a&&(a={}),b=this.model.pick("start","size","format","filename"),b.format=b.format.id,b.query=this.getExportQuery().toXML(),this.model.get("compress")&&(b.compress=this.model.get("compression")),this.model.get("headers")&&(b.columnheaders=this.model.get("headerType")),"json"===b.format&&"rows"!==this.model.get("jsonFormat")&&(b.format+=this.model.get("jsonFormat")),"fasta"===b.format&&this.model.get("fastaExtension")&&(b.extension=this.model.get("fastaExtension")),"fasta"!==b.format&&"gff3"!==b.format||(b.view=this.model.get("columns")),d.extend(b,a)}}).call(this)},{underscore:310}],34:[function(a,b,c){(function(){c.setPathNames=function(){var a,b,c,d,e,f,g,h,i,j;return b=null!=(i=this.query)?i:this.model.query,h=null!=(j=this.view)?j:this.model.view,d=b.service,g=h.getParent().getType(),a=h.end,c=this.state,e=function(a){return function(b){return c.set(a,b)}},f=e("error"),h.getDisplayName().then(e("pathName"),f),g.getDisplayName().then(e("typeName"),f),d.get("model/"+g.name+"/"+a.name).then(function(a){return a.name}).then(e("endName"),f)}}).call(this)},{}],35:[function(a,b,c){(function(){var c,d={}.hasOwnProperty,e=function(a,b){function c(){this.constructor=a}for(var e in b)d.call(b,e)&&(a[e]=b[e]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};a("underscore"),c=a("../core-model"),b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return e(b,a),b.prototype.defaults=function(){return{target:null,type:null}},b}(c)}).call(this)},{"../core-model":2,underscore:310}],36:[function(a,b,c){(function(){var c,d,e,f,g,h={}.hasOwnProperty,i=function(a,b){function c(){this.constructor=a}for(var d in b)h.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};c=a("../core/collection"),d=a("./path"),e=function(a,b,c){var d,e,f,g;return g=function(){var d,e,g,h;for(g=[b,c],h=[],d=0,e=g.length;d<e;d++)f=g[d],h.push(a(f));return h}(),d=g[0],e=g[1],d<e?-1:d>e?1:0},g=function(a){return a.get("parts").length},f=function(a){return a.get("displayName")},b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return i(b,a),b.prototype.model=d,b.prototype.add=function(a){var c;if((c=b.__super__.add.apply(this,arguments))&&null==c.collection)return c.collection=this},b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this.on("change:parts change:displayName",function(a){return function(){return a.sort()}}(this))},b.prototype.comparator=function(a,b){return e(g,a,b)||e(f,a,b)},b}(c)}).call(this)},{"../core/collection":5,"./path":56}],37:[function(a,b,c){(function(){var c,d,e,f,g,h={}.hasOwnProperty,i=function(a,b){function c(){this.constructor=a}for(var d in b)h.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};g=a("underscore"),f=a("es6-promise").Promise,e=a("../options"),c=a("../core-model"),d="DynamicObjects.NameDelimiter",b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return i(b,a),b.prototype.defaults=function(){return{columnName:null,typeName:null,typeNames:[],entity:null,column:null,node:null,field:null,value:null}},b.prototype.initialize=function(){var a,c,g,h,i,j;return b.__super__.initialize.apply(this,arguments),i=null!=(j=this.get("entity").get("classes"))?j:[this.get("node")],c=(a=this.get("column")).model,a.getDisplayName().then(function(a){return function(b){return a.set({columnName:b})}}(this)),g=function(){var a,b,d;for(d=[],a=0,b=i.length;a<b;a++)h=i[a],d.push(c.makePath(h).getDisplayName());return d}(),f.all(g).then(function(a){return function(b){return a.set({typeNames:b,typeName:b.join(e.get(d))})}}(this))},b.prototype.getPath=function(){return this.get("column")},b.prototype.toJSON=function(){return g.extend(b.__super__.toJSON.apply(this,arguments),{column:this.get("column").toString(),node:this.get("node").toString(),entity:this.get("entity").toJSON()})},b}(c)}).call(this)},{"../core-model":2,"../options":63,"es6-promise":257,underscore:310}],38:[function(a,b,c){(function(){var c,d,e={}.hasOwnProperty,f=function(a,b){function c(){this.constructor=a}for(var d in b)e.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};d=a("../options"),c=a("../core-model"),b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return f(b,a),b.prototype.defaults=function(){return{lang:d.get("CodeGen.Default"),showBoilerPlate:!1,highlightSyntax:!0}},b}(c)}).call(this)},{"../core-model":2,"../options":63}],39:[function(a,b,c){(function(){var c,d,e,f={}.hasOwnProperty,g=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};c=a("../core/collection"),d=a("./header"),e=a("../utils/build-headers"),b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return g(b,a),b.prototype.model=d,b.prototype.comparator="index",b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this.listenTo(this,"change:index",this.sort)},b.prototype.setHeaders=function(a,b){var c;return c=e(a,b),c.then(function(b){return function(c){var e;return b.set(function(){
var b,f,g;for(g=[],b=0,f=c.length;b<f;b++)e=c[b],g.push(new d(e,a));return g}())}}(this))},b}(c)}).call(this)},{"../core/collection":5,"../utils/build-headers":71,"./header":44}],40:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l=[].indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(b in this&&this[b]===a)return b;return-1},m={}.hasOwnProperty,n=function(a,b){function c(){this.constructor=a}for(var d in b)m.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};j=a("underscore"),k=a("imjs").Query,c=k.LIST_OPS,d=k.LOOP_OPS,h=k.TERNARY_OPS,g=k.RANGE_OPS,e=k.NULL_OPS,f=a("./path"),i=function(a){var b,f,i,j,k;if(a.path.isAttribute())return a.values?"MULTI_VALUE":"ATTR_VALUE";if(a.type)return"TYPE";if(a.ids)return"IDS";if(a.values&&(b=a.op,l.call(g,b)>=0))return"RANGE";if(f=a.op,l.call(h,f)>=0)return"LOOKUP";if(i=a.op,l.call(c,i)>=0)return"LIST";if(j=a.op,l.call(d,j)>=0)return"LOOP";if(k=a.op,l.call(e,k)>=0)return a.op;throw new Error("Cannot determine constraint type: "+a.path+" "+a.op)},b.exports=function(a){function b(a){var c;b.__super__.constructor.call(this,a.path),c=a.type,this.unset("id"),this.unset("type"),this.set(j.omit(a,"path","type")),null!=c&&(this.set({type:c.toString()}),c.getDisplayName().then(function(a){return function(b){return a.set({typeName:b})}}(this))),this.set({CONSTRAINT_TYPE:i(a)})}return n(b,a),b.prototype.defaults=function(){return j.extend(b.__super__.defaults.apply(this,arguments),{value:null,values:[],ids:[],extraValue:null,code:null,CONSTRAINT_TYPE:"ATTR_VALUE"})},b}(f)}).call(this)},{"./path":56,imjs:271,underscore:310}],41:[function(a,b,c){(function(){var c,d,e,f,g,h={}.hasOwnProperty,i=function(a,b){function c(){this.constructor=a}for(var d in b)h.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};g=a("underscore"),d=a("../core-model"),c=a("../core/collection"),e=/,\s*/,f=function(a){return a.replace(/(^\s+|\s+$)/g,"")},b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return i(b,a),b.prototype.defaults=function(){return{name:null,description:null}},b.prototype.initialize=function(){var a;return this.tags=new c,this.has("tags")&&this.tags.reset(function(){var b,c,d,e;for(d=this.get("tags"),e=[],b=0,c=d.length;b<c;b++)a=d[b],e.push({id:a});return e}.call(this)),this.listenTo(this.tags,"remove",function(a){return function(b){return a.trigger("remove:tag",b),a.trigger("change")}}(this)),this.listenTo(this.tags,"add",function(a){return function(b){return a.trigger("add:tag",b),a.trigger("change")}}(this))},b.prototype.toJSON=function(){return g.extend(b.__super__.toJSON.apply(this,arguments),{tags:this.tags.map(function(a){return a.get("id")})})},b.prototype.addTag=function(){var a,b,c,d,g,h;if(null==(b=this.get("nextTag")))throw new Error("No tag to add");for(this.unset("nextTag"),g=f(b).split(e),h=[],c=0,d=g.length;c<d;c++)a=g[c],h.push(this.tags.add({id:a}));return h},b.prototype.destroy=function(){var a;return null!=(a=this.tags)&&a.close(),b.__super__.destroy.apply(this,arguments)},b}(d)}).call(this)},{"../core-model":2,"../core/collection":5,underscore:310}],42:[function(a,b,c){(function(){var b,d,e;e=a("underscore"),b=function(){function a(a){var b,c,d,f,g,h;this.id=a.id,this.group=a.group,f=a.icon,h=a.needs,this.maxColumns=a.maxColumns,d="tab"===this.id?"tsv":this.id,b=d.toUpperCase(),null==f&&(f=d),null==h&&(h=[]),c="export.format.description."+b,g="export.format.name."+b,e.extend(this,{icon:f,desc:c,name:g,needs:h,ext:d,EXT:b})}return a.prototype.toString=function(){return this.ext},a.prototype.toJSON=function(){return{id:this.id,group:this.group,icon:this.icon,needs:this.needs,ext:this.ext}},a.prototype.isSuitable=function(a){return 0===this.needs.length||e.any(this.needs,function(b){return a[b]})},a}(),d=[new b({id:"tab",group:"flat"}),new b({id:"csv",group:"flat"}),new b({id:"xml",group:"machine"}),new b({id:"json",group:"machine"}),new b({id:"fasta",group:"bio",icon:"dna",needs:["Protein","SequenceFeature"],maxColumns:1}),new b({id:"gff3",group:"bio",icon:"dna",needs:["SequenceFeature"]}),new b({id:"bed",group:"bio",icon:"dna",needs:["SequenceFeature"]}),new b({id:"fake",group:"fake",icon:"fake",needs:["Department"]}),new b({id:"fake_2",group:"fake",icon:"fake",needs:["Company"]})],c.getFormat=function(a){return e.findWhere(d,{id:a})},c.getFormats=function(a){var b,c,e,f;for(f=[],c=0,e=d.length;c<e;c++)b=d[c],b.isSuitable(a)&&f.push(b);return f},c.registerFormat=function(a){var c,e,f;return e=a.id,c=a.icons,f=a.needs,d.push(new b(e,c,f))}}).call(this)},{underscore:310}],43:[function(a,b,c){(function(){var c,d={}.hasOwnProperty,e=function(a,b){function c(){this.constructor=a}for(var e in b)d.call(b,e)&&(a[e]=b[e]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};c=a("../core-model"),b.exports=function(a){function b(a,c){b.__super__.constructor.call(this),this.set({id:null,classes:[a.class],"service:base":"","service:url":"","report:uri":null}),this.set(c,a.value)}return e(b,a),b}(c)}).call(this)},{"../core-model":2}],44:[function(a,b,c){(function(){var c,d,e,f,g,h,i={}.hasOwnProperty,j=function(a,b){function c(){this.constructor=a}for(var d in b)i.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};h=a("underscore"),d=a("./path"),c=a("../options"),g=function(a){return null!=a?a.toUpperCase():void 0},e=h.compose(h.first,h.compact,h.map),f=function(a){return null!=a&&null!=a.isReference&&null!=a.isAttribute},b.exports=function(a){function b(a,c){var d;if(this.query=c,!(null!=(d=this.query)?d.on:void 0))throw new Error("no query");if(null==a)throw new Error("no options");b.__super__.constructor.call(this,a.path),this.set(h.omit(a,"path")),this.set({id:this.query.toXML()+"-"+this.get("path")}),this.listenTo(this.query,"change:joins",this.setOuterJoined),this.listenTo(this.query,"change:sortorder",this.setSortDirection),this.listenTo(this.query,"change:constraints",this.setConstraintNum),this._update_attrs()}return j(b,a),b.prototype.defaults=function(){return h.extend(b.__super__.defaults.apply(this,arguments),{replaces:[],isFormatted:!1,isComposed:!1,sortable:!0,sortDirection:null,numOfCons:0,minimised:!1,outerJoined:!1,expanded:c.get("Subtables.Initially.Expanded")})},b.prototype._update_attrs=function(){return this.setOuterJoined(),this.setSortDirection(),this.setConstraintNum()},b.prototype.toJSON=function(){return h.extend(b.__super__.toJSON.apply(this,arguments),{replaces:this.get("replaces").map(String)})},b.prototype.getView=function(){var a,b,c,d;return d=this.pick("replaces","isFormatted","path"),c=d.replaces,a=d.isFormatted,b=d.path,String(a&&1===c.length?c[0]:b)},b.prototype.validate=function(a,b){var c;if("replaces"in a){if(c=a.replaces,!h.isArray(c))return new Error("replaces must be an array");if(c.length&&!h.all(c,f))return new Error("all elements in replaces must be PathInfo objects")}},b.prototype.setOuterJoined=function(){var a,b,c,d,e;return e=this.getView(),c=this.get("replaces"),b=this.query.isOuterJoined(e),a=this.get("isFormatted")&&c.length>1,d=!b,this.set({outerJoined:b,isComposed:a,sortable:d})},b.prototype.setSortDirection=function(){var a,b,c,d;return c=this.get("replaces"),d=this.getView(),b=function(a){return function(b){return a.query.getSortDirection(b)}}(this),a=g(e(c.concat([d]),b)),this.set({sortDirection:a})},b.prototype.setConstraintNum=function(){var a,b,c;return c=this.getView(),b=h.size(function(){var b,d,e,f;for(e=this.query.constraints,f=[],b=0,d=e.length;b<d;b++)a=e[b],a.path.match(c)&&f.push(a);return f}.call(this)),this.set({numOfCons:b})},b}(d)}).call(this)},{"../options":63,"./path":56,underscore:310}],45:[function(a,b,c){(function(){var c,d,e,f={}.hasOwnProperty,g=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};e=a("underscore"),c=a("../core/collection"),d=a("./step"),b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return g(b,a),b.prototype.model=d,b.prototype.currentQuery=null,b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this.listenTo(this,"remove",this.unwatch),this.listenTo(this,"add",this.watch)},b.prototype.currentStep=0,b.prototype.comparator="revision",b.prototype.getCurrentQuery=function(){return this.currentQuery},b.prototype.setCurrentQuery=function(a){return this.currentQuery=a.get("query").clone()},b.prototype.unwatch=function(a){var b,c;if(null!=(b=null!=(c=null!=a?a.get("query"):void 0)?c:this.getCurrentQuery()))return this.stopListening(b)},b.prototype.watch=function(a){var b;if(this.setCurrentQuery(a),null!=(b=this.getCurrentQuery()))return this.listenTo(b,"change:constraints",this.onChangeConstraints),this.listenTo(b,"change:views",this.onChangeViews),this.listenTo(b,"change:joins",this.onChangeJoins),this.listenTo(b,"change:sortorder",this.onChangeSortOrder),this.listenTo(b,"change:logic",this.onChangeLogic),this.listenTo(b,"undo",this.popState)},b.prototype.onChangeConstraints=function(){return this.onChange("constraints","filter",function(a){return e.map(a,JSON.stringify)})},b.prototype.onChangeViews=function(){return this.onChange("views","column")},b.prototype.onChangeJoins=function(){return this.onChange("joins","join",function(a){return e.map(a,function(a,b){return b+":"+a})})},b.prototype.onChangeSortOrder=function(){return this.onChange("sortOrder","sort order element",function(a){return e.map(a,JSON.stringify)})},b.prototype.onChangeLogic=function(){return this.onChange("constraintLogic","constraint logic element",function(a){var b;return null!=(b=null!=a?a.match(/([A-Z]+)/):void 0)?b:[]})},b.prototype.triggerChangedCurrent=function(){return this.trigger("changed:current",this.last())},b.prototype.onChange=function(a,b,c){var d,f,g,h,i,j,k,l;return null==c&&(c=function(a){return a}),h=this.currentQuery,g=this.last().get("query"),k=c(g[a]),l=c(h[a]),j=k.length,f=l.length,d=Math.abs(j-f),i=function(){switch(!1){case!(j<f):return"Added";case!(j>f):return"Removed";case f!==e.union(k,l).length:return"Rearranged";default:return"Changed"}}(),this.addStep(i,d,b,h)},b.prototype.setInitialState=function(a){return this.size()&&this.reset(),this.addStep(null,null,"Initial",a)},b.prototype.addStep=function(a,b,c,d){var e,f;return f=this.currentQuery,e=d.clone(),this.unwatch(),this.add({query:e,revision:this.currentStep++,title:{verb:a,number:b,label:c}}),null!=f&&f.trigger("replaced:by",e),this.triggerChangedCurrent()},b.prototype.popState=function(){return this.revertToIndex(-2)},b.prototype.revertToIndex=function(a){var b;return a<0&&(a=this.length+a),b=this.at(a),this.revertTo(b)},b.prototype.revertTo=function(a){var b,c;if(!this.contains(a))throw new Error("State not in history");for(c=this.getCurrentQuery(),b=a.get("revision");this.last().get("revision")>b;)this.pop();return this.watch(a),null!=c&&c.trigger("replaced:by",a.get("query")),this.triggerChangedCurrent()},b}(c)}).call(this)},{"../core/collection":5,"./step":59,underscore:310}],46:[function(a,b,c){(function(){var c,d,e={}.hasOwnProperty,f=function(a,b){function c(){this.constructor=a}for(var d in b)e.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};d=a("underscore"),c=a("../core-model"),b.exports=function(a){function b(a,c,d){b.__super__.constructor.call(this,{classes:null!=c?c.map(String):void 0,id:d}),this.set({"service:base":a}),this.freeze("service:base","id","classes")}return f(b,a),b.prototype.toJSON=function(){var a,c;return c=this.get("service:url"),a=/^http/.test(c)?c:this.get("service:base")+c,d.extend(b.__super__.toJSON.apply(this,arguments),{"report:uri":a})},b.prototype.merge=function(a,b){return this.set(b,a.value),this.set({"service:url":a.url})},b}(c)}).call(this)},{"../core-model":2,underscore:310}],47:[function(a,b,c){(function(){var c,d,e,f,g,h={}.hasOwnProperty,i=function(a,b){function c(){this.constructor=a}for(var d in b)h.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};g=a("underscore"),c=a("../core/collection"),f=a("./path"),d=function(a){function b(a){var c,d;c=a.path,d=a.style,b.__super__.constructor.call(this,c),null!=d&&this.set({style:d})}return i(b,a),b.prototype.defaults=function(){return g.extend(b.__super__.defaults.apply(this,arguments),{style:"INNER"})},b}(f),b.exports=e=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return i(b,a),b.prototype.model=d,b.prototype.comparator="displayName",b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this.listenTo(this,"change:displayName",this.sort)},b.prototype.getJoins=function(){return g.object(this.where({style:"OUTER"}).map(function(a){return[a.get("path"),a.get("style")]}))},b}(c),e.fromQuery=function(a){var b,c,f,g,h,i,j,k,l;b=new e,k=a.joins;for(f in k)h=k[f],g=a.makePath(f),b.add(new d({style:h,path:g}));for(l=a.getQueryNodes(),i=0,j=l.length;i<j;i++)for(c=l[i];!c.isRoot();)b.add(new d({path:c})),c=c.getParent();return b}}).call(this)},{"../core/collection":5,"./path":56,underscore:310}],48:[function(a,b,c){(function(){var c,d,e={}.hasOwnProperty,f=function(a,b){function c(){this.constructor=a}for(var d in b)e.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};d=a("underscore"),c=a("../core-model"),b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return f(b,a),b.prototype.defaults=function(){return{columnName:null,columnTypeName:null,columnName:null,typeName:null,column:null,node:null,fieldName:null,contentName:null,view:[],rows:[]}},b.prototype.initialize=function(){return this.onChangeColumn(),this.listenTo(this,"change:column",this.onChangeColumn)},b.prototype.onChangeColumn=function(){var a,b,c;return a=this.get("column"),b=this.get("node"),c=this.get("view"),1===c.length&&(a=a.model.makePath(c[0],a.subclasses),b=a.isAttribute()?a.getParent():a),b.getType().getDisplayName().then(function(a){return function(b){return a.set({columnTypeName:b})}}(this)),a.getDisplayName().then(function(b){return function(c){return b.set({columnName:c}),a.isAttribute()&&b.set({fieldName:d.last(c.split(" > "))}),b.set({contentName:d.compact([b.get("columnTypeName"),b.get("fieldName")]).join(" ")})}}(this))},b.prototype.getPath=function(){return this.get("column")},b.prototype.toJSON=function(){return d.extend(b.__super__.toJSON.apply(this,arguments),{column:this.get("column").toString(),node:this.get("node").toString(),rows:this.get("rows").map(function(a){return a.map(function(a){return a.toJSON()})})})},b}(c)}).call(this)},{"../core-model":2,underscore:310}],49:[function(a,b,c){(function(){var c,d={}.hasOwnProperty,e=function(a,b){function c(){this.constructor=a}for(var e in b)d.call(b,e)&&(a[e]=b[e]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};c=a("../core-model"),b.exports=function(a){function b(a,c){b.__super__.constructor.call(this),this.set({id:null,isNULL:!0,classes:[a],"service:base":"","service:url":"","report:uri":null}),c&&this.set(c,null)}return e(b,a),b}(c)}).call(this)},{"../core-model":2}],50:[function(a,b,c){(function(){var c,d,e={}.hasOwnProperty,f=function(a,b){function c(){this.constructor=a}for(var d in b)e.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};d=a("underscore"),c=a("backbone"),b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return f(b,a),b.prototype._defaults={},b.prototype.setLimits=function(a){return d.extend(this._defaults,a)},b.prototype.get=function(a){var c;return c=b.__super__.get.call(this,a),null!=c?c:a in this._defaults?this._defaults[a]:null},b.prototype.toJSON=function(){return d.extend({},this._defaults,this.attributes)},b.prototype.nullify=function(){var a,b,c,d,e;for(this.unset("min"),this.unset("max"),this.nulled=!0,d=["change:min","change:max","change"],e=[],b=0,c=d.length;b<c;b++)a=d[b],e.push(this.trigger(a,this));return e},b.prototype.reset=function(){return this.clear(),this.trigger("reset",this)},b.prototype.set=function(a,c){var e;return this.nulled=!1,d.isString(a)&&a in this._defaults?(e="min"===a?"max":"min",b.__super__.set.call(this,a,Math[e](this._defaults[a],c))):b.__super__.set.apply(this,arguments)},b.prototype.isAll=function(){return!this.isNotAll()},b.prototype.isNotAll=function(){var a,b,c;return!this.nulled&&(c=this.toJSON(),b=c.min,a=c.max,null!=b&&b!==this._defaults.min||null!=a&&a!==this._defaults.max)},b}(c.Model)}).call(this)},{backbone:236,underscore:310}],51:[function(a,b,c){(function(){var c;a("underscore"),c=a("./intermine-object"),b.exports=function(){function a(a,b){if(this.schema=b,null==a)throw new Error("No root");if(null==this.schema)throw new Error("no schema");this.base=a.replace(/\/service\/?$/,""),this._objects={}}return a.prototype.get=function(a,b){var c,d,e;return c=null!=(d=this._objects)[e=a.id]?d[e]:d[e]=this._newObject(a),c.merge(a,b),c},a.prototype._newObject=function(a){var b,d;return d=function(){var c,d,e,f,g,h;for(g=null!=(e=null!=(f=a.class)?f.split(","):void 0)?e:[],h=[],c=0,d=g.length;c<d;c++)b=g[c],h.push(this.schema.makePath(b));return h}.call(this),new c(this.base,d,a.id)},a.prototype.destroy=function(){var a,b,c;c=this._objects;for(a in c)b=c[a],b.destroy();return delete this.selectedObjects,delete this._objects},a}()}).call(this)},{"./intermine-object":46,underscore:310}],52:[function(a,b,c){(function(){var c,d,e,f={}.hasOwnProperty,g=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};c=a("backbone"),d=a("./uniq-items"),e=function(a,b){if(!(null!=a?a.equals:void 0)||!(null!=b?b.isRoot:void 0))return!1;for(;!a.equals(b);){if(b.isRoot())return!1;b=b.getParent()}return!0},b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return g(b,a),b.prototype.contains=function(a){return a instanceof c.Model?b.__super__.contains.call(this,a):this.any(function(b){return e(a,b.get("item"))})},b.prototype.remove=function(a){var d,f,g,h,i;if(null==a)return!1;for(a instanceof c.Model&&b.__super__.remove.call(this,a),d=this.filter(function(b){return e(a,b.get("item"))}),i=[],g=0,h=d.length;g<h;g++)f=d[g],i.push(b.__super__.remove.call(this,f));return i},b}(d)}).call(this)},{"./uniq-items":62,backbone:236}],53:[function(a,b,c){(function(){var c,d={}.hasOwnProperty,e=function(a,b){function c(){this.constructor=a}for(var e in b)d.call(b,e)&&(a[e]=b[e]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};c=a("./path"),b.exports=function(a){function b(a){var c,d;d=a.path,c=a.direction,b.__super__.constructor.call(this,d),null==c&&(c="ASC"),this.set({direction:c})}return e(b,a),b.prototype.asOrderElement=function(){return this.pick("path","direction")},b.prototype.toOrderString=function(){return this.get("path")+" "+this.get("direction")},b}(c)}).call(this)},{"./path":56}],54:[function(a,b,c){(function(){b.exports=function(){function a(a,b){if(this.start=a,this.size=null!=b?b:null,!(null!=this.start&&this.start>=0))throw new Error("Start must be >= 0");if(null!=this.size&&this.size<0)throw new Error("Size must be null or Natural")}return a.prototype.end=function(){return this.all()?null:this.start+this.size},a.prototype.all=function(){return!this.size},a.prototype.isBefore=function(a){return null!=this.size&&this.end()<a},a.prototype.isAfter=function(a){return a<this.start},a.prototype.leftGap=function(a){return this.isAfter(a)?this.start-a:null},a.prototype.rightGap=function(a){return this.isBefore(a)?a-this.end():null},a.prototype.next=function(){return new a(this.end(),this.size)},a.prototype.prev=function(){return new a(Math.max(0,this.start-this.size),this.size)},a.prototype.toString=function(){return"Page("+this.start+" .. "+this.end()+")"},a}()}).call(this)},{}],55:[function(a,b,c){(function(){var c,d,e={}.hasOwnProperty,f=function(a,b){function c(){this.constructor=a}for(var d in b)e.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};d=a("./uniq-items"),c=a("backbone"),b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return f(b,a),b.prototype.paths=function(){return this.map(function(a){return a.get("item")})},b.prototype.contains=function(a){return this.any(function(b){return a.equals(b.get("item"))})},b.prototype.toggle=function(a){return this.contains(a)?this.remove(a):this.add(a)},b.prototype.remove=function(a){var d;return a instanceof c.Model?b.__super__.remove.apply(this,arguments):(d=this.find(function(b){return a.equals(b.get("item"))}),null!=d?b.__super__.remove.call(this,d):void 0)},b}(d)}).call(this)},{"./uniq-items":62,backbone:236}],56:[function(a,b,c){(function(){var c,d,e,f,g={}.hasOwnProperty,h=function(a,b){function c(){this.constructor=a}for(var d in b)g.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},i=[].indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(b in this&&this[b]===a)return b;return-1};d=a("../core-model"),f=a("imjs").Model,e=f.NUMERIC_TYPES,c=f.BOOLEAN_TYPES,b.exports=function(a){function b(a){b.__super__.constructor.call(this),this.set(this.pathAttributes(a)),this.setDisplayName(a),this.setTypeName(a),this.pathInfo=function(){return a},this.freeze("path","isNumeric","isBoolean","isReference","isAttribute")}return h(b,a),b.prototype.defaults=function(){return{path:null,type:null,displayName:null,typeName:null,parts:[],isNumeric:!1,isBoolean:!1,isReference:!1,isAttribute:!0}},b.prototype.setDisplayName=function(a){return a.getDisplayName().then(function(a){return function(b){return a.set({displayName:b,parts:b.split(" > ")}),a.freeze("displayName","parts")}}(this))},b.prototype.setTypeName=function(a){var b;return b=(a.isAttribute()?a.getParent():a).getType(),b.getDisplayName().then(function(a){return function(b){return a.set({typeName:b})}}(this))},b.prototype.pathAttributes=function(a){var b,d,f,g,h;return f=String(a),d=a.isAttribute(),g=a.getType(),b={id:d?f:f+".id",path:f,type:null!=(h=g.name)?h:g},d?(b.isNumeric=i.call(e,g)>=0,b.isBoolean=i.call(c,g)>=0):(b.isReference=!0,b.isAttribute=!1),b},b}(d)}).call(this)},{"../core-model":2,imjs:271}],57:[function(a,b,c){(function(){var c,d,e,f,g={}.hasOwnProperty,h=function(a,b){function c(){this.constructor=a}for(var d in b)g.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};f=a("underscore"),d=a("../core-model"),c=a("../core/collection"),e=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return h(b,a),b.prototype.defaults=function(){return{index:null,query:null,cells:[]}},b.prototype.toJSON=function(){var a;return f.extend(b.__super__.toJSON.apply(this,arguments),{cells:function(){var b,c,d,e;for(d=this.get("cells"),e=[],b=0,c=d.length;b<c;b++)a=d[b],e.push(a.toJSON());return e}.call(this)})},b}(d),b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return h(b,a),b.prototype.model=e,b.prototype.comparator="index",b}(c)}).call(this)},{"../core-model":2,"../core/collection":5,underscore:310}],58:[function(a,b,c){(function(){var c,d,e,f,g={}.hasOwnProperty,h=function(a,b){function c(){this.constructor=a}for(var d in b)g.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};d=a("../core-model"),c=a("../core/collection"),f=a("../core/type-assertions"),e=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return h(b,a),b.prototype.defaults=function(){return{class:null,id:null}},b.prototype.validate=function(a,b){return"class"in a&&null==a.class?'"class" must not be null':"id"in a&&null==a.id&&'"id" must not be null'},b}(d),b.exports=function(a){function b(a){b.__super__.constructor.call(this),f.assertMatch(f.Service,a,"service"),this.state=new d({node:null,commonType:null,typeName:null}),this.listenTo(this.state,"change:commonType",this.onChangeType),this.listenTo(this.state,"change:node",this.onChangeNode),this.listenTo(this,"add remove reset",this.setType),a.fetchModel().then(function(a){return function(b){return a.schema=b,a.setType()}}(this))}return h(b,a),b.prototype.model=e,b.prototype.onChangeNode=function(){return this.trigger("change:node change",this.state.get("node"))},b.prototype.onChangeType=function(){var a,b;if(null!=this.schema)return null==(b=this.state.get("commonType"))?this.state.set({typeName:null}):(a=this.schema.makePath(b),a.getDisplayName().then(function(a){return function(b){return a.state.set({typeName:b}),a.trigger("change:typeName change")}}(this)),this.trigger("change:commonType change"))},b.prototype.setType=function(){var a;if(null!=this.schema)return a=this.size()?a=this.schema.findCommonType(this.map(function(a){return a.get("class")})):null,null!=a?this.state.set({commonType:a}):this.state.set({commonType:null,typeName:null})},b}(c)}).call(this)},{"../core-model":2,"../core/collection":5,"../core/type-assertions":10}],59:[function(a,b,c){(function(){var c,d,e,f={}.hasOwnProperty,g=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};e=a("underscore"),c=a("../core-model"),d=a("../utils/count-executor"),b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return g(b,a),b.prototype.defaults=function(){return{count:0}},b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this.set({createdAt:new Date}),this.listenTo(this,"change:query",this._setCount),this._setCount()},b.prototype._setCount=function(){var a;return a=this.get("query"),null!=a?d.count(a).then(function(a){return function(b){return a.set({count:b})}}(this)):this.set({count:0})},b.prototype.toJSON=function(){return e.extend(b.__super__.toJSON.apply(this,arguments),{query:this.get("query").toJSON()})},b}(c)}).call(this)},{"../core-model":2,"../utils/count-executor":77,underscore:310}],60:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l={}.hasOwnProperty,m=function(a,b){function c(){this.constructor=a}for(var d in b)l.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};k=a("underscore"),d=a("../core-model"),c=a("../core/collection"),e=a("../options"),i=a("../services/column-summary").getColumnSummary,j=function(a){return"int"===a||"Integer"===a||"long"===a||"Long"===a||"short"===a||"Short"===a},b.exports=function(a){function b(a){var c,d;if(this.query=a.query,this.view=a.view,b.__super__.constructor.call(this),null==this.query)throw new Error("No query in call to new SummaryModel");if(null==this.view)throw new Error("No view in call to new SummaryModel");this.fetch=k.partial(i,this.query,this.view),d=this.view.getType(),c=j(d),this.set({limit:e.get("INITIAL_SUMMARY_ROWS"),canHaveMultipleValues:this.query.canHaveMultipleValues(this.view),type:d,integral:c}),this.histogram=new f,this.items=new h,this.listenTo(this,"change:filterTerm",this.onFilterChange),this.listenTo(this,"change:summaryLimit",this.onLimitChange),this.listenTo(this.query,"change:constraints",this.load),this.load()}return m(b,a),b.prototype.defaults=function(){return{error:null,maxCount:null,loading:!1,initialized:!1,canHaveMultipleValues:!1,numeric:!1,filterTerm:null}},b.prototype.destroy=function(){return this.histogram.close(),this.items.close(),b.__super__.destroy.apply(this,arguments)},b.prototype.getMaxCount=function(){return this.get("maxCount")},b.prototype.hasMore=function(){return!this.get("numeric")&&this.get("got")<this.get("uniqueValues")},b.prototype.hasAll=function(){return!this.hasMore()},b.prototype.toJSON=function(){return k.extend(b.__super__.toJSON.apply(this,arguments),{items:this.items.toJSON(),histogram:this.getHistogram()})},b.prototype.onFilterChange=function(){return this.hasAll()?this.filterLocally():this.load()},b.prototype.filterLocally=function(){var a,b,c;return a=this.get("filterTerm"),null!=a?(b=a.toLowerCase().split(/\s+/),c=function(a){return k.all(b,function(b){return!(!a||!~a.toLowerCase().indexOf(b))})},this.items.each(function(a){return a.show(c(a.get("item")))})):this.items.each(function(a){return a.show()})},b.prototype.increaseLimit=function(a){var b;return null==a&&(a=2),b=a*this.get("limit"),this.set({limit:b})},b.prototype.onLimitChange=function(){return this.load()},b.prototype.setFilterTerm=function(a){return this.set({filterTerm:a})},b.prototype.fetchAll=function(){return this.set({limit:null})},b.prototype.load=function(){return this.set({loading:!0}),this.fetch(this.get("filterTerm"),this.get("limit")).then(this.getSummaryHandler()).then(null,function(a){return function(b){return a.set({error:b})}}(this))},b.prototype.getSummaryHandler=function(){var a;return this.lastSummaryHandlerCreatedAt=a=k.now(),function(b){return function(c){return b.handleSummary(a,c)}}(this)},b.prototype.getHistogram=function(){var a,b,c,d,e,f;if(!(b=this.get("buckets")))return[];for(f=[],a=c=1;1<=b?c<=b:c>=b;a=1<=b?++c:--c)f.push(null!=(d=null!=(e=this.histogram.get(a))?e.get("count"):void 0)?d:0);return f},b.prototype.handleSummary=function(a,b){var c,d,e,f,g,h,i,j,l,m,n,o,p,q;if(o=b.stats,n=b.results,a===this.lastSummaryHandlerCreatedAt)return m=null!=o.max,l={filteredCount:o.filteredCount,uniqueValues:o.uniqueValues,available:null!=(q=o.filteredCount)?q:o.uniqueValues,got:n.length,numeric:m,initialized:!0,loading:!1},m?(e=o.buckets,i=o.max,j=o.min,p=o.stdev,c=o.average,k.extend(l,{buckets:e,max:i,min:j,stdev:parseFloat(p),average:parseFloat(c)}),this.items.size()&&this.items.reset(),this.histogram.set(function(){var a,b,c,e;for(e=[],a=0,b=n.length;a<b;a++)c=n[a],d=c.bucket,f=c.count,e.push({item:d,count:f,id:d});return e}()),l.maxCount=this.histogram.getMaxCount()):(this.histogram.size()&&this.histogram.reset(),this.items.set(function(){var a,b,c,d;for(d=[],g=a=0,b=n.length;a<b;g=++a)c=n[g],h=c.item,f=c.count,d.push({item:h,count:f,id:g});return d}()),l.maxCount=this.items.getMaxCount()),this.set(l)},b}(d),g=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return m(b,a),b.prototype.defaults=function(){return{symbol:null,share:null,visible:!0,selected:!1,hover:!1,count:0,item:null}},b.prototype.select=function(){return this.set({selected:!1})},b.prototype.deselect=function(){return this.set({selected:!1})},b.prototype.hide=function(){return this.set({visible:!1})},b.prototype.show=function(a){return null==a&&(a=!0),this.set({visible:a})},b.prototype.mousein=function(){return this.set({hover:!0})},b.prototype.mouseout=function(){return this.set({hover:!1})},b}(d),h=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return m(b,a),b.prototype.model=g,b.prototype.getMaxCount=function(){var a;return null!=(a=this.first())?a.get("count"):void 0},b}(c),f=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return m(b,a),b.prototype.model=g,b.prototype.getMaxCount=function(){var a;return k.max(function(){var b,c,d,e;for(d=this.models,e=[],b=0,c=d.length;b<c;b++)a=d[b],e.push(a.get("count"));return e}.call(this))},b}(c)}).call(this)},{"../core-model":2,"../core/collection":5,"../options":63,"../services/column-summary":65,underscore:310}],61:[function(a,b,c){(function(){var c,d,e,f=function(a,b){return function(){return a.apply(b,arguments)}},g={}.hasOwnProperty,h=function(a,b){function c(){this.constructor=a}for(var d in b)g.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};d=a("../options"),c=a("../core-model"),e=a("./path-set"),b.exports=function(a){function b(){return this.filled=f(this.filled,this),
b.__super__.constructor.apply(this,arguments)}return h(b,a),b.prototype.defaults=function(){return{phase:"FETCHING",start:0,size:d.get("DefaultPageSize"),count:null,fill:0,error:null,selecting:!1,previewOwner:null,highlitNode:null,minimisedColumns:new e}},b.prototype.initialize=function(){var a;return a=this.get("minimisedColumns"),this.listenTo(a,"add remove reset",function(){return this.trigger("change:minimisedColumns change")}),this.freeze("minimisedColumns")},b.prototype.filled=function(){return this.swap("fill",function(a){return a+1})},b.prototype.toJSON=function(){var a;return a=b.__super__.toJSON.apply(this,arguments),a.minimisedColumns=this.get("minimisedColumns").toJSON().map(String),a},b.prototype.destroy=function(){return this.get("minimisedColumns").close(),b.__super__.destroy.apply(this,arguments)},b}(c)}).call(this)},{"../core-model":2,"../options":63,"./path-set":55}],62:[function(a,b,c){(function(){var c,d,e,f,g,h={}.hasOwnProperty,i=function(a,b){function c(){this.constructor=a}for(var d in b)h.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};c=a("backbone"),g=a("underscore"),e=a("../core-model"),d=a("../core/collection"),f=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return i(b,a),b.prototype.initialize=function(a,b){return null!=b&&this.set(b),this.set({item:a,id:String(a)})},b}(e),b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return i(b,a),b.prototype.model=f,b.prototype.toJSON=function(){var a,b,c,d,e;for(d=this.models,e=[],b=0,c=d.length;b<c;b++)a=d[b],e.push(a.get("item"));return e},b.prototype.togglePresence=function(a){return this.contains(a)?this.remove(a):this.add(a)},b.prototype.get=function(a){return b.__super__.get.call(this,a instanceof c.Model?a:String(a))},b.prototype.contains=function(a){return a instanceof f?b.__super__.contains.call(this,a):null!=this.findWhere({item:a})},b.prototype.add=function(a,c){var d,e,h,i;for(a=g(a).isArray()?a:[a],i=[],e=0,h=a.length;e<h;e++)null!=(d=a[e])&&""!==d&&(this.contains(d)?i.push(void 0):i.push(b.__super__.add.call(this,new f(d,c))));return i},b.prototype.remove=function(a,c){var d,e,h,i;for(a=g(a).isArray()?a:[a],i=[],e=0,h=a.length;e<h;e++)d=a[e],d instanceof f?i.push(b.__super__.remove.call(this,d,c)):i.push(b.__super__.remove.call(this,this.findWhere({item:d}),c));return i},b}(d)}).call(this)},{"../core-model":2,"../core/collection":5,backbone:236,underscore:310}],63:[function(a,b,c){(function(){var c,d,e={}.hasOwnProperty,f=function(a,b){function c(){this.constructor=a}for(var d in b)e.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};c=a("./core/nested-model"),d=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return f(b,a),b.prototype.defaults=function(){return{INITIAL_SUMMARY_ROWS:1e3,NUM_SEPARATOR:",",NUM_CHUNK_SIZE:3,MAX_PIE_SLICES:15,DropdownMax:20,DefaultPageSize:25,DynamicObjects:{NameDelimiter:" / "},CodeGen:{Default:"py",Langs:["py","pl","java","rb","js","xml"],Extra:{js:"codegen.AsHTML"}},ListFreshness:250,MaxSuggestions:1e3,ListCategorisers:["organism.name","department.company.name"],PieColors:"category10",TableResults:{CacheFactor:10,RequestLimit:5e3},TableHeader:{FullPathPopoverEnabled:!0},TableCell:{AddDataClasses:!0,PreviewTrigger:"hover",HoverDelay:200,IndicateOffHostLinks:!0,ExternalLinkIcons:{"http://some.host.somewhere":"http://some.host.somewhere/logo.png"}},ItemDetails:{ShowReferenceCounts:!1,Fields:{},Count:{}},StylePrefix:"imtables",SuggestionDepth:2,Events:{ActivateTab:"mouseenter"},Subtables:{Initially:{expanded:!1}},Facets:{DrawAverageLine:!0,Initially:{Open:!0}},Destinations:["download","Galaxy","GenomeSpace","Drive","Dropbox"],Destination:{download:{Enabled:!0},Galaxy:{Main:"http://main.g2.bx.psu.edu",Current:null,Tool:"flymine",Save:!1,Enabled:!0},GenomeSpace:{Upload:"https://gsui.genomespace.org/jsui/upload/loadUrlToGenomespace.html",Enabled:!0},Drive:{Library:"https://apis.google.com/js/client.js",Enabled:!1},Dropbox:{Library:"https://www.dropbox.com/static/api/2/dropins.js",Enabled:!1}},ShowId:!1,TableWidgets:{Pagination:{enabled:!0,index:0},PageSizer:{enabled:!0,index:1},TableSummary:{enabled:!0,index:2}},CellCutoff:100,ShowHistory:!0,icons:"fontawesome",D3:{Transition:{Easing:"exp",Duration:500,DurationShort:200}},brand:{"http://www_flymine_org/query/service/":{name:"FlyMine"},"http://preview_flymine_org/preview/service/":{name:"FlyMine-Preview"},"http://www_mousemine_org/mousemine/service/":{name:"MouseMine (MGI)"}},Formatters:{testmodel:{},genomic:{}},ColumnManager:{SelectColumn:{Multi:!0}},UndoHistory:{ShowAllStatesCutOff:6}}},b}(c),b.exports=new d,b.exports.Options=d}).call(this)},{"./core/nested-model":8}],64:[function(a,b,c){(function(){c.IS_BLANK=/^\s*$/}).call(this)},{}],65:[function(a,b,c){(function(){var a,b;a={},b=function(a,b){return a.service.root+":"+a.service.token+":"+a.toXML()+":"+b},c.getColumnSummary=function(c,d,e,f){var g;return null!=a[g=b(c,d,e,f)]?a[g]:a[g]=function(){return c.filterSummary(d,e,f)}()}}).call(this)},{}],66:[function(a,b,c){(function(b){(function(){var c,d,e,f;f=b.jQuery,e=c=a("jquery"),d=a("backbone"),d.$=e,b.jQuery=c,a("bootstrap"),a("typeahead.js"),a("jquery-ui/slider"),a("jquery-ui/draggable"),a("jquery-ui/droppable"),a("jquery-ui/sortable"),null!=f?b.jQuery=f:delete b.jQuery}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{backbone:236,bootstrap:238,jquery:288,"jquery-ui/draggable":282,"jquery-ui/droppable":283,"jquery-ui/slider":285,"jquery-ui/sortable":286,"typeahead.js":309}],67:[function(a,b,c){function d(a){if(!a)throw new Error("Name is required.");if(a=a.replace(/-/g,"_"),templ=f[a],templ)return templ;throw new Error('No template registered as "'+a+'"')}var e=a("underscore"),f=c;c.template=function(a,b){return e.template(d(a),b)},c.templateFromParts=function(a,b){var c=a.map(d).join("\n");return e.template(c,b)},f.clear='<div style="clear:both"></div>',c.modal_base='<div class="modal-dialog <%- modalSize %>">\n    <div class="modal-content">\n        <div class="modal-header">\n            <button type="button" class="close">\n                <span aria-hidden="true">&times;</span>\n                <span class="sr-only">Close</span>\n            </button>\n            <h4 class="modal-title"><%- title %></h4>\n        </div>\n        <div class="modal-body">\n            <%= body %>\n        </div>\n    </div>\n</div>\n',c.column_manager_path_chooser_buttons="<button class=\"btn btn-default im-rearrange-columns\">\n  <%- Messages.getText('Cancel') %>\n</button>\n<button class=\"btn btn-success im-add-column\"\n  <%= collection.length ? (void 0) : 'disabled' %> >\n  <%- Messages.getText('columns.AddColumn', {num: collection.length}) %>\n</button>\n\n",c.type_value_controls="<label class=\"span4\">\n    <%- messages.getText('conbuilder.IsA') %>\n</label>\n<% if (subclasses.length == 1) { %>\n  <select disabled class=\"form-control\">\n      <option><%- subclasses[0].text %></option>\n  </select>\n<% } else { %>\n  <%= select(subclasses, isSelected, 'form-control im-value-type') %>\n<% } %>\n  \n",c.select='<select class="<%- data.classes %>">\n  <% _.each(data.options, function (opt) { %>\n    <option value="<%- data.key(opt) %>"\n      <%- data.selectedTest(opt) ? \'selected\' : void 0 %> >\n      <% if (data.contentHandler) { %>\n        <%- data.contentHandler(opt) %>\n      <% } else { %>\n        <%- opt.text %>\n      <% } %>\n    </option>\n  <% }); %>\n</select>\n',c.list_dialogue_button_node='<a href="#">\n    <strong>\n        <%- displayName || path %>\n    </strong>\n    <% if (state.count) { %>\n        (<%- numToString(state.count) %>\n        <%- pluralise((typeName || type), state.count) %>)\n    <% } %>\n</a>\n',c.progress_bar='<% /* requires: doneness (float: 0 <= i <= 1) */ %>\n<% if (doneness != null && doneness >= 0) { %>\n    <div class="progress">\n        <div class="progress-bar progress-bar-striped active"\n             role="progressbar"\n             aria-valuenow="<%- doneness %>"\n             aria-valuemin="0"\n             aria-valuemax="1"\n             style="width: <%- 100 * doneness %>%;">\n            <% if (doneness < 1) { %>\n              <span class="sr-only">\n                <%- Math.round(100 * doneness) %>% <%- Messages.getText(\'Complete\') %>\n              </span>\n            <% } %>\n        </div>\n    </div>\n<% } %>\n',c.cell_preview_reference="<tr>\n    <td class=\"im-field-name\"><%- _.rest(parts).join(' ') %></td>\n    <td class=\"im-field-value <%- field.toLowerCase() %>\">\n        <%- values.join(', ') %>\n    </td>\n</tr>\n",c.no_results="<% /* requires: selectList :: [], canUndo :: bool */ %>\n<td colspan=\"<%- selectList.length %>\">\n  <div class=\"alert alert-warning\">\n    <% if (canUndo) { %>\n      <button class=\"pull-right btn btn-large btn-default btn-undo\">\n        <%= Icons.icon('Undo') %>\n        <%- Messages.getText('Undo') %>\n      </button>\n    <% } %>\n    <strong><%- Messages.getText('table.Empty') %></strong>\n    <p><%- Messages.getText('table.EmptyWhy') %></p>\n  </div>\n</td>\n",c.summary_stats='<table class="table">\n    <thead>\n        <tr>\n            <th><%- Messages.getText(\'summary.Max\') %></th>\n            <th><%- Messages.getText(\'summary.Min\') %></th>\n            <th><%- Messages.getText(\'summary.Average\') %></th>\n            <th><%- Messages.getText(\'summary.StdDev\') %></th>\n        </tr>\n        <tr>\n            <td><%- Messages.getText(\'Number\', {n: max}) %></td>\n            <td><%- Messages.getText(\'Number\', {n: min}) %></td>\n            <td><%- Messages.getText(\'Number\', {n: average}) %></td>\n            <td><%- Messages.getText(\'Number\', {n: stdev}) %></td>\n        </tr>\n    </thead>\n</table>\n\n<div class="row im-range-controls">\n    <div class="col-sm-4 im-range-from">\n        <input type="text"\n               class="form-control im-range-min input im-range-val"\n               value="<%- min %>">\n    </div>\n    <div class="col-sm-1 im-ellipsis">\n        <span>...</span>\n    </div>\n    <div class="col-sm-4 im-range-to">\n        <input type="text"\n               class="form-control im-range-max input im-range-val"\n               value="<%- max %>">\n    </div>\n    <div class="col-sm-3 im-range-buttons">\n        <div class="btn-group pull-right">\n            <button class="btn btn-primary disabled">Apply</button>\n            <button class="btn btn-cancel disabled">Reset</button>\n        </div>\n    </div>\n</div>\n\n<div class="slider"></div>\n\n',c.list_dialogue_body='<div class="im-list-name"></div>\n\n<div class="row">\n  <div class="col-sm-12 im-more-options">\n    <h4>\n      <%= Icons.icon(\'Options\') %>\n      <span class="msg"><%- Messages.getText(\'lists.ShowExtraOptions\', state) %></span>\n    </h4>\n  </div>\n</div>\n\n<div class="im-optional-attributes" style="<%- state.minimised ? \'display:none\' : void 0 %>">\n  <div class="im-list-desc"></div>\n\n  <div class="well im-tags">\n    <div class="row im-active-tags">\n    </div>\n    <div class="row">\n      <div class="col-sm-6 im-apology">\n      </div>\n      <div class="col-sm-6">\n        <div class="im-next-tag">\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n',c.reset_button="<button type=\"button\"\n        <%= (isAll) ? 'disabled' : void 0 %>\n        class=\"btn btn-default btn-reset\">\n    <%- Messages.getText('Reset') %>\n</button>\n",c.active_constraints='<% /* requires: constraints.length */ %>\n<div class="well im-current-constraints">\n    <p class="well-help">\n      <% if (constraints.length) { %>\n        <%- Messages.getText(\'constraints.EditOrRemove\') %>\n      <% } else { %>\n        <%- Messages.getText(\'constraints.None\') %>\n      <% } %>\n    </p>\n\n    <ul class="im-active-constraints">\n    </ul>\n</div>\n',c.logic_manager_body='<div class="form-group">\n  <label class="form-label">\n    <%- Messages.getText(\'logic.LogicLabel\') %>\n    <input type="text"\n          class="im-logic form-control"\n          placeholder="<%- state.defaultLogic %>"\n          value="<%- logic %>">\n  </label>\n</div>\n<div class="form-group">\n  <button class="pull-right btn btn-primary <%- (state.disabled) ? \'disabled\' : null %>"\n          type="submit">\n    <%- Messages.getText(\'logic.ApplyLogic\') %>\n  </button>\n</div>\n',c.constraint_adder_options='<% if (showTree) { %>\n    <div class="col-sm-5">\n        <div class="input-group">\n            <span class="input-group-addon">find</span>\n            <input type="text"\n                value="<%- filter %>"\n                class="im-tree-filter form-control" placeholder="path">\n            <span class="input-group-btn">\n                <button class="btn btn-default im-clear-filter" type="button">\n                    <%- Messages.getText(\'Clear\') %>\n                </button>\n            </span>\n        </div>\n    </div>\n<% } %>\n<div class="col-sm-7">\n    <div class="btn-group">\n        <% if (!showTree) { %>\n            <button type="button" class="btn btn-default btn-chooser im-choose">\n                <%= Icons.icon(\'Tree\') %>\n                <span><%- Messages.getText(\'constraints.BrowseForColumn\') %></span>\n            </button>\n        <% } else { %>\n            <button <%= anyNodeChosen ? void 0 : \'disabled\' %>\n                    class="btn btn-primary im-approve"\n                    type="button" >\n                <%- Messages.getText(\'constraints.Choose\') %>\n                <% _.each(chosen, function (path, i) { %>\n                    <%- path %>\n                    <% if (i + 2 === chosen.length) { %>\n                        <%- Messages.get(\'and\') %>\n                    <% } else if (i + 2 < chosen.length) { %>\n                        <%- Messages.get(\'comma\') %>\n                    <% } %>\n                <% }); %>\n            </button>\n        <% } %>\n    </div>\n    <div class="form-group">\n        <label class="im-tree-option">\n            <%- Messages.getText(\'columns.AllowRevRef\') %>\n            <input type="checkbox"\n                    class="im-allow-rev-ref"\n                    <%= allowRevRefs ? \'checked\' : void 0 %> >\n        </label>\n    </div>\n</div>\n',c.list_dialogue_expander="<button class=\"btn btn-default im-expand-dialogue <%= minimised ? 'active' : void 0 %>\">\n  <%- Messages.getText('lists.picker.Collapse') %>\n</button>\n",c.table_building="<h2><%- Messages.getText('table.Building') %></h2>\n<%= IndeterminateProgressBar %>\n",c.attribute_value_select='<select class="form-control im-con-value-attr">\n    <% _.each(items, function (item) { %>\n    <option <%= (item.item === value) ? \'selected\' : void 0 %> value="<%- item.item %>">\n            <%- item.item %>\n        </option>\n    <% }); %>\n</select>\n',c.export_tab_menu='<% _.each(data.tabs, function (tabDef) { %>\n  <li role="presentation" class="im-tab-<%= tabDef.ident %> <%= data.tab === tabDef.ident ? \'active\' : void 0 %>">\n    <a><%- data.Messages.getText(tabDef.key, data) %></a>\n  </li>\n<% }); %>\n',c.export_fasta_options='<h3><%- Messages.getText(\'export.category.Options\') %></h3>\n\n<div class="form-group">\n    <label><%- Messages.getText(\'FastaExtension\') %></label>\n    <input type="text"\n           value="<%- fastaExtension %>"\n           placeholder="5kbp"\n           class="form-control im-fasta-ext">\n</div>\n',c.list_tags_apology="<% if (!hasTags) { %>\n  <span>\n    <%- Messages.getText('lists.NoTags') %>\n  </span>\n<% } %>\n",c.code_gen_button='<% /* requires lang :: string, options.Langs :: [string] */ %>\n<div class="btn-group language-selector">\n    <button type="button"\n            class="btn btn-default im-show-code-gen-dialogue">\n    </button>\n    <button type="button"\n            data-toggle="dropdown"\n            aria-expanded="false"\n            class="btn btn-default dropdown-toggle">\n        <span class="caret"></span>\n    </button>\n    <ul class="dropdown-menu im-code-gen-langs" role="menu">\n        <% _.each(options.Langs, function (l) { %>\n            <li data-lang="<%- l %>" class="<%= (l === lang) ? \'active\' : void 0 %>">\n                <a href="#"><%- Messages.getText(\'codegen.Lang\', {lang: l}) %></a>\n            </li>\n        <% }); %>\n    </ul>\n</div>\n',c.summary_no_results="<div class=\"alert alert-warning\">\n    <%= Icons.icon('Warning') %>\n    <%- Messages.getText('summary.NoResults', {path: pathName}) %>\n</div>\n\n",c.large_table_disuader='<div class="modal-dialog">\n    <div class="modal-content">\n        <div class="modal-header">\n            <h3>\n            <%= size %> rows - are you sure?\n            </h3>\n        </div>\n\n        <div class="modal-body">\n\n            <p><%= Messages.getText(\'largetable.appeal\', {size: size}) %></p>\n\n            <ul>\n                <li>\n                    <p>\n                        If you want to see all the data, you can page \n                        <span class="label label-info">\n                            <%= Icons.icon(\'GoBack\') %>\n                            backwards\n                        </span>\n                        and \n                        <span class="label label-info">\n                            forwards\n                            <%= Icons.icon(\'GoForward\') %>\n                        </span>\n                        through the results.\n                    </p>\n                    <div class="btn-group">\n                        <a class="btn btn-default im-alternative-action page-backwards" href="#">\n                            <%= Icons.icon(\'GoBack\') %>\n                            go one page back\n                        </a>\n                        <a class="btn btn-default im-alternative-action page-forwards" href="#">\n                            go one page forward\n                            <%= Icons.icon(\'GoForward\') %>\n                        </a>\n                    </div>\n                </li>\n\n                <li>\n                    <p>\n                        If you are looking for something specific, you can use the\n                        <span class="label label-info">filtering tools</span>\n                        to narrow down the result set. Then you \n                        might be able to fit the items you are interested in in a\n                        single page.\n                    </p>\n                    <button class="btn btn-default im-alternative-action add-filter-dialogue">\n                        <%= Icons.icon(\'Filter\') %>\n                        Add a new filter.\n                    </button>\n                </li>\n\n                <li>\n                    <p>\n                        If you want to get and save the results, we suggest\n                        <span class="label label-info">downloading</span>\n                        the results in a format that suits you. \n                    <p>\n                    <button class="btn btn-default im-alternative-action download-menu">\n                        <%= Icons.icon(\'Export\') %>\n                        Open the download menu.\n                    </buttn>\n                </li>\n\n            </ul>\n        </div>\n\n        <div class="modal-footer">\n            <button class="btn btn-primary pull-right">\n                <%- Messages.getText(\'largetable.ok\', {size: size}) %>\n            </button>\n            <button class="btn pull-left close">\n                <%- Messages.getText(\'largetable.abort\') %>\n            </button>\n        </div>\n    </div>\n</div>\n',c.active_constraint='<div class="im-con-overview">\n  <% if (data.con.editable != null && data.con.editable === false) { %>\n    <a title="<%- data.messages.getText(\'conbuilder.NotEditable\') %>">\n        <%= data.icons.icon(\'Lock\') %>\n    </a>\n  <% } else { %>\n    <a class="im-remove-constraint"\n        title="<%- data.messages.getText(\'conbuilder.Remove\') %>"\n        >\n        <%= data.icons.icon(\'RemoveConstraint\') %>\n    </a>\n    <a class="im-edit" title="<%- data.messages.getText(\'conbuilder.EditCon\') %>">\n        <%= data.icons.icon(\'Edit\') %>\n    </a>\n  <% } %>\n</div>\n\n<% /* We use the :empty selector on this element - hence it must be on one line */ %>\n<div class="im-constraint-editor"></div>\n',c.export_add_column_control='<div class="row">\n    <div class="col-sm-1 im-help"\n         title="<%- Messages.getText(\'export.help.AdditionalCols\') %>">\n        <%= Icons.icon(\'Help\', \'lg\') %>\n    </div>\n    <div class="col-sm-11 form-group">\n        <input type="text" class="form-control">\n    </div>\n</div>\n',c.table_subtables_header="<a title=\"<%- Messages.getText('subtables.RemoveColumn') %>\">\n  <%= Icons.icon('Remove') %>\n</a>\n<% if (displayName && columnName) { %>\n  <%- displayName.replace(columnName, '').replace(/^ > /, '') %>\n<% } %>\n",c.table_cell='<% if (state.minimised) { %>\n  &hellip;\n<% } else if (entity.id == null) { %>\n  <% if (value != null && formattedValue != null) { %>\n    <span class="im-displayed-value"><%= value %></span>\n  <% } else if (entity.isNULL) { %>\n    <span class="im-null-entity">\n      <%- Messages.getText(\'table.cell.NullEntity\', {type: entity[\'class\']}) %>\n    </span>\n  <% } else { %>\n    <%= NULL_VALUE %>\n  <% } %>\n<% } else { %>\n  <input\n    class="im-list-chooser"\n    type="checkbox"\n    <% if (input.checked) { %>checked<% } %>\n    <% if (input.disabled) { %>disabled<% } %>\n    style="display:<%- input.display %>">\n\n  <a class="im-cell-link" target="<%- target %>" href="<%= url %>">\n\n    <% if (isForeign) { %>\n      <% if (icon) { %>\n        <img src="<%= icon %>" class="im-external-link"></img>\n      <% } else { %>\n        <%= Icons.icon(\'ExternalLink\') %>\n      <% } %>\n    <% } %>\n\n    <% if (value != null && formattedValue != null) { %>\n      <span class="im-displayed-value"><%= formattedValue %></span>\n    <% } else { %>\n      <%= NULL_VALUE %>\n    <% } %>\n\n  </a>\n\n  <% if (value != null && field === \'url\' && rawValue != url) { %>\n    <a class="im-cell-link external" href="<%= rawValue %>">\n      <%= Icons.icon(\'ExternalLink\') %>\n      <%- Messages.getText(\'table.cell.Link\') %>\n    </a>\n  <% } %>\n<% } %>\n',c.column_manager_sort_order_editor='<% /* requires: collection, available */ %>\n<h4>\n  <%- Messages.getText(\'columns.CurrentSortOrder\', {\n    oes: collection\n  }) %>\n</h4>\n\n<span class="help-block">\n  <%- Messages.getText(\'columns.CurrentSortOrderHelp\') %>\n</span>\n\n<div class="well im-current-sort-order">\n\n  <div class="row">\n    <div class="col-md-6">\n        <% if (collection.length) { %>\n          <ul class="list-group im-active-oes im-connected-list"></ul>\n        <% } else { %>\n          <div class="im-empty-collection">\n            <%- Messages.getText(\'columns.NoSortOrder\') %>\n          </div>\n        <% } %>\n    </div>\n\n    <div class="col-md-6">\n        <% if (available) { %>\n          <div class="im-rubbish-bin">\n            <ul class="list-group im-removed im-available-oes im-connected-list">\n            </ul>\n          </div>\n        <% } %>\n    </div>\n  </div>\n</div>\n',c.cell_preview_reference_relation='<% _.each(collection, function (relation) { %>\n  <li class="im-relation">\n    <span class="im-name"><%- _.last(relation.parts) %></span>\n    <span class="im-count"><%- numToString(relation.count) %></span>\n  </li>\n<% }); %>\n',c.export_preview='<div class="form-group im-export-formats">\n  <label><%- Messages.getText(\'export.param.Format\') %></label>\n  <select class="form-control">\n    <% _.each(formats, function (fmt) { %>\n      <option value="<%- fmt.id %>"\n              <%= (fmt.id === format.id) ? \'selected\' : void 0 %>>\n        <%- Messages.getText(fmt.name) %>\n      </option>\n    <% }); %>\n  </select>\n</div>\n\n<pre class="im-export-preview">\n<%- state.preview %>\n</pre>\n\n<div class="alert alert-info">\n    <strong class="nb">nb</strong>\n    <%- Messages.getText(\'export.preview.Limit\') %>\n</div>\n',c.export_dialogue='<div class="row">\n    <nav class="col-sm-3 menu">\n    </nav>\n    <div class="col-sm-9 main">\n    </div>\n</div>\n',c.column_manager_select_list='<div class="im-removal-and-rearrangement">\n  <button class="pull-right btn btn-success im-add-view-path">\n      <%= Icons.icon(\'Add\') %>\n      <%- Messages.getText(\'columns.FindColumnToAdd\') %>\n  </button>\n\n  <h4>\n    <%- Messages.getText(\'columns.ColumnsSelected\', {columns: collection, removed: hasRubbish}) %>\n  </h4>\n\n  <span class="help-block"><%- Messages.getText(\'columns.CurrentViewHelp\') %></span>\n\n  <div class="well im-current-view">\n\n    <div class="row">\n\n      <div class="col-md-6">\n        <ul class="list-group im-active-view im-connected-list">\n        </ul>\n      </div>\n\n      <div class="col-md-6">\n        <div class="im-rubbish-bin">\n            <%= Icons.icon((hasRubbish ? \'RubbishFull\' : \'Rubbish\'), \'lg\') %>\n            <% if (hasRubbish) { %>\n                <ul class="list-group im-removed im-removed-view im-connected-list">\n                </ul>\n            <% } %>\n        </div>\n      </div>\n\n    </div>\n  </div>\n</div>\n\n<div class="im-addition">\n</div>\n\n',c.export_column_controls='<h4><%- Messages.getText(\'export.heading.Columns\') %></h4>\n\n<ul class="list-group">\n</ul>\n\n<div class="row controls"></div>\n',c.export_dialogue_footer='<% if (linkToFile) { %>\n    <div class="pull-left alert alert-info">\n        <%- Messages.getText(\'export.cloud.FileLocation\', {cloud: dest}) %>\n        <a href="<%= linkToFile %>" target="_blank"><%- linkToFile %></a>\n    </div>\n<% } %>\n\n<button type="button" class="btn btn-cancel">\n    <%- dismissAction %>\n</button>\n\n<% if (dest === \'download\') { %>\n    <a class="btn btn-primary"\n        href="<%- exportURI %>">\n        <%= Icons.icon(primaryIcon) %>\n        <%- primaryAction %>\n    </a>\n<% } else { %>\n    <button type="button"\n            <%= (error || doneness != null) ? \'disabled\' : void 0 %>\n            class="btn btn-primary">\n        <%= Icons.icon(primaryIcon) %>\n        <%- primaryAction %>\n    </button>\n<% } %>\n\n',c.table_subtable='<span class="im-subtable-summary">\n</span>\n<div class="im-table-wrapper">\n</div>\n',c.column_manager_path_name='<% /* requires parts */ %>\n<span class="im-path-name">\n    <% _.each(parts, function (part) { %>\n        <span class="im-name-part"><%- part %></span>\n    <% }); %>\n</span>\n\n',c.count_summary="<% if (size && count) { %>\n  <% var msg = (size == 0 ? '.ShowingAll' : '.ShowingRange'); %>\n  <% ['xs', 'sm', 'md', 'lg'].forEach(function (pageSize) { %>\n    <span class=\"visible-<%= pageSize %>-inline\">\n      <%- Messages.getText('table.' + pageSize + msg, page) %>\n    </span>\n  <% }); %>\n<% } %>\n",c.undo_history='<button class="btn btn-default im-undo">\n  <%= Icons.icon(\'Undo\') %>\n  <span class="visible-lg-inline">\n    <%- Messages.getText(\'Undo\') %>\n  </span>\n</button>\n\n<button class="btn btn-default dropdown-toggle"\n        data-toggle="dropdown">\n  <span class="caret"></span>\n</button>\n\n<ul class="dropdown-menu im-state-list">\n    <li>\n      <button\n          title="<%- Messages.getText(\'undo.ToggleTrivialTitle\', state) %>"\n          class="btn btn-xs btn-default im-toggle-trivial <%= state.hideTrivial ? \'active\' : void 0 %>">\n        <%- Messages.getText(\'undo.ToggleTrivial\', state) %>\n      </button>\n    </li>\n</ul>\n',c.export_json_options="<h3><%- Messages.getText('export.category.Options') %></h3>\n\n<div class=\"radio\">\n    <label>\n        <input type=\"radio\"\n               name=\"rows\"\n               <%= (jsonFormat === 'rows') ? 'checked' : void 0 %>>\n        <%- Messages.getText('export.json.Rows') %>\n        <pre><%- Messages.getText('export.json.RowsExample') %></pre>\n    </label>\n</div>\n\n<div class=\"radio\">\n    <label>\n        <input type=\"radio\"\n               name=\"objects\"\n               <%= (jsonFormat === 'objects') ? 'checked' : void 0 %>>\n        <%- Messages.getText('export.json.Objects') %>\n        <pre><%- Messages.getText('export.json.ObjExample') %></pre>\n    </label>\n</div>\n\n<% if ((size || start) && jsonFormat === 'objects') { %>\n    <div class=\"alert alert-warning\">\n        <h4><%- Messages.get('Warning') %></h4>\n        <p><%- Messages.get('export.json.ObjWarning') %></p>\n    </div>\n<% } %>\n\n",c.too_many_suggestions="<span class=\"alert alert-info\">\n  {{{ icons.icon('Info') }}}\n  {{ messages.getText('conbuilder.TooManySuggestions') }}\n  There are {{ extra }} values we could not include.\n</span>\n",c.table_throbber='<tr class="im-table-throbber">\n  <td colspan="<%= colcount %>">\n    <h2><%- Messages.getText(\'table.RequestingData\') %></h2>\n    <div class="progress progress-info progress-striped active">\n      <div class="bar" style="width: 100%"></div>\n    </div>\n  </td>\n</tr>\n',c.download_popover='<% /* requires: formats, query, path */ %>\n<ul role="menu" class="im-export-summary">\n    <% _.each(formats, function (icon, param) { %>\n      <li role="presentation">\n        <a role="menuitem"\n            href="<%= query.getExportURI(param) %>&summaryPath=<%= path %>">\n            <%= Icons.icon(icon) %>\n            <%- icon.toUpperCase() %>\n        </a>\n      </li>\n    <% }); %>\n</ul>\n',c.value_control_row='<td>\n  <input type="checkbox" {{ (selected) ? \'checked\' : void 0 }}>\n</td>\n<td class="im-multi-value">\n  {{# if (editing) { }}\n    <div class="input-group">\n      <input type="text" value="{{ value }}" class="form-control">\n      <span class="input-group-btn">\n        <button class="btn btn-success im-save"\n                title="{{ messages.getText(\'multivalue.SaveValue\') }}"\n                type="button">\n            {{{ icons.icon(\'OK\') }}}\n            <span class="im-long">{{ messages.getText(\'multivalue.SaveValue\') }}</span>\n        </button>\n        <button class="btn btn-danger im-cancel"\n                title="{{ messages.getText(\'Cancel\') }}"\n                type="button">\n            {{{ icons.icon(\'Cancel\') }}}\n            <span class="im-long">{{ messages.getText(\'Cancel\') }}</span>\n        </button>\n      </span>\n    </div>\n  {{# } else { }}\n    <a class="im-edit pull-right">{{{ icons.icon(\'Edit\') }}}</a>\n    {{ value }}\n  {{# } }}\n</td>\n',c.constraint_editor='<fieldset class="im-constraint-options form-group row">\n  <label class="col-sm-3 path-label"><%- data.con.displayName %></label>\n  <% if (data.con.op) { %>\n    <div class="im-operator col-sm-3">\n        <select class="form-control im-ops">\n        <option selected><%- data.con.op %></option>\n        <% data.otherOperators.forEach(function (op) { %>\n            <option><%- op %></option>\n        <% }); %>\n        </select>\n    </div>\n  <% } %>\n  <div class="col-sm-6 im-value-options im-value-section">\n  </div>\n</fieldset>\n\n<div class="btn-group im-con-buttons">\n  <% data.buttons.forEach(function (b, i) { %>\n  <button class="btn btn-<%= (i === 0) ? \'primary\' : \'default\' %> <%- b.classes %>">\n    <%- data.messages.getText(b.key) %>\n  </button>\n  <% }); %>\n</div>\n',
c.export_format_controls='<h4 class="im-title"></h4>\n\n<% _.each(formats, function (formatDef) { %>\n    <div class="radio">\n        <label>\n            <input type="radio"\n                   name="format"\n                   value="<%= formatDef.id %>"\n                   <%= (formatDef.id === format) ? \'checked\' : void 0 %>>\n            <%= Icons.icon(formatDef.icon) %>\n            <%= Messages.getText(formatDef.desc) %>\n        </label>\n    </div>\n<% }); %>\n',c.constraint_summary="<% if (code) { %>\n  <li><span class=\"text-muted\"><strong><%- code %>:</strong></span></li>\n<% } %>\n<% _.each(labels, function (label) { %>\n  <li>        \n    <span class=\"label label-<%- label.type %>\">\n      <% if (_.include(['error', 'warning'], label.type)) { %>\n        <%= Icons.icon('Error') %>\n        <%- Messages.getText('consummary.' + label.content) %>\n      <% } else if (label.type === 'path') { %>\n        <% _.each(label.content.split(' > '), function (part) { %>\n          <span title=\"<%- label.content %>\" class=\"im-name-part\"><%- part %></span>\n        <% }); %>\n      <% } else { %>\n        <% if (label.icon) { %><%= Icons.icon(label.icon) %><% } %>\n        <%- label.content %>\n      <% } %>\n    </span>\n  </li>\n<% }); %>\n",c.facet_row='<% /* requires: selected, symbol, item, count, percent, opacity, share */ %>\n<td class="im-selector-col">\n  <span><%- symbol %></span>\n  <div class="checkbox"></div>\n</td>\n\n<td class="im-item-col">\n  <% if (item != null) { %>\n    <%- item %>\n  <% } else { %>\n    <span class=null-value>&nbsp;</span>\n  <% } %>\n</td>\n\n<td class="im-count-col">\n  <% if (max > 1) { %>\n    <div class="im-facet-bar"\n         style="width:<%- percent %>%;background:<%- Messages.getText(\'summary.FacetBar\', {opacity: opacity}) %>">\n    </div>\n  <% } %>\n  <span class="im-count"><%- numToString(count) %></span>\n</td>\n\n<% if (share != null) { %>\n    <td class="im-percent-col"><i><%- share.toFixed() %>%</i></td>\n<% } %>\n',c.export_column_control="<span class=\"badge\"><%- item.getType() %></span>\n<span class=\"im-active-state\">\n    <% if (active) { %>\n        <%= Icons.icon('Check') %>\n    <% } else { %>\n        <%= Icons.icon('UnCheck') %>\n    <% } %>\n</span>\n<%- name %>\n",c.constraints_heading="<% /* requires constraints.length */ %>\n<h3>\n  <%- Messages.getText('constraints.Heading', {n: constraints.length}) %>\n</h3>\n",c.boolean_value_controls="<button class=\"btn btn-default im-true {{ (value === true) ? ' active' : void 0 }}\">\n  True\n</button>\n<button class=\"btn btn-default im-false {{ (value === false) ? ' active' : void 0 }}\">\n  False\n</button>\n",c.formatted_sorting="<a> <% /* requires Icons, direction and name */ %>\n    <%= Icons.icon(direction || 'unsorted') %>\n    <span class=\"im-sort-path\"><%- name %></span>\n</a>\n",c.undo_history_step='<% if (!state.current) { %>\n  <button class="btn btn-default btn-small im-state-revert"\n      title="<%- Messages.getText(\'undo.RevertToState\') %>">\n      <%= Icons.icon(\'Undo\') %>\n  </button>\n<% } %>\n\n<h4>\n    <%- Messages.getText(\'undo.StepTitle\', title) %>\n</h4>\n\n<% if (state.current) { %>\n  <span class="help-block"><%- Messages.getText(\'undo.IsCurrentState\') %></span>\n<% } %>\n<div style="clear:both"></div>\n\n<span class="im-revision" title="<%- Messages.getText(\'undo.RevisionTitle\', {v: revision}) %>">\n  <%- Messages.getText(\'undo.Revision\', {v: revision}) %>\n</span>\n\n<div class="im-step-count">\n  <span><%- Messages.getText(\'undo.StepCount\', {count: count}) %></span>\n  <% if (diff) { %>\n    <span class="label im-label-<%= (diff > 0 ) ? \'pos\' : \'neg\' %>">\n      <% if (diff > 0) { %>+<% } %><%- numToString(diff) %>\n    </span>\n  <% } %>\n</div>\n\n<div class="im-step-details"></div>\n\n<div style="clear:both"></div>\n',c.column_manager_restore_path='<% /* requires: restoreTitle */ %>\n<span class="pull-right im-restore-view"\n    title="<%- Messages.getText(restoreTitle) %>">\n    <%= Icons.icon(\'Add\') %>\n</span>\n\n',c.modal_error='<% /* Renders an alert box at various levels, with appropriate icons and messages */ %>\n<% if (error) { %>\n    <div class="pull-left alert <%- errorAlert(error) %>">\n        <% if (!error.cannotDismiss) { %>\n            <button type="button" class="dismiss">\n                <span aria-hidden="true">&times;</span>\n                <span class="sr-only">Close</span>\n            </button>\n        <% } %>\n        <%= Icons.icon(errorIcon(error)) %>\n        <strong><%- Messages.getText(\'ErrorTitle\', error) %></strong>\n        <% if (error.key != null) { %>\n            <%- Messages.getText(error.key) %>\n        <% } else { %>\n            <%- error.message || error %>\n        <% } %>\n    </div>\n<% } %>\n',c.error_message="<% if (error) { %>\n    <div class=\"alert alert-<%= error.level || 'danger' %>\">\n        <%= icons.icon('Error') %>\n        <span class=\"im-conbuilder-error\">\n            <%- error.message || error %>\n        </span>\n    </div>\n<% } %>\n\n",c.join_style='<% /* requires innerJoinBtn, outerJoinBtn */ %>\n<div class="btn-group pull-right">\n  <button class="<%- innerJoinBtn %>">\n    <%- Messages.getText(\'joins.Inner\') %>\n  </button>\n  <button class="<%- outerJoinBtn %>">\n    <%- Messages.getText(\'joins.Outer\') %>\n  </button>\n</div>\n',c.modal_dialogue_opener='<button class="btn btn-default im-open-dialogue">\n  <%= Icons.icon(labels.ICON) %>\n  <span class="im-hidden-sm hidden-sm hidden-xs">\n    <%- Messages.getText(labels.LONG, state) %>\n  </span>\n  <span class="im-visible-sm-inline visible-sm-inline">\n    <%- Messages.getText(labels.SHORT, state) %>\n  <span>\n</button>\n',c.loop_value_controls="<% if (candidateLoops.length) { %>\n    <%= select(candidateLoops, isSelected, 'form-control im-value-options im-con-value') %>\n<% } else { %>\n    <%- messages.getText('conbuilder.NoSuitableLoops') %>\n<% } %>\n",c.extra_value_controls='<label class="im-value-options">\n    <%- messages.getText(\'conbuilder.ExtraLabel\') %>\n    <input type="text" class="im-extra-value form-control"\n            placeholder="<%- state.extraPlaceholder %>"\n            value="<%- con.extraValue %>">\n</label>\n\n',c.cell_preview_error='<div class="alert alert-error">\n    <h4>Error</h4>\n    <p>Sorry. We could not fetch the preview due to an error:</p>\n    <code><%- message %></code>\n</div>\n',c.attribute_value_controls='<div>\n    <input class="form-control im-constraint-value im-value-options im-con-value im-con-value-attr"\n           type="text"\n           placeholder="<%- state.valuePlaceholder %>"\n           value="<%- con.value %>">\n</div>\n',c.column_manager_tabs='<ul class="nav nav-tabs">\n    <li role="presentation" class="<%- classes.view %>">\n      <a href="#">\n        <%- Messages.getText(\'columns.ViewTabTitle\') %>\n      </a>\n    </li>\n    <li role="presentation" class="<%- classes.sortorder %>">\n      <a href="#">\n        <%- Messages.getText(\'columns.SortOrderTabTitle\') %>\n      </a>\n    </li>\n</ul>\n',c.list_tag="<%- id %>\n<span class=\"im-remove\" title=\"<%- Messages.getText('lists.RemoveTag') %>\">\n    <%= Icons.icon('Remove') %>\n</span>\n",c.summary_selected_count="<% if (state.selectedCount) { %>\n    <div class=\"alert alert-info im-selected-count\">\n        <strong>\n            <%- Messages.getText('summary.SelectedCount', state) %>\n        </strong>\n    </div>\n<% } %>\n",c.export_compression_controls="<h4><%- Messages.getText('export.category.Compression', state) %></h4>\n\n<div class=\"checkbox im-compress\">\n    <label>\n        <input type=\"checkbox\" <%= compress ? 'checked' : void 0 %>>\n        <%- Messages.getText('export.UseCompression') %>\n    </label>\n</div>\n\n<fieldset <%= compress ? void 0 : 'disabled' %>>\n    <div class=\"radio\">\n        <label>\n            <input type=\"radio\"\n                name=\"gzip\"\n                <%= (compression === 'gzip') ? 'checked' : void 0 %>>\n            <%- Messages.getText('export.UseGZIP') %>\n        </label>\n    </div>\n\n    <div class=\"radio\">\n        <label>\n            <input type=\"radio\"\n                name=\"zip\"\n                <%= (compression === 'zip') ? 'checked' : void 0 %>>\n            <%- Messages.getText('export.UseZIP') %>\n        </label>\n    </div>\n</fieldset>\n\n",c.summary_items='<% if (!(/boolean/i).test(type)) { %>\n    <div class="input-group im-filter-group">\n    <span class="input-group-btn">\n        <button class="btn btn-default im-clear-value-filter">\n        <%= Icons.icon(\'Refresh\') %>\n        </button>\n    </span>\n    <input type="search" class="form-control im-filter-values"\n        value="<%- filterTerm %>"\n        placeholder="<%- Messages.getText(\'summary.FilterValuesPlaceholder\') %>">\n    </div>\n<% } %>\n\n<div class="im-item-table">\n  <table class="table table-condensed table-striped">\n    <colgroup>\n      <% _.each(colClasses, function (cls) { %>\n        <col class="<%- cls %>">\n      <% }); %>\n    </colgroup>\n    <thead>\n      <tr>\n        <% _.each(colHeaders, function (hdr) { %>\n          <th><%- hdr %></th>\n        <% }); %>\n      </tr>\n    </thead>\n    <tbody class="scrollable">\n    </tbody>\n  </table>\n\n  <% if (hasMore) { %>\n    <div class="im-load-more">\n      <%- Messages.getText(\'summary.MoreItems\') %>\n    </div>\n  <% } %>\n</div>\n\n<div class="im-summary-controls">\n</div>\n',c.export_destination_galaxy_options='<div class="form-group">\n    <label><%- Messages.getText(\'GalaxyURILabel\') %></label>\n    <input type="url"\n           class="form-control im-galaxy-uri-param"\n           value="<%- Galaxy.Current || Galaxy.Main %>">\n</div>\n<div class="checkbox im-save-galaxy">\n    <label>\n        <input type="checkbox" <%= (Galaxy.Save) ? \'checked\' : void 0 %>>\n        <%- Messages.getText(\'SaveGalaxyURL\') %></label>\n    </label>\n</div>\n',c.join_manager_body="<ul class=\"list-group\"></ul>\n\n<div class=\"alert alert-info\">\n  <%= Icons.icon('Info') %>\n  <strong class=\"im-clickable\">\n    <%- Messages.getText('joins.ExplanationTitle') %>\n  </strong>\n  <p class=\"<%= (!state.explaining) ? 'im-latent' : void 0 %>\">\n    <%- Messages.getText('joins.Explanation') %>\n  </p>\n</div>\n",c.row_surrogate="<%= Icons.icon(above ? 'ASC' : 'DESC') %>\n<%- item %>: <%- count %>\n",c.code_gen_button_main="<%= Icons.icon('CodeFile') %>\n<span class=\"hidden-sm hidden-xs\">\n  <%- Messages.getText('codegen.GenerateCodeIn', {lang: lang}) %>\n</span>\n<span class=\"visible-sm-inline im-current-lang\">\n    <%- Messages.getText('codegen.Lang', {lang: lang}) %>\n</span>\n\n",c.facet_item='<dd>\n    <a href=#>\n        <b class="im-facet-count pull-right">\n            (<%- count %>)\n        </b>\n        <%- item %>\n    </a>\n</dd>\n',c.active_progress_bar='<div class="progress progress-info progress-striped active">\n  <div class="bar" style="width: 100%"></div>\n</div>\n',c.facet_title="<%= Icons.icon(state.open ? 'Expanded' : 'Collapsed') %>\n<span class=\"im-facet-title\"><%- pathName %></span>\n&nbsp;\n<span class=\"im-facet-count\"><%- Messages.getText('Number', {n: got} %></span>\n",c.null_value='<span class="im-null-value">&nbsp;</span>\n',c.cell_preview_attribute='<tr>\n  <td class="im-field-name"><%- _.last(parts) %></td>\n  <td class="im-field-value <%- field.toLowerCase() %> <%- type %>">\n    <% if (isNumeric) { %>\n      <%- numToString(+value) %>\n    <% } else { %>\n      <%- value %>\n    <% } %>\n    <% if (tooLong) { %>\n      <span class="im-overspill"><%- valueOverspill %></span>\n      <a class="im-too-long">\n        <span class="im-ellipsis">...</span>\n        <%= Icons.icon(\'More\') %>\n      </a>\n    <% } %>\n  </td>\n</tr>\n',c.input_with_label='<label><%- Messages.getText(label) %></label>\n<input class="form-control"\n       placeholder="<%- Messages.getText(placeholder) %>"\n       value="<%- value %>">\n<% if (helpMessage) { %>\n  <span style="display:<%= hasProblem ? \'block\' : \'none\' %>"\n        class="help-block">\n        <%- Messages.getText(helpMessage) %>\n  </span>\n<% } %>\n',c.summary_heading='<% /* requires:\n    *  numeric, available, got, uniqueValues\n    *  state.typeName, state.endName\n    *  filtered \n    */ %>\n<h3>\n  <% if (numeric) { %>\n    <%- Messages.getText(\'summary.NumericDistribution\', {n: available}) %>\n    <span class="im-type-name"><%- state.typeName %></span>\n    <span class="im-attr-name"><%- pluralise(state.endName, got) %></span>\n  <% } else { %> \n    <span class="im-item-got">\n      <%- Messages.getText(\'summary.Got\', {available: available, got: got}) %>\n    </span>\n    <span class="im-item-available">\n      <%- Messages.getText(\'Number\', {n: available}) %>\n    </span>\n    <span class="im-type-name"><%- state.typeName %></span>\n    <span class="im-attr-name"><%- pluralise(state.endName, got) %></span>\n    <span class="im-item-total">\n      <%- Messages.getText(\'summary.Total\', {\n            filtered: filtered,\n            total: uniqueValues\n          }) %>\n    </span>\n  <% } %> \n</h3>\n',c.table_error="<div class=\"alert alert-error alert-warning\">\n\n  <h2><%= Icons.icon('Bug') %><%- Messages.getText('error.Oops') %></h2>\n\n  <p>\n    <i><%- Messages.getText(error.key || 'error.' + domain + '.Heading') %></i>\n  </p>\n\n  <p><%- Messages.getText('error.' + domain + '.Body') %></p>\n\n  <a class=\"btn btn-primary pull-right\" href=\"mailto:<%= mailto %>\">\n    <%= Icons.icon('Mail') %>\n    <%- Messages.getText('error.EmailHelp') %>\n  </a>\n\n  <button class=\"btn btn-default im-show-query\">\n    <%= Icons.icon('xml') %>\n    <%- Messages.getText('error.ShowQuery') %>\n  </button>\n  <% if (error.message) { %>\n    <button class=\"btn btn-default im-show-error\">\n      <%= Icons.icon('Bug') %>\n      <%- Messages.getText('error.ShowError') %>\n    </button>\n  <% } %>\n\n  <pre class=\"query-xml well im-latent\"><%- indent(query) %></pre>\n\n  <% if (error.message) { %>\n    <pre class=\"error-message well im-latent\"><%- error.message %></pre>\n  <% } %>\n\n</div>\n",c.page_sizer='<% /* Expects size, sizes */ %>\n<% if (sizes.length) { %>\n    <label>\n        <span class="hidden-tablet">Rows per page:</span>\n    </label>\n    <select class="form-control" title="Rows per page">\n        <% sizes.forEach(function (s) { %>\n            <option value="<%= s[0] %>" <%= (s[0] === size) && \'selected\' %>>\n            <%= s[1] || s[0] %>\n            </option>\n        <% }); %>\n    </select>\n<% } %>\n',c.code_gen_js='<% if (asHTML) { %>\n\x3c!-- The Element we will target --\x3e\n<div id="some-elem"></div>\n\x3c!-- The imtables source --\x3e\n<script src="<%= imtablesJS %>" charset="UTF-8"><\/script>\n<link rel="stylesheet" href="<%= imtablesCSS %>">\n<script>\n<% } %>\n<% if (!asHTML) { %>\n/* Install from npm: npm install imtables\n * This snippet assumes the presence on the page of an element like:\n * <div id="some-elem"></div>\n */\nvar imtables = require(\'imtables\');\n<% } %>\n\nvar selector = \'#some-elem\';\nvar service  = {root: \'<%= service.root %>\'};\nvar query    = <%= JSON.stringify(query, null, 2) %>;\n\nimtables.loadTable(\n  selector, // Can also be an element, or a jQuery object.\n  <%= JSON.stringify(page) %>, // May be null\n  {service: service, query: query} // May be an imjs.Query\n).then(\n  function (table) { console.log(\'Table loaded\', table); },\n  function (error) { console.error(\'Could not load table\', error); }\n);\n<% if (asHTML) { %>\n<\/script>\n<% } %>\n',c.undo_history_step_section="<div class=\"im-section-summary\">\n  <% if (collection.length) { %>\n    <%= Icons.icon(state.open ? 'ExpandedSection' : 'CollapsedSection') %>\n  <% } %>\n  <%- Messages.getText(summaryLabel, {n: count}) %>\n</div>\n<% if (collection.length) { %>\n  <div class=\"<%- collectionClasses %>\">\n    <% _.each(collection, function (e) { %>\n      <span class=\"label label-<%= e.added ? 'success' : (e.removed ? 'danger' : 'default') %>\">\n        <%- labelContent(e) %>\n      </span>\n    <% }); %>\n  </div>\n<% } %>\n",c.slider='<div class="im-slider">\n    <% _.each(markers, function(marker) { %>\n        <span class="im-slider-marker"><%- marker.value %></span>\n    <% }); %>\n</div>\n',c.list_dialogue_button='<button class="btn btn-default dropdown-toggle" data-toggle="dropdown">\n  <%= Icons.icon(\'Lists\') %>\n  <span class="hidden-xxs">\n    <%- Messages.getText(\'lists.SaveAsList\') %>\n  </span>\n  <span class="caret"></span>\n</button>\n\n<ul class="dropdown-menu dropdown-menu-right" role="menu">\n    <li class="divider"></li>\n    <li>\n        <a class="im-pick-items" href="#">\n            <%- Messages.getText(\'lists.StartPicking\') %>\n        </a>\n    </li>\n    <li class="divider"></li>\n    <li>\n        <div class="btn-group btn-group-justified" role="group">\n            <a role="button" class="<%- createBtnClasses %>">\n                <%- Messages.getText(\'lists.Create\') %>\n            </a>\n            <a role="button" class="<%- appendBtnClasses %>">\n                <%- Messages.getText(\'lists.Append\') %>\n            </a>\n        </div>\n    </li>\n</ul>\n',c.column_name_popover='<% _.each(parts, function (part) { %>\n  <span class="im-name-part"><%- part %></span>\n<% }); %>\n',c.pagination='<ul class="pagination">\n    <li class="hidden-xs <%= gotoStart || \'im-goto-start\' %>" title="Go to start">\n        <a class="im-pagination-button">&#x21e4;</a>\n    </li>\n    <li class="hidden-xs hidden-sm <%= goFiveBack || \'im-go-back-5\' %>"\n        title="Go back five pages"\n        class="visible-desktop">\n        <a class="im-pagination-button">&#x219e;</a>\n    </li>\n    <li class="<%= goOneBack || \'im-go-back-1\' %>"\n        title="Go to previous page">\n        <a class="im-pagination-button">&larr;</a>\n    </li>\n    <li class="im-current-page">\n        <% if (useSelect) { %>\n          <form class="im-page-form form form-inline">\n            <select class="form-control">\n              <% for (i = 0; i < max; i++) { %>\n                <option\n                  <%= selected(i) ? \'selected\' : void 0 %>\n                  value="<%= i * size %>">\n                  page <%= i + 1 %>\n                </option>\n              <% } %>\n            </select>\n          </form>\n        <% } else { %>\n          <a href="#">&hellip;</a>\n          <form class="im-page-form form form-inline"\n                style="display:none;">\n            <div class="control-group">\n                <input type="number"\n                       value="<%= currentPage %>"\n                       max="<%= max %>"\n                       min="<%= min %>"\n                       class="form-control im-page-number">\n            </div>\n          </form>\n        <% } %>\n    </li>\n    <li class="<%= goOneForward || \'im-go-fwd-1\' %>"\n        title="Go to next page">\n        <a class="im-pagination-button">&rarr;</a>\n    </li>\n    <li class="hidden-xs hidden-sm <%= goFiveForward || \'im-go-fwd-5\' %>"\n        title="Go forward five pages"\n        class="visible-desktop">\n        <a class="im-pagination-button">&#x21a0;</a>\n    </li>\n    <li class="hidden-xs <%= gotoEnd || \'im-goto-end\' %>"\n        title="Go to last page">\n        <a class="im-pagination-button">&#x21e5;</a>\n    </li>\n</ul>\n',c.export_row_controls='<h4 class="im-title"></h4>\n\n<div class="form-group">\n    <label class="size-label"></label>\n    <input name="size"\n           step="1"\n           type="range"\n           min="1"\n           max="<%= max %>"\n           value="<%= size || max %>">\n</div>\n\n<div class="form-group">\n    <label class="start-label"></label>\n    <input name="start"\n           step="1"\n           type="range"\n           min="0"\n           max="<%= max - 1 %>"\n           value="<%= start %>">\n</div>\n\n<div class="form-group im-reset">\n</div>\n',c.list_value_controls="<% if (suitableLists.length) { %>\n    <%= select(suitableLists, isSelected, 'span7 im-value-options im-con-value im-con-value-list form-control', formatList, getOptionValue) %>\n<% } else { %>\n    <%- messages.getText('conbuilder.NoSuitableLists') %>\n<% } %>\n",c.summary_items_controls='<button class="btn btn-default pull-right im-download">\n  <%= Icons.icon(\'Download\') %>\n  <%- Messages.getText(\'summary.DownloadData\') %>\n</button>\n\n<div class="btn-group im-filter-group">\n  <button type="submit"\n        class="btn btn-primary im-filter-in"\n        <%= (anyItemSelected) ? void 0 : \'disabled\' %>>\n    <%- Messages.getText(\'Filter\') %>\n  </button>\n  <button class="btn btn-primary dropdown-toggle" \n          title="<%- Messages.getText(\'summary.SelectFilter\') %>"\n          <%= (anyItemSelected) ? void 0 : \'disabled\' %>>\n    <span class="caret"></span>\n  </button>\n  <ul class="dropdown-menu">\n    <li>\n      <a href="#" class="im-filter-in">\n        <%- Messages.getText(\'summary.Include\') %>\n      </a>\n    </li>\n    <li>\n      <a href="#" class="im-filter-out">\n        <%- Messages.getText(\'summary.Exclude\') %>\n      </a>\n    </li>\n  </ul>\n</div>\n\n<div class="btn-group">\n  <button class="btn btn-default btn-cancel"\n          <%= (anyItemSelected) ? void 0 : \'disabled\' %>\n          title="<%- Messages.getText(\'summary.Reset\') %>">\n    <%= Icons.icon(\'Undo\') %>\n  </button>\n  <% if (!(/boolean/i).test(type)) { %>\n    <button class="btn btn-default btn-toggle-selection"\n            title="<%- Messages.getText(\'summary.Toggle\') %>">\n        <%= Icons.icon(\'Toggle\') %>\n    </button>\n  <% } %>\n</div>\n\n',c.table_subtable_summary="<% if (rows.length) { %>\n  <%= Icons.icon('Table') %>\n<% } else { %>\n  <%= Icons.icon('EmptyTable') %>\n<% } %>\n<%- rows.length %>\n<%- pluralise(contentName, rows.length) %>\n",c.select_with_label='<label><%- Messages.getText(label) %></label>\n\n<% if (options.length) { %>\n    <select class="form-control">\n        <% _.each(options, function (option) { %>\n            <option selected="<%= selected(option) ? \'selected\' : void 0 %>"\n                    value="<%- option.name %>">\n                <%- Messages.getText(optionLabel, option) %>\n            </option>\n        <% }) %>\n    </select>\n    <% if (helpMessage) { %>\n        <span style="display:<%= hasProblem ? \'block\' : \'none\' %>"\n              class="help-block">\n                <%- Messages.getText(helpMessage) %>\n        </span>\n    <% } %>\n<% } else { %>\n    <span class="help-block">\n        <%- Messages.getText(noOptionsMessage, {model: model}) %>\n    </span>\n<% } %>\n\n',c.export_flat_file_options="<h4><%- Messages.getText('export.category.ColumnHeaders', state) %></h4>\n\n<div class=\"checkbox im-headers\">\n    <label>\n        <input type=\"checkbox\" <%= headers ? 'checked' : void 0 %>>\n        <%- Messages.getText('export.AddHeaders') %>\n    </label>\n</div>\n\n<fieldset <%= headers ? void 0 : 'disabled' %>>\n    <div class=\"radio\">\n        <label>\n            <input type=\"radio\"\n                name=\"hdrs-friendly\"\n                <%= (headerType === 'friendly') ? 'checked' : void 0 %>>\n            <%- Messages.getText('export.ff.FriendlyHeaders') %>\n        </label>\n    </div>\n\n    <div class=\"radio\">\n        <label>\n            <input type=\"radio\"\n                name=\"hdrs-path\"\n                <%= (headerType === 'path') ? 'checked' : void 0 %>>\n            <%- Messages.getText('export.ff.PathHeaders') %>\n        </label>\n    </div>\n</fieldset>\n\n",c.only_one_item="<div class=\"alert alert-info\">\n    <%= Icons.icon('Info') %>\n    <%= Messages.getText('summary.OnlyOne', {names: state, item: items[0]}) %>\n</div>\n\n",c.column_header='<% /* requires the properties of HeaderModel +\n    *  penult, last, headerClasses, colTitleClasses, penultClasses\n    *  and the usual Icons, Messages\n    */ %>\n<div class="<%- headerClasses %>">\n\n<div class="im-th-buttons">\n    \n    <% if (outerJoined && isReference) { %>\n      <a href="#" \n          class="im-subtable-expander im-th-button"\n          title="<%- Messages.getText(\'table.header.ToggleTables\') %>">\n        <%= Icons.icon(\'Table\') %>\n      </a>\n    <% } %>\n\n    <% if (sortable) { %>\n        <span class="im-th-dropdown im-col-sort dropdown">\n            <a class="im-th-button im-col-sort-indicator"\n                title="<%- Messages.getText(\'table.header.SortColumn\', {dir: sortDirection}) %>">\n                <%= Icons.icon(sortDirection || \'unsorted\') %>\n            </a>\n            <div class="dropdown-menu">\n                <div><%- Messages.getText(\'table.header.FailedToInitSortMenu\') %></div>\n            </div>\n        </span>\n    <% } %>\n\n    <a class="im-th-button im-col-remover"\n        title="<%- Messages.getText(\'table.header.RemoveColumn\') %>">\n        <%= Icons.icon(\'headerIconRemove\') %>\n    </a>\n\n    <a class="im-th-button im-col-minumaximiser"\n        title="<%- Messages.getText(\'table.header.ToggleColumn\') %>">\n        <%= Icons.icon(minimised ? \'headerIconReveal\' : \'headerIconHide\') %>\n    </a>\n\n    <span class="dropdown im-filter-summary im-th-dropdown">\n        <a class="im-th-button im-col-filters dropdown-toggle"\n            title="<%- Messages.getText(\'table.header.FilterTitle\', {count: numOfCons}) %>"\n            data-toggle="dropdown" >\n            <%= Icons.icon(\'Filter\') %>\n        </a>\n        <div class="dropdown-menu">\n            <div><%- Messages.getText(\'table.header.FailedToInitFilter\') %></div>\n        </div>\n    </span>\n\n    <span class="dropdown im-summary im-th-dropdown">\n        <a class="im-th-button summary-img dropdown-toggle"\n            title="<%- Messages.getText(\'table.header.ViewSummary\') %>"\n            data-toggle="dropdown" >\n            <%= Icons.icon(\'Summary\') %>\n        </a>\n        <div class="dropdown-menu">\n            <div><%- Messages.getText(\'table.header.FailedToInitSummary\') %></div>\n        </div>\n    </span>\n\n    <% if (isComposed) { %>\n        <a class="im-th-button im-col-composed"\n            title="<%- Messages.getText(\'table.header.Composed\', {replaces: replaces}) %>">\n            <%= Icons.icon(\'Composed\') %>\n        </a>\n    <% } %>\n</div>\n\n<div class="<%- colTitleClasses %>">\n  <div class="<%- penultClasses %>">\n      <%- penult %>\n  </div>\n  <% if (last) { %>\n    <div class="im-title-part im-last">\n        <%- last %>\n    </div>\n  <% } %>\n</div>\n\n</div>\n\n',c.modal_footer='<button type="button" class="btn btn-cancel">\n    <%- dismissAction %>\n</button>\n<% if (exportLink != null) { %>\n    <a class="btn btn-primary"\n        <%= (error) ? \'disabled\' : void 0 %>\n        href="<%- exportLink %>">\n        <%= Icons.icon(primaryIcon) %>\n        <%- primaryAction %>\n    </a>\n<% } else { %>\n    <% /* We need the wrapper to deal with the fact that tooltips do not\n        * work on disabled buttons. */ %>\n    <div class="im-tooltip-wrapper"\n        <% if (disabled && disabledReason) { %>\n          title="<%- Messages.getText(disabledReason)  %>"\n        <% } %>>\n        <button type="button"\n                <%= (error || disabled) ? \'disabled\' : void 0 %>\n                class="btn btn-primary">\n            <%= Icons.icon(primaryIcon) %>\n            <%- primaryAction %>\n        </button>\n    </div>\n<% } %>\n',c.add_value_control='<div class="im-table-height-wrapper">\n    <table class="table table-condensed"></table>\n</div>\n<div class="input-group">\n    <input type="text" class="im-new-multi-value form-control">\n    <span class="input-group-btn">\n        <button class="btn btn-primary im-add" type="button">\n            <span class="im-long"><%- messages.getText(\'multivalue.AddValue\') %></span>\n            <span class="im-short"><%- messages.getText(\'multivalue.AddValueShort\') %></span>\n        </button>\n    </span>\n</div>\n',c.input_with_button='<input type="text" class="form-control"\n       value="<%- value %>"\n       placeholder="<%- Messages.getText(placeholder) %>">\n<span class="input-group-btn">\n  <button class="btn btn-default" type="button">\n    <%- Messages.getText(button) %>\n  </button>\n</span>\n\n',c.export_rows_reset_button="<button type=\"button\"\n        <%= (isAll) ? 'disabled' : void 0 %>\n        class=\"btn btn-default btn-reset\">\n        <%- Messages.getText('export.ResetRowSelection') %>\n</button>\n\n<% if (tablePage) { %>\n    <button type=\"button\"\n            <%= (tablePage.start === start && tablePage.size === size) ? 'disabled' : void 0 %>\n            class=\"btn btn-default im-set-table-page\">\n            <%- Messages.getText('export.SetTablePage') %>\n    </button>\n<% } %>\n        \n",c.column_manager_position_controls="<div class=\"im-position-controls\">\n    <% if (index > 0) { %>\n        <%= Icons.iconWithProps('ASC', {\n            className: 'im-move-up',\n            title: Messages.getText('columns.MoveUp')\n        }) %>\n    <% } %>\n    <% if (!isLast) { %>\n        <%= Icons.iconWithProps('DESC', {\n            className: 'im-move-down',\n            title: Messages.getText('columns.MoveDown')\n        }) %>\n    <% } %>\n</div>\n\n",c.column_manager_order_direction="<% /* requires: direction, isNumeric */ %>\n<span class=\"im-change-direction\"\n  title=\"<%- Messages.getText('columns.ChangeDirection') %>\">\n  <span class=\"sr-only\">\n    <%- Messages.getText('columns.CurrentDirection', {\n      dir: direction, numeric: isNumeric\n    }) %>\n  </span>\n  <%= Icons.icon('Sort' + (isNumeric ? 'Numeric' : 'String') + direction) %>\n</span>\n",c.column_manager_path_remover='<% /* requires: removeTitle */ %>\n<span class="pull-right im-remove-view"\n      title="<%- Messages.getText(removeTitle) %>">\n    <%= Icons.icon(\'Remove\') %>\n</span>\n\n',c.cell_preview_items='<colgroup>\n  <col class="im-item-field"/>\n  <col class="im-item-value"/>\n</colgroup>\n<tbody></tbody>\n',c.column_manager_path_chooser="<div class=\"btn-group pull-right\">\n</div>\n<h4>\n  <%- Messages.getText('columns.ChooseAPathFrom', {root: state.rootName}) %>\n</h4>\n\n",c.facet_frequency='<% /* requires: error, initialized */ %>\n<% if (error) { %>\n    <% /* Oh noes - something went wrong. */ %>\n    <div class="alert alert-warning">\n        <%= Icons.icon(\'Error\') %>\n        <strong><%- Messages.getText(\'Error\') %></strong>\n        <% if (error.key) { %>\n            <%- Messages.getText(error.key) %>\n        <% } else { %>\n            <%- error.message || error %>\n        <% } %>\n    </div>\n<% } else if (initialized) { %>\n    <% /* Huzzah - there is data, which will be added here as child views */ %>\n<% } else { %>\n    <% /* Boo - no data. Show an indeterminate progress bar while we wait. */ %>\n    <div class="progress">\n      <div class="progress-bar progress-bar-info progress-bar-striped active"\n           role="progressbar"\n           style="width:100%">\n        <span class="sr-only"><%- Messages.getText(\'Loading\') %>.</span>\n      </div>\n    </div>\n<% } %>\n',c.export_destination_radios='<label><%- Messages.getText(\'export.param.Destination\') %></label>\n<% _.each(destinations, function (d) { %>\n    <div class="radio im-dest-<%- d %>">\n        <label>\n            <input type="radio"\n                    name="dest"\n                    <%= (d === dest) ? \'checked\' : void 0 %>>\n            <%- Messages.getText(d) %>\n        </label>\n    </div>\n<% }); %>\n\n',
c.code_gen_body='<div class="row">\n  <div class="col-sm-2">\n    <% /* requires lang :: string, options :: {Extra :: {}, Langs :: [string]} */ %>\n    <div class="btn-group language-selector">\n      <button type="button"\n              data-toggle="dropdown"\n              aria-expanded="false"\n              class="btn btn-default dropdown-toggle">\n        <span class="im-current-lang">\n          <%- Messages.getText(\'codegen.Lang\', {lang: lang}) %>\n        </span>\n        <span class="caret"></span>\n      </button>\n      <ul class="dropdown-menu im-code-gen-langs" role="menu">\n        <% _.each(options.Langs, function (l) { %>\n            <li data-lang="<%- l %>"\n                class="<%= (l === lang) ? \'active\' : void 0 %>">\n              <a href="#"><%- Messages.getText(\'codegen.Lang\', {lang: l}) %></a>\n            </li>\n        <% }); %>\n      </ul>\n    </div>\n    <div class="im-show-boilerplate"></div>\n    <div class="im-highlight-syntax"></div>\n    <div class="im-extra-options"></div>\n  </div>\n  <div class="col-sm-10">\n    <pre class="im-generated-code"><%- generatedCode %></pre>\n  </div>\n</div>\n',c.classy_popover='<div class="popover <%- classes %>" role="tooltip">\n  <div class="arrow"></div>\n  <h3 class="popover-title"></h3>\n  <div class="popover-content"></div>\n</div>\n',c.constraint_adder='<div class="im-constraint-adder-options"></div>\n<div class="im-path-finder"><div>\n<div class="im-new-constraint"></div>\n',c.checkbox="<label>\n    <input type=\"checkbox\" \n           <%= checked ? 'checked' : void 0 %>\n           >\n    <%- label %>\n</label>\n",c.new_filter_dialogue='<div class="modal-body">\n</div>\n<div class="modal-footer">\n    <button class="disabled btn btn-primary pull-right im-add-constraint">\n        <%- Messages.getText(\'constraints.AddFilter\') %>\n    </button>\n    <button class="btn im-close pull-left">\n        <%- Messages.getText(\'Cancel\') %>\n        Cancel\n    </button>\n</div>\n',c.export_destination_options='<div class="form-group im-param-name">\n    <label><%- Messages.getText(\'export.param.Name\') %></label>\n    <div class="input-group">\n      <input type="text"\n             value="<%- filename %>"\n             class="form-control"\n             placeholder="<%- Messages.getText(\'export.param.Name\') %>"\n             aria-label="<%- Messages.getText(\'export.param.Name\') %>">\n      <div class="input-group-btn">\n        <button type="button"\n                class="btn btn-default dropdown-toggle"\n                data-toggle="dropdown"\n                aria-expanded="false">\n          .<%- format %>\n          <span class="caret"></span>\n        </button>\n        <ul class="dropdown-menu dropdown-menu-right" role="menu">\n          <% _.chain(formats).groupBy(\'group\').each(function (fmts, grp) { %>\n            <% if (this.i++) { %><li class="divider"></li><% } %>\n            <% _.each(fmts, function (fmt) { %>\n                <li>\n                    <a href="#"\n                       class="im-fmt-<%- fmt.id %>">\n                      <%= Icons.icon(fmt.icon) %>\n                      <%- Messages.getText(fmt.name) %>\n                    </a>\n                </li>\n            <% }); %>\n          <% }, {i: 0}); %>\n        </ul>\n      </div>\n    </div>\n</div>\n\n<% if (format && format.desc) { %>\n  <div class="alert alert-info">\n    <%- Messages.getText(format.desc) %>\n  </div>\n<% } %>\n\n<div class="row">\n    <div class="col-sm-6 im-param-dest">\n    </div>\n    <div class="col-sm-6 im-dest-opts">\n    </div>\n</div>\n'},{underscore:310}],68:[function(a,b,c){(function(){var b,d,e,f,g;g=a("underscore"),b=a("../options"),d=a("pluralize"),e='<select class="<%- data.classes %>">\n  <% _.each(data.options, function (opt) { %>\n    <option value="<%- data.key(opt) %>"\n      <%- data.selectedTest(opt) ? \'selected\' : void 0 %> >\n      <% if (data.contentHandler) { %>\n        <%- data.contentHandler(opt) %>\n      <% } else { %>\n        <%- opt.text %>\n      <% } %>\n    </option>\n  <% }); %>\n</select>\n',f=g.template(e,{variable:"data"}),c.select=function(a,b,c,d,e){return null==b&&(b=function(){return!1}),null==c&&(c=""),null==d&&(d=null),null==e&&(e=function(a){return null!=a?a.value:void 0}),f({options:a,selectedTest:b,classes:c,contentHandler:d,key:e})},c.pluralise=function(a,b){return null!=a?d(a,b):a},c.numToString=function(a){var c,d,e,f,h,i,j,k,l,m;if(!(null!=a?a.toFixed:void 0))return a;if(k=b.get("NUM_SEPARATOR"),d=b.get("NUM_CHUNK_SIZE"),j=[],h=0,-1<a&&a<1)return String(a);for(m=a.toFixed(3).split("."),l=m[0],e=m[1],c=l.split(""),i=c.length,f=g(c).groupBy(function(a,b){return Math.floor((i-(b+1))/d).toFixed()});f[h];)j.unshift(f[h].join("")),h++;return j.join(k)+("000"===e?"":"."+e)},c.errorAlert=function(a){switch(a.level){case"Error":return"alert-danger";case"Warning":return"alert-warning";case"Info":return"alert-info";case"OK":return"alert-success";default:return"alert-danger"}},c.errorIcon=function(a){var b;return b=a.level,null!=b?b:"Error"}}).call(this)},{"../options":63,pluralize:290,underscore:310}],69:[function(a,b,c){(function(){b.exports={interpolate:/\{\{\{ (.+?) \}\}\}/g,escape:/\{\{ (.+?) \}\}/g,evaluate:/\{\{# (.+?) \}\}/g}}).call(this)},{}],70:[function(a,b,c){(function(){var c,d,e,f,g;d=a("../options"),e=a("es6-promise").Promise,g={},f=function(a){var b;return null!=g[b=a.root]?g[b]:g[b]=new c(a)},b.exports=function(a){return f(a).getBranding()},c=function(){function a(a){this.key=a.root.replace(/\./g,"_"),this.promise=a.get("branding").then(function(a){return function(b){return d.set(["brand",a.key],b.properties)}}(this))}return a.prototype.getBranding=function(){return new e(function(a){return function(b){return a.promise.then(function(){return b(d.get(["brand",a.key]))},function(){return b(null)})}}(this))},a}()}).call(this)},{"../options":63,"es6-promise":257}],71:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j=[].indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(b in this&&this[b]===a)return b;return-1};d=a("./create-columns"),g=a("./is-key-field"),e=a("./get-replaced-test"),c=a("../formatting"),h=function(a){return function(b){return!a.findWhere({formatter:b})}},i=function(a,b){return function(c){var d;return d=a(c),b(d)?d:null}},f=function(a){var b,c,d,e,f;for(f=[],b=d=0,e=a.length;d<e;b=++d)c=a[b],f.push(c.index=b);return f},b.exports=function(a,b){return a.service.fetchClassKeys().then(function(k){var l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H;for(r=g(k),v={},n={},p=i(c.getFormatter,h(b)),m=d(a),x=0,B=m.length;x<B;x++)if(l=m[x],l.path.isAttribute()&&(o=p(l.path)))for(l.isFormatted=!0,l.formatter=o,t=l.path.getParent(),G=null!=(F=o.replaces)?F:[],y=0,C=G.length;y<C;y++)u=G[y],w=t+"."+u,null==v[w]&&(v[w]=l),j.call(a.views,w)>=0&&l.replaces.push(a.makePath(w));for(z=0,D=m.length;z<D;z++)for(l=m[z],H=l.replaces,A=0,E=H.length;A<E;A++)u=H[A],n[u]=l;return q=e(v,n),s=function(){var a,b,c,d;for(d=[],b=0,a=m.length;b<a;b++)l=m[b],q(l)||(l.isFormatted&&(c=l.path,j.call(l.replaces,c)<0&&l.replaces.push(l.path),(r(l.path)||l.replaces.length>1)&&(l.path=l.path.getParent())),d.push(l));return d}(),f(s),s})}}).call(this)},{"../formatting":13,"./create-columns":78,"./get-replaced-test":85,"./is-key-field":89}],72:[function(a,b,c){(function(){b.exports=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q;for(k={},l=0,n=a.length;l<n;l++)if(d=a[l],null!=(null!=(p=d.formatter)?p.replaces:void 0)&&(g=d.model.get("node").toString(),e=d.model.get("column"),h=e.toString(),null!=b&&e.isAttribute()&&d.formatter.replaces.length>1&&(f=b.indexOf(b.get(h)),b.remove(h),i=e.getParent(),c=b.add(i,{at:f}),c.set({replaces:d.formatter.replaces.map(function(a){return i.append(a)})})),!k[h]))for(q=d.formatter.replaces.map(function(a){return g+"."+a}),m=0,o=q.length;m<o;m++)(j=q[m])!==h&&(k[j]=!0,null!=b&&b.remove(j));return k}}).call(this)},{}],73:[function(a,b,c){(function(){var a,c,d=[].indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(b in this&&this[b]===a)return b;return-1};a=function(a,b,c){var d,e,f;if(!(e=a.getOuterJoin(b))||e===c)return null;for(f=a.makePath(e),d=f.isCollection()?e:null,f=f.getParent();f&&!f.isRoot();)!function(b){var e;null!=b&&(e=a.makePath(b)),(null!=e?e.isCollection():void 0)&&b!==c&&(d=b),f=null!=e?e.getParent():void 0}(a.getOuterJoin(f));return d},c=function(b,c){return a(b,c,null)},b.exports=function(b){var e,f,g,h,i,j,k,l,m,n,o,p,q;for(k=[],h={},q=b.views,m=0,o=q.length;m<o;m++)if(l=q[m],!h[l])if(j=c(b,l)){for(e=b.views.filter(function(a){return j===c(b,a)}),g={column:j,view:[]},n=0,p=e.length;n<p;n++)f=e[n],i=a(b,f,j),h[f]=g,i?d.call(g.view,i)>=0||g.view.push(i):g.view.push(f);k.push(h[j]=g)}else k.push(h[l]={column:l});return k}}).call(this)},{}],74:[function(a,b,c){(function(){c.bool=function(a){return!!a}}).call(this)},{}],75:[function(a,b,c){(function(){var c,d,e,f,g,h;h=a("underscore"),g=a("../models/object-store"),e=a("../models/nested-table"),c=a("../models/cell"),f=a("../models/null-object"),d=a("../models/fast-path-object"),b.exports=function(){function a(a,b){this.itemModels=new g(a.root,b)}return a.prototype.getCreator=function(a){var b;if(!a)throw new Error("No query");return b=function(c){return function(d){var e;return e=a.makePath(d.column),h.has(d,"rows")?c._make_sub_table_model(d,e,b):c._make_simple_cell_model(d,e)}}(this)},a.prototype._make_sub_table_model=function(a,b,c){var d;return new e(h.extend({},a,{node:b,column:b,rows:function(){var b,e,f,g;for(f=a.rows,g=[],b=0,e=f.length;b<e;b++)d=f[b],g.push(d.map(function(a){return c(a)}));return g}()}))},a.prototype._make_simple_cell_model=function(a,b){var e,g,h;return h=b.getParent(),g=b.end.name,e=null!=a.id?this.itemModels.get(a,g):null==a.class?new f(h.getType().name,g):new d(a,g),new c({entity:e,node:h,column:b,field:g,value:a.value})},a.prototype.destroy=function(){var a;return null!=(a=this.itemModels)&&a.destroy(),delete this.itemModels,this},a}()}).call(this)},{"../models/cell":37,"../models/fast-path-object":43,"../models/nested-table":48,"../models/null-object":49,"../models/object-store":51,underscore:310}],76:[function(a,b,c){(function(){var b;b=a("underscore"),c.createChild=function(a,c,d){var e,f,g;return null==d&&(d={}),e=(null!=(g=c.prototype.parameters)?g:[]).concat(c.prototype.optionalParameters),f=b.extend(b.pick(a,e),d),new c(f)}}).call(this)},{underscore:310}],77:[function(a,b,c){(function(){var a,b;a={},b=function(a){return a.service.root+":"+a.service.token+":"+a.toXML()},c.count=function(c){var d;return null!=a[d=b(c)]?a[d]:a[d]=c.count()},c.clearCache=function(){return a={}}}).call(this)},{}],78:[function(a,b,c){(function(){var c,d;c=a("./longest-common-prefix"),d=a("./calculate-row-template"),b.exports=function(a){return d(a).map(function(b){var d,e,f,g,h;return null!=b.view?(d=c(b.view),e=a.makePath(d),g=function(){var c,d,e,f;for(e=b.view,f=[],c=0,d=e.length;c<d;c++)h=e[c],f.push(a.makePath(h));return f}(),f=function(){var b,c,e,f;for(e=a.views,f=[],b=0,c=e.length;b<c;b++)h=e[b],0===h.indexOf(d)&&f.push(a.makePath(h));return f}()):(e=a.makePath(b.column),g=null,f=[]),{path:e,subview:g,replaces:f}})}}).call(this)},{"./calculate-row-template":73,"./longest-common-prefix":91}],79:[function(a,b,c){(function(){var c;c=a("underscore"),b.exports=function(){function a(a){this.definitions=a}return a.prototype.activeClasses=function(){var a,b;b=[];for(a in this.definitions)c.result(this.definitions,a)&&b.push(a);return b},a.prototype.toString=function(){return this.activeClasses().join(" ")},a}()}).call(this)},{underscore:310}],80:[function(a,b,c){(function(){var c,d,e;c=a("./fetch-missing-data"),d=a("./has-fields"),e=function(a,b){return b.then(function(b){return a.set(b)})},b.exports=function(a,b){var f,g;return g=c(a,b),f=d(b),function(a,b){return f(a)||e(a,g(b,a.get("id"))),a.toJSON()}}}).call(this)},{"./fetch-missing-data":82,"./has-fields":87}],81:[function(a,b,c){(function(){var b,d;d=a("underscore"),b=a("backbone"),c.ignore=function(a){return null!=a&&a.preventDefault(),null!=a&&a.stopPropagation(),!1},c.Bus=function(){function a(){}return d.extend(a.prototype,b.Events),a.prototype.destroy=function(){return this.stopListening(),this.off()},a}()}).call(this)},{backbone:236,underscore:310}],82:[function(a,b,c){(function(){var c,d,e,f;f=a("underscore"),c=function(a){return function(b){return b?f.object(f.zip(a,b)):{}}},d=function(a){var b;return f.flatten(function(){var c,d,f;for(f=[],c=0,d=a.length;c<d;c++)b=a[c],~b.indexOf(".")&&f.push(e(b));return f}())},e=function(a){var b,c,d,e,f;for(c=a.split("."),f=[],b=d=1,e=c.length;1<=e?d<e:d>e;b=1<=e?++d:--d)f.push(c.slice(0,b).join("."));return f},b.exports=function(a,b,e){return null==e&&(e={}),function(g,h){var i;return i=g.root+"#"+h,null!=e[i]?e[i]:e[i]=function(){return g.rows({select:b,from:a,where:{id:h},joins:d(b)}).then(f.compose(c(b),f.head))}()}}}).call(this)},{underscore:310}],83:[function(a,b,c){(function(){var a,c=[].indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(b in this&&this[b]===a)return b;return-1};b.exports=a=function(b,d){var e,f,g,h,i,j;return j=function(){var a;a=[];for(g in b)null!=(f=b[g])&&c.call(d,g)<0&&a.push(f);return a}(),e=function(){var a,b,c;for(c=[],a=0,b=j.length;a<b;a++)i=j[a],null==i.objectId&&c.push(i);return c}(),h=function(){var a,b,c;for(c=[],a=0,b=j.length;a<b;a++)i=j[a],null!=i.objectId&&c.push(i);return c}(),h.reduce(function(b,c){return b.concat(a(c,d))},e)}}).call(this)},{}],84:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k=[].indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(b in this&&this[b]===a)return b;return-1};j=a("underscore"),d=a("es6-promise").Promise,h=j.compose(j.uniq,j.flatten),e=function(a){var b;return null!=(null!=(b=a.getType().fields)?b.organism:void 0)},g=function(a){return"Organism"===a.getEndClass().name||e(a)},f=function(a){var b;return"Organism"===a.getEndClass().name&&("name"===(b=a.end.name)||"shortName"===b)},i=function(a){return null!=a&&/\*/.test(a)},c=["=","==","ONE OF"],b.exports=function(a){return new d(function(b,d){var l,m,n,o,p,q,r,s,t;return n=j.compose(b,h),r=function(){return b([])},m=function(){var b,d,e,g,h;for(e=a.constraints,h=[],b=0,d=e.length;b<d;b++)l=e[b],g=l.op,k.call(c,g)>=0&&!i(l.value)&&f(a.makePath(l.path))&&h.push(l.value||l.values);return h}(),s=function(){var b,c,d,f;for(d=a.constraints,f=[],b=0,c=d.length;b<c;b++)l=d[b],"LOOKUP"===l.op&&null!=l.extraValue&&e(a.makePath(l.path))&&f.push(l.extraValue);return f}(),o=j.union(m,s),o.length?n(o):(q=function(){var b,c,d,e;for(d=a.getViewNodes(),e=[],b=0,c=d.length;b<c;b++)p=d[b],g(p)&&(t="Organism"===p.getType().name?p:p.append("organism"),e.push(t.append("shortName")));return e}(),q.length?a.clone().select(j.uniq(q,String)).orderBy([]).rows().then(n,r):r())})}}).call(this)},{"es6-promise":257,underscore:310}],85:[function(a,b,c){(function(){var c,d;d=a("../formatting").shouldFormat,c=function(a){return a.isAttribute()&&"id"===a.end.name},b.exports=function(a,b){return function(e){var f,g;if(null==e)throw new Error("no column");return f=e.path,!!(d(f)||f in b)&&(g=a[f],c(f)&&null==g&&(g=a[f.getParent()]),g&&null!=g.formatter&&e!==g)}}}).call(this)},{"../formatting":13}],86:[function(a,b,c){(function(){var c;c=a("es6-promise").Promise,b.exports=function(a){return new c(function(b,c){var d,e,f,g,h;return g=a.getViewNodes(),e=a.model,b((d=e.findCommonType(function(){var a,b,c;for(c=[],a=0,b=g.length;a<b;a++)f=g[a],c.push(f.getType());return c}()))?e.getPathInfo(d).getDisplayName():null!=(h=e.name)?h:"")})}}).call(this)},{"es6-promise":257}],87:[function(a,b,c){(function(){b.exports=function(a){return null==a&&(a=[]),function(b){return a.every(function(a){return b.has(a)})}}}).call(this)},{}],88:[function(a,b,c){(function(){b.exports=function(a){var b,c,d,e,f,g,h,i,j;for(h=a.split(/></),c=1,b=[],i=0,j=h.length;i<j;i++)g=h[i],/>$/.test(g)||(g+=">"),/^</.test(g)||(g="<"+g),d=/^<\/\w+\s*>/.test(g),e=/\/>$/.test(g)||!d&&/<\/\w+>$/.test(g),f=!(e||d),d&&c--,b.push(new Array(c).join("  ")+g),f&&c++;return b.join("\n")}}).call(this)},{}],89:[function(a,b,c){(function(){var a=[].indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(b in this&&this[b]===a)return b;return-1};b.exports=function(b){return function(c){var d,e,f,g,h;return!!c.isAttribute()&&(f=c.getParent().getType().name,d=c.end.name,e=null!=(g=null!=b?b[f]:void 0)?g:[],h=f+"."+d,a.call(e,h)>=0)}}}).call(this)},{}],90:[function(a,b,c){(function(c){(function(){var d,e,f;d=a("jquery"),f=a("es6-promise").Promise,e=a("../options"),b.exports=function(a,b){return c[b]?f.resolve(c[b]):f.resolve(d.ajax({url:e.get(a),cache:!0,dataType:"script"})).then(function(){return c[b]})}}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../options":63,"es6-promise":257,jquery:288}],91:[function(a,b,c){(function(){var c,d,e=[].slice;d=a("underscore"),c=function(a){return function(b){return d.all(a,function(a){return 0===a.indexOf(b)})}},b.exports=function(a){var b,d,f,g,h,i,j,k,l;if(b=a[0],i=2<=a.length?e.call(a,1):[],null==b)throw new Error("Empty list");if(!i.length)return b;for(g=b.split(/\./),j=c(i),h=g[0],k=0,l=g.length;k<l;k++)f=g[k],j(d=h+"."+f)&&(h=d);return h}}).call(this)},{underscore:310}],92:[function(a,b,c){(function(){c.href=function(a,b,c){var d,e;return d=[["subject",b],["body",c]],e=d.map(function(a){var b,c;return b=a[0],c=a[1],b+"="+encodeURIComponent(c)}).join("&"),a+"?"+e}}).call(this)},{}],93:[function(a,b,c){(function(){b.exports=function(a){return a.map(function(a){return"change:"+a}).join(" ")}}).call(this)},{}],94:[function(a,b,c){(function(){b.exports=function(a,b,c){var d,e,f,g,h;e=document.createElement("form"),e.method="POST",e.style.display="none",e.action=a,e.target=b+(new Date).getTime();for(g in c)f=document.createElement("input"),f.type="hidden",f.name=g,f.value=c[g],e.appendChild(f);d=document.querySelector("body"),d.appendChild(e),h=window.open("somenonexistantpathtonowhere",b),e.submit(),d.removeChild(e),h.close()}}).call(this)},{}],95:[function(a,b,c){(function(){var c,d;d=a("underscore"),c=function(a){var b;return d.object(function(){var c,d,e;for(e=[],c=0,d=a.length;c<d;c++)b=a[c],e.push(b.split("=").map(decodeURIComponent));return e}())},b.exports=function(a){var b,d,e,f,g;return g=a.split("?"),b=g[0],f=g[1],d=f.split("&"),e=c(d),{URL:b,params:e}}}).call(this)},{underscore:310}],96:[function(a,b,c){(function(){var c,d;d=a("underscore"),c=function(a,b){return a.toLowerCase().indexOf(b)>=0},b.exports=function(a){return function(b,e){var f,g,h,i,j;return g=null!=(i=null!=b&&null!=(j=b.toLowerCase())?j.split(" "):void 0)?i:[],f=function(a){var b,e,f;return f=a.path,b=a.item,e=a.name,d.all(g,function(a){return null==f&&(f=b),c(f.toString(),a)||c(e,a)})},e(null!=a.each?a.map(function(a){return a.toJSON()}).filter(f):function(){var b,c,d;for(d=[],b=0,c=a.length;b<c;b++)h=a[b],f(h)&&d.push(h);return d}())}}}).call(this)},{underscore:310}],97:[function(a,b,c){(function(){var c,d,e,f;f=a("underscore"),d=a("es6-promise").Promise,c={},e=function(a){return function(b){var c,d,e,g,h,i,j;for(h=f.zip(a,b),j=[],e=0,g=h.length;e<g;e++)i=h[e],d=i[0],c=i[1],j.push({path:d,name:c});return j}},b.exports=function(a,b){var f,g,h,i;return(f=a.service.root+":"+a.root+":"+b)in c?c[f]:(i=function(){var c,d,e,f;for(e=a.getPossiblePaths(b),f=[],c=0,d=e.length;c<d;c++)h=e[c],f.push(a.makePath(h));return f}(),i=i.filter(function(a){var b;return!("id"===(null!=(b=a.end)?b.name:void 0))}),g=function(){var a,b,c;for(c=[],a=0,b=i.length;a<b;a++)h=i[a],c.push(h.getDisplayName());return c}(),null!=c[f]?c[f]:c[f]=d.all(g).then(e(i)))}}).call(this)},{"es6-promise":257,underscore:310}],98:[function(a,b,c){(function(){var a;a=function(){function a(a){this.wrapped=a,this.root=this.wrapped.root,this._foundById={},this._counts={}}return a.prototype.fetchModel=function(){return this.wrapped.fetchModel()},a.prototype.findById=function(a,b,c){var d,e;return null!=(d=this._foundById)[e=a+":"+b+":"+c]?d[e]:d[e]=this.wrapped.findById(a,b,c)},a.prototype.count=function(a){var b,c;return null!=(b=this._counts)[c=JSON.stringify(a)]?b[c]:b[c]=this.wrapped.count(a)},a.prototype.destroy=function(){return this._foundById={},this._counts={},delete this.wrapped},a}(),b.exports=function(){function b(b,c){this.Preview=c,this.service=new a(b)}return b.prototype.get=function(a){var b,c,d,e;return b=this.Preview,d=this.service,e=a.get("classes"),c=a.get("id"),new b({service:d,model:{types:e,id:c}})},b.prototype.destroy=function(){return this.service.destroy(),delete this.service},b}()}).call(this)},{}],99:[function(a,b,c){(function(){c.fromPairs=function(a){var b;return function(){var c,d,e;for(e=[],c=0,d=a.length;c<d;c++)b=a[c],e.push(b.map(encodeURIComponent).join("="));return e}().join("&")}}).call(this)},{}],100:[function(a,b,c){(function(){var c,d,e,f;a("jquery"),d=a("es6-promise").Promise,c=a("../options"),f=a("./load-resource"),e=function(){return f("Destination.Dropbox.Library","Dropbox")},b.exports=function(a,b,f){return e().then(function(e){return new d(function(d,g){return e.appKey=c.get("auth.dropbox"),e.save({files:[{url:a,filename:b}],success:d,progress:f,cancel:g,error:g})})})}}).call(this)},{"../options":63,"./load-resource":90,"es6-promise":257,jquery:288}],101:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l,m;m=a("underscore"),e=a("es6-promise").Promise,d=a("../options"),c=a("../messages"),g=a("./get-organisms"),f=a("./branding"),i=a("./get-result-class"),j=a("./open-window-with-post"),k=a("./parse-url"),b.exports=l=function(a,b,c){var k,l,n,o,p,q;return k=d.get("Destination.Galaxy"),p=null!=(q=k.Current)?q:k.Main,/tool_runner$/.test(p)||(p+="/tool_runner"),l=f(this.query.service),o=i(this.query),n=g(this.query),e.all([o,n,l]).then(h(a,this.query,this.model.format.ext)).then(m.partial(j,p,"Upload"))},h=function(a,b,e){return function(f){var g,h,i,j,l,n,o,p,q,r,s,t,u,v;return j=f[0],s=f[1],h=f[2],v=k(a),g=v.URL,t=v.params,p=function(){var a,c,d,e;for(d=b.constraints,e=[],a=0,c=d.length;a<c;a++)i=d[a],"IN"===i.op&&e.push(i.value);return e}(),n="tsv"===e?"tabular":e,l=window.location.toString().replace(/\?.*$/,""),u=d.get("Destination.Galaxy.Tool"),q=c.getText("export.galaxy.name",{cls:j,orgs:s,branding:h}),o=c.getText("export.galaxy.info",{query:b,lists:p,orgs:s,currentLocation:l}),null!=s&&(r=s.join(", ")),m.extend(t,{tool_id:u,URL:g,name:q,info:o,data_type:n,organism:r,URL_method:"post"})}},l.after=function(){var a;return a=d.get("Destination.Galaxy"),a.Current&&a.Save?this.query.service.whoami().then(function(b){if(b.preferences["galaxy-url"]!==a.Current)return b.setPreference("galaxy-url",a.Current)}):e.resolve(null)}}).call(this)},{"../messages":16,"../options":63,"./branding":70,"./get-organisms":84,"./get-result-class":86,"./open-window-with-post":94,"./parse-url":95,"es6-promise":257,underscore:310}],102:[function(a,b,c){(function(){var c,d,e,f,g;a("underscore"),d=a("es6-promise").Promise,c=a("../options"),e=a("./query-string").fromPairs,f=function(a,b){var d,f,g;return d=c.get("Destination.GenomeSpace"),f=[["uploadUrl",a],["fileName",b]],g=e(f),d.Upload+"?"+g},g=function(a,b){return new d(function(c,d){var e;return e=window.open(f(a,b)),e.setCallbackOnGSUploadComplete=function(a){return c(a)},e.setCallbackOnGSUploadError=function(a){return console.log("GSERR",arguments),d(new Error("Could not save to "+a))},e.addEventListener("unload",function(){return d(new Error("Upload cancelled"))}),e.focus()})},b.exports=g}).call(this)},{"../options":63,"./query-string":99,"es6-promise":257,underscore:310}],103:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x;c=a("jquery"),w=a("underscore"),p=a("es6-promise").Promise,o=a("../options"),u=a("./load-resource"),x=null,l="Destination.Drive.Library",d="-------314159265358979323846",f="\r\n--"+d+"\r\n",e="\r\n--"+d+"--",t="v2",s="https://www.googleapis.com/auth/drive.file",i="No configuration available for Google Drive",m="Content-Type: application/json\r\n\r\n",j="Content-Type: text/tab-separated-values\r\n\r\n",q='multipart/mixed; boundary="'+d+'"',h="/upload/drive/v2/files",g="POST",r={path:h,method:g,params:{uploadType:"multipart"},headers:{"Content-Type":q}},v=function(){return null!=x?x:x=u(l,"gapi").then(function(a){return new k(a)})},b.exports=function(a,b,c){return v().then(function(d){return c(1),d.upload(a,b)})},n=function(){function a(a){this.title=a}return a.prototype.mimetype="text/plain",a.prototype.toString=function(){return JSON.stringify({title:this.title,mimetype:this.mimetype})},a}(),k=function(){function a(a){if(this.gapi=a,!this.gapi)throw new Error("No api");if(!o.get("auth.drive"))throw new Error(i);console.log(this.gapi)}return a.prototype.authorize=function(){return new p(function(a){return function(b,c){var d,e,f,g,h,i;f=a.gapi,i=null,h={client_id:o.get("auth.drive"),scope:s,immediate:!1},g=function(){return f.auth.authorize(h,function(a){return null==a?c(new Error("Not authorized")):a.error?c(new Error(a.error)):b()})},d=function(){return clearTimeout(i),c(new Error("timed out"))},e=function(){var a;return clearTimeout(i),(null!=(a=f.auth)?a.authorize:void 0)?g():i=setTimeout(e,50)},e(),setTimeout(d,5e3)}}(this))},a.prototype.loadClient=function(){return new p(function(a){return function(b,c){return a.gapi.client.load("drive",t,b)}}(this))},a.prototype.makeRequestBody=function(a,b){return f+m+String(a)+f+j+b+e},a.prototype.makeRequest=function(a){return this.gapi.client.request(w.extend({body:a},r))},a.prototype.upload=function(a,b){return this.authorize().then(function(a){return function(){return a.loadClient()}}(this)).then(function(){return p.resolve(c.get(a))}).then(function(a){return function(c){return a.makeRequestBody(new n(b),c)}}(this)).then(function(a){return function(b){return a.makeRequest(b)}}(this)).then(function(a){return a.result.alternateLink})},a}()}).call(this)},{"../options":63,"./load-resource":90,"es6-promise":257,jquery:288,underscore:310}],104:[function(a,b,c){(function(){var c,d,e,f,g,h=[].slice;g=a("underscore"),d=g.compose,e=g.escape,f=a("./ensure-required-data"),c=function(a){return function(){var b;return arguments[0],b=2<=arguments.length?h.call(arguments,1):[],a.apply(null,b)}},b.exports=function(a,b,g,h){return{classes:h,target:a,replaces:b,call:c(d(e,g,f(a,b)))}}}).call(this)},{"./ensure-required-data":80,underscore:310}],105:[function(a,b,c){(function(){var a;a={ASC:"DESC",DESC:"ASC",NONE:"ASC"},b.exports=function(b,c){var d,e,f;return d=null!=(f=b.getSortDirection(c))?f:"NONE",e=a[d],b.orderBy([{path:c,direction:e}])}}).call(this)},{}],106:[function(a,b,c){(function(){b.exports=function(a){if(null!=a)return a=a.replace(/\n\s*\n/g,"\n\n"),a.replace(/(^\s*|\s*$)/g,"")}}).call(this)},{}],107:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j=function(a,b){return function(){return a.apply(b,arguments)}};i=a("underscore"),e=a("../options"),d=a("../messages"),c=a("../icons"),g=a("../templates/mustache-settings"),f="<span class=\"alert alert-info\">\n  {{{ icons.icon('Info') }}}\n  {{ messages.getText('conbuilder.TooManySuggestions') }}\n  There are {{ extra }} values we could not include.\n</span>\n",h=i.template(f,g),b.exports=function(){function a(a,b){var f;this.suggestions=a,this.total=b,this.suggest=j(this.suggest,this),f=e.get("MaxSuggestions"),this.total>f&&(this.tooMany=h({icons:c,messages:d,extra:b-f}))}return a.prototype.tooMany="<span></span>",a.prototype.suggest=function(a,b){var c,d,e,f,g;return null==a||""===a?b(function(){var a,b,c,d;for(c=this.suggestions.slice(0,10),d=[],a=0,b=c.length;a<b;a++)e=c[a],d.push(e);return d}.call(this)):(d=null!=(f=null!=a&&null!=(g=a.toLowerCase())?g.split(" "):void 0)?f:[],c=function(a){var b;return b=a.item,null==b&&(b=""),i.all(d,function(a){return b.toLowerCase().indexOf(a)>=0})},b(function(){var a,b,d,f;for(d=this.suggestions,f=[],a=0,b=d.length;a<b;a++)e=d[a],c(e)&&f.push(e);return f}.call(this)))},a}()}).call(this)},{"../icons":14,"../messages":16,"../options":63,"../templates/mustache-settings":69,underscore:310}],108:[function(a,b,c){(function(){var b,d,e,f,g,h,i=[].indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(b in this&&this[b]===a)return b;return-1};g=a("es6-promise").Promise,e=a("../options"),f=a("../models/page"),d={},b=g.resolve(!0),c.getCache=function(a){var b,c,e;return c=a.toXML(),b=a.service.root,null!=d[e=b+":"+c]?d[e]:d[e]=new h(a)},c.onListChange=function(a){var b,c;for(c in d)b=d[c],i.call(listNamesFor(b.query),a)>=0&&b.dropRows();return!1},h=function(){function a(a){this.query=a.clone()}return a.prototype.offset=0,a.prototype.rows=null,a.prototype.toString=function(){var a;return(null!=(a=this.rows)?a.length:void 0)?"ResultCache("+this.offset+" .. "+(this.offset+this.rows.length)+")":"ResultCache(EMPTY)"},a.prototype.fetchRows=function(a,b){var c,d;return null==a&&(a=0),null==b&&(b=null),c=new f(a,b),d=this.updateCache(c),d.then(function(a){return function(){return a.getRows(c)}}(this))},a.prototype.updateCache=function(a){var c;return this.contains(a)?b:(c=this.getRequestPage(a),this.query.tableRows({start:c.start,size:c.size}).then(this.addRowsToCache(c)))},a.prototype.contains=function(a){var b,c;return b=this.rows,!(null==b||!b.length)&&(c=this.offset+b.length,!a.all()&&a.start>=this.offset&&a.end()<=c)},a.prototype.dropRows=function(){return this.rows=null,this.offset=0},a.prototype.getRequestPage=function(a){var b,c,d,g,h,i,j,k;return b=this.rows,c=e.get("TableResults.CacheFactor"),g=e.get("TableResults.RequestLimit"),i=a.all()?a.size:a.size*c,null==b?new f(a.start,i):(k=this.offset+b.length,j=a.all()||a.start>=this.offset?a.start:Math.max(0,a.start-i),h=new f(j,i),h.isBefore(this.offset)?(d=h.rightGap(this.offset),d+h.size>g?this.dropRows():h.size+=d):h.isAfter(k)&&(d=h.leftGap(k),d+h.size>g?this.dropRows():(h.size+=d,h.start=k)),h)},a.prototype.addRowsToCache=function(a){return function(b){return function(c){var d,e,f;if(d=b.rows,e=b.offset,null!=d){if(f=b.offset+d.length,a.start<e){if(a.end()<e)throw new Error("Cannot add "+a+" to "+b+" - non contiguous");d=a.all()||a.end()>f?c.slice():c.concat(d.slice(a.end()-e))}else{if(a.start>f)throw new Error("Cannot add "+a+" to "+b+" - non contiguous");a.all()||f<a.end()?d=d.slice(0,a.start-e).concat(c):console.error("Useless cache add - we already had these rows: "+a)}e=Math.min(e,a.start)}else d=c.slice(),e=a.start;return b.offset=e,b.rows=d,!0}}(this)},a.prototype.getRows=function(a){var b,c,d;if(d=a.start,c=a.size,null==this.rows)throw new Error("Cache has not been updated");return b=this.rows.slice(),b.splice(0,d-this.offset),null!=c&&c>0&&b.splice(c,b.length),b},a}(),c.ResultCache=h}).call(this)},{"../models/page":54,"../options":63,"es6-promise":257}],109:[function(a,b,c){(function(){b.exports=function(a){return a.getDisplayName().then(function(b){return{path:a.toString(),name:b}})}}).call(this)},{}],110:[function(a,b,c){(function(c){(function(){var d,e,f,g,h=[].indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(b in this&&this[b]===a)return b;return-1};f=a("es6-promise").Promise,d=a("../cdn"),e={},g=function(a,b){return h.call(c,b)>=0?f.resolve(c[b]):d.load(a).then(function(){return c[b]},console.error.bind(console))},b.exports=function(a,b,c){return(null!=e[a]?e[a]:e[a]=g(a,b)).then(c)}}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../cdn":1,"es6-promise":257}],111:[function(a,b,c){b.exports="2.0.2"},{}],112:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q=[].indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(b in this&&this[b]===a)return b;return-1},r={}.hasOwnProperty,s=function(a,b){function c(){this.constructor=a}for(var d in b)r.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};o=a("underscore"),a("jquery"),a("es6-promise").Promise,p=a("imjs"),j=p.Query,i=p.Model,
f=a("../core-model"),h=a("../messages"),k=a("../templates"),g=a("../icons"),a("../options"),l=a("../core-view"),e=a("./constraint-summary"),c=a("./constraint-editor"),h.setWithPrefix("conbuilder",{Add:"Add constraint",Update:"Update",Cancel:"Cancel",Remove:"Remove",EditCon:"Edit filter",NotEditable:"This constraint is not editable",ValuePlaceholder:"David*",ExtraPlaceholder:"Wernham-Hogg",ExtraLabel:"in",IsA:"is a",NoValue:"No value selected. Please enter a value.",NoOperator:"No operator selected. Please choose an operator.",BadLoop:"The selected path is not in the query.",NaN:"The value provided is not a number.",Duplicate:"This constraint is already on the query",TooManySuggestions:"We cannot show you all the possible values",NoSuitableLists:"No lists of this type are available",NoSuitableLoops:"No suitable loop paths were found"}),m=function(a,b){var c,d,e;return!a&&!b||!(!a||!b)&&(e=o.sortBy([a,b],function(a){return a.length}),d=e[0],c=e[1],o.all(c,function(a){return q.call(d,a)>=0}))},n=function(a,b){var c,d,e,f,g,h,i,j,k;if(!a||!b)return a===b;for(d=o.union.apply(o,[a,b].map(o.keys)),e=!0,i=0,j=d.length;i<j;i++)c=d[i],k=function(){var d,e,f,g;for(f=[a,b],g=[],d=0,e=f.length;d<e;d++)h=f[d],g.push(h[c]);return g}(),f=k[0],g=k[1],e&&(e=o.isArray(f)?m(f,g):f===g);return e},d=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return s(b,a),b.prototype.defaults=function(){return{code:null}},b.prototype.isTypeConstraint=function(){return null==this.get("op")},b}(f),b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}var f;return s(b,a),b.prototype.Model=d,b.prototype.tagName="div",b.prototype.className="im-constraint row-fluid",b.prototype.parameters=["query","constraint"],b.prototype.optionalParameters=["buttonDelegate"],b.prototype.initialize=function(){var a;b.__super__.initialize.apply(this,arguments),this.model.set(this.constraint),this.state.set({editing:!1}),this.listenTo(this.state,"change:editing",this.toggleEditor),this.listenTo(this.model,"change:type",this.setTypeName),this.listenTo(this.model,"change:path",this.setDisplayName),this.listenTo(h,"change",this.reRender),this.listenTo(this.model,"cancel",this.cancelEditing),this.listenTo(this.model,"apply",this.applyChanges);try{this.model.set({path:this.query.makePath(this.constraint.path)})}catch(b){a=b,this.model.set({error:a}),this.state.set({editing:!0})}return this.setTypeName()},b.prototype.setDisplayName=function(){return this.model.get("path").getDisplayName(function(a){return function(b,c){if(a.model.set({error:b,displayName:c}),null!=b)return a.listenToOnce(a.query,"change:constraints",function(){return a.model.set({path:a.query.getPathInfo(a.constraint.path)}),a.setDisplayName()})}}(this))},b.prototype.cancelEditing=function(){return this.state.set({editing:!1}),this.model.set(o.omit(this.constraint,"path")),this.model.set({error:null})},b.prototype.toggleEditing=function(){return this.state.get("editing")?this.cancelEditing():this.state.set({editing:!0})},b.prototype.setTypeName=function(){var a,b;if(null==(b=this.model.get("type")))return this.model.unset("typeName");try{return this.query.model.makePath(b).getDisplayName(function(a){return function(b,c){return a.model.set({error:b,typeName:c})}}(this))}catch(c){return a=c,this.model.set({error:a,typeName:b})}},b.prototype.events=function(){return{"click .im-edit":"toggleEditing","click .im-remove-constraint":"removeConstraint"}},f=/^\s*$/,b.prototype.getLoopProblem=function(a){var b;return function(){try{return this.query.getPathInfo(a.value),null}catch(a){return b=a,"BadLoop"}}.call(this)},b.prototype.getValueProblem=function(a){var b,c,d;return b=a.path,a.op,c=a.value,null==c||f.test(c)?"NoValue":(d=b.getType(),q.call(i.NUMERIC_TYPES,d)>=0&&o.isNaN(1*c)?"NaN":null)},b.prototype.getProblem=function(a){var b,c;return null!=a.type?null:!a.op||f.test(a.op)?"NoOperator":!a.path.isReference()||"="!==(b=a.op)&&"!="!==b?(c=a.op,q.call(j.ATTRIBUTE_VALUE_OPS.concat(j.REFERENCE_OPS),c)>=0?this.getValueProblem(a):this.isDuplicate(a)?"Duplicate":null):this.getLoopProblem(a)},b.prototype.isDuplicate=function(a){return o.any(this.query.constraints,o.partial(n,a))},b.prototype.setError=function(a){var b;return b=h.get("conbuilder."+a),this.model.set({error:b})},b.prototype.applyChanges=function(a){var b;return null!=(b=this.getProblem(a))?this.setError(b):(this.state.set({editing:!1}),this.removeConstraint(null,!0),null==a.values||a.values.length?(a.path=a.path.toString(),this.query.addConstraint(a),this.constraint=a,this.model.unset("new")):this.query.trigger("change:constraints"))},b.prototype.removeConstraint=function(a,b){if(null==b&&(b=!1),null!=a&&a.preventDefault(),null!=a&&a.stopPropagation(),this.model.get("new")||this.query.removeConstraint(this.constraint,b),null!=a)return this.remove()},b.prototype.getData=function(){var a,b,c;return c=h,b=g,a=this.model.toJSON(),{icons:b,messages:c,con:a}},b.prototype.template=k.template("active-constraint",{variable:"data"}),b.prototype.toggleEditor=function(){var a;return this.state.get("editing")&&this.rendered?(a={model:this.model,query:this.query,buttonDelegate:this.buttonDelegate},this.renderChild("editor",new c(a),this.$(".im-constraint-editor"))):this.removeChild("editor")},b.prototype.renderSummary=function(){var a;return a={model:this.model},this.renderChild("summary",new e(a),this.$(".im-con-overview"))},b.prototype.postRender=function(){return this.renderSummary(),this.toggleEditor(),this.$("[title]").tooltip()},b}(l)}).call(this)},{"../core-model":2,"../core-view":3,"../icons":14,"../messages":16,"../options":63,"../templates":67,"./constraint-editor":129,"./constraint-summary":130,"es6-promise":257,imjs:271,jquery:288,underscore:310}],113:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x={}.hasOwnProperty,y=function(a,b){function c(){this.constructor=a}for(var d in b)x.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},z=[].indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(b in this&&this[b]===a)return b;return-1};c=a("jquery"),u=a("underscore"),l=a("es6-promise").Promise,h=a("../messages"),o=a("../templates"),d=a("../core-view"),k=a("../options"),j=a("../core/nested-model"),p=a("../utils/branding"),g=a("../patterns").IS_BLANK,e=a("../mixins/has-typeaheads"),n=a("../utils/suggestion-source"),v=a("imjs"),w=v.Model,f=w.INTEGRAL_TYPES,i=w.NUMERIC_TYPES,m=v.Query,s=o.template("attribute_value_select"),t=function(a){return String(a).replace(/^\s+/,"").replace(/\s+$/,"")},r=function(a){return 1*t(a)},q=a("../templates/helpers").numToString,h.set({"constraintvalue.NoValues":"There are no possible values. This query returns no results","constraintvalue.OneValue":"There is only one possible value: <%- value %>. You might want to remove this constraint"}),b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return y(b,a),b.include(e),b.prototype.className="im-attribute-value-controls",b.prototype.template=o.template("attribute_value_controls"),b.prototype.getData=function(){return u.extend(this.getBaseData(),{messages:h,con:this.model.toJSON()})},b.prototype.initialize=function(a){var c;if(this.query=a.query,b.__super__.initialize.apply(this,arguments),this.sliders=[],this.branding=new j,this.cast=(c=this.model.get("path").getType(),z.call(i,c)>=0?r:t),this.listenTo(h,"change",this.reRender),this.state.set({valuePlaceholder:h.getText("conbuilder.ValuePlaceholder")}),this.listenTo(this.branding,"change:defaults.value",function(){return this.state.set({valuePlaceholder:this.branding.get("defaults.value")})}),null!=this.query)return this.listenTo(this.query,"change:constraints",this.clearCachedData),this.listenTo(this.query,"change:constraints",this.reRender),p(this.query.service).then(function(a){return function(b){return a.branding.set(b)}}(this))},b.prototype.modelEvents=function(){return{destroy:function(){return this.stopListening()},"change:value":this.onChangeValue,"change:op":this.onChangeOp}},b.prototype.stateEvents=function(){return{"change:valuePlaceholder":this.reRender}},b.prototype.onChangeOp=function(){var a;return a=this.model.get("op"),null!=this.model.get("value")&&z.call(m.MULTIVALUE_OPS,a)>=0&&this.model.set({value:null,values:[this.model.get("value")]}),this.reRender()},b.prototype.onChangeValue=function(){return this.reRender()},b.prototype.removeAllChildren=function(){return this.removeTypeAheads(),this.removeSliders(),b.__super__.removeAllChildren.apply(this,arguments)},b.prototype.removeSliders=function(){var a,b;for(b=[];a=this.sliders.pop();)try{a.slider("destroy"),b.push(a.remove())}catch(a){}return b},b.prototype.events=function(){return{"change .im-con-value-attr":"setAttributeValue"}},b.prototype.updateInput=function(){var a,b;return a=null!=(b=this.lastTypeahead())?b:this.$(".im-con-value-attr"),a.val(this.model.get("value"))},b.prototype.readAttrValue=function(){var a,b;a=(null!=(b=this.lastTypeahead())?b:this.$(".im-con-value-attr")).val();try{return null==a||g.test(a)?null:this.cast(a)}catch(b){return b,this.model.set({error:new Error(a+" might not be a legal value for "+this.path)}),a}},b.prototype.setAttributeValue=function(){return this.model.set({value:this.readAttrValue()})},b.prototype.postRender=function(){return this.provideSuggestions().then(null,function(a){return function(b){return a.model.set({error:b})}}(this)),this.$(".im-con-value-attr").focus()},b.prototype.provideSuggestions=function(){return this.getSuggestions().then(function(a){return function(b){var c,d,e;return e=b.stats,d=b.results,0===e.uniqueValues?(c=h.getText("constraintvalue.NoValues"),a.model.set({error:{message:c,level:"warning"}})):1===e.uniqueValues?(c=h.getText("constraintvalue.OneValue",{value:d[0].item}),a.model.set({error:{message:c,level:"warning"}})):null!=e.max?a.handleNumericSummary(e):null!=d[0].item?a.handleSummary(d,e.uniqueValues):void 0}}(this))},b.prototype.clearCachedData=function(){return delete this.__suggestions,this.model.unset("error")},b.prototype.getSuggestions=function(){return null!=this.__suggestions?this.__suggestions:this.__suggestions=function(a){return function(){var b,c,d,e,f;return a.model.get("path")?(c=a.query.clone(),f=a.model.get("value"),e=String(a.model.get("path")),d=k.get("MaxSuggestions"),c.constraints=function(){var a,d,g,h;for(g=c.constraints,h=[],a=0,d=g.length;a<d;a++)b=g[a],b.path===e&&b.value===f||h.push(b);return h}(),c.summarise(e,d)):l.reject(new Error("no path"))}}(this)()},b.prototype.replaceInputWithSelect=function(a){var b;return this.model.has("value")?null==(b=this.model.get("value"))||u.any(a,function(a){return a.item===b})||a.push({item:b}):this.model.set({value:a[0].item}),this.$el.html(s({Messages:h,items:a,value:b}))},b.prototype.handleSummary=function(a,b){var c,d,e,f,g,h;return("="===(h=this.model.get("op"))||"!="===h)&&a.length<k.get("DropdownMax")?this.replaceInputWithSelect(a):(e=this.$(".im-con-value-attr"),g=new n(a,b),f={minLength:0,highlight:!0},c={name:"summary_suggestions",source:g.suggest,displayKey:"item",templates:{footer:g.tooMany}},this.removeTypeAheads(),d=function(a){return function(b,c){return a.model.set({value:c.item})}}(this),this.activateTypeahead(e,f,c,a[0].item,d,function(a){return function(){return a.setAttributeValue()}}(this)))},b.prototype.clearer='<div class="" style="clear:both;">',b.prototype.getMarkers=function(a,b,c){var d,e,f,g,h,i,j,k;for(g=b-a,f=function(b){var d;return d=b*g+a,c?Math.round(d):d},e=function(a){return Math.round(100*a)},j=[0,.5,1],k=[],h=0,i=j.length;h<i;h++)d=j[h],k.push({percent:e(d),value:q(f(d))});return k},b.prototype.makeSlider=o.template("slider",{variable:"markers"}),b.prototype.handleNumericSummary=function(a){var b,d,e,g,h,i,j,k,l,m,n,o;return l=a.min,k=a.max,d=a.average,m=this.model.get("path"),o=m.getType(),i=z.call(f,o)>=0,n=i?1:k-l/100,e=i?function(a){return parseInt(a,10)}:parseFloat,g=this.$el,h=this.$("input"),g.append(this.clearer),j=this.getMarkers(l,k,i),this.removeSliders(),h.off("change.slider"),b=c(this.makeSlider(j)),b.appendTo(g).slider({min:l,max:k,value:this.model.has("value")?this.model.get("value"):e(d),step:n,slide:function(a,b){return h.val(b.value).change()}}),h.attr({placeholder:e(d)}),g.append(this.clearer),h.on("change.slider",function(a){return b.slider("value",e(h.val()))}),this.sliders.push(b)},b.prototype.remove=function(){return b.__super__.remove.apply(this,arguments),this.removeTypeAheads()},b}(d)}).call(this)},{"../core-view":3,"../core/nested-model":8,"../messages":16,"../mixins/has-typeaheads":32,"../options":63,"../patterns":64,"../templates":67,"../templates/helpers":68,"../utils/branding":70,"../utils/suggestion-source":107,"es6-promise":257,imjs:271,jquery:288,underscore:310}],114:[function(a,b,c){(function(){var c,d,e,f,g={}.hasOwnProperty,h=function(a,b){function c(){this.constructor=a}for(var d in b)g.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};f=a("underscore"),a("../messages"),c=a("../core-view"),a("../options"),e=a("../templates/mustache-settings"),d="<button class=\"btn btn-default im-true {{ (value === true) ? ' active' : void 0 }}\">\n  True\n</button>\n<button class=\"btn btn-default im-false {{ (value === false) ? ' active' : void 0 }}\">\n  False\n</button>\n",b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return h(b,a),b.prototype.className="im-value-options btn-group",b.prototype.modelEvents=function(){return{change:this.reRender}},b.prototype.getData=function(){return f.extend({value:null},b.__super__.getData.apply(this,arguments))},b.prototype.template=f.template(d,e),b.prototype.events=function(){return{"click .im-true":"setValueTrue","click .im-false":"setValueFalse"}},b.prototype.setValueTrue=function(){return this.model.set({value:!0})},b.prototype.setValueFalse=function(){return this.model.set({value:!1})},b}(c)}).call(this)},{"../core-view":3,"../messages":16,"../options":63,"../templates/mustache-settings":69,underscore:310}],115:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j={}.hasOwnProperty,k=function(a,b){function c(){this.constructor=a}for(var d in b)j.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};i=a("underscore"),d=a("../core-view"),a("../messages"),g=a("../options"),h=a("../templates"),c=a("../models/code-gen"),e=a("./code-gen-dialogue"),a("../messages/code-gen"),f=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return k(b,a),b.prototype.modelEvents=function(){return{"change:lang":this.reRender}},b.prototype.template=h.template("code-gen-button-main"),b}(d),b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return k(b,a),b.prototype.parameters=["query","tableState"],b.prototype.Model=c,b.prototype.template=h.template("code-gen-button"),b.prototype.getData=function(){return i.extend(b.__super__.getData.apply(this,arguments),{options:g.get("CodeGen")})},b.prototype.renderChildren=function(){return this.renderChildAt(".im-show-code-gen-dialogue",new f({model:this.model}))},b.prototype.events=function(){return{"click .dropdown-menu.im-code-gen-langs li":"chooseLang","click .im-show-code-gen-dialogue":"showDialogue"}},b.prototype.chooseLang=function(a){var b;return b=this.$(a.target).closest("li").data("lang"),this.model.set({lang:b}),this.showDialogue()},b.prototype.showDialogue=function(){var a,b;return b=this.tableState.pick("start","size"),a=new e({query:this.query,model:this.model,page:b}),this.renderChild("dialogue",a),a.show()},b}(d)}).call(this)},{"../core-view":3,"../messages":16,"../messages/code-gen":18,"../models/code-gen":38,"../options":63,"../templates":67,"./code-gen-dialogue":116,underscore:310}],116:[function(a,b,c){(function(c){(function(){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A=[].indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(b in this&&this[b]===a)return b;return-1},B={}.hasOwnProperty,C=function(a,b){function c(){this.constructor=a}for(var d in b)B.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};z=a("underscore"),o=a("es6-promise").Promise,l=a("./modal"),k=a("../messages"),n=a("../options"),p=a("../templates"),g=a("../models/code-gen"),f=a("../core/checkbox"),a("../messages/code-gen"),t=a("../utils/indent-xml"),v=a("../utils/strip-extra-whitespace"),y=a("../utils/with-cdn-resource"),m=/\s*#.*$/gm,e=/\/\*(\*(?!\/)|[^*])*\*\//gm,q="application/xml;charset=utf8",i="text/javascript;charset=utf8",h="text/html;charset=utf8",d={level:"Info",key:"codegen.CannotExportXML"},j={js:i,xml:q,html:h},x=z.partial(y,"prettify","prettyPrintOne"),w=z.partial(y,"filesaver","saveAs"),r=o.reject("Requirements not met"),u=function(a){var b,c;return z.object(function(){var d;d=[];for(b in a)(c=a[b])&&0!==c.length&&d.push([b,c]);return d}())},s=function(){var a;return a=!1,A.call(c,a)>=0?r:w(z.identity)},b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return C(b,a),b.prototype.Model=g,b.prototype.parameters=["query"],b.prototype.optionalParameters=["page"],b.prototype.page={start:0,size:n.get("DefaultPageSize")},b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this.generateCode(),this.setExportLink()},b.prototype.modalSize=function(){return"lg"},b.prototype.title=function(){return k.getText("codegen.DialogueTitle",{query:this.query,lang:this.model.get("lang")})},b.prototype.primaryIcon=function(){return"Download"},b.prototype.primaryAction=function(){return k.getText("codegen.PrimaryAction")},b.prototype.body=p.template("code_gen_body"),b.prototype.invariants=function(){return{hasQuery:"No query"}},b.prototype.hasQuery=function(){return null!=this.query},b.prototype.modelEvents=function(){return{change:this.onChangeLang,"change:showBoilerPlate":this.reRenderBody,"change:highlightSyntax":this.reRenderBody}},b.prototype.stateEvents=function(){return{"change:generatedCode":this.reRenderBody}},b.prototype.events=function(){return z.extend(b.__super__.events.apply(this,arguments),{"click .dropdown-menu.im-code-gen-langs li":"chooseLang"})},b.prototype.getBoilerPlateRegex=function(){if(!this.model.get("showBoilerPlate"))switch(this.model.get("lang")){case"pl":case"py":case"rb":return m;case"java":case"js":return e;default:return null}},b.prototype.act=function(){var a,b,c,d;return c=this.model.get("lang"),"js"===c&&this.model.get("extrajs")&&(c="html"),a=new Blob([this.state.get("generatedCode")],{type:j[c]}),b=(null!=(d=this.query.name)?d:"name")+"."+c,w(function(c){return function(c){return c(a,b)}}())},b.prototype.onChangeLang=function(){var a;return a=this.model.get("lang"),this.$(".im-current-lang").text(k.getText("codegen.Lang",{lang:a})),this.$(".modal-title").text(this.title()),"js"===a||"xml"===a?s().then(function(a){return function(){return a.state.unset("error")}}(this)).then(null,function(a){return function(){return a.state.set({error:d})}}(this)):this.state.unset("error"),this.generateCode(),this.setExportLink()},b.prototype.generateCode=function(){var a;switch(a=this.model.get("lang")){case"xml":return this.state.set({generatedCode:this.generateXML()});case"js":return this.state.set({generatedCode:this.generateJS()});default:return this.getCodeFromCache(a)}},b.prototype.getCodeFromCache=function(a){var b,c;return null==this.cache&&(this.cache={}),null!=(null!=(c=this.cache)?c[a]:void 0)?this.state.set({generatedCode:this.cache[a]}):(b={query:this.query.toXML(),lang:a,date:Date.now()},this.query.service.post("query/code?cachebuster="+Date.now(),b).then(function(b){return function(c){return b.cache[a]=c.code,b.state.set({generatedCode:c.code})}}(this)))},b.prototype.generateXML=function(){return t(this.query.toXML())},b.prototype.generateJS=function(){var a,b,c,d;return d=p.template("code-gen-js"),c=u(this.query.toJSON()),a=n.get("CDN.server")+n.get(["CDN","imtables"]),b={service:this.query.service,query:c,page:this.page,asHTML:this.model.get("extrajs"),imtablesJS:a+"imtables.js",imtablesCSS:a+"main.sandboxed.css"},d(b)},b.prototype.setExportLink=function(){var a;switch(a=this.model.get("lang")){case"xml":case"js":return this.state.set({exportLink:null});default:return this.state.set({exportLink:this.query.getCodeURI(a)})}},b.prototype.reRenderBody=function(){if(this.rendered)return this.$(".modal-body").html(this.body(this.getData())),this.trigger("rendered",this.rendered)},b.prototype.postRender=function(){return b.__super__.postRender.apply(this,arguments),this.addCheckboxes(),this.highlightCode(),this.setMaxHeight()},b.prototype.setMaxHeight=function(){var a;return a=Math.max(250,this.$el.closest(".modal").height()-200),this.$(".im-generated-code").css({"max-height":a})},b.prototype.addCheckboxes=function(){var a;if(this.renderChildAt(".im-show-boilerplate",new f({model:this.model,attr:"showBoilerPlate",label:"codegen.ShowBoilerPlate"})),this.renderChildAt(".im-highlight-syntax",new f({model:this.model,attr:"highlightSyntax",label:"codegen.HighlightSyntax"})),a=n.get(["CodeGen","Extra",this.model.get("lang")]))return this.renderChildAt(".im-extra-options",new f({model:this.model,attr:"extra"+this.model.get("lang"),label:a}))},b.prototype.highlightCode=function(){var a,b;if(this.model.get("highlightSyntax")){if(this.model.get("lang"),b=this.$(".im-generated-code"),null==(a=this.getCode()))return;return x(function(c){return b.html(c(z.escape(a)))})}},b.prototype.getData=function(){return z.extend(b.__super__.getData.apply(this,arguments),{options:n.get("CodeGen"),generatedCode:this.getCode()})},b.prototype.getCode=function(){var a,b;return a=this.state.get("generatedCode"),b=this.getBoilerPlateRegex(),b?v(null!=a?a.replace(b,""):void 0):a},b.prototype.toggleShowBoilerPlate=function(){return this.model.toggle("showBoilerPlate")},b.prototype.toggleHighlightSyntax=function(){return this.model.toggle("highlightSyntax")},b.prototype.chooseLang=function(a){var b;return a.stopPropagation(),b=this.$(a.target).closest("li").data("lang"),this.model.set({lang:b})},b}(l)}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../core/checkbox":4,"../messages":16,"../messages/code-gen":18,"../models/code-gen":38,"../options":63,"../templates":67,"../utils/indent-xml":88,"../utils/strip-extra-whitespace":106,"../utils/with-cdn-resource":110,"./modal":197,"es6-promise":257,underscore:310}],117:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l,m,n,o,p=function(a,b){return function(){return a.apply(b,arguments)}},q={}.hasOwnProperty,r=function(a,b){function c(){this.constructor=a}for(var d in b)q.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};o=a("underscore"),h=a("./modal"),a("../templates"),g=a("../messages"),d=a("../core/collection"),k=a("../models/path"),e=a("./column-manager/tabs"),m=a("./column-manager/select-list"),n=a("./column-manager/sort-order"),c=a("../models/available-columns"),j=a("../models/order-element"),a("../messages/columns"),f=function(a){function b(){this.model=p(this.model,this),b.__super__.constructor.apply(this,arguments),this.listenTo(this,"change:index",function(){return o.defer(function(a){return function(){return a.sort()}}(this))})}return r(b,a),b.prototype.comparator="index",b.prototype.add=function(){return b.__super__.add.apply(this,arguments)},b.prototype.modelFactory=d.prototype.model,b.prototype.model=function(a){var b,c;return b=this.size(),c=new this.modelFactory(a),c.collection=this,c.set({index:b}),c},b}(d),l=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return r(b,a),b.prototype.modelFactory=k,b}(f),i=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return r(b,a),b.prototype.modelFactory=j,b}(f),b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return r(b,a),b.prototype.parameters=["query"],b.prototype.modalSize=function(){return"lg"},b.prototype.className=function(){return b.__super__.className.apply(this,arguments)+" im-column-manager"},b.prototype.title=function(){return g.getText("columns.DialogueTitle")},b.prototype.primaryAction=function(){return g.getText("columns.ApplyChanges")},b.prototype.dismissAction=function(){return g.getText("Cancel")},b.prototype.act=function(){var a,b,c,d;if(!this.state.get("disabled"))return d=this.state.pick("viewChanged","orderChanged"),c=d.viewChanged,b=d.orderChanged,c&&!b?this.query.select(this.getCurrentView()):b&&!c?this.query.orderBy(this.getCurrentSortOrder()):(a={silent:!0,events:[]},this.query.select(this.getCurrentView(),a),this.query.orderBy(this.getCurrentSortOrder(),a),this.query.trigger(a.events.join(" "))),this.resolve("changed")},b.prototype.stateEvents=function(){return{"change:currentTab":this.renderTabContent,"change:adding":this.setDisabled}},b.prototype.initialize=function(){var a,d,e,f,g,h,j,k,m,n,o,p,q;for(b.__super__.initialize.apply(this,arguments),this.selectList=new l,this.rubbishBin=new l,this.sortOrder=new i,this.availableColumns=new c,n=this.query.views,f=0,j=n.length;f<j;f++)e=n[f],this.selectList.add(this.query.makePath(e));for(o=this.query.sortOrder,g=0,k=o.length;g<k;g++)p=o[g],d=p.path,a=p.direction,this.sortOrder.add({direction:a,path:this.query.makePath(d)});for(q=this.getRelevantPaths(),h=0,m=q.length;h<m;h++)d=q[h],this.sortOrder.get(d.toString())||this.availableColumns.add(d,{sort:!1});return this.availableColumns.sort(),this.listenTo(this.selectList,"sort add remove",this.setDisabled),this.listenTo(this.sortOrder,"sort add remove",this.setDisabled)},b.prototype.getRelevantPaths=function(){return o.chain(this.query.getQueryNodes()).filter(function(a){return function(b){return!a.query.isOuterJoined(b)}}(this)).map(function(a){var b,c,d,e,f;for(e=a.getChildNodes(),f=[],c=0,d=e.length;c<d;c++)b=e[c],b.isAttribute()&&"id"!==b.end.name&&f.push(b);return f}).flatten().value()},b.prototype.getCurrentView=function(){return this.selectList.pluck("path")},b.prototype.getCurrentSortOrder=function(){return this.sortOrder.map(function(a){return a.asOrderElement()})},b.prototype.setDisabled=function(){var a,b,c,d,e,f;return this.state.get("adding")?this.state.set({disabled:!0}):(b=this.getCurrentView().join(" "),d=this.query.views.join(" "),a=this.sortOrder.map(function(a){return a.toOrderString()}).join(" "),c=this.query.getSorting(),f=b===d,e=a===c,this.state.set({viewChanged:!f,orderChanged:!e,disabled:f&&e}))},b.prototype.initState=function(){return this.state.set({disabledReason:"columns.NoChangesToApply",disabled:!0,currentTab:e.TABS[0]})},b.prototype.renderTabs=function(){return this.renderChild("tabs",new e({state:this.state}),this.$(".modal-body"))},b.prototype.renderTabContent=function(){var a;if(this.rendered)return a=function(){switch(this.state.get("currentTab")){case"view":return new m({state:this.state,query:this.query,rubbishBin:this.rubbishBin,collection:this.selectList});case"sortorder":return new n({query:this.query,availableColumns:this.availableColumns,collection:this.sortOrder});default:throw new Error("Cannot render "+this.state.get("currentTab"))}}.call(this),this.renderChild("main",a,this.$(".modal-body"))},b.prototype.postRender=function(){return b.__super__.postRender.apply(this,arguments),this.renderTabs(),this.renderTabContent()},b.prototype.remove=function(){return this.selectList.close(),this.rubbishBin.close(),this.sortOrder.close(),this.availableColumns.close(),b.__super__.remove.apply(this,arguments)},b}(h)}).call(this)},{"../core/collection":5,"../messages":16,"../messages/columns":19,"../models/available-columns":36,"../models/order-element":53,"../models/path":56,"../templates":67,"./column-manager/select-list":122,"./column-manager/sort-order":124,"./column-manager/tabs":125,"./modal":197,underscore:310}],118:[function(a,b,c){(function(){var c,d,e,f={}.hasOwnProperty,g=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};e=a("underscore"),d=a("./unselected-column"),c=900,b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return g(b,a),b.prototype.parameters=["findActives"],b.prototype.restoreTitle="columns.AddColumnToSortOrder",b.prototype.events=function(){return e.extend(b.__super__.events.apply(this,arguments),{mousedown:"onMouseDown",dragstart:"onDragStart",dragstop:"onDragStop"})},b.prototype.onMouseDown=function(){return this.fixAppendTo()},b.prototype.fixAppendTo=function(){var a,b;return this.$el.draggable("option","appendTo",this.$el.closest(".well")),a=this.$el.closest(".modal").width(),b=a>=c,this.$el.draggable("option","axis",b?null:"y")},b.prototype.onDragStart=function(){return this.state.set({dragged:this.model.get("path")}),this.$el.addClass("ui-dragging")},b.prototype.onDragStop=function(){return this.state.unset("dragged"),this.$el.removeClass("ui-dragging")},b.prototype.postRender=function(){var a,b,d;return b=this.$el.closest(".modal").width(),d=b>=c,a=this.model.collection.indexOf(this.model),this.$el.draggable({axis:d?null:"y",connectToSortable:this.findActives(),helper:"clone",revert:"invalid",opacity:.8,cancel:"i,a,button",zIndex:1e3}),this.$("[title]").tooltip({placement:0===a?"bottom":"top"})},b}(d)}).call(this)},{"./unselected-column":126,underscore:310}],119:[function(a,b,c){(function(){var c,d,e={}.hasOwnProperty,f=function(a,b){function c(){this.constructor=a}for(var d in b)e.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};d=a("../query-dialogue-button"),c=a("../column-manager"),a("../../messages/columns"),b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return f(b,a),b.prototype.className="im-column-manager-button",b.prototype.longLabel="columns.ManageColumns",b.prototype.shortLabel="columns.ManageColumnsShort",b.prototype.icon="Columns",b.prototype.Dialogue=c,b}(d)}).call(this)},{"../../messages/columns":19,"../column-manager":117,"../query-dialogue-button":206}],120:[function(a,b,c){(function(){var c,d,e,f,g,h={}.hasOwnProperty,i=function(a,b){function c(){this.constructor=a}for(var d in b)h.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};g=a("underscore"),c=a("./selected-column"),e=a("../../templates"),d=["column-manager-position-controls","column-manager-order-direction","column-manager-path-name","column-manager-path-remover"],f=function(a){return"ASC"===a?"DESC":"ASC"},b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return i(b,a),b.prototype.removeTitle="columns.RemoveOrderElement",b.prototype.template=e.templateFromParts(d),b.prototype.modelEvents=function(){return g.extend(b.__super__.modelEvents.apply(this,arguments),{"change:direction":this.reRender})},b.prototype.events=function(){return g.extend(b.__super__.events.apply(this,arguments),{"click .im-change-direction":"changeDirection"})},b.prototype.changeDirection=function(){return this.model.swap("direction",f)},b}(c)}).call(this)},{"../../templates":67,"./selected-column":123,underscore:310}],121:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j={}.hasOwnProperty,k=function(a,b){function c(){this.constructor=a}for(var d in b)j.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};d=a("../../core-view"),i=a("../../templates"),f=a("../../options"),h=a("../../models/path-set"),e=a("../../models/open-nodes"),g=a("../path-chooser"),c=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return k(b,a),b.prototype.parameters=["collection","selectList"],b.prototype.template=i.template("column-manager-path-chooser-buttons"),
b.prototype.collectionEvents=function(){return{"add remove reset":"reRender"}},b.prototype.events=function(){return{"click .im-add-column":"addColumn","click .im-rearrange-columns":"cancel"}},b.prototype.cancel=function(){return this.trigger("done")},b.prototype.addColumn=function(){var a,b;return b=this.selectList,a=this.collection.paths(),this.cancel(),b.add(a)},b}(d),b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return k(b,a),b.prototype.parameters=["query","collection"],b.prototype.template=i.template("column-manager-path-chooser"),b.prototype.initialize=function(){var a;return b.__super__.initialize.apply(this,arguments),this.chosenPaths=new h,this.view=new h(function(){var b,c,d,e;for(d=this.collection.pluck("path"),e=[],b=0,c=d.length;b<c;b++)a=d[b],e.push(this.query.makePath(a));return e}.call(this)),this.openNodes=new e(this.query.getViewNodes())},b.prototype.initState=function(){return this.query.makePath(this.query.root).getDisplayName().then(function(a){return function(b){return a.state.set({rootName:b})}}(this))},b.prototype.stateEvents=function(){return{"change:rootName":"reRender"}},b.prototype.postRender=function(){return this.renderButtons(),this.openPathChooser()},b.prototype.renderButtons=function(){var a;return a=new c({state:this.state,collection:this.chosenPaths,selectList:this.collection}),this.listenTo(a,"done",function(a){return function(){return a.trigger("done")}}(this)),this.renderChildAt(".btn-group",a)},b.prototype.openPathChooser=function(){var a,b;return a={dontSelectView:!0,multiSelect:f.get("ColumnManager.SelectColumn.Multi")},b=new g({model:a,query:this.query,chosenPaths:this.chosenPaths,openNodes:this.openNodes,view:this.view,trail:[]}),this.renderChild("pathChooser",b),this.setPathChooserHeight()},b.prototype.setPathChooserHeight=function(){return this.$(".im-path-chooser").css({"max-height":this.$el.closest(".modal").height()-350})},b.prototype.remove=function(){return this.chosenPaths.close(),this.view.close(),this.openNodes.close(),b.__super__.remove.apply(this,arguments)},b}(d)}).call(this)},{"../../core-view":3,"../../models/open-nodes":52,"../../models/path-set":55,"../../options":63,"../../templates":67,"../path-chooser":201}],122:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l,m={}.hasOwnProperty,n=function(a,b){function c(){this.constructor=a}for(var d in b)m.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};l=a("underscore"),d=a("../../core-view"),g=a("../../templates"),a("../../core/collection"),e=a("../../mixins/handles-dom-resort"),f=a("./selected-column"),h=a("./unselected-column"),c=a("./path-chooser"),j=function(a){return"path_"+a.get("id")},i=function(a){return"expath_"+a.get("id")},k=function(a){return a+1},b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return n(b,a),b.include(e),b.prototype.parameters=["query","collection","rubbishBin"],b.prototype.className="im-select-list-editor",b.prototype.template=g.template("column-manager-select-list"),b.prototype.getData=function(){return l.extend(b.__super__.getData.apply(this,arguments),{hasRubbish:this.rubbishBin.size()})},b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this.listenTo(this.rubbishBin,"remove",this.restoreView)},b.prototype.initState=function(){return this.state.set({adding:!1})},b.prototype.collectionEvents=function(){return{remove:"moveToBin","add remove":"reRender"}},b.prototype.events=function(){return{"drop .im-rubbish-bin":"onDragToBin","sortupdate .im-active-view":"onOrderChanged","click .im-add-view-path":"setAddingTrue"}},b.prototype.stateEvents=function(){return{"change:adding":"onChangeMode"}},b.prototype.setAddingTrue=function(){return this.state.set({adding:!0})},b.prototype.onDragToBin=function(a,b){return b.draggable.trigger("binned")},b.prototype.moveToBin=function(a){return this.rubbishBin.add(this.query.makePath(a.get("path"))),this.reIndexFrom(a.get("index"))},b.prototype.reIndexFrom=function(a){var b,c,d,e,f;for(f=[],b=c=a,d=this.collection.size();a<=d?c<=d:c>=d;b=a<=d?++c:--c)f.push(null!=(e=this.collection.at(b))?e.set({index:b}):void 0);return f},b.prototype.restoreView=function(a){return this.collection.add(this.query.makePath(a.get("path")))},b.prototype.onChangeMode=function(){if(this.rendered)return this.state.get("adding")?(this.$(".im-removal-and-rearrangement").hide(),this.$(".im-addition").show(),this.renderPathChooser()):(this.$(".im-removal-and-rearrangement").show(),this.$(".im-addition").hide(),this.removeChild("columnChooser"))},b.prototype.renderPathChooser=function(){var a;return a=new c({query:this.query,collection:this.collection}),this.listenTo(a,"done",function(a){return function(){return a.state.set({adding:!1})}}(this)),this.renderChild("columnChooser",a,this.$(".im-addition"))},b.prototype.onOrderChanged=function(a,b){return null!=b.sender?this.restoreFromBin(b.item):this.onDOMResort()},b.prototype.getInsertPoint=function(a){var b,c,d;return b=a.prev(),c=this.children,d=this.collection.find(function(a){var d;return d=c[j(a)],d.el===b[0]}),null==d?0:d.get("index")+1},b.prototype.getRestoredModel=function(a){return this.rubbishBin.find(function(b){return function(c){var d;return d=b.children[i(c)],(null!=d?d.el:void 0)===a[0]}}(this))},b.prototype.restoreFromBin=function(a){var b,c,d,e,f,g,h,i,l,m;if(e=this.children,g=this.collection.size(),c=this.getInsertPoint(a),null==(i=this.getRestoredModel(a)))return void console.error("could not find model for:",a);if(i.destroy(),c!==g){for(h=function(){var a,b;for(b=[],d=a=c;c<=g?a<g:a>g;d=c<=g?++a:--a)b.push(this.collection.at(d));return b}.call(this),b=this.collection.last(),l=0,m=h.length;l<m;l++)f=h[l],f.swap("index",k);return b.set({index:c}),e[j(b)].$el.insertBefore(e[j(h[0])].el)}},b.prototype.onDOMResort=function(){return this.setChildIndices(j)},b.prototype.postRender=function(){var a,b,c,d,e;return b=this.$(".im-active-view"),a=this.$(".im-removed-view"),c=900,d=this.$el.closest(".modal").width(),e=d>=c,this.collection.each(function(a){return function(b){return b.collection=a.collection}}(this)),this.rubbishBin.each(function(a){return function(b){return b.collection=a.rubbishBin}}(this)),this.collection.each(function(a){return function(c){return a.renderChild(j(c),new f({model:c}),b)}}(this)),this.rubbishBin.each(function(b){return function(c){return b.renderChild(i(c),new h({model:c}),a)}}(this)),b.sortable({placeholder:"im-view-list-placeholder",opacity:.6,cancel:"i,a,button",axis:e?null:"y",appendTo:this.el}),this.$(".im-removed-view").sortable({placeholder:"im-view-list-placeholder",connectWith:b,opacity:.6,cancel:"i,a,button",axis:e?null:"y",appendTo:this.el}),this.$(".im-rubbish-bin").droppable({accept:".im-selected-column",activeClass:"im-can-remove-column",hoverClass:"im-will-remove-column"}),this.onChangeMode()},b.prototype.removeAllChildren=function(){return this.rendered&&(this.$(".im-active-view").sortable("destroy"),this.$(".im-removed-view").sortable("destroy"),this.$(".im-rubbish-bin").droppable("destroy")),b.__super__.removeAllChildren.apply(this,arguments)},b}(d)}).call(this)},{"../../core-view":3,"../../core/collection":5,"../../mixins/handles-dom-resort":31,"../../templates":67,"./path-chooser":121,"./selected-column":123,"./unselected-column":126,underscore:310}],123:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l={}.hasOwnProperty,m=function(a,b){function c(){this.constructor=a}for(var d in b)l.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};k=a("underscore"),d=a("../../core-view"),c=a("../../core/collection"),g=a("../../templates"),e=a("../../models/path"),i=a("../../utils/events").ignore,h=function(a){return a-1},j=function(a){return a+1},f=["column-manager-path-remover","column-manager-position-controls","column-manager-path-name"],b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return m(b,a),b.prototype.Model=e,b.prototype.tagName="li",b.prototype.className="list-group-item im-selected-column",b.prototype.template=g.templateFromParts(f),b.prototype.removeTitle="columns.RemoveColumn",b.prototype.getData=function(){var a;return a=this.model===this.model.collection.last(),k.extend(b.__super__.getData.apply(this,arguments),{removeTitle:this.removeTitle,isLast:a,parts:this.parts.pluck("part")})},b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this.parts=new c,this.listenTo(this.parts,"add remove reset",this.reRender),this.resetParts(),this.listenTo(this.model.collection,"sort",this.onCollectionSorted)},b.prototype.modelEvents=function(){return{destroy:this.stopListeningTo,"change:parts":this.resetParts}},b.prototype.stateEvents=function(){return{"change:fullPath":this.setFullPathClass}},b.prototype.onCollectionSorted=function(){return this.reRender()},b.prototype.resetParts=function(){var a,b;return this.parts.reset(function(){var c,d,e,f;for(e=this.model.get("parts"),f=[],a=c=0,d=e.length;c<d;a=++c)b=e[a],f.push({part:b,id:a});return f}.call(this))},b.prototype.postRender=function(){return this.$("[title]").tooltip({container:this.$el})},b.prototype.events=function(){return{"click .im-remove-view":"removeView","click .im-move-up":"moveUp","click .im-move-down":"moveDown",click:"toggleFullPath",binned:"removeView"}},b.prototype.toggleFullPath=function(){return this.state.toggle("fullPath")},b.prototype.moveDown=function(a){var b;return i(a),b=this.model.collection.at(j(this.model.get("index"))),b.swap("index",h),this.model.swap("index",j),this.$el.insertAfter(this.$el.next())},b.prototype.moveUp=function(a){var b;return i(a),b=this.model.collection.at(h(this.model.get("index"))),b.swap("index",j),this.model.swap("index",h),this.$el.insertBefore(this.$el.prev())},b.prototype.setFullPathClass=function(){return this.$el.toggleClass("im-full-path",this.state.get("fullPath"))},b.prototype.removeView=function(a){return i(a),this.model.collection.remove(this.model),this.model.destroy()},b}(d)}).call(this)},{"../../core-view":3,"../../core/collection":5,"../../models/path":56,"../../templates":67,"../../utils/events":81,underscore:310}],124:[function(a,b,c){(function(c){(function(){var d,e,f,g,h,i,j,k,l,m={}.hasOwnProperty,n=function(a,b){function c(){this.constructor=a}for(var d in b)m.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};l=a("underscore"),f=a("../../core-view"),e=a("../../core-model"),i=a("../../templates"),g=a("../../mixins/handles-dom-resort"),d=a("./available-path"),h=a("./order-element"),j=function(a){return"active_"+a.get("id")},k=function(a){return"inactive_"+a.get("id")},b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return n(b,a),b.include(g),b.prototype.parameters=["collection","query","availableColumns"],b.prototype.className="im-sort-order-editor",b.prototype.template=i.template("column-manager-sort-order-editor"),b.prototype.getData=function(){return l.extend(b.__super__.getData.apply(this,arguments),{available:this.availableColumns.size()})},b.prototype.collectionEvents=function(){return{"add remove":this.reRender,sort:this.resortSortOrder,remove:this.makeAvailable}},b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this.dragState=new e,this.listenTo(this.availableColumns,"sort add remove",this.resortAvailable),this.listenTo(this.availableColumns,"remove",this.addToSortOrder)},b.prototype.currentSortOrder=function(){return this.collection.map(function(a){return a.get("path")+" "+a.get("direction")}).join(" ")},b.prototype.postRender=function(){return this.resortSortOrder(),this.activateSortables(),this.resortAvailable(),this.setAvailableHeight()},b.prototype.activateSortables=function(){var a,b,c,d;return a=this.$(".im-active-oes"),b=900,c=this.$el.closest(".modal").width(),d=c>=b,this.collection.size()?this.$actives=a.sortable({placeholder:"im-view-list-placeholder",opacity:.6,cancel:"i,a,button",axis:d?null:"y",appendTo:this.el}):this.$droppable=this.$(".im-empty-collection").droppable({accept:".im-selected-column",activeClass:"im-can-add-column",hoverClass:"im-will-add-column"})},b.prototype.removeAllChildren=function(){var a,c;return null!=(a=this.$actives)&&a.sortable("destroy"),null!=(c=this.$droppable)&&c.droppable("destroy"),this.$droppable=null,this.$actives=null,b.__super__.removeAllChildren.apply(this,arguments)},b.prototype.events=function(){return{"drop .im-empty-collection":"addSortElement","sortupdate .im-active-oes":"onDOMResort"}},b.prototype.onDOMResort=function(a,b){var c,d,e;return(e=this.dragState.get("dragged"))?(d=this.availableColumns.findWhere({path:e}),c=b.item.prevAll().length,this.addToSortOrder(d,c),this.dragState.unset("dragged")):this.setChildIndices(j)},b.prototype.makeAvailable=function(a){return this.availableColumns.add(this.query.makePath(a.get("path")))},b.prototype.findAvailable=function(a){return this.availableColumns.find(function(b){return function(c){var d;return(null!=(d=b.children[k(c)])?d.el:void 0)===a}}(this))},b.prototype.addSortElement=function(a,b){var c,d;return c=b.draggable,d=this.findAvailable(c[0]),this.addToSortOrder(d)},b.prototype.addToSortOrder=function(a,b){var c,d,e,f,g,h,i,j;if(f=this.query.makePath(a.get("path")),e={id:String(f),path:f},g=this.collection.size(),a.destroy(),this.collection.add(e),null!=b&&b<g){for(h=this.collection.filter(function(a){return a.get("index")>=b}),c=this.collection.last(),i=0,j=h.length;i<j;i++)d=h[i],d.swap("index",function(a){return a+1});return c.set({index:b})}},b.prototype.resortAvailable=function(){var a;if(this.rendered)return a=c.document.createDocumentFragment(),this.availableColumns.each(function(b){return function(c){return b._renderAvailable(c,a)}}(this)),this.$(".im-available-oes").html(a)},b.prototype._renderAvailable=function(a,b){var c,e,f;return e=k(a),c=function(a){return function(){return a.$actives}}(this),f=new d({model:a,findActives:c,state:this.dragState}),this.renderChild(e,f,b)},b.prototype.resortSortOrder=function(){var a;if(this.rendered)return a=c.document.createDocumentFragment(),this.collection.each(function(b){return function(c){return b.renderChild(j(c),new h({model:c}),a)}}(this)),this.$(".im-active-oes").html(a)},b.prototype.setAvailableHeight=function(){return this.$(".im-rubbish-bin").css({"max-height":Math.max(200,this.$el.closest(".modal").height()-450)})},b.prototype.remove=function(){return this.dragState.destroy(),b.__super__.remove.apply(this,arguments)},b}(f)}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../core-model":2,"../../core-view":3,"../../mixins/handles-dom-resort":31,"../../templates":67,"./available-path":118,"./order-element":120,underscore:310}],125:[function(a,b,c){(function(){var c,d,e,f,g,h={}.hasOwnProperty,i=function(a,b){function c(){this.constructor=a}for(var d in b)h.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};g=a("underscore"),d=a("../../core-view"),e=a("../../templates"),c=a("../../utils/css-class-set"),f=function(a,b){var d;return d={active:function(){return b.get("currentTab")===a}},d["im-"+a+"-tab"]=!0,new c(d)},b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return i(b,a),b.TABS=["view","sortorder"],b.prototype.template=e.template("column-manager-tabs"),b.prototype.className="im-column-manager-tabs",b.prototype.getData=function(){return g.extend(b.__super__.getData.apply(this,arguments),{classes:this.classSets})},b.prototype.initState=function(){return this.state.set({currentTab:b.TABS[0]})},b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this.initClassSets()},b.prototype.stateEvents=function(){return{"change:currentTab":this.reRender}},b.prototype.events=function(){return{"click .im-view-tab":"selectViewTab","click .im-sortorder-tab":"selectSortOrderTab"}},b.prototype.selectViewTab=function(){return this.state.set({currentTab:"view"})},b.prototype.selectSortOrderTab=function(){return this.state.set({currentTab:"sortorder"})},b.prototype.initClassSets=function(){var a,b,c,d,e;for(this.classSets={},d=["view","sortorder"],e=[],b=0,c=d.length;b<c;b++)a=d[b],e.push(function(a){return function(b){return a.classSets[b]=f(b,a.state)}}(this)(a));return e},b}(d)}).call(this)},{"../../core-view":3,"../../templates":67,"../../utils/css-class-set":79,underscore:310}],126:[function(a,b,c){(function(){var c,d,e,f,g={}.hasOwnProperty,h=function(a,b){function c(){this.constructor=a}for(var d in b)g.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};f=a("underscore"),c=a("./selected-column"),e=a("../../templates"),d=["column-manager-path-name","column-manager-restore-path"],b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return h(b,a),b.prototype.template=e.templateFromParts(d),b.prototype.events=function(){return{"click .im-restore-view":"removeView",click:"toggleFullPath"}},b.prototype.restoreTitle="columns.RestoreColumn",b.prototype.getData=function(){return f.extend(b.__super__.getData.apply(this,arguments),{restoreTitle:this.restoreTitle})},b}(c)}).call(this)},{"../../templates":67,"./selected-column":123,underscore:310}],127:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l,m=[].slice,n={}.hasOwnProperty,o=function(a,b){function c(){this.constructor=a}for(var d in b)n.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};l=a("underscore"),f=a("es6-promise").Promise,h=a("../core-view"),e=a("../options"),g=a("../templates"),c=a("../mixins/has-typeaheads"),d=a("../patterns").IS_BLANK,j=a("../utils/path-suggester"),i=a("../utils/path-suggestions"),k=function(a){var b,c,d,e,f;return b=a.split(" > "),b.length>3?(4<=b.length?m.call(b,0,f=b.length-3):(f=0,[]),c=b[f++],d=b[f++],e=b[f++],"..."+c+" > "+d+" > "+e):a},b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return o(b,a),b.include(c),b.prototype.className="row",b.prototype.initialize=function(a){return this.query=a.query,this.openNodes=a.openNodes,this.chosenPaths=a.chosenPaths,b.__super__.initialize.apply(this,arguments),this.state.set({chosen:[]}),this.listenTo(this.openNodes,"add remove reset",this.reRender),this.listenTo(this.chosenPaths,"add remove reset",this.reRender),this.listenTo(this.chosenPaths,"add remove reset",this.setChosen),this.setChosen(),this.generatePathSuggestions()},b.prototype.modelEvents=function(){return{destroy:this.stopListeningTo,"change:showTree change:allowRevRefs":this.reRender}},b.prototype.stateEvents=function(){return{"change:chosen change:suggestions":this.reRender}},b.prototype.pathAcceptable=function(a){var b;return"id"!==(null!=(b=a.end)?b.name:void 0)&&(!!this.model.get("canSelectReferences")||a.isAttribute())},b.prototype.generatePathSuggestions=function(){var a;return a=e.get("SuggestionDepth"),i(this.query,a).then(function(a){return function(b){return a.state.set({suggestions:b.filter(function(b){return a.pathAcceptable(b.path)})})}}(this))},b.prototype.getData=function(){var a,c;return c=this.openNodes.size(),a=this.chosenPaths.size(),l.extend({anyNodesOpen:c,anyNodeChosen:a},this.state.toJSON(),b.__super__.getData.apply(this,arguments))},b.prototype.template=g.template("constraint_adder_options"),b.prototype.render=function(){return b.__super__.render.apply(this,arguments),this.state.has("suggestions")&&this.installTypeahead(),this},b.prototype.installTypeahead=function(){var a,b,c,d,e;return this.removeTypeAheads(),b=this.$(".im-tree-filter"),e=this.state.get("suggestions"),d=j(e),c={minLength:3,highlight:!0},a={name:"path_suggestions",source:d,displayKey:"name"},this.activateTypeahead(b,c,a,e[0].name,function(a){return function(b,c){var d;return d=c.path,a.openNodes.add(d),a.model.get("multiSelect")?a.chosenPaths.add(d):a.chosenPaths.reset([d])}}(this))},b.prototype.events=function(){return{"click .im-collapser":"collapseBranches","change .im-allow-rev-ref":"toggleReverseRefs","change .im-tree-filter":"setFilter","click .im-choose":"toggleShowTree","click .im-approve":"triggerApproval","click .im-clear-filter":"clearFilter"}},b.prototype.triggerApproval=function(){return this.model.trigger("approved")},b.prototype.remove=function(){return this.removeTypeAheads(),b.__super__.remove.apply(this,arguments)},b.prototype.clearFilter=function(){return this.model.set({filter:null}),this.reRender()},b.prototype.setFilter=function(a){var b;return b=a.target.value,this.model.set({filter:d.test(b)?null:b})},b.prototype.collapseBranches=function(){return this.openNodes.reset()},b.prototype.toggleShowTree=function(){return this.model.toggle("showTree")},b.prototype.toggleReverseRefs=function(){return this.model.toggle("allowRevRefs")},b.prototype.setConstraint=function(){return this.model.trigger("approved")},b.prototype.setChosen=function(){var a,b,c;return c=this.chosenPaths.toJSON(),a=f.all(function(){var a,d,e;for(e=[],a=0,d=c.length;a<d;a++)b=c[a],e.push(b.getDisplayName());return e}()),a.then(function(a){var b,c,d,e;for(e=[],c=0,d=a.length;c<d;c++)b=a[c],e.push(k(b));return e}).then(function(a){return function(b){return a.state.set({chosen:b})}}(this),function(a){return console.error(a)})},b}(h)}).call(this)},{"../core-view":3,"../mixins/has-typeaheads":32,"../options":63,"../patterns":64,"../templates":67,"../utils/path-suggester":96,"../utils/path-suggestions":97,"es6-promise":257,underscore:310}],128:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l,m,n={}.hasOwnProperty,o=function(a,b){function c(){this.constructor=a}for(var d in b)n.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},p=function(a,b){return function(){return a.apply(b,arguments)}};a("underscore"),f=a("../messages"),l=a("../templates"),m=a("../core-view"),e=a("../core-model"),k=a("../models/path-set"),i=a("../models/open-nodes"),d=a("./constraint-adder-options"),g=a("./new-constraint"),j=a("./path-chooser"),f.set({"constraints.BrowseForColumn":"Browse for Column","constraints.AddANewFilter":"Add a new filter","constraints.Choose":"Choose","constraints.Filter":"Filter","columns.CollapseAll":"Collapse columns","columns.AllowRevRef":"Allow reverse references"}),c=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return o(b,a),b.prototype.defaults=function(){return{filter:null,showTree:!0,allowRevRefs:!1,canSelectReferences:!0,multiSelect:!1}},b}(e),h=".im-constraint-adder-options",b.exports=function(a){function b(){return this.showTree=p(this.showTree,this),b.__super__.constructor.apply(this,arguments)}return o(b,a),b.prototype.tagName="div",b.prototype.className="im-constraint-adder row-fluid",b.prototype.Model=c,b.prototype.initialize=function(a){var c;return this.query=a.query,this.buttonDelegate=a.buttonDelegate,b.__super__.initialize.apply(this,arguments),this.model.set({root:this.query.getPathInfo(this.query.root)}),this.chosenPaths=new k,this.view=new k(function(){var a,b,d,e;for(d=this.query.views,e=[],a=0,b=d.length;a<b;a++)c=d[a],e.push(this.query.makePath(c));return e}.call(this)),this.openNodes=new i(this.query.getViewNodes()),this.listenTo(this.query,"change:constraints",this.remove)},b.prototype.modelEvents=function(){return{approved:this.handleApproval,"change:showTree":this.toggleTree,"change:constraint":this.onChangeConstraint}},b.prototype.getTreeRoot=function(){return this.model.get("root")},b.prototype.handleApproval=function(){var a,b,c,d;return a=this.chosenPaths.toJSON()[0],null!=a?(c=this.model.get("constraint"),d=a.toString(),(null!=c?c.path:void 0)!==d?(b={path:d},this.model.set({constraint:b}),this.query.trigger("editing-constraint",b)):this.onChangeConstraint()):(console.debug("nothing chosen"),this.model.unset("constraint"))},b.prototype.renderConstraintEditor=function(){var a,b;return a=this.model.get("constraint"),b=new g({buttonDelegate:this.buttonDelegate,query:this.query,constraint:a}),this.renderChild("con",b,this.$(".im-new-constraint")),this.listenTo(b,"remove",function(){return this.model.set({showTree:!0})})},b.prototype.onChangeConstraint=function(){if(this.rendered)return this.model.get("constraint")?(this.model.set({showTree:!1}),this.renderConstraintEditor()):this.removeChild("con")},b.prototype.toggleTree=function(){return this.model.get("showTree")?this.showTree():this.hideTree()},b.prototype.hideTree=function(){return this.trigger("resetting:tree"),this.$(".im-path-finder").removeClass("open"),this.removeChild("tree")},b.prototype.showTree=function(a){var b;return this.trigger("showing:tree"),this.removeChild("con"),b=new j({model:this.model,query:this.query,chosenPaths:this.chosenPaths,openNodes:this.openNodes,view:this.view,trail:[]}),this.$(".im-path-finder").addClass("open"),this.renderChild("tree",b,this.$(".im-path-finder"))},b.prototype.template=l.template("constraint_adder"),b.prototype.renderOptions=function(){var a;return a={model:this.model,openNodes:this.openNodes,chosenPaths:this.chosenPaths,query:this.query},this.renderChild("opts",new d(a),this.$(h))},b.prototype.postRender=function(){return this.renderOptions(),this.toggleTree()},b}(m)}).call(this)},{"../core-model":2,"../core-view":3,"../messages":16,"../models/open-nodes":52,"../models/path-set":55,"../templates":67,"./constraint-adder-options":127,"./new-constraint":199,"./path-chooser":201,underscore:310}],129:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B=[].indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(b in this&&this[b]===a)return b;return-1},C={}.hasOwnProperty,D=function(a,b){function c(){this.constructor=a}for(var d in b)C.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};z=a("underscore"),p=a("../messages"),j=a("../icons"),h=a("../core-view"),w=a("./type-value-controls"),e=a("./attribute-value-controls"),r=a("./multi-value-controls"),g=a("./boolean-value-controls"),m=a("./lookup-value-controls"),n=a("./loop-value-controls"),l=a("./list-value-controls"),i=a("./error-message"),A=a("imjs"),t=A.Query,q=A.Model,u=t.REFERENCE_OPS,k=t.LIST_OPS,o=t.MULTIVALUE_OPS,s=t.NULL_OPS,c=t.ATTRIBUTE_OPS,d=t.ATTRIBUTE_VALUE_OPS,q.NUMERIC_TYPES,f=q.BOOLEAN_TYPES,d.concat(s),x='<fieldset class="im-constraint-options form-group row">\n  <label class="col-sm-3 path-label"><%- data.con.displayName %></label>\n  <% if (data.con.op) { %>\n    <div class="im-operator col-sm-3">\n        <select class="form-control im-ops">\n        <option selected><%- data.con.op %></option>\n        <% data.otherOperators.forEach(function (op) { %>\n            <option><%- op %></option>\n        <% }); %>\n        </select>\n    </div>\n  <% } %>\n  <div class="col-sm-6 im-value-options im-value-section">\n  </div>\n</fieldset>\n\n<div class="btn-group im-con-buttons">\n  <% data.buttons.forEach(function (b, i) { %>\n  <button class="btn btn-<%= (i === 0) ? \'primary\' : \'default\' %> <%- b.classes %>">\n    <%- data.messages.getText(b.key) %>\n  </button>\n  <% }); %>\n</div>\n',v=z.template(x,{variable:"data"}),y=function(a){var b,d;if(b=a.path,!(null!=b?b.isReference:void 0))throw new Error("No path or wrong type");return b.isRoot()&&u.concat(t.RANGE_OPS),b.isReference()?u.concat(t.RANGE_OPS).concat(a.new?["ISA"]:[]):(d=b.getType(),B.call(f,d)>=0?["=","!="].concat(s):c)},b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return D(b,a),b.prototype.tagName="div",b.prototype.className="form",b.prototype.parameters=["query","model"],b.prototype.optionalParameters=["buttonDelegate"],b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this.path=this.model.get("path")},b.prototype.invariants=function(){return{modelHasPath:"No path found on model"}},b.prototype.modelHasPath=function(){return this.model.get("path")},b.prototype.getType=function(){return this.model.get("path").getType()},b.prototype.modelEvents=function(){return{"change:op change:displayName":this.reRender,destroy:this.stopListening}},b.prototype.events=function(){return{submit:function(a){return a.preventDefault(),a.stopPropagation()},"click .btn-cancel":"cancelEditing","click .btn-primary":"applyChanges","change .im-ops":"setOperator"}},b.prototype.delegateButtonEvents=function(){return this.buttonDelegate.off("click.constraint-editor"),this.buttonDelegate.on("click.constraint-editor",".btn-cancel",function(a){return function(){return a.cancelEditing()}}(this)),this.buttonDelegate.on("click.constraint-editor",".btn-primary",function(a){return function(){return a.applyChanges()}}(this))},b.prototype.setOperator=function(){return this.model.set({op:this.$(".im-ops").val()})},b.prototype.cancelEditing=function(){return this.model.trigger("cancel")},b.prototype.applyChanges=function(a){return null!=a&&a.preventDefault(),null!=a&&a.stopPropagation(),this.model.trigger("apply",this.getConstraint())},b.prototype.getConstraint=function(){var a,b,c;return a=this.model.pick(["path","op","value","values","code","type"]),b=a.op,B.call(o.concat(s),b)>=0&&delete a.value,c=a.op,B.call(d.concat(s),c)>=0&&delete a.values,"ISA"===a.op&&delete a.op,a},b.prototype.getValueControls=function(){return null==this.path?null:this.isNullConstraint()?null:this.isTypeConstraint()?new w({model:this.model,query:this.query}):this.isMultiValueConstraint()?new r({model:this.model,query:this.query}):this.isListConstraint()?new l({model:this.model,query:this.query}):this.isBooleanConstraint()?new g({model:this.model,query:this.query}):this.isLoopConstraint()?new n({model:this.model,query:this.query}):this.isLookupConstraint()?new m({model:this.model,query:this.query}):this.isRangeConstraint()?new r({model:this.model,query:this.query}):this.path.isAttribute()?new e({model:this.model,query:this.query}):(this.model.set({error:new Error("cannot handle this constaint type")}),null)},b.prototype.isNullConstraint=function(){var a;return a=this.model.get("op"),B.call(s,a)>=0},b.prototype.isLoopConstraint=function(){var a;return this.path.isClass()&&("="===(a=this.model.get("op"))||"!="===a)},b.prototype.isTypeConstraint=function(){return this.path.isReference()&&(!this.model.get("op")||"ISA"===this.model.get("op"))},b.prototype.isBooleanConstraint=function(){var a,b;return a=this.path.getType(),B.call(f,a)>=0&&(b=this.model.get("op"),!(B.call(s,b)>=0))},b.prototype.isMultiValueConstraint=function(){var a;return this.path.isAttribute()&&(a=this.model.get("op"),B.call(o,a)>=0)},b.prototype.isListConstraint=function(){var a;return this.path.isClass()&&(a=this.model.get("op"),B.call(k,a)>=0)},b.prototype.isLookupConstraint=function(){var a;return this.path.isClass()&&(a=this.model.get("op"),B.call(t.TERNARY_OPS,a)>=0)},b.prototype.isRangeConstraint=function(){var a;return this.path.isReference()&&(a=this.model.get("op"),B.call(t.RANGE_OPS,a)>=0)},b.prototype.getOtherOperators=function(){return z.without(y(this.model.pick("new","path")),this.model.get("op"))},b.prototype.buttons=function(){var a;return null!=this.buttonDelegate?[]:(a=[{key:"conbuilder.Update",classes:"im-update"},{key:"conbuilder.Cancel",classes:"btn-cancel"}],this.model.get("new")?(a[0].key="conbuilder.Add",a[1].classes="im-remove-constraint"):a.push({key:"conbuilder.Remove",classes:"btn btn-default im-remove-constraint"}),a)},b.prototype.getData=function(){var a,b,c,d,e;return a=this.buttons(),d=p,c=j,e=this.getOtherOperators(),b=this.model.toJSON(),{buttons:a,icons:c,messages:d,icons:c,otherOperators:e,con:b}},b.prototype.template=v,b.prototype.render=function(){return b.__super__.render.apply(this,arguments),this.renderChild("valuecontrols",this.getValueControls(),this.$(".im-value-options")),
this.renderChild("error",new i({model:this.model})),null!=this.buttonDelegate&&this.delegateButtonEvents(),this},b.prototype.remove=function(){var a;return null!=(a=this.buttonDelegate)&&a.off("click.constraint-editor"),this.$el.slideUp({always:function(a){return function(){return b.__super__.remove.call(a)}}(this)})},b}(h)}).call(this)},{"../core-view":3,"../icons":14,"../messages":16,"./attribute-value-controls":113,"./boolean-value-controls":114,"./error-message":137,"./list-value-controls":193,"./lookup-value-controls":194,"./loop-value-controls":195,"./multi-value-controls":198,"./type-value-controls":228,imjs:271,underscore:310}],130:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j={}.hasOwnProperty,k=function(a,b){function c(){this.constructor=a}for(var d in b)j.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},l=[].indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(b in this&&this[b]===a)return b;return-1},m=[].slice;h=a("underscore"),e=a("../messages"),g=a("../templates"),c=a("../core-view"),d=a("../patterns").IS_BLANK,i=a("imjs"),f=i.Query,i.Model,e.set({"consummary.IsA":"is a","consummary.NoValue":"no value"}),b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return k(b,a),b.prototype.tagName="ol",b.prototype.className="constraint-summary breadcrumb",b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this.listenTo(e,"change",this.reRender)},b.prototype.getData=function(){return h.extend(b.__super__.getData.apply(this,arguments),{labels:this.getSummary()})},b.prototype.template=g.template("constraint-summary"),b.prototype.getTitleOp=function(){return this.model.get("op")||e.getText("consummary.IsA")},b.prototype.modelEvents=function(){return{change:this.reRender}},b.prototype.events=function(){return{"click .label-path":function(){return this.state.toggle("showFullPath")}}},b.prototype.stateEvents=function(){return{"change:showFullPath":this.toggleFullPath}},b.prototype.toggleFullPath=function(){return this.$(".label-path").toggleClass("im-show-full-path",!!this.state.get("showFullPath"))},b.prototype.postRender=function(){return this.toggleFullPath()},b.prototype.getTitleVal=function(){var a,b,c,d,e,g;return this.model.has("values")&&(e=this.model.get("op"),l.call(f.MULTIVALUE_OPS.concat(f.RANGE_OPS),e)>=0)?(c=this.model.get("values"))?1===c.length?c[0]:0===c.length?"[ ]":c.length>5?c.length+" values":(a=2<=c.length?m.call(c,0,d=c.length-1):(d=0,[]),b=c[d++],a.join(", ")+" and "+b):void 0:this.model.has("value")?this.model.get("value"):null!=(g=this.model.get("typeName"))?g:this.model.get("type")},b.prototype.isLookup=function(){return"LOOKUP"===this.model.get("op")},b.prototype.getPathLabel=function(){var a,b,c,d,e;return d=this.model.toJSON(),c=d.title,a=d.displayName,b=d.path,{content:String(null!=(e=null!=c?c:a)?e:b),type:"path"}},b.prototype.getSummary=function(){var a,b,c,e,g;return a=[],a.push(this.getPathLabel()),(c=this.getTitleOp())&&a.push({content:c,type:"op"}),g=this.model.get("op"),l.call(f.NULL_OPS,g)<0&&(e=this.getTitleVal(),null==e||d.test(e)?(b=this.model.get("new")?"warning":"error",a.push({content:"NoValue",type:b})):a.push({content:e,type:"value"}),this.isLookup()&&this.model.has("extraValue")&&a.push({content:this.model.get("extraValue"),type:"extra",icon:"ExtraValue"})),a},b}(c)}).call(this)},{"../core-view":3,"../messages":16,"../patterns":64,"../templates":67,imjs:271,underscore:310}],131:[function(a,b,c){(function(){var c,d,e,f,g,h={}.hasOwnProperty,i=function(a,b){function c(){this.constructor=a}for(var d in b)h.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};g=a("underscore"),e=a("../core-view"),f=a("../templates"),d=a("./constraint-adder"),c=a("./active-constraint"),a("../messages/constraints"),b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return i(b,a),b.prototype.className="im-constraints",b.prototype.initialize=function(a){return this.query=a.query,b.__super__.initialize.apply(this,arguments),this.listenTo(this.query,"change:constraints",this.reRender)},b.prototype.getData=function(){return g.extend(b.__super__.getData.apply(this,arguments),{constraints:this.getConstraints()})},b.prototype.events=function(){return{click:function(a){return null!=a?a.stopPropagation():void 0}}},b.prototype.template=f.templateFromParts(["constraints-heading","active-constraints"]),b.prototype.postRender=function(){var a,b,d,e,f,g;for(b=this.$(".im-active-constraints"),g=this.getConstraints(),d=e=0,f=g.length;e<f;d=++e)a=g[d],this.renderChild("con_"+d,new c({query:this.query,constraint:a}),b);return this.renderChild("conAdder",this.getConAdder())},b.prototype.getConstraints=function(){return this.query.constraints.slice()},b.prototype.getConAdder=function(){return new d({query:this.query})},b}(e)}).call(this)},{"../core-view":3,"../messages/constraints":21,"../templates":67,"./active-constraint":112,"./constraint-adder":128,underscore:310}],132:[function(a,b,c){(function(){var c,d,e,f,g={}.hasOwnProperty,h=function(a,b){function c(){this.constructor=a}for(var d in b)g.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};f=a("underscore"),c=a("../../core-view"),d=a("../../messages"),e=a("../../models/path"),a("../../messages/constraints"),b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return h(b,a),b.prototype.Model=e,b.prototype.tagName="button",b.prototype.className="btn btn-primary im-add-constraint",b.prototype.optionalParameters=["hideType"],b.prototype.hideType=!1,b.prototype.template=function(a){return f.escape(d.getText("constraints.AddConFor",a))},b.prototype.getData=function(){return f.extend(b.__super__.getData.apply(this,arguments),{hideType:this.hideType})},b.prototype.modelEvents=function(){return{change:this.reRender}},b.prototype.events=function(){return{click:function(){return this.trigger("chosen",this.model.get("path"))}}},b}(c)}).call(this)},{"../../core-view":3,"../../messages":16,"../../messages/constraints":21,"../../models/path":56,underscore:310}],133:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l={}.hasOwnProperty,m=function(a,b){function c(){this.constructor=a}for(var d in b)l.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},n=[].slice;k=a("underscore"),e=a("../../core-view"),i=a("../../models/path"),a("../../templates"),a("../../messages"),d=a("../constraint-adder"),c=a("./column-adder-button"),a("../../messages/constraints"),g=".im-constraint-adder-options",f=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return m(b,a),b.prototype.className="btn-group",b.prototype.parameters=["main","options"],b.prototype.initState=function(){return this.state.set({open:!1})},b.prototype.stateEvents=function(){return{"change:open":this.toggleOpen}},b.prototype.toggleOpen=function(){return this.$el.toggleClass("open",this.state.get("open"))},b.prototype.ICONS="NONE",b.prototype.postRender=function(){var a,b,c,d,e,f;for(this.toggleOpen(),this.renderChild("main",this.main),this.renderChild("toggle",new j({state:this.state})),c=document.createElement("ul"),c.className="dropdown-menu",f=this.options,a=d=0,e=f.length;d<e;a=++d)b=f[a],this.renderChild(a,b,c);return this.$el.append(c)},b}(e),j=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return m(b,a),b.prototype.tagName="button",b.prototype.className="btn btn-primary dropdown-toggle",b.prototype.ICONS="NONE",b.prototype.template=k.template('<span class="caret"></span>\n<span class="sr-only"><%- Messages.getText(\'constraints.OtherPaths\') %></span>'),b.prototype.events=function(){return{click:function(){return this.state.toggle("open")}}},b}(e),h=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return m(b,a),b.prototype.tagName="li",b.prototype.className="",b.prototype.template=function(){return"<a>"+b.__super__.template.apply(this,arguments)+"</a>"},b}(c),b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return m(b,a),b.prototype.parameters=["query","paths"],b.prototype.onChosen=function(a){return this.model.set({constraint:{path:a}})},b.prototype.renderOptions=function(){},b.prototype.showTree=function(){var a,b,d,e,j,k,l,m,o,p,q;for(p=this.paths,j=p[0],l=2<=p.length?n.call(p,1):[],d=new c({hideType:!0,model:new i(j)}),e=function(){var a,b,c;for(c=[],a=0,b=l.length;a<b;a++)k=l[a],c.push(new h({hideType:!0,model:new i(k)}));return c}(),b=new f({main:d,options:e}),q=[d].concat(n.call(e)),m=0,o=q.length;m<o;m++)a=q[m],this.listenTo(a,"chosen",this.onChosen);return this.renderChild("tree",b,this.$(g))},b}(d)}).call(this)},{"../../core-view":3,"../../messages":16,"../../messages/constraints":21,"../../models/path":56,"../../templates":67,"../constraint-adder":128,"./column-adder-button":132,underscore:310}],134:[function(a,b,c){(function(){var c,d,e,f,g={}.hasOwnProperty,h=function(a,b){function c(){this.constructor=a}for(var d in b)g.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};a("underscore"),a("../../core-view"),f=a("../../models/path"),a("../../templates"),a("../../messages"),d=a("../constraint-adder"),c=a("./column-adder-button"),a("../../messages/constraints"),e=".im-constraint-adder-options",b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return h(b,a),b.prototype.parameters=["query","path"],b.prototype.initialize=function(){var a;return b.__super__.initialize.apply(this,arguments),a={path:this.path},this.model.set({constraint:a})},b.prototype.events=function(){return{"click .im-add-constraint":this.act}},b.prototype.act=function(){return this.hideTree(),this.renderConstraintEditor()},b.prototype.renderOptions=function(){},b.prototype.showTree=function(){var a;return a=new f(this.query.makePath(this.path)),new c({model:a}),this.renderChild("tree",new c({model:a}),this.$(e))},b}(d)}).call(this)},{"../../core-view":3,"../../messages":16,"../../messages/constraints":21,"../../models/path":56,"../../templates":67,"../constraint-adder":128,"./column-adder-button":132,underscore:310}],135:[function(a,b,c){(function(){var c,d,e,f={}.hasOwnProperty,g=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};d=a("../constraints"),e=a("./single-column-adder"),c=a("./composed-column-adder"),b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return g(b,a),b.prototype.getConAdder=function(){var a,b,d,f,g;if(this.shouldShowAdder())return g=this.model.attributes,f=g.replaces,a=g.isComposed,b=g.outerJoined,d=this.model.pathInfo(),a&&f.length>1?new c({query:this.query,paths:f}):b?new c({query:this.query,paths:[d].concat(f)}):new e({query:this.query,path:d})},b.prototype.shouldShowAdder=function(){var a,b,c,d;return d=this.model.attributes,b=d.numeric,a=d.isComposed,c=d.outerJoined,b||a||c||!this.getConstraints().length},b.prototype.getConstraints=function(){var a,b,c,d,e,f;for(b=this.model.get("path"),e=this.query.constraints,f=[],c=0,d=e.length;c<d;c++)a=e[c],a.path.match(b)&&f.push(a);return f},b}(d)}).call(this)},{"../constraints":131,"./composed-column-adder":133,"./single-column-adder":134}],136:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l,m,n,o={}.hasOwnProperty,p=function(a,b){function c(){this.constructor=a}for(var d in b)o.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};n=a("underscore"),f=a("../core-view"),h=a("../models/history"),l=a("../models/table"),j=a("../models/selected-objects"),c=a("../utils/events").Bus,e=a("../utils/children"),m=a("../core/type-assertions"),k=a("./table"),i=a("./query-tools"),g="Bad arguments to Dashboard - {query :: imjs.Query} is required",d="consumerContainer provided as selector - but no matching element was found",b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return p(b,a),b.prototype.tagName="div",b.prototype.className="imtables-dashboard container-fluid",b.prototype.Model=l,b.prototype.optionalParameters=["consumerContainer","consumerBtnClass"],b.prototype.initialize=function(a){var e;if(e=a.query,!m.Query.test(e)&&null==e)throw new Error(g);if(b.__super__.initialize.apply(this,arguments),this.history=new h,this.bus=new c,this.history.setInitialState(e),this.selectedObjects=new j(e.service),null!=this.consumerContainer&&n.isString(this.consumerContainer)&&(this.consumerContainer=document.querySelector(this.consumerContainer),!this.consumerContainer))return console.log(d)},b.prototype.renderChildren=function(){return this.renderQueryTools(),this.renderTable()},b.prototype.renderTable=function(){var a;return a=e.createChild(this,k),this.renderChild("table",a)},b.prototype.renderQueryTools=function(){var a;return a=e.createChild(this,i,{tableState:this.model}),this.renderChild("tools",a)},b.prototype.remove=function(){return this.bus.destroy(),this.history.close(),b.__super__.remove.apply(this,arguments)},b}(f)}).call(this)},{"../core-view":3,"../core/type-assertions":10,"../models/history":45,"../models/selected-objects":58,"../models/table":61,"../utils/children":76,"../utils/events":81,"./query-tools":208,"./table":209,underscore:310}],137:[function(a,b,c){(function(){var c,d,e,f={}.hasOwnProperty,g=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};a("underscore"),a("fs"),c=a("../core-view"),d=a("../icons"),e=a("../templates"),b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return g(b,a),b.prototype.className="im-error-message",b.prototype.modelEvents=function(){return{"change:error":this.reRender}},b.prototype.getData=function(){return{icons:d,error:this.model.get("error")}},b.prototype.logError=function(){var a;if(a=this.model.get("error"))return console.error(a,a.stack)},b.prototype.template=e.template("error-message"),b}(c)}).call(this)},{"../core-view":3,"../icons":14,"../templates":67,fs:252,underscore:310}],138:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D={}.hasOwnProperty,E=function(a,b){function c(){this.constructor=a}for(var d in b)D.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},F=function(a,b){return function(){return a.apply(b,arguments)}};C=a("underscore"),a("jquery"),q=a("../core-model"),p=a("./modal"),a("./constraint-adder"),o=a("../messages"),v=a("../templates"),r=a("../options"),k=a("../models/export-formats"),u=a("../mixins/runs-query"),n=a("./export-dialogue/tab-menu"),j=a("./export-dialogue/format-controls"),t=a("./export-dialogue/row-controls"),c=a("./export-dialogue/column-controls"),d=a("./export-dialogue/compression-controls"),i=a("./export-dialogue/flat-file-options"),m=a("./export-dialogue/json-options"),h=a("./export-dialogue/fasta-options"),e=a("./export-dialogue/destination-options"),s=a("./export-dialogue/preview"),a("../utils/open-window-with-post"),y=a("../utils/send-to-dropbox"),B=a("../utils/send-to-google-drive"),z=a("../utils/send-to-galaxy"),A=a("../utils/send-to-genomespace"),l={doneness:null,tab:"dest",dest:"download",linkToFile:null},g=["progress_bar","modal_error","export_dialogue_footer"],w=function(){function a(a){this.key="export.error."+a,this.message=o.get(this.key)}return a.prototype.cannotDismiss=!0,a}(),f=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return E(b,a),b.prototype.defaults=function(){return{filename:"results",format:k.getFormat("tab"),tablePage:null,start:0,columns:[],size:null,max:null,compress:!1,compression:"gzip",headers:!1,jsonFormat:"rows",fastaExtension:null,headerType:"friendly"}},b}(q),x=function(a){return function(b){return b.isa(a)}},b.exports=function(a){function b(){return this.onUploadError=F(this.onUploadError,this),this.onUploadProgress=F(this.onUploadProgress,this),this.onUploadComplete=F(this.onUploadComplete,this),b.__super__.constructor.apply(this,arguments)}return E(b,a),b.include(u),b.prototype.Model=f,b.prototype.className=function(){return"im-export-dialogue "+b.__super__.className.apply(this,arguments)},b.prototype.parameters=["query"],b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this.model.has("format")&&!this.model.get("format").ext&&this.model.set({format:k.getFormat(this.model.get("format"))}),this.state.set(l),this.listenTo(this.state,"change:tab",this.renderMain),this.listenTo(this.model,"change",this.updateState),this.listenTo(this.model,"change:columns",this.setMax),this.listenTo(this.model,"change:format",this.onChangeFormat),this.categoriseQuery(),this.model.set({columns:this.query.views}),null!=this.query.name&&this.model.set({filename:this.query.name.replace(/\s+/g,"_")}),this.updateState(),this.setMax(),this.readUserPreferences()},b.prototype.onChangeFormat=function(){return C.defer(function(a){return function(){var b,c,d,e,f,g,h,i,j,k,l,m,n;if(d=a.model.get("format"),b=a.model.get("columns"),null!=(m=d.needs)?m.length:void 0){for(h=b.slice(),f=[],n=a.query.views,k=0,l=n.length;k<l;k++)j=n[k],i=a.query.makePath(j).getParent(),C.any(d.needs,function(a){return i.isa(a)})&&f.push(i.append("id").toString());return g=C.uniq(f),a.model.set({nodecolumns:g}),e=d.maxColumns,c=e?C.first(g,e):g.slice(),a.model.set({columns:c}),a.model.once("change:format",function(){return a.model.set({columns:h}),a.model.unset("nodecolumns")})}}}(this))},b.prototype.readUserPreferences=function(){return this.query.service.whoami().then(function(a){return function(a){var b;if(a.hasPreferences)return(b=a.preferences["galaxy-url"])?r.set("Destination.Galaxy.Current",b):void 0}}())},b.prototype.setMax=function(){return this.getEstimatedSize().then(function(a){return function(b){return a.model.set({max:b})}}(this))},b.prototype.categoriseQuery=function(){var a,b,c,d;c=this.query.getViewNodes(),a={},d=this.query.model.classes;for(b in d)d[b],a[b]=C.any(c,x(b));return this.model.set({has:a})},b.prototype.title=function(){return o.getText("ExportTitle",{name:this.query.name})},b.prototype.modalSize="lg",b.prototype.primaryAction=function(){return o.getText(this.state.get("dest"))},b.prototype.primaryIcon=function(){return this.state.get("dest")},b.prototype.body=v.template("export_dialogue"),b.prototype.footer=v.templateFromParts(g),b.prototype.updateState=function(){var a,b,c,d,e,f,g,h,i;return i=this.model.toJSON(),c=i.compress,d=i.compression,h=i.start,i.size,g=i.max,f=i.format,b=i.columns,a=C.isEqual(b,this.query.views)?o.get("All"):b.length,this.getRowCount(),e=0===b.length?new w("NoColumnsSelected"):h>=g?new w("OffsetOutOfBounds"):null,this.state.set(this.model.pick("headers","headerType","jsonFormat","fastaExtension")),this.state.set({error:e,format:f,max:g,exportURI:this.getExportURI(),rowCount:this.getRowCount(),compression:c?d:null,columns:a})},b.prototype.getRowCount=function(){var a,b,c,d;return d=this.model.pick("start","size","max"),c=d.start,b=d.size,a=d.max,null==c&&(c=0),a-=null!=c?c:0,b=null!=b&&b>0?b:a,Math.min(a,b)},b.prototype.getMain=function(){switch(this.state.get("tab")){case"format":return j;case"columns":return c;case"compression":return d;case"column-headers":return i;case"opts-json":return m;case"opts-fasta":return h;case"dest":return e;case"rows":return t;case"preview":return s;default:return j}},b.prototype.onUploadComplete=function(a){return this.state.set({doneness:null,linkToFile:a})},b.prototype.onUploadProgress=function(a){return this.state.set({doneness:a})},b.prototype.onUploadError=function(a){return this.state.set({doneness:null,error:a}),console.error(a)},b.prototype.act=function(){var a,b,c,d,e,f,g,h,i,j;if(this.onUploadProgress(0),b=this.getExporter(),e=this.model,i=this.state,h=this.query,a={model:e.toJSON(),state:i.toJSON(),query:h.clone()},j=this.getExportURI(),d=this.getFileName(),f=this.onUploadProgress,c=b.call(a,j,d,f),c.then(this.onUploadComplete,this.onUploadError),null!=b.after)return g=b.after.bind(a),c.then(g,g).then(null,function(a){return function(b){return a.state.set({error:b})}}(this))},b.prototype.getExporter=function(){switch(this.state.get("dest")){case"download":return function(){return Promise.resolve(null)};case"Dropbox":return y;case"Drive":return B;case"Galaxy":return z;case"GenomeSpace":return A;default:throw new Error("Cannot export to "+this.state.get("dest"))}},b.prototype.events=function(){var a;return a=b.__super__.events.apply(this,arguments),a.keyup="handleKeyup",a},b.prototype.handleKeyup=function(a){var b,c;if(!this.$(a.target).is("input"))switch(a.which){case 40:return null!=(b=this.children.menu)?b.next():void 0;case 38:return null!=(c=this.children.menu)?c.prev():void 0}},b.prototype.renderMain=function(){var a;return a=this.getMain(),this.renderChild("main",new a({model:this.model,query:this.query,state:this.state}),this.$("div.main"))},b.prototype.postRender=function(){return this.renderChild("menu",new n({model:this.state}),this.$("nav.menu")),this.renderMain(),this.$el.focus(),b.__super__.postRender.apply(this,arguments)},b}(p)}).call(this)},{"../core-model":2,"../messages":16,"../mixins/runs-query":33,"../models/export-formats":42,"../options":63,"../templates":67,"../utils/open-window-with-post":94,"../utils/send-to-dropbox":100,"../utils/send-to-galaxy":101,"../utils/send-to-genomespace":102,"../utils/send-to-google-drive":103,"./constraint-adder":128,"./export-dialogue/column-controls":140,"./export-dialogue/compression-controls":141,"./export-dialogue/destination-options":142,"./export-dialogue/fasta-options":143,"./export-dialogue/flat-file-options":144,"./export-dialogue/format-controls":145,"./export-dialogue/json-options":146,"./export-dialogue/preview":148,"./export-dialogue/row-controls":149,"./export-dialogue/tab-menu":150,"./modal":197,jquery:288,underscore:310}],139:[function(a,b,c){(function(){var c,d,e,f={}.hasOwnProperty,g=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};a("underscore"),e=a("../query-dialogue-button"),d=a("../export-dialogue"),c=a("../../utils/count-executor"),b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return g(b,a),b.prototype.className="im-export-dialogue-button",b.prototype.longLabel="export.ExportQuery",b.prototype.shortLabel="export.Export",b.prototype.icon="Download",b.prototype.optionalParameters=["tableState"],b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),c.count(this.query).then(function(a){return function(b){return a.state.set({disabled:0===b})}}(this)).then(null,function(a){return function(b){return a.state.set({disabled:!0,error:b})}}(this))},b.prototype.initState=function(){return this.state.set({name:this.query.name})},b.prototype.dialogueOptions=function(){var a,b;return a=null!=(b=this.tableState)?b.pick("start","size"):void 0,{query:this.query,model:{tablePage:a}}},b.prototype.Dialogue=d,b}(e)}).call(this)},{"../../utils/count-executor":77,"../export-dialogue":138,"../query-dialogue-button":206,underscore:310}],140:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l,m,n={}.hasOwnProperty,o=function(a,b){function c(){this.constructor=a}for(var d in b)n.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},p=[].indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(b in this&&this[b]===a)return b;return-1};m=a("underscore"),k=a("../../core-view"),h=a("../../models/path-set"),f=a("../label-view"),g=a("../../messages"),j=a("../../templates"),e=a("../../mixins/has-typeaheads"),l=a("../../utils/path-suggester"),function(a){function b(){return b.__super__.constructor.apply(this,arguments)}o(b,a),b.prototype.template=m.partial(g.getText,"export.category.Columns")}(f),c=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return o(b,a),b.include(e),b.prototype.initialize=function(a){return this.columns=a.columns,this.query=a.query,b.__super__.initialize.apply(this,arguments),this.initSuggestions()},b.prototype.addSuggestion=function(a){var b;if(!this.columns.contains(a))return this.suggestions.add(a),b=this.suggestions.get(a),a.getDisplayName(function(a,c){return b.set({error:a,name:c})})},b.prototype.initSuggestions=function(){var a,b,c,d,e,f;for(this.suggestions=new h,c=this.query.getQueryNodes(),f=[],d=0,e=c.length;d<e;d++)b=c[d],f.push(function(){var c,d,e,f;for(e=b.getChildNodes(),f=[],c=0,d=e.length;c<d;c++)a=e[c],a.isAttribute()&&(this.columns.contains(a)?f.push(void 0):f.push(this.addSuggestion(a)));return f}.call(this));return f},b.prototype.postRender=function(){var a,b,c;return b=this.$("input"),c={minLength:1,highlight:!0},a={name:"view_suggestions",source:l(this.suggestions),displayKey:"name"},this.activateTypeahead(b,c,a,"Additional paths",function(a){return function(b,c){var d;return d=c.item,a.columns.add(d,{active:!0})}}(this)),this.$(".im-help").tooltip()},b.prototype.className="col-sm-8",b.prototype.template=j.template("export_add_column_control"),b}(k),i=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return o(b,a),b.prototype.className="col-sm-4",b.prototype.RERENDER_EVENT="change:isAll",b.prototype.initialize=function(a){return this.query=a.query,this.columns=a.columns,b.__super__.initialize.apply(this,arguments),this.setIsAll(),this.listenTo(this.columns,"change:active",this.setIsAll)},b.prototype.setIsAll=function(){var a,b,c;return c=this.query.views,b=function(){var b,c,d,e;for(d=this.columns.where({active:!0}),e=[],b=0,c=d.length;b<c;b++)a=d[b],e.push(a.get("item").toString());return e}.call(this),this.model.set({isAll:m.isEqual(c,b)})},b.prototype.template=j.template("reset_button"),b.prototype.events=function(){return{"click button":"reset"}},b.prototype.reset=function(){var a;return a=this.query.views,this.columns.each(function(b){var c;return c=b.get("item").toString(),b.set({active:m.any(a,function(a){return a===c})})})},b}(k),d=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return o(b,a),b.prototype.RERENDER_EVENT="change",b.prototype.initialize=function(){var a,c;if(b.__super__.initialize.apply(this,arguments),this.model.has("active")||this.model.set({active:!0}),!this.model.has("name"))return this.model.set({name:null}),a=this.model.get("item"),"id"===(null!=(c=this.model.get("item").end)?c.name:void 0)&&(a=a.getParent()),a.getDisplayName(function(a){return function(b,c){return a.model.set({error:b,name:c})}}(this))},b.prototype.className="list-group-item",b.prototype.events=function(){return{"click .im-active-state":function(a){return function(){return a.model.toggle("active")}}(this)}},b.prototype.tagName="li",b.prototype.template=j.template("export_column_control"),b}(k),b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return o(b,a),b.prototype.className="container-fluid",b.prototype.initialize=function(a){var c,d,e,f,g,i,j,k,l,n,o,p,q,r,s;if(this.query=a.query,b.__super__.initialize.apply(this,arguments),this.columns=new h,e=this.model.get("format"),c=this.model.get("columns"),!(null!=(r=e.needs)?r.length:void 0))for(s=this.query.views,k=0,o=s.length;k<o;k++)j=s[k],i=this.query.makePath(j),this.columns.add(i,{active:m.any(c,function(a){return a===j})});for(l=0,p=c.length;l<p;l++)d=c[l],this.columns.add(this.query.makePath(d),{active:!0});if(g=this.model.get("nodecolumns"))for(n=0,q=g.length;n<q;n++)f=g[n],this.columns.add(this.query.makePath(f),{active:!1});return this.listenTo(this.columns,"add remove reset change:active",this.setColumns),this.listenTo(this.columns,"add remove reset",this.reRender)},b.prototype.setColumns=function(a){var b,c,d,e,f;return c=function(){var a,c,d,e;for(d=this.columns.where({active:!0}),e=[],a=0,c=d.length;a<c;a++)b=d[a],e.push(b.get("item").toString());return e}.call(this),(d=this.model.get("format").maxColumns)&&null!=a&&c.length>d&&(e=a.get("item").toString(),f=function(){var a,d,f;for(f=[],a=0,d=c.length;a<d;a++)(b=c[a])!==e&&f.push(b);return f}(),c=[e].concat(m.first(f,d-1)),m.defer(function(a){return function(){var d,e,f,g,h;for(f=a.columns.where({active:!0}),h=[],d=0,e=f.length;d<e;d++)b=f[d],h.push(b.set({active:(g=b.get("item").toString(),p.call(c,g)>=0)}));return h}}(this))),this.model.set({columns:c})},b.prototype.tagName="form",b.prototype.template=j.template("export_column_controls"),b.prototype.postRender=function(){var a,b;return b=this.$("ul"),a=this.$(".controls"),this.columns.each(function(a){return function(c,e){return a.renderChild(e,new d({model:c}),b)}}(this)),this.renderChild("reset",new i({query:this.query,columns:this.columns}),a),this.renderChild("add",new c({query:this.query,columns:this.columns}),a)},b}(k)}).call(this)},{"../../core-view":3,"../../messages":16,"../../mixins/has-typeaheads":32,"../../models/path-set":55,"../../templates":67,"../../utils/path-suggester":96,"../label-view":179,underscore:310}],141:[function(a,b,c){(function(){var c,d,e={}.hasOwnProperty,f=function(a,b){function c(){this.constructor=a}for(var d in b)e.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};a("underscore"),c=a("./main"),d=a("../../templates"),b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return f(b,a),b.prototype.RERENDER_EVENT="change",b.prototype.tagName="form",b.prototype.template=d.template("export_compression_controls"),b.prototype.setCompression=function(a){return function(b){return function(){return b.model.set({compression:a})}}(this)},b.prototype.events=function(){return{"click .im-compress":function(a){return function(){return a.model.toggle("compress")}}(this),"click input[name=gzip]":this.setCompression("gzip"),"click input[name=zip]":this.setCompression("zip")}},b}(c)}).call(this)},{"../../templates":67,"./main":147,underscore:310}],142:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j={}.hasOwnProperty,k=function(a,b){function c(){this.constructor=a}for(var d in b)j.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};i=a("underscore"),c=a("../../core-view"),h=a("../../templates"),f=a("../../options"),e=a("../../models/export-formats"),d=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return k(b,a),b.prototype.RERENDER_EVENT="change:dest",b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this.listenTo(f,"change:Destination.Galaxy.*",this.reRender)},b.prototype.getData=function(){return i.extend(b.__super__.getData.apply(this,arguments),{Galaxy:f.get("Destination.Galaxy")})},b.prototype.getTemplate=function(){switch(this.model.get("dest")){case"Galaxy":return this.galaxyTemplate;default:return function(){return""}}},b.prototype.galaxyTemplate=h.template("export_destination_galaxy_options"),b.prototype.template=function(a){return this.getTemplate()(a)},b.prototype.events=function(){return{"change .im-galaxy-uri-param":"setGalaxyUri","change .im-save-galaxy input":"toggleSaveGalaxy"}},b.prototype.setGalaxyUri=function(a){var b;return b=a.target,f.set("Destination.Galaxy.Current",b.value)},b.prototype.toggleSaveGalaxy=function(){var a,b;return b="Destination.Galaxy.Save",a=f.get(b),f.set(b,!a)},b}(c),g=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return k(b,a),b.prototype.RERENDER_EVENT="change:dest",b.prototype.destinations=function(){var a,b,c,d,e;for(d=f.get("Destinations"),e=[],b=0,c=d.length;b<c;b++)a=d[b],f.get(["Destination",a,"Enabled"])&&e.push(a)
;return e},b.prototype.getData=function(){return i.extend({destinations:this.destinations()},b.__super__.getData.apply(this,arguments))},b.prototype.template=h.template("export_destination_radios"),b.prototype.setDest=function(a){return function(b){return function(){return b.model.set({dest:a})}}(this)},b.prototype.events=function(){var a;return i.object(function(){var b,c,d,e;for(d=this.destinations(),e=[],b=0,c=d.length;b<c;b++)a=d[b],e.push(["click .im-dest-"+a,this.setDest(a)]);return e}.call(this))},b}(c),b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return k(b,a),b.prototype.RERENDER_EVENT="change:format",b.prototype.getData=function(){var a,c;return c=this.model.get("has"),a=e.getFormats(c),i.extend({formats:a},b.__super__.getData.apply(this,arguments))},b.prototype.template=h.template("export_destination_options"),b.prototype.postRender=function(){return this.renderChildAt(".im-param-dest",new g({model:this.state})),this.renderChildAt(".im-dest-opts",new d({model:this.state}))},b.prototype.events=function(){var a,b,c,d,f,g;for(a={".change .im-param-name input":"setName"},c=this.model.get("has"),g=e.getFormats(c),d=0,f=g.length;d<f;d++)b=g[d],a["click .im-fmt-"+b.id]=this.setFormat.bind(this,b);return a},b.prototype.setName=function(a){return this.model.set({filename:a.target.value})},b.prototype.setFormat=function(a){return this.model.set({format:a})},b}(c)}).call(this)},{"../../core-view":3,"../../models/export-formats":42,"../../options":63,"../../templates":67,underscore:310}],143:[function(a,b,c){(function(){var c,d,e={}.hasOwnProperty,f=function(a,b){function c(){this.constructor=a}for(var d in b)e.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};a("underscore"),d=a("../../core-view"),a("../label-view"),a("../../messages"),c=a("../../templates"),b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return f(b,a),b.prototype.RERENDER_EVENT="change",b.prototype.tagName="form",b.prototype.template=c.template("export_fasta_options"),b.prototype.setFastaExtension=function(a){return this.model.set({fastaExtension:a})},b.prototype.events=function(){return{"change .im-fasta-ext":function(a){return function(b){return a.setFastaExtension(b.target.value)}}(this)}},b}(d)}).call(this)},{"../../core-view":3,"../../messages":16,"../../templates":67,"../label-view":179,underscore:310}],144:[function(a,b,c){(function(){var c,d,e={}.hasOwnProperty,f=function(a,b){function c(){this.constructor=a}for(var d in b)e.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};a("underscore"),d=a("../../core-view"),c=a("../../templates"),b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return f(b,a),b.prototype.RERENDER_EVENT="change",b.prototype.tagName="form",b.prototype.template=c.template("export_flat_file_options"),b.prototype.setHeaderType=function(a){return function(b){return function(){return b.model.set({headerType:a})}}(this)},b.prototype.events=function(){return{"click .im-headers":function(a){return function(){return a.model.toggle("headers")}}(this),"click input[name=hdrs-friendly]":this.setHeaderType("friendly"),"click input[name=hdrs-path]":this.setHeaderType("path")}},b}(d)}).call(this)},{"../../core-view":3,"../../templates":67,underscore:310}],145:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j={}.hasOwnProperty,k=function(a,b){function c(){this.constructor=a}for(var d in b)j.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};i=a("underscore"),h=a("../../core-view"),f=a("../../messages"),g=a("../../templates"),e=a("../label-view"),c=a("../../models/export-formats"),d=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return k(b,a),b.prototype.template=i.partial(f.getText,"export.category.Format"),b}(e),b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return k(b,a),b.prototype.tagName="form",b.prototype.template=g.template("export_format_controls"),b.prototype.getData=function(){var a,d;return d=this.model.get("has"),a=c.getFormats(d),i.extend({formats:a},b.__super__.getData.apply(this,arguments))},b.prototype.events=function(){return{"change input:radio":"onChangeFormat"}},b.prototype.onChangeFormat=function(){return this.model.set({format:this.$("input:radio:checked").val()})},b.prototype.postRender=function(){return this.renderChild("heading",new d({model:this.model}),this.$(".im-title"))},b}(h)}).call(this)},{"../../core-view":3,"../../messages":16,"../../models/export-formats":42,"../../templates":67,"../label-view":179,underscore:310}],146:[function(a,b,c){(function(){var c,d,e={}.hasOwnProperty,f=function(a,b){function c(){this.constructor=a}for(var d in b)e.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};a("underscore"),d=a("../../core-view"),a("../label-view"),a("../../messages"),c=a("../../templates"),b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return f(b,a),b.prototype.RERENDER_EVENT="change",b.prototype.tagName="form",b.prototype.template=c.template("export_json_options"),b.prototype.setJSONFormat=function(a){return function(b){return function(){return b.model.set({jsonFormat:a})}}(this)},b.prototype.events=function(){return{"click input[name=rows]":this.setJSONFormat("rows"),"click input[name=objects]":this.setJSONFormat("objects")}},b}(d)}).call(this)},{"../../core-view":3,"../../messages":16,"../../templates":67,"../label-view":179,underscore:310}],147:[function(a,b,c){(function(){var c,d={}.hasOwnProperty,e=function(a,b){function c(){this.constructor=a}for(var e in b)d.call(b,e)&&(a[e]=b[e]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};c=a("../../core-view"),b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return e(b,a),b.prototype.initialize=function(a){return this.query=a.query,b.__super__.initialize.apply(this,arguments)},b}(c)}).call(this)},{"../../core-view":3}],148:[function(a,b,c){(function(){var c,d,e,f,g,h,i={}.hasOwnProperty,j=function(a,b){function c(){this.constructor=a}for(var d in b)i.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};h=a("underscore"),c=a("../../core-view"),a("../../messages"),g=a("../../templates"),d=a("../../models/export-formats"),f=a("../../mixins/runs-query"),e={compress:null,size:3},b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return j(b,a),b.include(f),b.prototype.initialize=function(a){return this.query=a.query,b.__super__.initialize.apply(this,arguments),this.state.set({preview:""}),this.setPreview(),this.listenTo(this.state,"change:preview",this.reRender),this.listenTo(this.model,"change:format",this.setPreview)},b.prototype.setPreview=function(){var a;return a=this.model.get("format"),"bio"===a.group?this.state.set({preview:"Previews are not supported for bio-informatics formats"}):this.runQuery(e).then(function(a){return function(b){return h.isString(b)?a.state.set({preview:b}):a.state.set({preview:JSON.stringify(b,null,2)})}}(this))},b.prototype.template=g.template("export_preview"),b.prototype.getData=function(){var a,c;return c=this.model.get("has"),a=d.getFormats(c),h.extend({formats:a},b.__super__.getData.apply(this,arguments))},b.prototype.events=function(){return{"change .im-export-formats select":"setFormat"}},b.prototype.setFormat=function(a){return this.model.set({format:d.getFormat(a.target.value)})},b}(c)}).call(this)},{"../../core-view":3,"../../messages":16,"../../mixins/runs-query":33,"../../models/export-formats":42,"../../templates":67,underscore:310}],149:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l={}.hasOwnProperty,m=function(a,b){function c(){this.constructor=a}for(var d in b)l.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};k=a("underscore"),j=a("../../core-view"),d=a("../label-view"),e=a("../../messages"),i=a("../../templates"),h=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return m(b,a),b.prototype.getData=function(){return{size:this.model.get("size")||e.getText("rows.All")}},b.prototype.template=k.partial(e.getText,"export.param.Size"),b}(d),f=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return m(b,a),b.prototype.template=k.partial(e.getText,"export.param.Start"),b}(d),c=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return m(b,a),b.prototype.template=k.partial(e.getText,"export.category.Rows"),b}(d),g=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return m(b,a),b.prototype.RERENDER_EVENT="change",b.prototype.getData=function(){return k.extend(b.__super__.getData.apply(this,arguments),{isAll:!(this.model.get("start")||this.model.get("size"))})},b.prototype.template=i.template("export_rows_reset_button"),b.prototype.events=function(){return{"click .btn-reset":"reset","click .im-set-table-page":"setTablePage"}},b.prototype.reset=function(){return this.model.set({start:0,size:null})},b.prototype.setTablePage=function(){return this.model.set(this.model.get("tablePage"))},b}(j),b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return m(b,a),b.prototype.RERENDER_EVENT="change:max",b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this.model.has("max")||this.model.set({max:null}),this.listenTo(this.model,"change:size",this.updateLabels),this.listenTo(this.model,"change:size change:start",this.updateInputs)},b.prototype.tagName="form",b.prototype.template=i.template("export_row_controls"),b.prototype.events=function(){return{"input input[name=size]":"onChangeSize","input input[name=start]":"onChangeStart"}},b.prototype.updateInputs=function(){var a,b,c,d;return d=this.model.toJSON(),c=d.start,b=d.size,a=d.max,this.$("input[name=size]").val(b||a),this.$("input[name=start]").val(c)},b.prototype.onChangeSize=function(){var a;return a=parseInt(this.$("input[name=size]").val(),10),a&&a!==this.model.get("max")?this.model.set({size:a}):this.model.set({size:null})},b.prototype.onChangeStart=function(){return this.model.set({start:parseInt(this.$("input[name=start]").val(),10)})},b.prototype.postRender=function(){return this.renderChild("heading",new c({model:this.state}),this.$(".im-title")),this.renderChild("size",new h({model:this.model}),this.$(".size-label")),this.renderChild("start",new f({model:this.model}),this.$(".start-label")),this.renderChild("reset",new g({model:this.model}),this.$(".im-reset"))},b}(j)}).call(this)},{"../../core-view":3,"../../messages":16,"../../templates":67,"../label-view":179,underscore:310}],150:[function(a,b,c){(function(){var c,d,e,f,g,h,i=[].indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(b in this&&this[b]===a)return b;return-1},j={}.hasOwnProperty,k=function(a,b){function c(){this.constructor=a}for(var d in b)j.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};h=a("underscore"),g=a("../../core-view"),c=a("../../options"),f=a("../../templates"),e=function(){function a(a,b,c,d){this.ident=a,this.formats=null!=c?c:[],this.groups=null!=d?d:null,this.key="export.category."+b}return a.prototype.isFor=function(a){var b;return this.formats.length?(b=a.ext,i.call(this.formats,b)>=0):null==this.groups||this.groups[a.group]},a}(),d=[new e("dest","Destination"),new e("opts-json","JsonFormat",["json"]),new e("opts-fasta","FastaFormat",["fasta"]),new e("columns","Columns"),new e("rows","Rows",[],{flat:!0,machine:!0}),new e("compression","Compression"),new e("column-headers","ColumnHeaders",["tsv","csv"]),new e("preview","Preview")],b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return k(b,a),b.prototype.tagName="ul",b.prototype.RERENDER_EVENT="change",b.prototype.className="nav nav-pills nav-stacked im-export-tab-menu",b.prototype.template=f.template("export_tab_menu",{variable:"data"}),b.prototype.getTabs=function(){var a,b,c,e;for(e=[],b=0,c=d.length;b<c;b++)a=d[b],a.isFor(this.model.get("format"))&&e.push(a);return e},b.prototype.getData=function(){var a;return a=this.getTabs(),h.extend({tabs:a},b.__super__.getData.apply(this,arguments))},b.prototype.setTab=function(a){return function(b){return function(){if(!b.state.get("pinned"))return b.model.set({tab:a})}}(this)},b.prototype.setPinned=function(a){return function(b){return function(){return b.state.get("pinned")===a?b.state.set({pinned:!1}):b.state.set({pinned:a}),b.model.set({tab:a})}}(this)},b.prototype.next=function(){var a,b,c,d;return d=function(){var a,b,d,e;for(d=this.getTabs(),e=[],a=0,b=d.length;a<b;a++)c=d[a],e.push(c.ident);return e}.call(this),a=h.indexOf(d,this.model.get("tab")),b=a+1,b===d.length&&(b=0),this.model.set({tab:d[b]})},b.prototype.prev=function(){var a,b,c,d;return d=function(){var a,b,d,e;for(d=this.getTabs(),e=[],a=0,b=d.length;a<b;a++)c=d[a],e.push(c.ident);return e}.call(this),a=h.indexOf(d,this.model.get("tab")),b=0===a?d.length-1:a-1,this.model.set({tab:d[b]})},b.prototype.events=function(){var a,b,e;return b=c.get("Events.ActivateTab"),a=h.object(function(){var a,c,f;for(f=[],a=0,c=d.length;a<c;a++)e=d[a].ident,f.push([b+" .im-tab-"+e,this.setTab(e)]);return f}.call(this)),"mouseenter"===b&&h.extend(a,h.object(function(){var a,b,c;for(c=[],a=0,b=d.length;a<b;a++)e=d[a].ident,c.push(["click .im-tab-"+e,this.setPinned(e)]);return c}.call(this))),a},b}(g)}).call(this)},{"../../core-view":3,"../../options":63,"../../templates":67,underscore:310}],151:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l=function(a,b){return function(){return a.apply(b,arguments)}},m={}.hasOwnProperty,n=function(a,b){function c(){this.constructor=a}for(var d in b)m.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};a("../../event"),c=a("../../core-view"),g=a("../../options"),i=a("../../mixins/sets-path-names"),k=a("../../models/summary-items"),f=a("../../models/numeric-range"),j=a("./summary-heading"),d=a("./items"),h=a("./selected-count"),e=a("./visualisation"),b.exports=function(a){function b(){return this.Model=l(this.Model,this),b.__super__.constructor.apply(this,arguments)}return n(b,a),b.include(i),b.prototype.className=function(){return"im-facet-view"},b.prototype.modelEvents=function(){return{"change:min change:max":this.setLimits}},b.prototype.stateEvents=function(){return{"change:open":this.honourOpenness}},b.prototype.parameters=["query","view"],b.prototype.optionalParameters=["noTitle"],b.prototype.Model=function(){return new k({query:this.query,view:this.view})},b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this.range=new f,this.setPathNames(),this.setLimits()},b.prototype.initState=function(){if(!this.state.has("open"))return this.state.set({open:g.get("Facets.Initally.Open")})},b.prototype.setLimits=function(){if(this.model.get("numeric"))return this.range.setLimits(this.model.pick("min","max"))},b.prototype.invariants=function(){return{hasQuery:"No query",hasAttrView:"The view is not an attribute: "+this.view,modelIsSummaryItemsModel:"The model is not a summary items model: "+this.model}},b.prototype.modelIsSummaryItemsModel=function(){return this.model instanceof k},b.prototype.hasQuery=function(){return null!=this.query},b.prototype.hasAttrView=function(){var a;return null!=(a=this.view)&&"function"==typeof a.isAttribute?a.isAttribute():void 0},b.prototype.postRender=function(){return this.renderTitle(),this.renderVisualisation(),this.renderSelectedCount(),this.renderItems(),this.honourOpenness()},b.prototype.renderTitle=function(){if(!this.noTitle)return this.renderChild("title",new j({model:this.model,state:this.state}))},b.prototype.renderVisualisation=function(){return this.renderChild("viz",new e({model:this.model,state:this.state,range:this.range}))},b.prototype.renderSelectedCount=function(){return this.renderChild("count",new h({model:this.model,range:this.range}))},b.prototype.renderItems=function(){return this.renderChild("facet",new d({model:this.model,state:this.state,range:this.range}))},b.prototype.honourOpenness=function(){var a,b,c;if(b=this.state.get("open"),c=this.state.previous("open"),a=this.$("dd.im-facet"),b?(a.slideDown(),this.trigger("opened",this)):(a.slideUp(),this.trigger("closed",this)),null!=c&&b!==c)return this.trigger("toggled",this)},b.prototype.events=function(){return{"click .im-summary-heading":"toggle"}},b.prototype.toggle=function(){return this.state.toggle("open")},b.prototype.close=function(){return this.state.set({open:!1})},b.prototype.open=function(){return this.state.set({open:!0})},b}(c)}).call(this)},{"../../core-view":3,"../../event":11,"../../mixins/sets-path-names":34,"../../models/numeric-range":50,"../../models/summary-items":60,"../../options":63,"./items":153,"./selected-count":160,"./summary-heading":161,"./visualisation":166}],152:[function(a,b,c){(function(){var c,d,e,f,g={}.hasOwnProperty,h=function(a,b){function c(){this.constructor=a}for(var d in b)g.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};e=a("d3-browserify"),a("underscore"),c=a("../../options"),a("../../messages"),d=a("./visualisation-base"),a("../../messages/summary"),a("../../utils/casts").bool,f=function(a,b){return e.scale.linear().domain(a).range(b)},b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return h(b,a),b.prototype.className="im-summary-histogram",b.prototype.chartHeight=50,b.prototype.leftMargin=25,b.prototype.rightMargin=25,b.prototype.bottomMargin=.5,b.prototype.stepWidth=0,b.prototype.allCountsAreOne=function(){return 1===this.model.get("maxCount")},b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this.listenTo(this.model.items,"add remove change:selected",function(a){return function(){return a.updateChart()}}(this))},b.prototype.invariants=function(){return{hasItems:"No items, or not the right thing: "+this.model.items}},b.prototype.hasItems=function(){var a,b;return null!=(null!=(a=this.model)&&null!=(b=a.items)?b.models:void 0)},b.prototype.initChart=function(){return b.__super__.initChart.apply(this,arguments),this.stepWidth=(this.chartWidth-(this.leftMargin+this.rightMargin+1))/this.model.items.size()},b.prototype.shouldNotDrawChart=function(){return this.allCountsAreOne()},b.prototype.getScales=function(){var a,b,c,d,e,g;return b=[0,this.model.items.size()],a=[0,this.model.get("maxCount")],g=[0,this.chartHeight-this.bottomMargin],d=[this.leftMargin,this.chartWidth-this.rightMargin],c=f(b,d),e=f(a,g),{x:c,y:e}},b.prototype.selectNodes=function(a){return a.selectAll("rect")},b.prototype.getChartData=function(a){return this.model.items.models.slice()},b.prototype.enter=function(a,b){return a.append("rect").classed("im-item-bar",!0).classed("squashed",this.stepWidth<4).attr("width",this.stepWidth).attr("y",this.chartHeight).attr("height",0).attr("x",function(a,c){return b.x(c)}).on("click",function(a){return a.toggle("selected")}).on("mouseover",function(a){return a.mousein()}).on("mouseout",function(a){return a.mouseout()})},b.prototype.update=function(a,b){var d,e,f,g,h;return h=c.get("D3.Transition"),d=h.Duration,e=h.Easing,f=this.chartHeight-this.bottomMargin,g=function(a){return b.y(a.get("count"))},a.classed("selected",function(a){return a.get("selected")}),a.transition().duration(d).ease(e).attr("height",g).attr("y",function(a){return f-g(a)})},b.prototype.drawAxes=function(a,b){var c;return c=this.chartHeight-this.bottomMargin,a.append("line").classed("x-axis",!0).attr("x1",0).attr("x2",this.chartWidth).attr("y1",c).attr("y2",c)},b}(d)}).call(this)},{"../../messages":16,"../../messages/summary":27,"../../options":63,"../../utils/casts":74,"./visualisation-base":165,"d3-browserify":256,underscore:310}],153:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k={}.hasOwnProperty,l=function(a,b){function c(){this.constructor=a}for(var d in b)k.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};j=a("underscore"),c=a("../../core-view"),i=a("../../templates"),h=a("./summary-stats"),g=a("./summary-items"),e=a("./only-one-item"),d=a("./no-results"),f=["error","initialized"],b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return l(b,a),b.prototype.className="im-facet-items",b.prototype.initialize=function(a){return this.range=a.range,b.__super__.initialize.apply(this,arguments)},b.prototype.invariants=function(){return{modelHasRequiredAttrs:"Model only has the following attributes: "+j.keys(this.model.attributes)}},b.prototype.modelHasRequiredAttrs=function(){return 2===j.intersection(f,j.keys(this.model.attributes)).length},b.prototype.modelEvents=function(){return{destroy:this.stopListening}},b.prototype.template=i.template("facet_frequency"),b.prototype.RERENDER_EVENT="change:error change:numeric change:uniqueValues change:initialized",b.prototype.postRender=function(){if(this.model.get("initialized"))return this.renderChild("items",this.getItems())},b.prototype.getItems=function(){switch(!1){case!this.model.get("numeric"):return new h({model:this.model,range:this.range});case!(this.model.get("uniqueValues")>1):return new g({model:this.model});case 1!==this.model.get("uniqueValues"):return new e({model:this.model,state:this.state});default:return new d({model:this.state})}},b}(c)}).call(this)},{"../../core-view":3,"../../templates":67,"./no-results":154,"./only-one-item":156,"./summary-items":163,"./summary-stats":164,underscore:310}],154:[function(a,b,c){(function(){var c,d,e={}.hasOwnProperty,f=function(a,b){function c(){this.constructor=a}for(var d in b)e.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};c=a("../../core-view"),d=a("../../templates"),a("../../messages/summary"),b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return f(b,a),b.prototype.className="im-no-results",b.prototype.stateEvents=function(){return{"change:pathName":this.reRender}},b.prototype.renderRequires=["pathName"],b.prototype.template=d.template("summary_no_results"),b}(c)}).call(this)},{"../../core-view":3,"../../messages/summary":27,"../../templates":67}],155:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l={}.hasOwnProperty,m=function(a,b){function c(){this.constructor=a}for(var d in b)l.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};h=a("d3-browserify"),c=a("jquery"),k=a("underscore"),e=a("../../options"),d=a("../../messages"),a("../../messages/summary"),f=a("./visualisation-base"),j=function(a,b){return h.scale.linear().domain(a).range(b)},g=function(a,b){var c,d,e,f;return f=function(){var d,e,f,g;for(f=[0,1],g=[],d=0,e=f.length;d<e;d++)c=f[d],g.push(a(b+c));return g}(),e=f[0],d=f[1],{min:e,max:d}},i=function(a,b){return function(c){return c<a?a:c>b?b:c}},b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return m(b,a),b.prototype.className="im-numeric-distribution",b.prototype.leftMargin=25,b.prototype.bottomMargin=18,b.prototype.rightMargin=14,b.prototype.chartHeight=70,b.prototype.__selecting_paths=!1,b.prototype.selection=null,b.prototype.initialize=function(a){return this.range=a.range,b.__super__.initialize.apply(this,arguments),this.listenTo(this.range,"change reset",this.onChangeRange)},b.prototype.invariants=function(){return{hasRange:"No range",hasHistogramModel:"Wrong model: "+this.model}},b.prototype.hasRange=function(){return null!=this.range},b.prototype.hasHistogramModel=function(){var a;return null!=(null!=(a=this.model)?a.getHistogram:void 0)},b.prototype.selectNodes=function(a){return a.selectAll("rect")},b.prototype.getChartData=function(a){var b,c,d,e,f,h;for(null==a&&(a=this.getScales()),f=this.model.getHistogram(),h=[],c=d=0,e=f.length;d<e;c=++d)b=f[c],h.push({count:b,bucket:c+1,range:g(a.bucketToVal,c+1)});return h},b.prototype.initChart=function(){return b.__super__.initChart.apply(this,arguments),this.bucketWidth=(this.model.get("max")-this.model.get("min"))/this.model.get("buckets"),this.stepWidth=(this.chartWidth-(this.leftMargin+1))/this.model.get("buckets")},b.prototype.getScales=function(){var a,b,c,d,e,f,g,l,m,n,o,p;return p=this.model.pick("min","max"),e=p.min,d=p.max,g=this.model.get("buckets"),c=this.model.getHistogram(),f=h.max(c),b=[0,f],m=[e,d],a=[1,g+1],n=[this.leftMargin,this.chartWidth-this.rightMargin],o=[0,this.chartHeight-this.bottomMargin],l=function(a){return k.compose(i(e,d),j(a,m))},{x:j(a,n),y:j(b,o),valToX:j(m,n),xToVal:l(n),bucketToVal:l(a)}},b.prototype.isIntish=function(){var a;return"int"===(a=this.model.get("type"))||"Integer"===a||"long"===a||"Long"===a||"short"===a||"Short"===a},b.prototype.getRounder=function(){return this.isIntish()?Math.round:k.identity},b.prototype.enter=function(a,b){var e,f,g,h,i;return null==b&&(b=this.getScales()),f=this.el,i=this.getRounder(),h=this.chartHeight,e=function(a){return function(b,c){return b.count>0?a.range.set(b.range):a.range.nullify()}}(this),g=function(a){var b,c,e,f;return f=a.range,e=f.min,c=f.max,b=a.count,d.getText("summary.Bucket",{count:b,range:{min:i(e),max:i(c)}})},a.append("rect").attr("x",function(a,c){return b.x(a.bucket)}).attr("width",function(a){return Math.max(0,b.x(a.bucket+1)-b.x(a.bucket))}).attr("y",h-this.bottomMargin).attr("height",0).classed("im-bucket",!0).classed("im-null-bucket",function(a){return null===a.bucket}).on("click",e).each(function(a){return c(this).tooltip({container:f,title:g(a)})})},b.prototype.update=function(a,b){var c,d,f,g,h,i;return null==b&&(b=this.getScales()),g=this.chartHeight,f=this.bottomMargin,i=e.get("D3.Transition"),c=i.Duration,d=i.Easing,h=function(a){return b.y(a.count)},a.transition().duration(c).ease(d).attr("height",h).attr("y",function(a){return g-f-h(a)-.5})},b.prototype.drawAxes=function(a,b){var f,g,h,i;return null==a&&(a=this.getCanvas()),null==b&&(b=this.getScales()),g=this.chartHeight-this.bottomMargin-.5,h=this.el,e.get("Facets.DrawAverageLine")&&a.append("line").classed("average",!0).attr("x1",b.valToX(this.model.get("average"))).attr("x2",b.valToX(this.model.get("average"))).attr("y1",0).attr("y2",g).each(function(){return c(this).tooltip({container:h,title:d.getText("summary.Average")})}),a.append("line").classed("axis",!0).attr("x1",0).attr("x2",this.chartWidth).attr("y1",g).attr("y2",g),f=a.append("svg:g"),i=b.x.ticks(this.model.get("buckets")),f.selectAll("line").data(i).enter().append("svg:line").classed("tick-line",!0).attr("x1",b.x).attr("x2",b.x).attr("y1",this.chartHeight-.75*this.bottomMargin).attr("y2",this.chartHeight-this.bottomMargin)},b.prototype.events=function(){return{mouseout:function(a){return function(){return a.__selecting_paths=!1}}(this)}},b.prototype.drawSelection=function(a,b){return null==a||a<=0||b>=this.chartWidth?this.removeSelection():(null==this.selection&&(this.selection=this.getCanvas().append("svg:rect").attr("y",0).attr("height",.9*this.chartHeight).classed("rubberband-selection",!0)),this.selection.attr("x",a).attr("width",b))},b.prototype.onChangeRange=function(){var a,b,c,d,e,f;return this.shouldDrawBox()?(c=this.getScales(),f=this.range.toJSON(),b=f.min,a=f.max,d=c.valToX(b),e=c.valToX(a)-d,this.drawSelection(d,e)):this.removeSelection()},b.prototype.removeSelection=function(){var a;return null!=(a=this.selection)&&a.remove(),this.selection=null},b.prototype.shouldDrawBox=function(){return this.range.isNotAll()},b.prototype.remove=function(){var a;return this.removeSelection(),null!=(a=this.paper)&&a.remove(),b.__super__.remove.apply(this,arguments)},b}(f)}).call(this)},{"../../messages":16,"../../messages/summary":27,"../../options":63,"./visualisation-base":165,"d3-browserify":256,jquery:288,underscore:310}],156:[function(a,b,c){(function(){var c,d,e={}.hasOwnProperty,f=function(a,b){function c(){this.constructor=a}for(var d in b)e.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};c=a("../../core-view"),d=a("../../templates"),b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return f(b,a),b.prototype.className="im-only-one",b.prototype.modelEvents=function(){return{change:this.reRender}},b.prototype.stateEvents=function(){return{change:this.reRender}},b.prototype.template=d.template("only_one_item"),b}(c)}).call(this)},{"../../core-view":3,"../../templates":67}],157:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r={}.hasOwnProperty,s=function(a,b){function c(){this.constructor=a}for(var d in b)r.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};q=a("underscore"),c=a("jquery"),i=a("d3-browserify"),f=a("../../options"),h=a("./visualisation-base"),e=function(a){return a.data.get("id")},d=i.layout.pie().value(function(a){return a.get("count")}),g={startAngle:0,endAngle:0},l=function(){var a,b;return a=f.get("PieColors"),b=q.isFunction(a)?a:i.scale[a](),function(a){return b(a.data.get("id"))}},n=function(a){var b;return null!=(b=a.get("currentPieCoords"))?b:g},p=function(a){return a.data.get("visible")?1:.25},m=function(a,b,c){return{startAngle:a,endAngle:b,selected:c.get("selected")?1:0}},k=function(a){return function(b){var c,d,e,f,g,h,j;return j=b.startAngle,e=b.endAngle,c=b.data,g=c,h=n(g),d=m(j,e,g),f=i.interpolateObject(h,d),g.set({currentPieCoords:f(1)}),function(b){return a(f(b))}}},o=function(a){return(a.endAngle+a.startAngle)/2>Math.PI},j=function(a,b,c){return i.svg.arc().startAngle(function(a){return a.startAngle}).endAngle(function(a){return a.endAngle}).innerRadius(function(a){return b+a.selected*c}).outerRadius(function(b){return a+b.selected*c})},b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return s(b,a),b.prototype.chartWidth=120,b.prototype.chartHeight=120,b.prototype.className="im-pie-chart",b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this.listenTo(this.model.items,"change:selected change:visible",this.update),this.listenTo(f,"change:PieColors",this.onChangePalette),this.onChangePalette()},b.prototype.onChangePalette=function(){return this.colour=l(),this.update()},b.prototype._drawD3Chart=function(){var a,b,c,d,e,f,g;return c=this.chartHeight,g=this.$el.closest(":visible").width(),e=.4*c,d=.1*c,f=.08*c,b=i.select(this.el).append("svg").attr("class","chart").attr("height",c).attr("width",g),this.arc=j(e,d,f),this.arc_group=b.append("svg:g").attr("class","arc").attr("transform","translate("+g/2+","+c/2+")"),a=b.append("svg:g").attr("class","center_group").attr("transform","translate("+g/2+","+c/2+")"),b.append("svg:g").attr("class","label_group").attr("transform","translate("+g/2+","+c/2+")"),a.append("svg:circle").attr("fill","white").attr("r",d),this.update()},b.prototype.enter=function(a){var b,d,e,f;return d=this.el,f=this.model.items.reduce(function(a,b){return a+b.get("count")},0),e=function(a){return(a.data.get("count")/f*100).toFixed(1)},b=function(a){var b,f,g;return b=c(this),g=a.data.get("item")+": "+e(a)+"%",f=o(a)?"left":"right",b.tooltip({title:g,placement:f,container:d})},a.append("svg:path").attr("class","donut-arc").on("click",function(a){return a.data.toggle("selected")}).on("mouseover",function(a){return a.data.mousein()}).on("mouseout",function(a){return a.data.mouseout()}).each(b)},b.prototype.exit=function(a){return a.remove()},b.prototype.getChartData=function(){return this.model.items.models.slice()},b.prototype.update=function(){var a,b,c,g
;if(null!=this.arc_group)return c=this.arc_group.selectAll("path").data(d(this.getChartData()),e),this.exit(c.exit()),this.enter(c.enter()),g=f.get("D3.Transition"),a=g.DurationShort,b=g.Easing,c.attr("fill",this.colour),c.transition().duration(a).ease(b).style("opacity",p).attrTween("d",k(this.arc))},b}(h)}).call(this)},{"../../options":63,"./visualisation-base":165,"d3-browserify":256,jquery:288,underscore:310}],158:[function(a,b,c){(function(){var c,d,e,f={}.hasOwnProperty,g=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};e=a("underscore"),c=a("../../core-view"),d=a("../../templates"),b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return g(b,a),b.prototype.className="im-facet-surrogate",b.prototype.initialize=function(a){return this.above=a.above,b.__super__.initialize.apply(this,arguments)},b.prototype.template=d.template("row_surrogate"),b.prototype.getData=function(){return e.extend(b.__super__.getData.apply(this,arguments),{above:this.above})},b.prototype.postRender=function(){return this.$el.addClass(this.above?"above":"below")},b.prototype.remove=function(){return this.$el.fadeOut("fast",function(a){return function(){return b.__super__.remove.call(a)}}(this))},b}(c)}).call(this)},{"../../core-view":3,"../../templates":67,underscore:310}],159:[function(a,b,c){(function(){var c,d,e,f,g,h,i={}.hasOwnProperty,j=function(a,b){function c(){this.constructor=a}for(var d in b)i.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};h=a("underscore"),d=a("../../core-view"),f=a("../../templates"),c=a("../../core/checkbox"),e=a("./row-surrogate"),a("../../messages/summary"),g=function(a){return!!a},b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return j(b,a),b.prototype.RERENDER_EVENT="change:count change:item change:symbol change:share",b.prototype.tagName="tr",b.prototype.className="im-facet-row",b.prototype.modelEvents=function(){return{"change:visible":this.onChangeVisibility,"change:hover":this.onChangeHover,"change:selected":this.onChangeSelected}},b.prototype.invariants=function(){return{modelHasCollection:"No collection on model"}},b.prototype.modelHasCollection=function(){var a;return null!=(null!=(a=this.model)?a.collection:void 0)},b.prototype.template=f.template("facet_row"),b.prototype.getData=function(){var a,c,d,e;return a=this.model.collection.getMaxCount(),e=this.model.get("count")/a,c=(e/2+.5).toFixed(),d=(100*e).toFixed(),h.extend(b.__super__.getData.apply(this,arguments),{percent:d,opacity:c,max:a})},b.prototype.onRenderError=function(a){return console.error(a)},b.prototype.postRender=function(){return this.addCheckbox(),this.onChangeVisibility(),this.onChangeHover(),this.onChangeSelected()},b.prototype.addCheckbox=function(){return this.renderChildAt(".checkbox",new c({model:this.model,attr:"selected"}))},b.prototype.onChangeVisibility=function(){return this.$el.toggleClass("im-hidden",!this.model.get("visible"))},b.prototype.onChangeHover=function(){var a;return a=g(this.model.get("hover")),this.$el.toggleClass("hover",a),a?this.showSurrogateUnlessVisible():this.removeSurrogate()},b.prototype.onChangeSelected=function(){return this.$el.toggleClass("im-selected",this.model.get("selected"))},b.prototype.removeSurrogate=function(){return this.removeChild("surrogate")},b.prototype.showSurrogateUnlessVisible=function(){var a,b,c,d;if(this.removeSurrogate(),!this.isVisible())return b=this.isAbove(),c=new e({model:this.model,above:b}),a=c.$el,d=this.getTable(),this.renderChild("surrogate",c,d),b?a.css({top:d.scrollTop()}):a.css({bottom:0-d.scrollTop()})},b.prototype.getTable=function(){return this.$el.closest(".im-item-table")},b.prototype.events=function(){return{click:"handleClick"}},b.prototype.handleClick=function(a){return a.stopPropagation(),this.model.toggle("selected")},b.prototype.isBelow=function(){var a;return a=this.getTable(),this.$el.offset().top+this.$el.outerHeight()>a.offset().top+a.outerHeight()},b.prototype.isAbove=function(){var a;return a=this.getTable(),this.$el.offset().top<a.offset().top},b.prototype.isVisible=function(){return!(this.isAbove()||this.isBelow())},b}(d)}).call(this)},{"../../core-view":3,"../../core/checkbox":4,"../../messages/summary":27,"../../templates":67,"./row-surrogate":158,underscore:310}],160:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l,m={}.hasOwnProperty,n=function(a,b){function c(){this.constructor=a}for(var d in b)m.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};l=a("underscore"),c=a("../../core-view"),d=a("../../templates"),a("../../messages/summary"),i=function(a,b){return null==a&&(a=l.identity),l.reduce(b,function(b,c){return b+a(c)},0)},j=l.partial(i,function(a){return a.count}),k=function(a,b,c){return i(l.partial(g,a,b),c)},e=function(a,b,c){var d;return a?(d=a.max-a.min,(a.min<b?Math.min(a.max,c)-b:c-Math.max(a.min,b))/d):0},f=function(a,b){return function(c){return c.min>=a&&c.max<=b}},h=function(a,b){return function(c){return c.min<a&&c.max>a||c.max>b&&c.min<b}},g=function(a,b,c){return c.count*e(c,a,b)},b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return n(b,a),b.prototype.className="im-summary-selected-count",b.prototype.template=d.template("summary-selected-count"),b.prototype.stateEvents=function(){return{"change:selectedCount change:isApprox":this.reRender}},b.prototype.initialize=function(a){return this.range=a.range,b.__super__.initialize.apply(this,arguments),this.listenTo(this.model.items,"change:selected",this.estimateSelectionSize),this.listenTo(this.range,"change",this.estimateSelectionSize)},b.prototype.estimateSelectionSize=function(){if(this.model.get("initialized"))return this.model.get("numeric")?this.estimateSelectedInRange():this.sumSelectedItems()},b.prototype.preRender=function(){return this.rendered?this.state.get("selectedCount")?void 0:this.$el.slideUp():this.$el.hide()},b.prototype.postRender=function(){if(this.state.get("selectedCount"))return this.$el.slideDown()},b.prototype.sumSelectedItems=function(){var a,b;return b=this.model.items.where({selected:!0}),a=i(function(a){return a.get("count")},b),this.state.set({isApprox:!1,selectedCount:a})},b.prototype.estimateSelectedInRange=function(){var a,b,c,d,e,g,i;return this.range.isAll()?this.state.unset("selectedCount"):(i=this.range.toJSON(),e=i.min,d=i.max,c=this.getHistogram(),b=c.filter(f(e,d)),g=c.filter(h(e,d)),a=Math.round(j(b)+k(e,d,g)),this.state.set({isApprox:!0,selectedCount:a}))},b.prototype.getHistogram=function(){var a,b,c,d,e,f,g,h,i;for(a=this.model.getHistogram(),d=this.model.get("max"),e=this.model.get("min"),f=(d-e)/a.length,i=[],c=g=0,h=a.length;g<h;c=++g)b=a[c],i.push({count:b,min:e+c*f,max:e+f+c*f});return i},b}(c)}).call(this)},{"../../core-view":3,"../../messages/summary":27,"../../templates":67,underscore:310}],161:[function(a,b,c){(function(){var c,d,e,f={}.hasOwnProperty,g=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};e=a("underscore"),c=a("../../core-view"),d=a("../../templates"),a("../../messages/summary"),b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return g(b,a),b.prototype.className="im-summary-heading",b.prototype.modelEvents=function(){return{change:this.reRender,destroy:this.stopListening}},b.prototype.stateEvents=function(){return{change:this.reRender}},b.prototype.renderRequires=["numeric","available","got","uniqueValues"],b.prototype.template=d.template("summary_heading"),b.prototype.getData=function(){return e.extend(b.__super__.getData.apply(this,arguments),{filtered:null!=this.model.get("filteredCount")})},b}(c)}).call(this)},{"../../core-view":3,"../../messages/summary":27,"../../templates":67,underscore:310}],162:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l,m={}.hasOwnProperty,n=function(a,b){function c(){this.constructor=a}for(var d in b)m.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};l=a("underscore"),d=a("../../core-view"),i=a("../../templates"),g=a("../../messages"),a("../../messages/summary"),j=function(a){return!!a},k=function(a){var b;return b={},b.multi="ONE OF"===a.multi?"NONE OF":"ONE OF",b.single="=="===a.single?"!=":"==",b.absent="IS NULL"===a.absent?"IS NOT NULL":"IS NULL",b},e=function(a){if(null!=a)return a.preventDefault(),a.stopPropagation()},c={single:"==",multi:"ONE OF",absent:"IS NULL"},h={tab:"tsv",csv:"csv",xml:"xml",json:"json"},f=10,b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return n(b,a),b.prototype.RERENDER_EVT="change",b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this.listenTo(this.model.items,"change:selected",this.reRender)},b.prototype.invariants=function(){return{viewIsAttribute:"No view, or view not Attribute: "+this.view,hasCollection:"No collection"}},b.prototype.viewIsAttribute=function(){var a,b;return null!=(a=this.model)&&null!=(b=a.view)&&"function"==typeof b.isAttribute?b.isAttribute():void 0},b.prototype.hasCollection=function(){var a;return null!=(null!=(a=this.model)?a.items:void 0)},b.prototype.template=i.template("summary_items_controls"),b.prototype.getData=function(){var a;return a=j(this.model.items.findWhere({selected:!0})),l.extend(b.__super__.getData.apply(this,arguments),{anyItemSelected:a})},b.prototype.postRender=function(){return this.activateTooltips(),this.activatePopovers()},b.prototype.activateTooltips=function(){return this.$btns=this.$(".btn[title]").tooltip({placement:"top",container:this.el})},b.prototype.activatePopovers=function(){return this.$(".im-download").popover({placement:"top",html:!0,container:this.el,title:g.getText("summary.DownloadFormat"),content:this.getDownloadPopover(),trigger:"manual"})},b.prototype.downloadPopoverTemplate=i.template("download_popover"),b.prototype.getDownloadPopover=function(){return this.downloadPopoverTemplate(l.extend(this.getBaseData(),{query:this.model.query,path:this.model.view.toString(),formats:h}))},b.prototype.events=function(){return{"click .im-export-summary":"exportSummary",click:"hideTooltips","click .btn-cancel":"unsetSelection","click .btn-toggle-selection":"toggleSelection","click .im-filter-group .dropdown-toggle":"toggleDropdown","click .im-download":"toggleDownloadPopover","click .im-filter-in":l.bind(this.addConstraint,this,c),"click .im-filter-out":l.bind(this.addConstraint,this,k(c))}},b.prototype.exportSummary=function(a){return a.stopImmediatePropagation(),!0},b.prototype.hideTooltips=function(){var a;return null!=(a=this.$btns)?a.tooltip("hide"):void 0},b.prototype.unsetSelection=function(a){return this.changeSelection(function(a){return a.set({selected:!1})})},b.prototype.toggleSelection=function(a){return this.changeSelection(function(a){if(a.get("visible"))return a.toggle("selected")})},b.prototype.toggleDropdown=function(){return this.$(".im-filter-group").toggleClass("open")},b.prototype.toggleDownloadPopover=function(){return this.$(".im-download").popover("toggle")},b.prototype.addConstraint=function(a,b){var c,d,g,h,i;return e(b),h=function(){var a,b,c,e;for(c=this.model.items.where({selected:!0}),e=[],a=0,b=c.length;a<b;a++)d=c[a],e.push(d.get("item"));return e}.call(this),g=this.model.items.where({selected:!1}),0===g.length?this.model.set({error:new Error("All items are selected")}):(c=l.any(h,function(a){return null==a}),!c&&this.model.hasAll()&&f>(i=h.length)&&i>g.length?this.constrainTo(k(a),function(){var a,b,c;for(c=[],a=0,b=g.length;a<b;a++)d=g[a],c.push(d.get("item"));return c}()):this.constrainTo(a,h))},b.prototype.constrainTo=function(a,b){var c,d,e,f,g;return(null!=b?b.length:void 0)?(f=this.model.query,e=this.model.view.toString(),g=b[0],d=function(){switch(!1){case!(b.length>1):return{op:a.multi,values:b};case null==g:return{op:a.single,value:String(g)};default:return{op:a.absent}}}(),!/or/.test(f.constraintLogic)&&"ONE OF"===d.op&&(c=l.findWhere(f.constraints,{path:e,op:"ONE OF"}))?(c.values=d.values,f.trigger("change:constraints",f.constraints)):f.addConstraint(l.extend(d,{path:e}))):this.model.set({error:new Error("No values are selected")})},b.prototype.changeSelection=function(a){return this.model.items.each(function(b){return l.defer(a,b)})},b}(d)}).call(this)},{"../../core-view":3,"../../messages":16,"../../messages/summary":27,"../../templates":67,underscore:310}],163:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l,m=function(a,b){return function(){return a.apply(b,arguments)}},n={}.hasOwnProperty,o=function(a,b){function c(){this.constructor=a}for(var d in b)n.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};l=a("underscore"),c=a("backbone"),d=a("../../core-view"),j=a("../../templates"),g=a("../../messages"),h=a("../../mixins/sets-path-names"),i=a("./summary-items-controls"),e=a("./row"),a("../../messages/summary"),f=function(a){if(null!=a)return a.preventDefault(),a.stopPropagation()},k=function(a){return"row_"+a.get("id")},b.exports=function(a){function b(){return this.filterItems=m(this.filterItems,this),b.__super__.constructor.apply(this,arguments)}return o(b,a),b.include(h),b.prototype.tagName="div",b.prototype.className="im-summary-items",b.prototype.stateEvents=function(){return{"change:error":this.setErrOnModel}},b.prototype.setErrOnModel=function(){return this.model.set(this.state.pick("error"))},b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this.listenTo(this.model.items,"add",this.addItem),this.listenTo(this.model.items,"remove",this.removeItem),this.listenTo(this.state,"change:typeName change:endName",this.reRender),this.setPathNames()},b.prototype.invariants=function(){return{modelHasItems:"expected a SummaryItems model, got: "+this.model,modelCanHasMore:"expected the correct model methods, got: "+this.model}},b.prototype.modelHasItems=function(){var a;return(null!=(a=this.model)?a.items:void 0)instanceof c.Collection},b.prototype.modelCanHasMore=function(){var a;return l.isFunction(null!=(a=this.model)?a.hasMore:void 0)},b.prototype.template=j.template("summary_items"),b.prototype.getData=function(){return l.extend(b.__super__.getData.apply(this,arguments),{hasMore:this.model.hasMore(),colClasses:l.result(this,"colClasses"),colHeaders:l.result(this,"colHeaders")})},b.prototype.colClasses=["im-item-selector","im-item-value","im-item-count"],b.prototype.colHeaders=function(){var a;return a=this.state.has("typeName")?this.state.get("typeName")+" "+this.state.get("endName"):g.getText("summary.Item"),[" ",a,g.getText("summary.Count")]},b.prototype.postRender=function(){if(this.tbody=this.$(".im-item-table tbody"),!this.tbody.length)throw new Error("Could not find table");return this.addControls(),this.addItems()},b.prototype.addControls=function(){return this.renderChildAt(".im-summary-controls",new i({model:this.model}))},b.prototype.addItems=function(a){var b;if(null==a&&(a=0),this.rendered&&a<this.model.items.length)return b=a+100,l.defer(function(c){return function(){var d;return d=document.createDocumentFragment(),c.model.items.slice(a,b).forEach(function(a){return c.addItem(a,d)}),c.tbody.append(d),c.addItems(b)}}(this))},b.prototype.addItem=function(a,b){if(this.rendered)return this.renderChild(k(a),new e({model:a}),null!=b?b:this.tbody)},b.prototype.removeItem=function(a){return this.removeChild(k(a))},b.prototype.events=function(){return{"click .im-load-more":"loadMoreItems","click .im-clear-value-filter":"clearValueFilter","keyup .im-filter-values":l.throttle(this.filterItems,250,{leading:!1}),submit:f,click:f}},b.prototype.loadMoreItems=function(){if(!this.model.get("loading"))return this.model.increaseLimit(2)},b.prototype.clearValueFilter=function(){var a;return a=this.$(".im-filter-values"),a.val(null),this.model.setFilterTerm(null)},b.prototype.filterItems=function(a){var b;return b=this.$(".im-filter-values"),b.val(),this.model.setFilterTerm(b.val())},b}(d)}).call(this)},{"../../core-view":3,"../../messages":16,"../../messages/summary":27,"../../mixins/sets-path-names":34,"../../templates":67,"./row":159,"./summary-items-controls":162,backbone:236,underscore:310}],164:[function(a,b,c){(function(){var c,d,e,f,g,h,i={}.hasOwnProperty,j=function(a,b){function c(){this.constructor=a}for(var d in b)i.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};h=a("underscore"),c=a("../../core-view"),f=a("../../templates"),d=40,g=38,e={min:0,max:0,average:0,stdev:0},b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return j(b,a),b.prototype.RERENDER_EVENT="change",b.prototype.className="im-summary-stats",b.prototype.template=f.template("summary_stats"),b.prototype.getData=function(){return h.extend({},e,b.__super__.getData.apply(this,arguments))},b.prototype.initialize=function(a){return this.range=a.range,b.__super__.initialize.apply(this,arguments),this.listenTo(this.range,"change",this.setSliderValues),this.listenTo(this.range,"change",this.setButtonDisabledness),this.listenTo(this.range,"change:min",this.onChangeMin),this.listenTo(this.range,"change:max",this.onChangeMax),this.listenForChange(this.model,this.initType,"integral","min","max"),this.initType()},b.prototype.invariants=function(){return{hasRange:"No range"}},b.prototype.hasRange=function(){return null!=this.range},b.prototype.setSliderValues=function(){var a,b,c,d;return c=this.range.toJSON(),b=c.min,a=c.max,null!=(d=this.$slider)?d.slider("option","values",[b,a]):void 0},b.prototype.onChangeMin=function(){var a;if(a=this.range.get("min"),this.$("input.im-range-min").val(a),null!=this.$slider&&this.$slider.slider("values",0)!==a)return this.$slider.slider("values",0,a)},b.prototype.onChangeMax=function(){var a;if(a=this.range.get("max"),this.$("input.im-range-max").val(a),null!=this.$slider&&this.$slider.slider("values",1)!==a)return this.$slider.slider("values",1,a)},b.prototype.setButtonDisabledness=function(){var a;return a=this.range.isNotAll(),this.$(".btn").toggleClass("disabled",!a)},b.prototype.events=function(){return{click:function(a){return a.stopPropagation()},"keyup input.im-range-min":"maybeIncrementMin","keyup input.im-range-max":"maybeIncrementMax","change input.im-range-min":"setRangeMin","change input.im-range-max":"setRangeMax","click .btn-primary":"changeConstraints","click .btn-cancel":"clearRange"}},b.prototype.clearRange=function(){return this.range.set(this.model.pick("min","max"))},b.prototype.maybeIncrementMin=function(a){return this.maybeIncrement("min",a)},b.prototype.maybeIncrementMax=function(a){return this.maybeIncrement("max",a)},b.prototype.maybeIncrement=function(a,b){var c;switch(c=this.range.get(a),b.keyCode){case d:c-=this.step;break;case g:c+=this.step}return this.range.set(a,c)},b.prototype.setRangeMin=function(){return this.range.set({min:this.parse(this.$(".im-range-min").val())})},b.prototype.setRangeMax=function(){return this.range.set({max:this.parse(this.$(".im-range-max").val())})},b.prototype.changeConstraints=function(a){var b,c,d,e,f,g,i;for(a.preventDefault(),a.stopPropagation(),e=this.model.view.toString(),f=this.model.query,c=h.where(f.constraints,{path:e}),d=this.range.nulled?[{path:e,op:"IS NULL"}]:[{path:e,op:">=",value:this.range.get("min")},{path:e,op:"<=",value:this.range.get("max")}],g=0,i=c.length;g<i;g++)b=c[g],f.removeConstraint(b,{silent:!0});return f.addConstraints(d)},b.prototype.postRender=function(){return this.drawSlider()},b.prototype.parse=function(a){try{return 1===this.step?parseInt(a,10):parseFloat(a)}catch(b){return b,this.model.set({error:new Error("Could not parse '"+a+"' as a number")}),null}},b.prototype.initType=function(){var a,b,c,d;return d=this.model.toJSON(),a=d.integral,c=d.min,b=d.max,this.step=a?1:Math.abs((b-c)/100),this.round=a?Math.round:h.identity},b.prototype.drawSlider=function(){var a,b,c;return c=this.model.pick("min","max"),a=c.max,b=c.min,this.activateSlider({range:!0,min:b,max:a,values:[b,a],step:this.step,slide:function(a){return function(b,c){var d;return null!=(d=a.range)?d.set({min:c.values[0],max:c.values[1]}):void 0}}(this)})},b.prototype.reRender=function(){return this.destroySlider(),b.__super__.reRender.apply(this,arguments)},b.prototype.activateSlider=function(a){return this.destroySlider(),this.$slider=this.$(".slider"),this.$slider.slider(a)},b.prototype.destroySlider=function(){if(null!=this.$slider)return this.$slider.slider("destroy"),this.$slider=null},b.prototype.remove=function(){return this.destroySlider(),b.__super__.remove.apply(this,arguments)},b}(c)}).call(this)},{"../../core-view":3,"../../templates":67,underscore:310}],165:[function(a,b,c){(function(){var c,d,e,f={}.hasOwnProperty,g=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};d=a("d3-browserify"),e=a("underscore"),c=a("../../core-view"),b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return g(b,a),b.prototype.chartHeight=0,b.prototype.chartWidth=0,b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this.listenTo(this.model,"change:loading",this.reRender)},b.prototype.postRender=function(){if(!this.model.get("loading"))return this.addChart()},b.prototype.addChart=function(){return e.defer(function(a){return function(){var b;try{return a._drawD3Chart()}catch(c){return b=c,a.model.set({error:b})}}}(this))},b.prototype.getScales=function(){throw new Error("Not implemented")},b.prototype.selectNodes=function(a){throw new Error("not implemented")},b.prototype.getChartData=function(a){throw new Error("not implemented")},b.prototype.exit=function(a){return a.remove()},b.prototype.enter=function(a,b){throw new Error("not implemented")},b.prototype.update=function(a,b){throw new Error("not implemented")},b.prototype.drawAxes=function(a,b){},b.prototype.shouldNotDrawChart=function(){return!1},b.prototype._drawD3Chart=function(){var a,b;if(!this.shouldNotDrawChart())return this.initChart(),b=this.getScales(),a=this.getCanvas(),this.updateChart(a,b),this.drawAxes(a,b)},b.prototype.updateChart=function(a,b){var c;if(!this.shouldNotDrawChart())return null==a&&(a=this.getCanvas()),null==b&&(b=this.getScales()),c=this.selectNodes(a).data(this.getChartData(b)),this.exit(c.exit()),this.enter(c.enter(),b),this.update(c,b)},b.prototype.initChart=function(){return this.chartWidth=this.$el.closest(":visible").width()},b.prototype.getCanvas=function(){return null!=this.paper?this.paper:this.paper=d.select(this.el).append("svg").attr("class","im-summary-chart").attr("width",this.chartWidth).attr("height",this.chartHeight)},b}(c)}).call(this)},{"../../core-view":3,"d3-browserify":256,underscore:310}],166:[function(a,b,c){(function(){var c,d,e,f,g,h={}.hasOwnProperty,i=function(a,b){function c(){this.constructor=a}for(var d in b)h.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};f=a("../../options"),c=a("../../core-view"),e=a("./numeric"),g=a("./pie"),d=a("./histogram"),a("./summary-items"),b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return i(b,a),b.prototype.className="im-facet-vis",b.prototype.initialize=function(a){return this.range=a.range,b.__super__.initialize.apply(this,arguments)},b.prototype.RERENDER_EVENT="change:loading change:numeric change:canHaveMultipleValues",b.prototype.postRender=function(){if(this.model.get("initialized"))return this.renderChild("vis",this.getVisualization())},b.prototype.getVisualization=function(a){var b,c,h,i,j;switch(j=this.model.toJSON(),i=j.uniqueValues,h=j.numeric,b=j.canHaveMultipleValues,j.type,c=j.got,!1){case!h:return new e({model:this.model,range:this.range});case 1!==i:return null;case!b:return new d({model:this.model});case!(0<i&&i<=f.get("MAX_PIE_SLICES")):return new g({model:this.model});case!c:return new d({model:this.model});default:return null}},b}(c)}).call(this)},{"../../core-view":3,"../../options":63,"./histogram":152,"./numeric":155,"./pie":157,"./summary-items":163}],167:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k={}.hasOwnProperty,l=function(a,b){function c(){this.constructor=a}for(var d in b)k.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};j=a("underscore"),e=a("../core-view"),h=a("./modal"),g=a("../messages"),i=a("../templates"),d=a("./constraints"),a("../messages/constraints"),a("../messages/logic"),f=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return l(b,a),b.prototype.className="form im-evenly-spaced im-constraint-logic",b.prototype.tagName="form",b.prototype.template=i.template("logic-manager-body"),b.prototype.parameters=["query"],b.prototype.initialize=function(){var a,c;return b.__super__.initialize.apply(this,arguments),c=function(){var b,c,d,e;for(d=this.query.constraints,e=[],b=0,c=d.length;b<c;b++)a=d[b],a.code&&e.push(a.code);return e}.call(this),this.model.set({logic:this.query.constraintLogic}),this.state.set({disabled:!0,defaultLogic:c.join(" and ")})},b.prototype.events=function(){return{"change .im-logic":this.setLogic,submit:this.applyChanges}},b.prototype.modelEvents=function(){return{"change:logic":this.setDisabled}},b.prototype.stateEvents=function(){return{"change:disabled":this.reRender}},b.prototype.setDisabled=function(){var a,b;return b=this.model.get("logic"),a=this.query.constraintLogic,this.state.set({disabled:b===a})},b.prototype.setLogic=function(a){return this.model.set({logic:a.target.value})},b.prototype.applyChanges=function(a){var b;if(null!=a&&a.preventDefault(),null!=a&&a.stopPropagation(),!this.state.get("disabled"))return b=this.model.get("logic"),this.query.constraintLogic=b,this.query.trigger("change:logic",b)},b}(e),c=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}var c;return l(b,a),b.prototype.template=i.template("active-constraints"),b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this.assignCodes()},b.prototype.stateEvents=function(){return{"change:adding":this.reRender}},c="ABCDEFGHIJKLMNOPQRSTUVWXYZ",b.prototype.assignCodes=function(){var a,b,d,e,f,g,h;if(e=function(){var b,c,d,e;for(d=this.query.constraints,e=[],b=0,c=d.length;b<c;b++)a=d[b],null!=a.op&&e.push(a);return e}.call(this),!(e.length<2)){for(d=c.split(""),h=[],f=0,g=e.length;f<g;f++)a=e[f],null==a.code&&h.push(function(){var c;for(c=[];null==a.code&&(b=d.shift());)j.any(e,function(a){return a.code===b})?c.push(void 0):c.push(a.code=b);return c}());return h}},b.prototype.postRender=function(){var a,c;return b.__super__.postRender.apply(this,arguments),a=this.getConstraints(),a.length>1&&this.renderChild("logic",new f({query:this.query})),c=this.state.get("adding")?"slideUp":"slideDown",this.$(".im-current-constraints")[c](400)},b.prototype.getConAdder=function(){if(this.state.get("adding"))return b.__super__.getConAdder.apply(this,arguments)},b}(d),b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return l(b,a),b.prototype.parameters=["query"],b.prototype.modalSize=function(){return"lg"},b.prototype.className=function(){return b.__super__.className.apply(this,arguments)+" im-filter-manager"},b.prototype.title=function(){return g.getText("constraints.Heading",{n:this.query.constraints.length})},b.prototype.initState=function(){return this.state.set({adding:!1,disabled:!1})},b.prototype.act=function(){return this.state.set({adding:!0,disabled:!0})},b.prototype.dismissAction=function(){return g.getText("Cancel")},b.prototype.primaryAction=function(){return g.getText("constraints.DefineNew")},b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this.listenTo(this,"shown",this.renderBodyContent),this.listenTo(this.query,"change:constraints",this.onChangeConstraints)},b.prototype.onChangeConstraints=function(){return this.initState(),this.renderTitle()},b.prototype.renderBodyContent=function(){var a;if(this.shown)return a=this.$(".modal-body"),j.defer(function(b){return function(){return b.renderChild("cons",new c({state:b.state,query:b.query}),a)}}(this))},b}(h)}).call(this)},{"../core-view":3,"../messages":16,"../messages/constraints":21,"../messages/logic":25,"../templates":67,"./constraints":131,"./modal":197,underscore:310}],168:[function(a,b,c){(function(){var c,d,e={}.hasOwnProperty,f=function(a,b){function c(){this.constructor=a}for(var d in b)e.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};d=a("../query-dialogue-button"),c=a("../filter-dialogue"),a("../../messages/constraints"),b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return f(b,a),b.prototype.className="im-filter-dialogue-button",b.prototype.longLabel="constraints.ManageFilters",b.prototype.shortLabel="constraints.ManageFiltersShort",b.prototype.icon="Filter",b.prototype.Dialogue=c,b}(d)}).call(this)},{"../../messages/constraints":21,"../filter-dialogue":167,"../query-dialogue-button":206}],169:[function(a,b,c){(function(){var c,d,e,f={}.hasOwnProperty,g=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};c=a("../core-view"),a("../templates"),d=a("./formatted/sorting-path"),e=a("../utils/sort-query-by-path"),b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return g(b,a),b.prototype.className="im-col-sort-menu no-margins",b.prototype.tagName="ul",b.prototype.initialize=function(a){return this.query=a.query,b.__super__.initialize.apply(this,arguments),this.setPathNames()},b.prototype.modelEvents=function(){return{"change:displayName":this.initState,"change:replaces":this.setPathNames}},b.prototype.initState=function(){return this.state.set({group:this.model.get("displayName")})},b.prototype.setPathNames=function(){var a,b,c,d,e;for(d=this.getPaths(),e=[],b=0,c=d.length;b<c;b++)a=d[b],e.push(function(a){return function(b){var c;return c=b.toString(),a.state.has(c)||a.state.set(c,""),b.getDisplayName().then(function(b){return a.state.set(c,b)})}}(this)(a));return e},b.prototype.getPaths=function(){var a;return a=this.model.get("replaces"),a.length?a.slice():[this.query.makePath(this.model.get("path"))]},b.prototype.preRender=function(a){var b,c;if(b=(c=this.getPaths())[0],1===c.length)return a.cancel(),e(this.query,b)},b.prototype.postRender=function(){var a,b,c,e,f,g;for(f=this.getPaths(),g=[],a=c=0,e=f.length;c<e;a=++c)b=f[a],g.push(this.renderChild(a,new d({model:this.model,state:this.state,query:this.query,path:b})));return g},b}(c)}).call(this)},{"../core-view":3,"../templates":67,"../utils/sort-query-by-path":105,"./formatted/sorting-path":170}],170:[function(a,b,c){(function(){var c,d,e,f,g,h={}.hasOwnProperty,i=function(a,b){function c(){this.constructor=a}for(var d in b)h.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};c=a("../../core-view"),f=a("../../templates"),e=a("../../icons"),g=a("../../utils/sort-query-by-path"),d=/^\s*>\s*/,b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return i(b,a),b.prototype.tagName="li",b.prototype.className="im-formatted-path im-subpath",b.prototype.parameters=["query","path"],b.prototype.stateEvents=function(){return{change:this.reRender}},b.prototype.getData=function(){var a,b,c,f;return c=this.state.toJSON(),b=null!=(f=c[this.path])?f.replace(c.group,"").replace(d,""):void 0,
a=this.query.getSortDirection(this.path),{Icons:e,name:b,direction:a}},b.prototype.template=f.template("formatted_sorting"),b.prototype.events=function(){return{click:"sortByPath"}},b.prototype.sortByPath=function(){return g(this.query,this.path)},b}(c)}).call(this)},{"../../core-view":3,"../../icons":14,"../../templates":67,"../../utils/sort-query-by-path":105}],171:[function(a,b,c){(function(){c.openDialogue=function(a){return this.renderChild("__dialogue__",a),a.show()},c.getDialogue=function(){var a;return null!=(a=this.children)?a.__dialogue__:void 0}}).call(this)},{}],172:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B={}.hasOwnProperty,C=function(a,b){function c(){this.constructor=a}for(var d in b)B.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},D=[].indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(b in this&&this[b]===a)return b;return-1},E=function(a,b){return function(){return a.apply(b,arguments)}};A=a("underscore"),o=a("es6-promise").Promise,t=a("../templates"),f=a("../core-view"),e=a("../core-model"),l=a("../options"),d=a("../core/collection"),m=a("../models/path"),z=a("../core/type-assertions"),y=a("../utils/get-leaves"),k=a("./item-preview/details"),q=a("./item-preview/reference-counts"),g=a("./item-preview/counts-title"),w=function(a,b){return"Could not determine origin of "+a+" from ["+b.join(", ")+"]"},h=function(a){function b(a){b.__super__.constructor.call(this,a.path),this.set(A.omit(a,"path"))}return C(b,a),b}(m),c=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return C(b,a),b.prototype.defaults=function(){return A.extend(b.__super__.defaults.apply(this,arguments),{fieldType:"ATTR",valueOverspill:null,tooLong:!1,value:null})},b}(h),p=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return C(b,a),b.prototype.defaults=function(){return A.extend(b.__super__.defaults.apply(this,arguments),{fieldType:"REF",values:[]})},b}(h),s=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return C(b,a),b.prototype.comparator="displayName",b.prototype.initialize=function(){return this.listenTo(this,"change:displayName",this.sort)},b}(d),n=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return C(b,a),b.prototype.defaults=function(){return{types:[],id:null,error:null,phase:"FETCHING"}},b}(e),i=t.template("cell-preview-error"),j=["class","objectId"],x=function(a,b){return a.concat(b)},u=function(){return function(a,b){return null!=b&&!b.objectId&&D.call(j,a)<0}},v=function(){return function(a,b){return null!=b?b.objectId:void 0}},r=new z.Structure("ServiceType",{root:z.String,count:z.Function,findById:z.Function,fetchModel:z.Function}),b.exports=function(a){function b(){return this.handleItem=E(this.handleItem,this),b.__super__.constructor.apply(this,arguments)}return C(b,a),b.prototype.Model=n,b.prototype.className="im-cell-preview-inner",b.prototype.parameters=["service"],b.prototype.parameterTypes={service:r},b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this.fieldDetails=new s,this.referenceFields=new s},b.prototype.modelEvents=function(){return{"change:phase":this.reRender,"change:error":this.reRender}},b.prototype.remove=function(){return this.removeAllChildren(),this.fieldDetails.close(),this.referenceFields.close(),delete this.fieldDetails,delete this.referenceFields,b.__super__.remove.apply(this,arguments)},b.prototype.fetching=null,b.prototype.template=function(a){var b,c;switch(c=a.phase,b=a.error,c){case"FETCHING":return this.helpers().IndeterminateProgressBar;case"ERROR":return i(b);default:return null}},b.prototype.preRender=function(){var a;return a=this.model,null==this.fetching&&(this.fetching=this.fetchData()),this.fetching.then(function(){return a.set({phase:"SUCCESS"})},function(b){return console.error(b),a.set({phase:"ERROR",error:b})})},b.prototype.postRender=function(){var a,b,c,d,e;if("SUCCESS"===this.model.get("phase")){for(d=this.model.get("types"),e=[],b=0,c=d.length;b<c;b++)a=d[b],e.push(this.$el.addClass(a));return e}},b.prototype.renderChildren=function(){var a,b,c;return b=new k({collection:this.fieldDetails}),this.renderChild("details",b),a=new g({collection:this.referenceFields}),this.renderChild("counttitle",a),c=new q({collection:this.referenceFields}),this.renderChild("counts",c),this.$el.append(t.clear)},b.prototype.fetchData=function(){return this.service.fetchModel().then(function(a){return function(b){var c,d;return a.schema=b,d=a.getAllDetails(),l.get("ItemDetails.ShowReferenceCounts")?(c=a.getRelationCounts(),o.all(d.concat(c))):o.all(d)}}(this))},b.prototype.getAllDetails=function(){var a,b,c,d,e;for(d=this.model.get("types"),e=[],b=0,c=d.length;b<c;b++)a=d[b],e.push(this.getDetails(a));return e},b.prototype.getDetails=function(a){var b,c;return c=this.model.get("id"),b=l.get(["ItemDetails","Fields",this.schema.name,a]),this.service.findById(a,c,b).then(this.handleItem)},b.prototype.handleItem=function(a){var b,c,d,e,f,g,h;c=this.fieldDetails,f=u(c),g=v(c),b=function(){var a,b,c,d;for(c=this.model.get("types"),d=[],a=0,b=c.length;a<b;a++)e=c[a],d.push(this.schema.classes[e]);return d}.call(this);for(d in a)h=a[d],f(d,h)&&this.handleAttribute(a,b,d,h);for(d in a)h=a[d],g(d,h)&&this.handleSubObj(a,b,d,h);return null},b.prototype.getPathForField=function(a,b){var c;if(null==(c=A.find(a,function(a){return null!=a.fields[b]})))throw new Error(w(b,A.pick(a,"name")));return this.schema.makePath(c.name+"."+b)},b.prototype.handleSubObj=function(a,b,c,d){var e,f,g;return f=this.getPathForField(b,c),g=y(d,j),e={path:f,field:c,values:g},this.fieldDetails.add(new p(e))},b.prototype.handleAttribute=function(a,b,d,e){var f,g,h,i,j;return h=this.getPathForField(b,d),g={path:h,field:d,value:e},(null!=e&&"String"===h.getType()||/Clob/.test(h.getType()))&&(f=l.get("CellCutoff"),j=String(e),e.length>f&&(i=j.indexOf(" ",.9*f),-1===i&&(i=f),g.tooLong=!0,g.valueOverspill=j.substring(i),g.value=j.substring(0,i))),this.fieldDetails.add(new c(g))},b.prototype.getRelationCounts=function(){var a,b,c,d,e,f,g,h;return z=this.model.get("types"),e=this.service.root,d=null!=(h=l.get(["ItemDetails","Count",e]))?h:{},c=function(){var c,e,h;for(h=[],c=0,e=z.length;c<e;c++)g=z[c],b=this.schema.classes[g],h.push(function(){var c,e,h,i,j;for(i=null!=(h=d[g])?h:function(){var c;c=[];for(a in b.collections)c.push(a);return c}(),j=[],c=0,e=i.length;c<e;c++)f=i[c],j.push(this.getRelationCount(f,g));return j}.call(this));return h}.call(this),c.reduce(x,[])},b.prototype.getRelationCount=function(a,b){var c,d,f,g,i,j,k;if(f=this.model.get("id"),A.isObject(a))j=a.query,g=a.label,c=j(f),d=function(a){return new e({parts:[g],id:g,displayName:g,count:a})};else{if(i=this.schema.makePath(b+"."+a),!(null!=(k=i.getType())?k.attributes.id:void 0))return o.resolve(!0);c={select:[a+".id"],from:b,where:{id:f}},d=function(a){return new h({path:i,count:a})}}return this.service.count(c).then(d).then(function(a){return function(b){if(b.get("count"))return a.referenceFields.add(b)}}(this))},b}(f)}).call(this)},{"../core-model":2,"../core-view":3,"../core/collection":5,"../core/type-assertions":10,"../models/path":56,"../options":63,"../templates":67,"../utils/get-leaves":83,"./item-preview/counts-title":173,"./item-preview/details":174,"./item-preview/reference-counts":175,"es6-promise":257,underscore:310}],173:[function(a,b,c){(function(){var c,d,e,f={}.hasOwnProperty,g=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};e=a("underscore"),c=a("../../core-view"),d=a("../../messages"),d.setWithPrefix("preview",{RelatedItemsHeading:"Related Items"}),b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return g(b,a),b.prototype.tagName="h4",b.prototype.collectionEvents=function(){return{"add remove reset":this.setVisibility}},b.prototype.setVisibility=function(){return this.$el.toggleClass("im-hidden",this.collection.isEmpty())},b.prototype.template=function(){return e.escape(d.getText("preview.RelatedItemsHeading"))},b.prototype.postRender=function(){return this.setVisibility()},b}(c)}).call(this)},{"../../core-view":3,"../../messages":16,underscore:310}],174:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j={}.hasOwnProperty,k=function(a,b){function c(){this.constructor=a}for(var d in b)j.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};i=a("underscore"),g=a("../../templates"),d=a("../../core-view"),h=a("../../utils/events").ignore,e=g.template("cell-preview-items"),f=g.template("cell-preview-reference"),c=g.template("cell-preview-attribute"),b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return k(b,a),b.prototype.tagName="table",b.prototype.className="im-item-details table table-condensed table-bordered",b.prototype.template=e,b.prototype.collectionEvents=function(){return{sort:this.reRender,add:this.addDetail}},b.prototype.events=function(){return{"click .im-too-long":this.revealLongField}},b.prototype.postRender=function(){return this.collection.each(function(a){return function(b){return a.addDetail(b)}}(this))},b.prototype.addDetail=function(a){return this.$el.append(this["render"+a.get("fieldType")](a.toJSON()))},b.prototype.renderATTR=function(a){return c(i.extend(this.getBaseData(),a))},b.prototype.renderREF=f,b.prototype.revealLongField=function(a){var b,c;return h(a),c=this.$(".im-too-long"),b=this.$(".im-overspill"),c.remove(),b.slideDown(250)},b}(d)}).call(this)},{"../../core-view":3,"../../templates":67,"../../utils/events":81,underscore:310}],175:[function(a,b,c){(function(){var c,d,e={}.hasOwnProperty,f=function(a,b){function c(){this.constructor=a}for(var d in b)e.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};d=a("../../templates"),c=a("../../core-view"),b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return f(b,a),b.prototype.className="im-related-counts",b.prototype.tagName="ul",b.prototype.collectionEvents=function(){return{"add change sort":this.reRender}},b.prototype.template=d.template("cell-preview-reference-relation"),b}(c)}).call(this)},{"../../core-view":3,"../../templates":67}],176:[function(a,b,c){(function(){var c,d,e,f,g,h,i={}.hasOwnProperty,j=function(a,b){function c(){this.constructor=a}for(var d in b)i.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};h=a("underscore"),a("../core-view"),e=a("../messages"),f=a("./modal"),c=a("./join-manager/body"),d=a("../models/joins"),a("../messages/joins"),g=function(a,b){return a.length===b.length&&h.all(a,function(a,c){return a===b[c]})},b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return j(b,a),b.prototype.parameters=["query"],b.prototype.className=function(){return b.__super__.className.apply(this,arguments)+" im-join-manager"},b.prototype.title=function(){return e.getText("joins.Heading")},b.prototype.dismissAction=function(){return e.getText("Cancel")},b.prototype.primaryAction=function(){return e.getText("modal.ApplyChanges")},b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this.joins=d.fromQuery(this.query),this.listenTo(this.joins,"change:style",this.setDisabled)},b.prototype.initState=function(){return this.state.set({disabled:!0})},b.prototype.act=function(){var a;if(!this.state.get("disabled"))return a=this.joins.getJoins(),this.query.joins=a,this.query.trigger("change:joins",a),this.resolve(a)},b.prototype.setDisabled=function(){var a,b,c,d;return a=h.keys(this.joins.getJoins()),b=function(){var a,b;a=this.query.joins,b=[];for(c in a)"OUTER"===(d=a[c])&&b.push(c);return b}.call(this),a.sort(),b.sort(),this.state.set({disabled:g(a,b)})},b.prototype.postRender=function(){var a;return b.__super__.postRender.apply(this,arguments),a=this.$(".modal-body"),this.renderChild("cons",new c({collection:this.joins}),a)},b}(f)}).call(this)},{"../core-view":3,"../messages":16,"../messages/joins":23,"../models/joins":47,"./join-manager/body":177,"./modal":197,underscore:310}],177:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k={}.hasOwnProperty,l=function(a,b){function c(){this.constructor=a}for(var d in b)k.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};j=a("underscore"),e=a("../../core-view"),h=a("../../templates"),d=a("../../utils/css-class-set"),a("../../messages/joins"),g=["join-style","column-manager-path-name","clear"],c=function(a){function b(a,c){b.__super__.constructor.call(this,{"btn btn-default":!0,active:function(){return c===a.get("style")}})}return l(b,a),b}(d),i=function(a){switch(a){case"INNER":return"OUTER";case"OUTER":default:return"INNER"}},f=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return l(b,a),b.prototype.tagName="li",b.prototype.className="list-group-item",b.prototype.template=h.templateFromParts(g),b.prototype.modelEvents=function(){return{"change:style change:parts":this.reRender}},b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this.classSets={innerJoinBtn:new c(this.model,"INNER"),outerJoinBtn:new c(this.model,"OUTER")}},b.prototype.getData=function(){return j.extend(b.__super__.getData.apply(this,arguments),this.classSets)},b.prototype.events=function(){return{"click button":this.onButtonClick}},b.prototype.onButtonClick=function(a){if(!/active/.test(a.target.className))return this.model.swap("style",i)},b}(e),b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return l(b,a),b.prototype.template=h.template("join-manager-body"),b.prototype.initState=function(){return this.state.set({explaining:!1})},b.prototype.postRender=function(){return this.$group=this.$(".list-group"),this.collection.each(function(a){return function(b){return a.addJoin(b)}}(this))},b.prototype.addJoin=function(a){if(this.rendered)return this.renderChild(a.id,new f({model:a}),this.$group)},b.prototype.removeJoin=function(a){return this.removeChild(a.id)},b.prototype.events=function(){return{"click .alert-info strong":function(){return this.state.toggle("explaining")}}},b.prototype.stateEvents=function(){return{"change:explaining":this.onChangeExplaining}},b.prototype.collectionEvents=function(){return{add:this.addJoin,remove:this.removeJoin,sort:this.reRender}},b.prototype.onChangeExplaining=function(){var a,b;if(this.rendered)return b=this.$(".alert-info p"),a=this.state.get("explaining")?"slideDown":"slideUp",b[a]()},b}(e)}).call(this)},{"../../core-view":3,"../../messages/joins":23,"../../templates":67,"../../utils/css-class-set":79,underscore:310}],178:[function(a,b,c){(function(){var c,d,e={}.hasOwnProperty,f=function(a,b){function c(){this.constructor=a}for(var d in b)e.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};d=a("../query-dialogue-button"),c=a("../join-manager"),a("../../messages/joins"),b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return f(b,a),b.prototype.className="im-join-manager-button",b.prototype.longLabel="joins.Manage",b.prototype.shortLabel="joins.ManageShort",b.prototype.icon="Joins",b.prototype.Dialogue=c,b}(d)}).call(this)},{"../../messages/joins":23,"../join-manager":176,"../query-dialogue-button":206}],179:[function(a,b,c){(function(){var c,d={}.hasOwnProperty,e=function(a,b){function c(){this.constructor=a}for(var e in b)d.call(b,e)&&(a[e]=b[e]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};c=a("../core-view"),b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return e(b,a),b.prototype.RERENDER_EVENT="change",b.prototype.tagName="span",b}(c)}).call(this)},{"../core-view":3}],180:[function(a,b,c){(function(){var c,d,e={}.hasOwnProperty,f=function(a,b){function c(){this.constructor=a}for(var d in b)e.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};a("es6-promise").Promise,c=a("./base-append-dialogue"),d=a("./from-path-mixin"),b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return f(b,a),b.include(d(c)),b}(c)}).call(this)},{"./base-append-dialogue":183,"./from-path-mixin":189,"es6-promise":257}],181:[function(a,b,c){(function(){var c,d,e,f={}.hasOwnProperty,g=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};a("es6-promise").Promise,c=a("./base-append-dialogue"),d=a("../../mixins/floating-dialogue"),e=a("./from-selection-mixin"),b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return g(b,a),b.include(d),b.include(e(c)),b}(c)}).call(this)},{"../../mixins/floating-dialogue":30,"./base-append-dialogue":183,"./from-selection-mixin":190,"es6-promise":257}],182:[function(a,b,c){(function(){var c,d,e={}.hasOwnProperty,f=function(a,b){function c(){this.constructor=a}for(var d in b)e.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};a("underscore"),c=a("../../core-view"),a("../../templates"),a("../../messages"),d=a("../../core/select-with-label"),a("../../messages/lists"),b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return f(b,a),b.prototype.parameters=["model","collection"],b.prototype.postRender=function(){return this.renderListSelector()},b.prototype.renderListSelector=function(){var a;return a=new d({model:this.model,collection:this.collection,attr:"target",label:"lists.params.Target",optionLabel:"lists.PossibleAppendTarget",helpMessage:"lists.params.help.Target",noOptionsMessage:"lists.append.NoSuitableLists",getProblem:function(a){return!(null!=a?a.length:void 0)}}),this.listenTo(a.state,"change:error",console.error.bind(console)),this.renderChild("list-selector",a)},b}(c)}).call(this)},{"../../core-view":3,"../../core/select-with-label":9,"../../messages":16,"../../messages/lists":24,"../../templates":67,underscore:310}],183:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t={}.hasOwnProperty,u=function(a,b){function c(){this.constructor=a}for(var d in b)t.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};s=a("underscore"),n=a("es6-promise").Promise,f=a("../../core/collection"),g=a("../../core-model"),i=a("../../messages"),e=a("./base-dialogue"),c=a("./append-to-list-body"),d=a("../../models/append-to-list"),j={key:"lists.NoSuitableLists",level:"Warning",cannotDismiss:!0},h={key:"lists.TargetNotCorrectType",level:"Error",cannotDismiss:!0},o={key:"lists.TargetDoesNotExist",level:"Error",cannotDismiss:!0},k={key:"lists.NoTargetSelected",level:"Info",cannotDismiss:!0},q=function(a){return function(b){if(!a.isa(b.type))return n.reject(h)}},p=function(a){return s.where(a,{status:"CURRENT"})},r=function(a){var b,c,d,e,f,g,h;for(h=[],e=0,f=a.length;e<f;e++)g=a[e],b=g.name,d=g.type,c=g.size,h.push({name:b,type:d,size:c,id:b});return h},l=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return u(b,a),b.prototype.defaults=function(){return{typeName:null,name:null,size:0}},b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this.fetchTypeName()},b.prototype.fetchTypeName=function(){var a,b;return a=this.collection.service,b=this.get("type"),a.fetchModel().then(function(a){return a.makePath(b)}).then(function(a){return a.getDisplayName()}).then(function(a){return function(b){return a.set({typeName:b})}}(this))},b}(g),m=function(a){function b(a){this.service=a.service,b.__super__.constructor.call(this)}return u(b,a),b.prototype.model=l,b}(f),b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return u(b,a),b.prototype.Body=c,b.prototype.Model=d,b.prototype.title=function(){return i.getText("lists.AppendToListTitle",this.getData())},b.prototype.primaryAction=function(){return i.getText("lists.Append")},b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this.listenTo(this.getPossibleLists(),"remove reset",this.verifyState),this.listenTo(this.getPossibleLists(),"add reset",this.setTargetIfOnlyOne)},b.prototype.getPossibleLists=function(){return null!=this.possibleLists?this.possibleLists:this.possibleLists=new m({service:this.getService()})},b.prototype.processQuery=function(a){return a.appendToList(this.model.get("target"))},b.prototype.modelEvents=function(){return s.extend(b.__super__.modelEvents.apply(this,arguments),{"change:target":"onChangeTarget"})},b.prototype.initState=function(){return b.__super__.initState.apply(this,arguments),this.fetchSuitableLists(),this.verifyState()},b.prototype.checkThereAreLists=function(){if(!this.getPossibleLists().size())return this.state.set({error:j})},b.prototype.onChangeTarget=function(){return this.setTitle(),this.verifyState()},b.prototype.verifyState=function(){return this.state.unset("error"),this.checkThereAreLists(),this.verifyTarget(),this.verifyTargetExistsAndIsSuitable()},b.prototype.setTargetIfOnlyOne=function(){var a;if(a=this.getPossibleLists(),1===a.length)return this.model.set({target:a.at(0).get("name")})},b.prototype.verifyTarget=function(){if(!this.model.get("target"))return this.state.set({error:k})},b.prototype.onChangeType=function(){return b.__super__.onChangeType.apply(this,arguments),this.fetchSuitableLists()},b.prototype.getBodyOptions=function(){return s.extend(b.__super__.getBodyOptions.apply(this,arguments),{collection:this.getPossibleLists()})},b.prototype.verifyTargetExistsAndIsSuitable=function(){var a,b,c;if(null!=(c=this.getType())&&null!=(b=this.model.get("target")))return a=c.model.makePath(c.name),this.getService().fetchList(b).then(q(a),function(){return o}).then(null,function(a){return function(b){return a.state.set({error:b})}}(this))},b.prototype.fetchSuitableLists=function(){var a,b;return null==(b=this.getType())?this.getPossibleLists().reset():(a=b.model.makePath(b.name),this.getService().fetchLists().then(function(b){return s.filter(b,function(b){return a.isa(b.type)})}).then(p).then(r).then(function(a){return function(b){return a.getPossibleLists().reset(b)}}(this)).then(null,function(a){return function(b){return a.state.set({error:b})}}(this)))},b}(e)}).call(this)},{"../../core-model":2,"../../core/collection":5,"../../messages":16,"../../models/append-to-list":35,"./append-to-list-body":182,"./base-dialogue":184,"es6-promise":257,underscore:310}],184:[function(a,b,c){(function(){var c,d,e,f,g,h,i={}.hasOwnProperty,j=function(a,b){function c(){this.constructor=a}for(var d in b)i.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};h=a("underscore"),g=a("../modal"),f=a("../../messages"),d=a("../../models/create-list"),e=a("./body"),a("../../messages/lists"),c=function(){throw new Error("not implemented")},b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return j(b,a),b.prototype.getQuery=c,b.prototype.fetchCount=c,b.prototype.getType=c,b.prototype.getService=function(){return c},b.prototype.Model=d,b.prototype.Body=e,b.prototype.className=function(){return b.__super__.className.apply(this,arguments)+" im-list-dialogue im-create-list"},b.prototype.title=function(){return f.getText("lists.CreateListTitle",this.getData())},b.prototype.primaryAction=function(){return f.getText("lists.Create")},b.prototype.act=function(){return this.getQuery().then(function(a){return function(b){return a.processQuery(b)}}(this)).then(this.resolve,function(a){return function(b){return a.state.set({error:b})}}(this))},b.prototype.verifyState=function(){return this.state.set({error:null})},b.prototype.processQuery=function(a){return a.saveAsList(this.model.toJSON())},b.prototype.modelEvents=function(){return{"change:type":"onChangeType"}},b.prototype.onChangeType=function(){return this.setTypeName()},b.prototype.stateEvents=function(){return{"change:typeName change:count":"setTitle","change:typeName":"setListName","change:error":function(){return console.log(this.state.get("error"))}}},b.prototype.setTitle=function(){return this.$(".modal-title").text(this.title())},b.prototype.setListName=function(){return this.model.set({name:f.getText("lists.DefaultName",this.state.toJSON())})},b.prototype.initState=function(){return this.state.set({existingLists:{},minimised:h.result(this,"initiallyMinimised")}),this.setTypeName(),this.setCount(),this.checkAuth(),this.getService().fetchLists().then(function(a){return h.where(a,{authorized:!0})}).then(function(a){return h.groupBy(a,"name")}).then(function(a){return function(b){return a.state.set({existingLists:b})}}(this))},b.prototype.setCount=function(){return this.fetchCount().then(function(a){return function(b){return a.state.set({count:b})}}(this)).then(null,function(a){return function(b){return a.state.set({error:b})}}(this))},b.prototype.setTypeName=function(){var a;return null!=(a=this.getType())?a.getDisplayName().then(function(a){return function(b){return a.state.set({typeName:b})}}(this)).then(null,function(a){return function(b){return a.state.set({error:b})}}(this)):void 0},b.prototype.checkAuth=function(){return this.getService().whoami().then(null,function(a){return function(){return a.state.set({error:{level:"Error",key:"lists.error.MustBeLoggedIn"}})}}(this))},b.prototype.getBodyOptions=function(){return{model:this.model,state:this.state}},b.prototype.postRender=function(){return b.__super__.postRender.apply(this,arguments),this.renderChild("body",new this.Body(this.getBodyOptions()),this.$(".modal-body"))},b}(g)}).call(this)},{"../../messages":16,"../../messages/lists":24,"../../models/create-list":41,"../modal":197,"./body":185,underscore:310}],185:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l={}.hasOwnProperty,m=function(a,b){function c(){this.constructor=a}for(var d in b)l.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};k=a("underscore"),c=a("../../core-view"),j=a("../../templates"),h=a("../../messages"),d=a("../../models/create-list"),f=a("../../core/input-with-label"),e=a("../../core/input-with-button"),g=a("./tag"),i=a("./tags-apology"),a("../../messages/lists"),b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return m(b,a),b.prototype.Model=d,b.prototype.template=j.template("list-dialogue-body"),b.prototype.getData=function(){return k.extend(b.__super__.getData.apply(this,arguments))},b.prototype.modelEvents=function(){return{"add:tag":"addTag"}},b.prototype.stateEvents=function(){return{"change:minimised":"toggleOptionalAttributes"}},b.prototype.events=function(){return{"click .im-more-options":function(a){return function(){return a.state.toggle("minimised")}}(this)}},b.prototype.$tags=null,b.prototype.postRender=function(){return this.renderListNameInput(),this.renderListDescInput(),this.renderTags()},b.prototype.renderTags=function(){return this.$tags=this.$(".im-active-tags"),this.addTags(),this.renderApology(),this.renderTagAdder()},b.prototype.renderTagAdder=function(){var a;return a=new e({model:this.model,placeholder:"lists.AddTag",button:"lists.AddTagBtn",sets:"nextTag"}),this.listenTo(a,"act",this.addNextTag),this.renderChildAt(".im-next-tag",a)},b.prototype.addTags=function(){return this.model.tags.each(function(a){return function(b){return a.addTag(b)}}(this))},b.prototype.addTag=function(a){if(this.rendered)return this.renderChild("tag-"+a.get("id"),new g({model:a}),this.$tags)},b.prototype.toggleOptionalAttributes=function(){var a,b,c;return c=this.state.toJSON(),a=this.$(".im-optional-attributes"),c.minimised?a.slideUp():a.slideDown(),b=h.getText("lists.ShowExtraOptions",c),this.$(".im-more-options .msg").text(b)},b.prototype.renderApology=function(){return this.renderChildAt(".im-apology",new i({collection:this.model.tags}))},b.prototype.renderListNameInput=function(){var a;return a=new f({model:this.model,attr:"name",label:"lists.params.Name",helpMessage:"lists.params.help.Name",placeholder:"lists.params.NamePlaceholder",getProblem:function(a){return function(b){return a.validateName(b)}}(this)}),this.listenTo(a.state,"change:problem",function(){var b;return b=a.state.get("problem"),this.state.set({disabled:!!b})}),this.renderChildAt(".im-list-name",a)},b.prototype.validateName=function(a){var b;return!(b=null!=a?a.replace(/(^\s+|\s+$)/g,""):void 0)||this.state.get("existingLists")[b]},b.prototype.renderListDescInput=function(){return this.renderChildAt(".im-list-desc",new f({model:this.model,attr:"description",label:"lists.params.Desc",placeholder:"lists.params.DescPlaceholder"}))},b.prototype.addNextTag=function(){return this.model.addTag()},b}(c)}).call(this)},{"../../core-view":3,"../../core/input-with-button":6,"../../core/input-with-label":7,"../../messages":16,"../../messages/lists":24,"../../models/create-list":41,"../../templates":67,"./tag":191,"./tags-apology":192,underscore:310}],186:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q={}.hasOwnProperty,r=function(a,b){function c(){this.constructor=a}for(var d in b)q.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};p=a("underscore"),h=a("../../core-view"),g=a("../../core-model"),f=a("../../core/collection"),o=a("../../templates"),e=a("../../utils/css-class-set"),i=a("../../utils/count-executor"),l=a("../../models/path"),d=a("./append-from-selection"),k=a("./create-from-selection"),c=a("./append-from-path"),j=a("./create-from-path"),a("../../messages/lists"),m=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return r(b,a),b.prototype.model=l,b}(f),n=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return r(b,a),b.prototype.parameters=["query","model","showDialogue","highLight"],b.prototype.tagName="li",b.prototype.modelEvents=function(){return{"change:displayName change:typeName":this.reRender}},b.prototype.stateEvents=function(){return{"change:count":this.reRender}},b.prototype.Model=l,b.prototype.template=o.template("list-dialogue-button-node"),b.prototype.events=function(){return{click:this.openDialogue,"mouseenter a":function(){return p.defer(function(a){return function(){return a.highLight(a.model.get("path"))}}(this))},"mouseout a":function(){return this.highLight(null)}}},b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this.query.summarise(this.model.get("id")).then(function(a){return function(b){var c;return c=b.stats,a.state.set({count:c.uniqueValues})}}(this))},b.prototype.openDialogue=function(){var a;return a={query:this.query,path:this.model.get("id")},this.showDialogue(a)},b}(h),b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return r(b,a),b.prototype.tagName="div",b.prototype.className="btn-group list-dialogue-button",b.prototype.template=o.template("list-dialogue-button"),b.prototype.parameters=["query","selected"],b.prototype.optionalParameters=["tableState"],b.prototype.tableState=new g,b.prototype.initState=function(){return this.state.set({action:"create",authenticated:!1,disabled:!1})},b.prototype.stateEvents=function(){return{"change:action":this.setActionButtonState,"change:authenticated":this.setVisible,"change:disabled":this.onChangeDisabled}},b.prototype.events=function(){return{"click .im-create-action":this.setActionIsCreate,"click .im-append-action":this.setActionIsAppend,"click .im-pick-items":this.startPicking}},b.prototype.initialize=function(){
return b.__super__.initialize.apply(this,arguments),this.initBtnClasses(),this.paths=new m,this.query.getQueryNodes().reverse().forEach(function(a){return function(b){return a.paths.add(new l(b))}}(this)),this.query.service.whoami().then(function(a){return function(b){return a.state.set({authenticated:!!b})}}(this)),i.count(this.query).then(function(a){return function(b){return a.state.set({disabled:0===b})}}(this)).then(null,function(a){return function(b){return a.state.set({disabled:!0,error:b})}}(this))},b.prototype.getData=function(){return p.extend(b.__super__.getData.apply(this,arguments),this.classSets,{paths:this.paths.toJSON()})},b.prototype.postRender=function(){var a,b,c;return this.setVisible(),this.onChangeDisabled(),b=this.$(".dropdown-menu"),a=function(a){return function(b){return a.tableState.set({highlitNode:b})}}(this),c=function(a){return function(b){return a.showPathDialogue(b)}}(this),this.paths.each(function(d){return function(e,f){var g;return g=new n({query:d.query,model:e,showDialogue:c,highLight:a}),d.renderChild("path-"+f,g,b,"prepend")}}(this))},b.prototype.onChangeDisabled=function(){return this.$(".btn").toggleClass("disabled",this.state.get("disabled"))},b.prototype.setVisible=function(){return this.$el.toggleClass("im-hidden",!this.state.get("authenticated"))},b.prototype.setActionIsCreate=function(a){return a.stopPropagation(),a.preventDefault(),this.state.set({action:"create"})},b.prototype.setActionIsAppend=function(a){return a.stopPropagation(),a.preventDefault(),this.state.set({action:"append"})},b.prototype.showDialogue=function(a,b){var c,d,e;return d=new a(b),this.renderChild("dialogue",d),c=this.state.get("action"),e=function(a){return function(b){return function(d){return a.trigger(b+":"+c,d),a.trigger(b,c,d)}}}(this),d.show().then(e("success"),e("failure"))},b.prototype.showPathDialogue=function(a){var b,d;return d=this.state.get("action"),b=function(){switch(d){case"append":return c;case"create":return j;default:throw new Error("Unknown action: "+d)}}(),this.showDialogue(b,a)},b.prototype.startPicking=function(){var a,b,c,e;return b=this.state.get("action"),c={collection:this.selected,service:this.query.service},a=function(){switch(b){case"append":return d;case"create":return k;default:throw new Error("Unknown action: "+b)}}(),this.tableState.set({selecting:!0}),e=function(a){return function(){return a.tableState.set({selecting:!1}),a.selected.reset()}}(this),this.showDialogue(a,c).then(e,e)},b.prototype.setActionButtonState=function(){var a;return a=this.state.get("action"),this.$(".im-create-action").toggleClass("active","create"===a),this.$(".im-append-action").toggleClass("active","append"===a)},b.prototype.initBtnClasses=function(){return this.classSets={},this.classSets.createBtnClasses=new e({"im-create-action":!0,"btn btn-default":!0,active:function(a){return function(){return"create"===a.state.get("action")}}(this)}),this.classSets.appendBtnClasses=new e({"im-append-action":!0,"btn btn-default":!0,active:function(a){return function(){return"append"===a.state.get("action")}}(this)})},b}(h)}).call(this)},{"../../core-model":2,"../../core-view":3,"../../core/collection":5,"../../messages/lists":24,"../../models/path":56,"../../templates":67,"../../utils/count-executor":77,"../../utils/css-class-set":79,"./append-from-path":180,"./append-from-selection":181,"./create-from-path":187,"./create-from-selection":188,underscore:310}],187:[function(a,b,c){(function(){var c,d,e={}.hasOwnProperty,f=function(a,b){function c(){this.constructor=a}for(var d in b)e.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};a("es6-promise").Promise,c=a("./base-dialogue"),d=a("./from-path-mixin"),b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return f(b,a),b.include(d(c)),b}(c)}).call(this)},{"./base-dialogue":184,"./from-path-mixin":189,"es6-promise":257}],188:[function(a,b,c){(function(){var c,d,e,f={}.hasOwnProperty,g=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};a("underscore"),a("es6-promise").Promise,c=a("./base-dialogue"),d=a("../../mixins/floating-dialogue"),e=a("./from-selection-mixin"),b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return g(b,a),b.include(d),b.include(e(c)),b}(c)}).call(this)},{"../../mixins/floating-dialogue":30,"./base-dialogue":184,"./from-selection-mixin":190,"es6-promise":257,underscore:310}],189:[function(a,b,c){(function(){var c;c=a("es6-promise").Promise,b.exports=function(a){return{parameters:["query","path"],className:function(){return a.prototype.className.call(this)+" im-from-path"},getQuery:function(){return c.resolve(this.query.selectPreservingImpliedConstraints([this.path]))},fetchCount:function(){return this.query.summarise(this.path).then(function(a){return a.stats.uniqueValues})},getType:function(){return this.query.makePath(this.path).getParent().getType()},getService:function(){return this.query.service}}}}).call(this)},{"es6-promise":257}],190:[function(a,b,c){(function(){var c,d,e,f;e=a("../../models/selected-objects"),f=a("../../core/type-assertions"),c={level:"Error",key:"lists.NoCommonType",cannotDismiss:!0},d={level:"Info",key:"lists.NoObjectsSelected",cannotDismiss:!0},b.exports=function(a){return{parameters:["service","collection"],parameterTypes:{collection:f.InstanceOf(e,"SelectedObjects")},className:function(){return a.prototype.className.call(this)+" im-list-picker"},getQuery:function(){return this.service.query({from:this.model.get("type"),select:["id"],where:[{path:this.model.get("type"),op:"IN",ids:this.getIds()}]})},fetchCount:function(){return Promise.resolve(this.collection.size())},getType:function(){var a;if(this.model.get("type"))return null!=(a=this.schema)?a.makePath(this.model.get("type")).getType():void 0},getService:function(){return this.service},collectionEvents:function(){return{"change:commonType change:typeName":this.setType,"add remove":this.setCount}},initiallyMinimised:!0,getIds:function(){return this.collection.map(function(a){return a.get("id")})},onChangeType:function(){return a.prototype.onChangeType.call(this),this.verifyState()},verifyState:function(){var b;return null!=(b=a.prototype.verifyState)&&b.call(this),this.collection.size()?this.model.get("type")?void 0:this.state.set({error:c}):this.state.set({error:d})},setType:function(){return this.model.set({type:this.collection.state.get("commonType")}),this.state.set({typeName:this.collection.state.get("typeName")})}}}}).call(this)},{"../../core/type-assertions":10,"../../models/selected-objects":58}],191:[function(a,b,c){(function(){var c,d,e={}.hasOwnProperty,f=function(a,b){function c(){this.constructor=a}for(var d in b)e.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};c=a("../../core-view"),d=a("../../templates"),b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return f(b,a),b.prototype.className="im-list-tag label label-primary",b.prototype.template=d.template("list-tag"),b.prototype.events=function(){return{"click .im-remove":"removeAndDestroy"}},b.prototype.postRender=function(){return this.activateTooltip()},b.prototype.activateTooltip=function(){return this.$("[title]").tooltip()},b.prototype.removeAndDestroy=function(){return this.model.collection.remove(this.model),this.model.destroy(),this.$el.fadeOut(400,function(a){return function(){return a.remove()}}(this))},b}(c)}).call(this)},{"../../core-view":3,"../../templates":67}],192:[function(a,b,c){(function(){var c,d,e,f={}.hasOwnProperty,g=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};e=a("underscore"),c=a("../../core-view"),d=a("../../templates"),a("../../messages/lists"),b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return g(b,a),b.prototype.collectionEvents=function(){return{"add remove reset":this.reRender}},b.prototype.template=d.template("list-tags-apology"),b.prototype.getData=function(){return e.extend(b.__super__.getData.apply(this,arguments),{hasTags:this.collection.size()})},b}(c)}).call(this)},{"../../core-view":3,"../../messages/lists":24,"../../templates":67,underscore:310}],193:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l,m={}.hasOwnProperty,n=function(a,b){function c(){this.constructor=a}for(var d in b)m.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};l=a("underscore"),d=a("es6-promise").Promise,c=a("../messages"),e=a("../core-view"),c.set({"convalue.BadType":"<%- name %> is of the wrong type (<%- type %>).","convalue.EmptyList":"<%- name %> is empty. This query will always return 0 results","convalue.BadList":'You do not have access to list called "<%- name %>". Choose one from the list.'}),h=a("../templates/helpers"),a("../templates/mustache-settings"),i="<% if (suitableLists.length) { %>\n    <%= select(suitableLists, isSelected, 'span7 im-value-options im-con-value im-con-value-list form-control', formatList, getOptionValue) %>\n<% } else { %>\n    <%- messages.getText('conbuilder.NoSuitableLists') %>\n<% } %>\n",j=l.template(i),g=function(a){return a.name},f=function(a){return a.size?a.name+" ("+a.size+" "+a.typeName+"s)":a.name},k=function(a){return function(b){var c;return c=a.makePath(b.type),c.getDisplayName().then(function(a){return l.extend(b,{typeName:a})})}},b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return n(b,a),b.prototype.className="im-list-value-controls",b.prototype.initialize=function(a){return this.query=a.query,b.__super__.initialize.apply(this,arguments),this.initialValue=this.model.get("value"),this.path=this.model.get("path"),this.setSuitableLists(),this.listenTo(this.model,"change",this.reRender),this.listenTo(this.model,"change:value",this.checkCurrentValue),this.checkCurrentValue()},b.prototype.checkCurrentValue=function(){var a,b,d;return d=this.model.get("value"),a=function(a){return function(b){return a.model.set({error:new Error(c.getText("convalue.BadList",{name:d}))}),a.listenToOnce(a.model,"change:value",function(){return a.model.unset("error")})}}(this),b=function(a){var b;if(null!=(b=a.size?this.path.isa(a.type)?void 0:"convalue.BadType":"convalue.EmptyList"))return this.model.set({error:new Error(c.getText(b,a))}),this.listenToOnce(this.model,"change:value",function(a){return function(){return a.model.unset("error")}}(this))},this.query.service.fetchList(d).then(b,a)},b.prototype.events=function(){return{"change select":"setList"}},b.prototype.setList=function(){return this.model.set({value:this.$("select").val()})},b.prototype.setSuitableLists=function(){var a,b;if(!this.model.has("suitableLists"))return b=function(a){return function(b){return a.model.set({suitableLists:b})}}(this),a=function(a){return function(b){return a.model.set({error:b})}}(this),this.fetchSuitableLists().then(b,a)},b.prototype.fetchSuitableLists=function(){return null!=this.__suitable_lists?this.__suitable_lists:this.__suitable_lists=this.query.service.fetchLists().then(function(a){return function(b){var c,e;return e=function(){var a,d,e;for(e=[],a=0,d=b.length;a<d;a++)c=b[a],c.size&&this.path.isa(c.type)&&e.push(c);return e}.call(a),d.all(e.map(k(a.query.model)))}}(this))},b.prototype.getSuitableLists=function(){var a,b,c;return a={name:this.initialValue},c=this.model.get("suitableLists")||[],b=l.findWhere(c,a),null==b&&(b=a),l.uniq([b].concat(c),!1,"name")},b.prototype.template=function(a){return a=l.extend({formatList:f,getOptionValue:g,messages:c},h,a),j(a)},b.prototype.getData=function(){var a,b,c;return a=this.model.get("value"),c=this.getSuitableLists(),b=function(b){return b.name===a},{suitableLists:c,isSelected:b}},b}(e)}).call(this)},{"../core-view":3,"../messages":16,"../templates/helpers":68,"../templates/mustache-settings":69,"es6-promise":257,underscore:310}],194:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j={}.hasOwnProperty,k=function(a,b){function c(){this.constructor=a}for(var d in b)j.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};i=a("underscore"),e=a("es6-promise").Promise,f=a("../utils/suggestion-source"),d=a("../messages"),c=a("./attribute-value-controls"),g='<label class="im-value-options">\n    <%- messages.getText(\'conbuilder.ExtraLabel\') %>\n    <input type="text" class="im-extra-value form-control"\n            placeholder="<%- state.extraPlaceholder %>"\n            value="<%- con.extraValue %>">\n</label>\n\n',h=i.template(g),b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return k(b,a),b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this.state.set({extraPlaceholder:d.get("conbuilder.ExtraPlaceholder")}),this.listenTo(this.branding,"change:defaults.extraValue.path",this.reRender),this.listenTo(this.branding,"change:defaults.extraValue.value",function(){return this.state.set({extraPlaceholder:this.branding.get("defaults.extraValue.value")})}),this.listenTo(this.model,"change",this.reRender)},b.prototype.stateEvents=function(){return i.extend(b.__super__.stateEvents.apply(this,arguments),{"change:extraPlaceholder":this.reRender})},b.prototype.template=function(a){return b.__super__.template.apply(this,arguments)+h(a)},b.prototype.events=function(){return{"change .im-con-value-attr":"setValue","change .im-extra-value":"setExtraValue"}},b.prototype.setExtraValue=function(){var a,b;return a=this.$("input.im-extra-value.tt-input"),a.length||(a=this.$("input.im-extra-value")),b=a.val(),b?this.model.set({extraValue:b}):this.model.unset("extraValue")},b.prototype.setValue=function(){var a,b;return a=this.$("input.im-con-value.tt-input"),a.length||(a=this.$("input.im-con-value")),b=a.val(),b?this.model.set({value:b}):this.model.unset("value")},b.prototype.setBoth=function(){return this.setValue(),this.setExtraValue()},b.prototype.suggestExtra=function(){var a,b,c,d,f;return b=this.branding.get("defaults.extraValue.path"),f=this.branding.get("defaults.extraValue.extraFor"),null!=b&&this.model.get("path").isa(f)?(d=this.model.get("path")+"."+b,c=null!=this.__extra_suggestions?this.__extra_suggestions:this.__extra_suggestions=this.query.summarise(d),a=this.handleSuggestionSet.bind(this,this.$("input.im-extra-value"),"extraValue"),c.then(function(a){return a.results}).then(a)):e.resolve(!0)},b.prototype.suggestValue=function(){var a,b,c,d,f;return d=this.model.get("path"),f=this.query.service,a=d.getEndClass().name,b=f.fetchClassKeys().then(function(b){return b[a]}),null==this.__value_suggestions&&(this.__value_suggestions=b.then(function(a){return function(b){var c,f;return(null!=b?b.length:void 0)?(f=function(){var a,e,f;for(f=[],a=0,e=b.length;a<e;a++)c=b[a],f.push(this.query.summarise(d+c.replace(/^[^\.]+/,"")));return f}.call(a),e.all(f).then(function(a){return a.reduce(function(a,b){return a.concat(b.results)},[])})):[]}}(this))),c=this.handleSuggestionSet.bind(this,this.$("input.im-con-value-attr"),"value"),this.__value_suggestions.then(c)},b.prototype.handleSuggestionSet=function(a,b,c){var d,e,g,h,i,j;if(0!==(j=c.length))return i=new f(c,j),h={minLength:0,highlight:!0},d={name:b+"_suggestions",source:i.suggest,displayKey:"item",templates:{footer:i.tooMany}},e=function(a){return function(c){return function(c,d){return a.model.set(b,d.item)}}}(this),g=c[0].item,this.activateTypeahead(a,h,d,g,e(a),function(a){return function(){return a.setBoth()}}(this))},b.prototype.provideSuggestions=function(){var a,b;return this.removeTypeAheads(),b=this.suggestValue(),a=this.suggestExtra(),e.all([a,b])},b.prototype.remove=function(){return b.__super__.remove.apply(this,arguments),this.branding.destroy()},b}(c)}).call(this)},{"../messages":16,"../utils/suggestion-source":107,"./attribute-value-controls":113,"es6-promise":257,underscore:310}],195:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l={}.hasOwnProperty,m=function(a,b){function c(){this.constructor=a}for(var d in b)l.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};k=a("underscore"),d=a("es6-promise").Promise,c=a("../messages"),e=a("../core-view"),f=a("../templates/helpers"),a("../templates/mustache-settings"),i=a("../utils/to-named-path"),g="<% if (candidateLoops.length) { %>\n    <%= select(candidateLoops, isSelected, 'form-control im-value-options im-con-value') %>\n<% } else { %>\n    <%- messages.getText('conbuilder.NoSuitableLoops') %>\n<% } %>\n",h=k.template(g),j=function(a){var b,c;return c=a.path,b=a.name,{value:c.toString(),text:b}},b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return m(b,a),b.prototype.initialize=function(a){return this.query=a.query,b.__super__.initialize.apply(this,arguments),this.path=this.model.get("path"),this.type=this.path.getType(),this.setCandidateLoops(),this.listenTo(this.model,"change",this.reRender)},b.prototype.events=function(){return{"change select":"setLoop"}},b.prototype.setLoop=function(){return this.model.set({value:this.$("select").val()})},b.prototype.setCandidateLoops=function(){if(!this.model.has("candidateLoops"))return this.getCandidateLoops().then(function(a){return function(b){return a.model.set({candidateLoops:b})}}(this))},b.prototype.isSuitable=function(a){return(a.isa(this.type)||this.path.isa(a.getType()))&&this.path.toString()!==a.toString()},b.prototype.getCandidateLoops=function(){return null!=this.__candidate_loops?this.__candidate_loops:this.__candidate_loops=function(a){return function(){var b,c;return b=function(){var a,b,d,e;for(d=this.query.getQueryNodes(),e=[],a=0,b=d.length;a<b;a++)c=d[a],this.isSuitable(c)&&e.push(c);return e}.call(a),d.all(b.map(i))}}(this)()},b.prototype.template=function(a){return h(k.extend({messages:c},f,a))},b.prototype.getData=function(){var a,b,c,d;return c=this.model.get("value"),b=function(){var b,c,d,e;for(d=this.model.get("candidateLoops")||[],e=[],b=0,c=d.length;b<c;b++)a=d[b],e.push(j(a));return e}.call(this),d=function(a){return a.value===c},{candidateLoops:b,isSelected:d}},b}(e)}).call(this)},{"../core-view":3,"../messages":16,"../templates/helpers":68,"../templates/mustache-settings":69,"../utils/to-named-path":109,"es6-promise":257,underscore:310}],196:[function(a,b,c){(function(){var c,d,e,f={}.hasOwnProperty,g=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};e=a("underscore"),c=a("../core-view"),a("../templates"),d=function(){return{error:null,exportLink:null,disabled:!1,disabledReason:null}},b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return g(b,a),b.prototype.tagName="div",b.prototype.className="modal-footer",b.prototype.RERENDER_EVENT="change:error change:exportLink",b.prototype.parameters=["template","actionNames","actionIcons"],b.prototype.getData=function(){return e.extend(d(),this.actionNames,this.actionIcons,b.__super__.getData.apply(this,arguments))},b.prototype.postRender=function(){return this.$("[title]").tooltip()},b}(c)}).call(this)},{"../core-view":3,"../templates":67,underscore:310}],197:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j={}.hasOwnProperty,k=function(a,b){function c(){this.constructor=a}for(var d in b)j.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};e=a("es6-promise").Promise,i=a("underscore"),g=a("../core-view"),c=a("../messages"),f=a("../templates"),h=f.template("modal_base"),d=a("./modal-footer"),b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return k(b,a),b.prototype.className=function(){return"modal fade"},b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this._promise=new e(function(a){return function(b,c){a.resolve=b,a.reject=c}}(this)),this.listenTo(this.state,"change",this.renderFooter)},b.prototype.resolve=function(){throw new Error("resolved before initialisation")},b.prototype.reject=function(){throw new Error("rejected before initialisation")},b.prototype.dismissError=function(){return this.$(".modal-footer .alert").slideUp(250,function(a){return function(){return a.state.set({error:null})}}(this))},b.prototype.events=function(){return{"click .modal-footer .alert .dismiss":"dismissError","click .modal-footer .btn-cancel":"hide","click .modal-footer button.btn-primary":"act","hidden.bs.modal":"onHidden","click .close":"hide"}},b.prototype.promise=function(){return this._promise},b.prototype.hide=function(){return this.resolve("dismiss")},b.prototype.act=function(){throw new Error("Not implemented.")},b.prototype.primaryIcon=function(){return null},b.prototype.Footer=d,b.prototype.renderFooter=function(){var a,b,c,d;if(this.rendered)return a=i.result(this,"dismissAction"),c=i.result(this,"primaryAction"),d=i.result(this,"primaryIcon"),b={template:this.footer,model:this.state,actionNames:{dismissAction:a,primaryAction:c},actionIcons:{primaryIcon:d}},this.renderChild("footer",new this.Footer(b),this.$(".modal-content"))},b.prototype.postRender=function(){return this.renderFooter()},b.prototype.onHidden=function(a){return(null==a||a.target===this.el)&&(this.resolve("dismiss"),this.shown=!1,this.remove())},b.prototype.remove=function(){return this.reject(new Error("unresolved before removal")),this.shown?this._hideModal():b.__super__.remove.call(this)},b.prototype.title=function(){return c.getText("modal.DefaultTitle")},b.prototype.dismissAction=function(){return c.getText("modal.Dismiss")},b.prototype.primaryAction=function(){return c.getText("modal.OK")},b.prototype.modalSize=function(){},b.prototype.body=function(){},b.prototype.renderTitle=function(){if(this.rendered)return this.$(".modal-title").text(i.result(this,"title"))},b.prototype.footer=f.templateFromParts(["modal_error","modal_footer"]),b.prototype.template=function(a){var b,c,d;return d=i.result(this,"title"),b=this.body(a),c="modal-"+i.result(this,"modalSize"),h({title:d,body:b,modalSize:c})},b.prototype.shown=!1,b.prototype.show=function(){var a,b;b=this.promise(),b.then(function(a){return function(){return a.remove()}}(this),function(a){return function(){return a.remove()}}(this));try{this._showModal(),this.trigger("shown",this.shown=!0)}catch(b){a=b,this.reject(a)}return b},b.prototype._showModal=function(){return this.$el.modal().modal("show")},b.prototype._hideModal=function(){return this.$el.modal("hide")},b}(g)}).call(this)},{"../core-view":3,"../messages":16,"../templates":67,"./modal-footer":196,"es6-promise":257,underscore:310}],198:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l,n,o,p,q={}.hasOwnProperty,r=function(a,b){function c(){this.constructor=a}for(var d in b)q.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};p=a("underscore"),c=a("backbone").Collection,f=a("../messages"),h=a("../templates"),e=a("../icons"),l=a("../core-view"),g=a("../core-model"),c=a("../core/collection"),a("../options"),d=a("../patterns").IS_BLANK,n=a("../utils/events").ignore,f.setWithPrefix("multivalue",{AddValue:"Add value",AddValueShort:"+",SaveValue:"Save changes"}),o=a("../templates/mustache-settings"),j=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return r(b,a),b.prototype.defaults=function(){return{editing:!1,scratch:null,selected:!0}},b.prototype.idAttribute="value",b}(g),k=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return r(b,a),b.prototype.model=j,b}(c),i=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return r(b,a),b.prototype.Model=j,b.prototype.tagName="tr",b.prototype.initialize=function(){return this.model.set({editing:!1,scratch:this.model.get("value")}),this.listenTo(this.model,"change:editing change:value change:selected",this.reRender)},b.prototype.events=function(){return{"click .input-group":function(a){return null!=a?a.stopPropagation():void 0},"click .im-edit":"editValue","keyup input":"updateScratch","change input":"updateScratch","click .im-save":"saveValue","click .im-cancel":"cancelEditing",click:"toggleSelected"}},b.prototype.updateScratch=function(a){return n(a),this.model.set({scratch:a.target.value})},b.prototype.saveValue=function(a){return n(a),this.model.set({editing:!1,value:this.model.get("scratch")})},b.prototype.cancelEditing=function(a){return n(a),this.model.set({editing:!1,scratch:this.model.get("value")})},b.prototype.editValue=function(a){return n(a),this.model.toggle("editing")},b.prototype.toggleSelected=function(a){return n(a),this.model.toggle("selected")},b.prototype.getData=function(){return p.extend({icons:e,messages:f},this.model.toJSON())},b.prototype.template=h.template("value-control-row",o),b}(l),b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return r(b,a),b.prototype.className="im-value-options im-multi-value-table",b.prototype.initialize=function(){var a,c,d,e;for(b.__super__.initialize.apply(this,arguments),this.values=new k,e=this.model.get("values")||[],c=0,d=e.length;c<d;c++)a=e[c],this.values.add({value:a});return this.listenTo(this.values,"change:selected change:value add",this.updateModel),this.listenTo(this.values,"add",this.renderValue),this.listenTo(this.values,"remove",this.removeValue)},b.prototype.stateEvents=function(){return{"change:value":this.onChangeNewValue}},b.prototype.modelEvents=function(){return{"change:op":this.onChangeOp,"change:values":this.onChangeValues}},b.prototype.onChangeValues=function(){var a,b;if(null==this.model.previous("values"))return a=this.model.get("values"),this.values.set(function(){var c,d,e,f;for(e=null!=a?a:[],f=[],c=0,d=e.length;c<d;c++)b=e[c],f.push({value:b});return f}())},b.prototype.onChangeOp=function(){var a;if(("="===(a=this.model.get("op"))||"!="===a)&&!this.model.has("value"))return this.model.set({values:null,value:this.values.first().get("value")})},b.prototype.events=function(){return{"keyup .im-new-multi-value":this.updateNewValue,"click .im-add":this.addValue}},b.prototype.onChangeNewValue=function(){return this.$(".im-new-multi-value").val(this.state.get("value"))},b.prototype.updateNewValue=function(){return this.state.set({value:this.$(".im-new-multi-value").val()})},b.prototype.addValue=function(a){var b;return n(a),b=this.state.get("value"),null==b||d.test(b)?(this.model.set({error:new Error("please enter a value")}),this.listenToOnce(this.state,"change:value",function(a){return function(){return a.model.unset("error")}}(this))):(this.values.add({value:b}),this.state.unset("value"))},b.prototype.updateModel=function(){var a;return this.model.set({values:function(){var b,c,d,e;for(d=this.values.where({selected:!0}),e=[],b=0,c=d.length;b<c;b++)a=d[b],e.push(a.get("value"));return e}.call(this)})},b.prototype.getData=function(){return{messages:f}},b.prototype.template=h.template("add-value-control"),b.prototype.postRender=function(){return this.$table=this.$("table"),this.renderRows()},b.prototype.renderRows=function(){return this.values.each(function(a){return function(b){return a.renderValue(b)}}(this))},b.prototype.removeValue=function(){return this.removeChild(m.id)},b.prototype.renderValue=function(a){return this.renderChild(a.id,new i({model:a}),this.$table)},b.prototype.remove=function(){return this.values.close(),b.__super__.remove.apply(this,arguments)},b}(l)}).call(this)},{"../core-model":2,"../core-view":3,"../core/collection":5,"../icons":14,"../messages":16,"../options":63,"../patterns":64,"../templates":67,"../templates/mustache-settings":69,"../utils/events":81,backbone:236,underscore:310}],199:[function(a,b,c){(function(){var c,d,e={}.hasOwnProperty,f=function(a,b){function c(){this.constructor=a}for(var d in b)e.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};d=a("../messages"),c=a("./active-constraint"),d.set({"conbuilder.Apply":"Apply"}),b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return f(b,a),b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this.model.set({new:!0,op:this.model.get("path").isAttribute()?"=":"LOOKUP"}),this.state.set({editing:!0})},b.prototype.render=function(){return b.__super__.render.apply(this,arguments),this.$el.addClass("im-new"),this},b}(c)}).call(this)},{"../messages":16,"./active-constraint":112}],200:[function(a,b,c){(function(){var c,d,e,f,g={}.hasOwnProperty,h=function(a,b){function c(){this.constructor=a}for(var d in b)g.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};f=a("underscore"),e=a("./modal"),c=a("./constraint-adder"),a("../templates"),d=a("../messages"),b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return h(b,a),b.prototype.className=function(){return"im-constraint-dialogue "+b.__super__.className.apply(this,arguments)},b.prototype.modalSize="lg",b.prototype.initialize=function(a){return this.query=a.query,b.__super__.initialize.apply(this,arguments),this.listenTo(this.query,"change:constraints",this.resolve),this.listenTo(this.query,"editing-constraint",function(a){return function(){return a.$(".im-add-constraint").removeClass("disabled")}}(this))},b.prototype.events=function(){return f.extend(b.__super__.events.apply(this,arguments),{"click .im-add-constraint":"addConstraint",childremoved:function(a){return function(b,d){if(d instanceof c)return a.hide()}}(this)})},b.prototype.title=function(){return d.getText("constraints.AddNewFilter")},b.prototype.primaryAction=function(){return d.getText("constraints.AddFilter")},b.prototype.postRender=function(){var a,d;return d=this.$(".modal-footer"),a=this.$(".modal-body"),this.renderChild("adder",new c({buttonDelegate:d,query:this.query}),a),b.__super__.postRender.apply(this,arguments)},b}(e)}).call(this)},{"../messages":16,"../templates":67,"./constraint-adder":128,"./modal":197,underscore:310}],201:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k=function(a,b){return function(){return a.apply(b,arguments)}},l={}.hasOwnProperty,m=function(a,b){function c(){this.constructor=a}for(var d in b)l.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};j=a("underscore"),e=a("../options"),d=a("../core-view"),c=a("./pathtree/attribute"),h=a("./pathtree/root"),f=a("./pathtree/reference"),g=a("./pathtree/reverse-reference"),i=function(a,b){return a.append(b)},b.exports=function(a){function b(){return this.createSubFinder=k(this.createSubFinder,this),b.__super__.constructor.apply(this,arguments)}return m(b,a),b.prototype.parameters=["model","query","chosenPaths","openNodes","view","trail"],b.prototype.tagName="ul",b.prototype.className="im-path-chooser",b.prototype.initialize=function(){var a,c,d,e,f,g,h;for(b.__super__.initialize.apply(this,arguments),this.path=j.last(this.trail)||this.model.get("root")||this.query.makePath(this.query.root),this.cd=this.path.getEndClass(),e=i.bind(null,this.path),h=["attributes","references","collections"],f=0,g=h.length;f<g;f++)c=h[f],this[c]=function(){var b,f;b=this.cd[c],f=[];for(d in b)a=b[d],f.push(e(a));return f}.call(this);return this.listenTo(this.model,"change:allowRevRefs",this.render),this.listenTo(this.openNodes,"reset",this.render)},b.prototype.getDepth=function(){return this.trail.length},b.prototype.showRoot=function(){return 0===this.getDepth()&&this.model.get("canSelectReferences")},b.prototype.events=function(){return{scroll:this.onScroll}},b.prototype.onScroll=function(){var a,b;if(!this.state.get("ignoreScroll"))return b=this.el.scrollTop,
a=this.state.has("scroll")?Math.abs(this.state.get("scroll")-b):0,0!==b||a<50?this.state.set({scroll:b}):j.defer(function(a){return function(){return a.el.scrollTop=a.state.get("scroll")}}(this))},b.prototype.startIgnoringScroll=function(){return this.state.set({ignoreScroll:!0})},b.prototype.startListeningForScroll=function(){return this.state.has("scroll")&&(this.el.scrollTop=this.state.get("scroll")),this.state.set({ignoreScroll:!1})},b.prototype.preRender=function(){return this.startIgnoringScroll()},b.prototype.postRender=function(){var a,b,c,d,f,g,h,i,j,k,l;for(f=e.get("ShowId"),this.showRoot()&&(d=this.createRoot(),this.renderChild("root",d)),k=this.attributes,g=0,i=k.length;g<i;g++)b=k[g],(f||"id"!==b.end.name)&&(a=this.createAttribute(b),this.renderChild(b.toString(),a));for(l=this.references.concat(this.collections),h=0,j=l.length;h<j;h++)b=l[h],c=this.createReference(b),this.renderChild(b.toString(),c);return this.startListeningForScroll()},b.prototype.createRoot=function(){return new h({query:this.query,model:this.model,chosenPaths:this.chosenPaths,openNodes:this.openNodes,cd:this.cd})},b.prototype.createAttribute=function(a){return new c({model:this.model,chosenPaths:this.chosenPaths,view:this.view,query:this.query,trail:this.trail,path:a})},b.prototype.createReference=function(a){var b,c;return c=this.isLoop(a),b=this.model.get("allowRevRefs"),new(c&&!b?g:f)({model:this.model,chosenPaths:this.chosenPaths,query:this.query,trail:this.trail,path:a,view:this.view,openNodes:this.openNodes,createSubFinder:this.createSubFinder})},b.prototype.createSubFinder=function(a){return new b(j.extend({model:this.model,query:this.query,chosenPaths:this.chosenPaths,view:this.view,openNodes:this.openNodes},a))},b.prototype.isLoop=function(a){return!(null==a.end.reverseReference||!this.path.isReference()||!this.path.getParent().isa(a.end.referencedType)||this.path.end.name!==a.end.reverseReference)},b}(d)}).call(this)},{"../core-view":3,"../options":63,"./pathtree/attribute":202,"./pathtree/reference":203,"./pathtree/reverse-reference":204,"./pathtree/root":205,underscore:310}],202:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j={}.hasOwnProperty,k=function(a,b){function c(){this.constructor=a}for(var d in b)j.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};i=a("underscore"),e=a("../../core-view"),d=a("../../options"),c=a("../../icons"),g=function(a){return null!=a&&/\w/.test(a)},h=function(a){return null!=a?a.replace(/^.*\s*>/,""):void 0},f=function(a){return"<strong>"+a+"</strong>"},b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return k(b,a),b.prototype.tagName="li",b.prototype.events=function(){return{"click a":"handleClick"}},b.prototype.initialize=function(a){return this.chosenPaths=a.chosenPaths,this.view=a.view,this.query=a.query,this.path=a.path,this.trail=a.trail,b.__super__.initialize.apply(this,arguments),this.depth=this.trail.length+1,this.state.set({visible:!0,highlitName:null,name:this.path.toString()}),this.listenTo(this.chosenPaths,"add remove reset",this.handleChoice),this.listenTo(this.state,"change:visible",this.onChangeVisible),this.listenTo(this.state,"change:highlitName",this.render),this.listenTo(this.state,"change:displayName",this.render),this.path.getDisplayName().then(function(a){return function(b){return a.state.set({displayName:b,name:h(b)})}}(this))},b.prototype.onChangeVisible=function(){return this.$el.toggle(this.state.get("visible"))},b.prototype.getFilterPatterns=function(){var a,b,c,d,e,f;if(a=this.model.get("filter"),g(a)){for(e=a.split(/\s+/),f=[],c=0,d=e.length;c<d;c++)(b=e[c])&&f.push(new RegExp(b,"i"));return f}return[]},b.prototype.handleClick=function(a){var b;if(a.stopPropagation(),a.preventDefault(),!(this.model.get("dontSelectView")&&(null!=(b=this.view)?b.contains(this.path):void 0)))return this.chosenPaths.contains(this.path)?this.chosenPaths.remove(this.path):this.choose()},b.prototype.choose=function(){return this.model.get("multiSelect")?this.chosenPaths.add(this.path):this.chosenPaths.reset([this.path])},b.prototype.handleChoice=function(){return this.$el.toggleClass("active",this.chosenPaths.contains(this.path))},b.prototype.setHighlitName=function(a){return this.state.has("name")?this.state.set({highlitName:this.getHighlitName(a)}):this.state.once("change:name",function(b){return function(){return b.state.set({highlitName:b.getHighlitName(a)})}}(this))},b.prototype.getHighlitName=function(a){var b,c,d,e,g,h;for(c=this.state.get("name"),null!=(h=this.path.end)?h.name:void 0,b=c,e=0,g=a.length;e<g;e++)d=a[e],b=b.replace(d,f);return/strong/.test(b)?b:f(b)},b.prototype.getDisabled=function(){return!1},b.prototype.getData=function(){var a,b,e;return e=d.get("ShowId")?this.path+" ("+this.path.getType()+")":"",b=this.state.get("highlitName")?this.state.get("highlitName"):this.state.escape("name"),a=c.icon("Attribute"),{icon:a,title:e,name:b}},b.prototype.template=i.template('<a href="#" title="<%- title %>">\n  <%= icon %>\n  <span>\n    <%= name %>\n  </span>\n</a>'),b.prototype.render=function(){return b.__super__.render.apply(this,arguments),this.$el.toggleClass("disabled",this.getDisabled()),d.get("ShowId")&&this.$("a").tooltip({placement:"bottom"}),this.handleChoice(),null!=this.view&&this.$el.toggleClass("in-view",this.view.contains(this.path)),this},b}(e)}).call(this)},{"../../core-view":3,"../../icons":14,"../../options":63,underscore:310}],203:[function(a,b,c){(function(){var c,d,e,f={}.hasOwnProperty,g=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};d=a("../../icons"),c=a("./attribute"),e=a("../../utils/events").ignore,b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return g(b,a),b.prototype.initialize=function(a){return this.openNodes=a.openNodes,this.createSubFinder=a.createSubFinder,b.__super__.initialize.apply(this,arguments),this.state.set({collapsed:!0}),this.listenTo(this.openNodes,"add remove",this.setCollapsed),this.listenTo(this.state,"change:collapsed",this.onChangeCollapsed),this.setCollapsed()},b.prototype.setCollapsed=function(){var a;return null!=(a=this.state)?a.set({collapsed:!this.openNodes.contains(this.path)}):void 0},b.prototype.handleClick=function(a){return e(a),this.$(a.target).is("i")||!this.model.get("canSelectReferences")?this.openNodes.togglePresence(this.path):b.__super__.handleClick.call(this,a)},b.prototype.getData=function(){var a;return a=b.__super__.getData.apply(this,arguments),a.icon=d.icon(this.state.get("collapsed")?"ClosedReference":"OpenReference"),a},b.prototype.postRender=function(){return this.onChangeCollapsed()},b.prototype.onChangeCollapsed=function(){var a,b;return this.state.get("collapsed")?this.removeChild("subfinder"):(b=this.trail.concat([this.path]),a=this.createSubFinder({trail:b}),this.renderChild("subfinder",a))},b}(c)}).call(this)},{"../../icons":14,"../../utils/events":81,"./attribute":202}],204:[function(a,b,c){(function(){var c,d,e={}.hasOwnProperty,f=function(a,b){function c(){this.constructor=a}for(var d in b)e.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};c=a("../../icons"),d=a("./reference"),b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return f(b,a),b.prototype.className="im-reverse-reference",b.prototype.getData=function(){var a;return a=b.__super__.getData.apply(this,arguments),a.icon+=" "+c.icon("ReverseRef"),a},b.prototype.handleClick=function(a){return a.preventDefault(),a.stopPropagation(),this.$el.tooltip("hide")},b.prototype.render=function(){return b.__super__.render.apply(this,arguments),this.$el.attr({title:"Refers back to "+this.path.getParent().getParent()}).tooltip(),this},b}(d)}).call(this)},{"../../icons":14,"./reference":203}],205:[function(a,b,c){(function(){var c,d,e,f={}.hasOwnProperty,g=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};e=a("underscore"),d=a("../../icons"),c=a("./attribute"),b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return g(b,a),b.prototype.className="im-rootclass",b.prototype.initialize=function(a){var c;return c=a.cd,this.openNodes=a.openNodes,a.trail=[],a.path=a.query.getPathInfo(c.name),b.__super__.initialize.call(this,a)},b.prototype.getData=function(){return e.extend(b.__super__.getData.call(this),{icon:d.icon("RootClass")})},b.prototype.handleClick=function(a){var c,d,f,g,h;return null!=a&&a.preventDefault(),null!=a&&a.stopPropagation(),this.$(a.target).is("i")||!this.model.get("canSelectReferences")?this.openNodes.size()?this.openNodes.reset([]):(h=this.path.getType(),c=h.collections,g=h.references,d=function(){var a,b,d,h;for(d=e.values(g).concat(e.values(c)),h=[],a=0,b=d.length;a<b;a++)f=d[a],h.push(this.path.append(f.name));return h}.call(this),this.openNodes.reset(d)):b.__super__.handleClick.call(this,a)},b}(c)}).call(this)},{"../../icons":14,"./attribute":202,underscore:310}],206:[function(a,b,c){(function(){var c,d,e,f={}.hasOwnProperty,g=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};e=a("underscore"),c=a("../core-view"),d=a("../templates"),b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return g(b,a),b.prototype.Dialogue=function(){throw new Error("Not implemented")},b.prototype.longLabel=function(){throw new Error("Not implemented")},b.prototype.shortLabel=function(){throw new Error("Not implemented")},b.prototype.icon=function(){throw new Error("Not implemented")},b.prototype.template=d.template("modal-dialogue-opener"),b.prototype.labels=function(){return{ICON:e.result(this,"icon"),LONG:e.result(this,"longLabel"),SHORT:e.result(this,"shortLabel")}},b.prototype.parameters=["query"],b.prototype.initState=function(){return this.state.set({disabled:!1})},b.prototype.events=function(){return{click:this.onClick}},b.prototype.createDialogue=function(){return new this.Dialogue(this.dialogueOptions())},b.prototype.dialogueOptions=function(){return{query:this.query}},b.prototype.stateEvents=function(){return{"change:disabled":function(){return this.$(".btn.im-open-dialogue").toggleClass("disabled",this.state.get("disabled"))}}},b.prototype.onClick=function(a){var b,c;if(!this.state.get("disabled"))return b=this.createDialogue(),this.renderChild("dialogue",b),this.state.set({disabled:!0}),c=function(a){return function(){return a.removeChild("dialogue"),document.body.classList.remove("modal-open"),e.defer(function(){return a.state.set({disabled:!1})})}}(this),b.show().then(c,c)},b}(c)}).call(this)},{"../core-view":3,"../templates":67,underscore:310}],207:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l,m={}.hasOwnProperty,n=function(a,b){function c(){this.constructor=a}for(var d in b)m.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};d=a("../core-view"),l=j=a("../core/type-assertions"),k=l.UnionOf,h=l.Listenable,i=l.Structure,c=a("./column-manager/button"),e=a("./filter-dialogue/button"),g=a("./join-manager/button"),f=k(h,new i("History",{getCurrentQuery:j.Function})),b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return n(b,a),b.prototype.className="im-query-management",b.prototype.parameters=["history"],b.prototype.parameterTypes={history:f},b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this.listenTo(this.history,"changed:current",this.reRender)},b.prototype.renderChildren=function(){var a;return a=this.history.getCurrentQuery(),this.renderChild("cols",new c({query:a})),this.renderChild("cons",new e({query:a})),this.renderChild("joins",new g({query:a}))},b}(d)}).call(this)},{"../core-view":3,"../core/type-assertions":10,"./column-manager/button":119,"./filter-dialogue/button":168,"./join-manager/button":178}],208:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l,m,n={}.hasOwnProperty,o=function(a,b){function c(){this.constructor=a}for(var d in b)n.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},p=[].slice;a("underscore"),c=a("jquery"),f=a("../core-view"),a("../templates"),i=a("../options"),j=a("./query-management-tools"),l=a("./undo-history"),h=a("./list-dialogue/button"),e=a("./code-gen-button"),g=a("./export-dialogue/button"),d=a("../utils/events").Bus,k=["im-query-management","im-history","im-query-consumers"],m=function(a){return'<div class="'+a+' clearfix"></div>'},b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return o(b,a),b.prototype.className="im-query-tools",b.prototype.parameters=["tableState","history","selectedObjects"],b.prototype.optionalParameters=["bus","consumerContainer","consumerBtnClass"],b.prototype.bus=new d,b.prototype.template=function(){return k.map(m).join("")},b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this.listenTo(this.history,"changed:current",this.renderQueryConsumers)},b.prototype.renderChildren=function(){return this.renderManagementTools(),this.renderUndo(),this.renderQueryConsumers()},b.prototype.renderManagementTools=function(){return this.renderChildAt(".im-query-management",new j({history:this.history}))},b.prototype.renderUndo=function(){var a;return a=this.$(".im-history"),this.renderChild("undo",new l({collection:this.history}),a)},b.prototype.getConsumerContainer=function(){var a;return null!=this.consumerContainer?(this.consumerContainer.classList.add(i.get("StylePrefix")),this.consumerContainer.classList.add("im-query-consumers"),this.$(".im-query-management").addClass("im-has-more-space"),this.$(".im-history").addClass("im-has-more-space"),this.consumerContainer):(a=this.$(".im-query-consumers").empty(),a.length?a:void 0)},b.prototype.renderQueryConsumers=function(){var a,b,c,d,f,i,j,k;if(a=this.getConsumerContainer()){if(d=this.history.getCurrentQuery(),f=this.selectedObjects,c=new h({query:d,tableState:this.tableState,selected:f}),this.listenTo(c,"all",function(a){return function(){var b,c,d,e;return c=arguments[0],b=2<=arguments.length?p.call(arguments,1):[],(d=a.bus).trigger.apply(d,["list-action:"+c].concat(p.call(b))),(e=a.bus).trigger.apply(e,["list-action",c].concat(p.call(b)))}}(this)),this.renderChild("save",new g({query:d,tableState:this.tableState}),a),this.renderChild("code",new e({query:d,tableState:this.tableState}),a),this.renderChild("lists",c,a),this.consumerContainer&&this.consumerBtnClass)for(k=["save","code","lists"],i=0,j=k.length;i<j;i++)b=k[i],this.listenTo(this.children[b],"rendered",this.setButtonStyle);return this.setButtonStyle()}},b.prototype.setButtonStyle=function(){var a,b;if((b=this.consumerContainer)&&(a=this.consumerBtnClass))return c(".btn",b).addClass(a)},b}(f)}).call(this)},{"../core-view":3,"../options":63,"../templates":67,"../utils/events":81,"./code-gen-button":115,"./export-dialogue/button":139,"./list-dialogue/button":186,"./query-management-tools":207,"./undo-history":229,jquery:288,underscore:310}],209:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w=function(a,b){return function(){return a.apply(b,arguments)}},x={}.hasOwnProperty,y=function(a,b){function c(){this.constructor=a}for(var d in b)x.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};v=a("underscore"),e=a("../core-view"),i=a("../options"),r=a("../templates"),h=a("../messages"),a("../core/collection"),a("../core-model"),s=a("../core/type-assertions"),o=a("../models/table"),d=a("../models/column-headers"),u=a("../models/uniq-items"),m=a("../models/rows"),n=a("../models/selected-objects"),g=a("../models/history"),c=a("../utils/cell-model-factory"),p=a("../utils/table-results"),l=a("./table/inner"),f=a("./table/error-notice"),k=a("./table/pagination"),j=a("./table/page-sizer"),q=a("./table/summary"),a("../messages/table"),t={message:"Unknown error",key:"error.Unknown"},b.exports=function(a){function b(){return this.canUseFormatter=w(this.canUseFormatter,this),this.unsetSelecting=w(this.unsetSelecting,this),this.setSelecting=w(this.setSelecting,this),b.__super__.constructor.apply(this,arguments)}return y(b,a),b.create=function(a){var c,d,e,f;return e=a.query,d=a.model,s.assertMatch(s.Query,e),null==d&&(d=new o),c=new g,f=new n(e.service),c.setInitialState(e),new b({history:c,model:d,selectedObjects:f})},b.prototype.Model=o,b.prototype.className="im-table-container",b.prototype.parameters=["history","selectedObjects"],b.prototype.optionalParameters=["model","columnHeaders","blacklistedFormatters"],b.prototype.parameterTypes={history:s.InstanceOf(g,"History"),selectedObjects:s.InstanceOf(n,"SelectedObjects")},b.prototype.cellModelFactory=null,b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),null==this.columnHeaders&&(this.columnHeaders=new d),null==this.blacklistedFormatters&&(this.blacklistedFormatters=new u),this.rows=new m,this.listenTo(this.history,"changed:current",this.onChangeQuery),this.listenTo(this.blacklistedFormatters,"reset add remove",this.buildColumnHeaders),this.listenTo(this.columnHeaders,"change:minimised",this.onChangeHeaderMinimised),this.onChangeQuery()},b.prototype.onChangeQuery=function(){var a,b,d;return d=this.query=this.history.getCurrentQuery(),b=d.service,a=d.model,null==this.cellModelFactory&&(this.cellModelFactory=new c(b,a)),this.buildColumnHeaders(),this.fetchVersion().then(function(a){return function(){return a.query.count(function(b,c){return a.model.set({error:b,count:c})}),a.setFreshness()}}(this))},b.prototype.fetchVersion=function(){return this.query.service.fetchVersion().then(function(a){return function(b){return a.model.set({version:b})}}(this)).then(null,function(a){return function(a){return onConnectionError(a)}}())},b.prototype.onConnectionError=function(a){var b;return b=new Error("Could not connect to server"),b.key="error.ConnectionError",this.model.set({error:b})},b.prototype.modelEvents=function(){return{"change:freshness change:start change:size":this.fillRows,"change:start change:size":this.overlayTable,"change:fill":this.removeOverlay,"change:freshness":this.resetPhase,"change:phase":this.onChangePhase,"change:error":this.onChangeError,"change:count":this.onChangeCount}},b.prototype.onChangePhase=function(){return this.removeOverlay(),this.reRender()},b.prototype.onChangeCount=function(){var a,b,c,d;if(d=this.model.pick("start","count","size"),c=d.start,b=d.size,a=d.count,c>=a)return this.model.set({start:Math.max(0,a-b)})},b.prototype.resetPhase=function(){return this.model.set({phase:"FETCHING"})},b.prototype.onChangeError=function(){if(this.model.get("error"))return this.model.set({phase:"ERROR"})},b.prototype.remove=function(){return this.cellModelFactory.destroy(),delete this.cellModelFactory,b.__super__.remove.apply(this,arguments)},b.prototype.onChangeHeaderMinimised=function(a){var b,c;return c=this.query.makePath(a.get("path")),b=this.model.get("minimisedColumns"),a.get("minimised")?b.add(c):b.remove(c)},b.prototype.setSelecting=function(){return this.model.set({selecting:!0})},b.prototype.unsetSelecting=function(){return this.model.set({selecting:!1})},b.prototype.canUseFormatter=function(a){return null!=a&&!this.blacklistedFormatters.contains(a)},b.prototype.setFreshness=function(){return this.model.set({freshness:this.query.toXML()})},b.prototype.buildColumnHeaders=function(){var a,b,c;return c={silent:!0},b=this.model.get("minimisedColumns"),a=function(a){return function(c){return b.contains(a.query.makePath(c.get("path")))}}(this),this.columnHeaders.setHeaders(this.query,this.blacklistedFormatters),this.columnHeaders.forEach(function(b){return function(b){return b.set({minimised:a(b)},c)}}())},b.prototype.fillRows=function(){var a,b,c,d,e;return e=this.model.pick("start","size"),c=e.start,b=e.size,d=function(a){return function(){return a.model.set({phase:"SUCCESS"})}}(this),a=function(a){return function(b){return null==b&&(b=t),a.model.set({phase:"ERROR",error:b})}}(this),p.getCache(this.query).fetchRows(c,b).then(function(a){return function(b){return a.fillRowsCollection(b)}}(this)).then(d,a).then(this.model.filled,this.model.filled)},b.prototype.fillRowsCollection=function(a){var b,c,d;return b=this.cellModelFactory.getCreator(this.query),d=this.model.get("start"),c=a.map(function(a){return function(c,e){var f;return{id:a.query.toXML()+"#"+(d+e),index:d+e,query:a.query.toXML(),cells:function(){var a,d,e;for(e=[],a=0,d=c.length;a<d;a++)f=c[a],e.push(b(f));return e}()}}}(this)),this.rows.set(c)},b.prototype.overlayTable=function(){var a,b,c;if(null!=(c=this.children.inner)?c.rendered:void 0)return b=this.children.inner.$el,this.$el.offset(),b.offset(),this.removeOverlay(),this.overlay=document.createElement("div"),this.overlay.className="im-table-overlay im-hidden",a=this.make("h1",{},h.getText("table.OverlayText")),a.style.top=b.height()/2+"px",this.overlay.appendChild(a),this.el.appendChild(this.overlay),v.delay(function(a){return function(){var b;return null!=(b=a.overlay)?b.classList.remove("im-hidden"):void 0}}(this),100)},b.prototype.removeOverlay=function(){return null!=this.overlay&&this.el.removeChild(this.overlay),delete this.overlay},b.prototype.template=function(){switch(this.model.get("phase")){case"FETCHING":return this.renderFetching();case"ERROR":return this.renderError();case"SUCCESS":return this.renderTable();default:throw new Error("Unknown phase: "+this.model.get("phase"))}},b.prototype.renderFetching=function(){return r.template("table-building")(this.getBaseData())},b.prototype.renderError=function(){var a;return this.removeChild("error"),this.children.error=a=new f({query:this.query,model:this.model}),a.render().el},b.prototype.renderTable=function(){var a,b;return a=document.createDocumentFragment(),this.renderWidgets(a),b=new l(v.extend(v.pick(this,l.prototype.parameters),{tableState:this.model})),this.renderChild("inner",b,a),a},b.prototype.renderWidgets=function(a){var b,c,d,e,f,g,h;if(null==a&&(a=this.el),f=v.chain(i.get("TableWidgets")).map(function(a,b){var c,d;return c=a.enabled,d=a.index,{name:b,index:d,enabled:c}}).where({enabled:!0}).sortBy("index").pluck("name").value(),f.length){for(d=document.createElement("div"),d.className="im-table-controls",b=document.createElement("div"),b.style.clear="both",g=0,h=f.length;g<h;g++)"place"+(e=f[g])in this&&(c="place"+e,this[c](d));return d.appendChild(b),a.appendChild(d)}},b.prototype.renderWidget=function(a,b,c){var d;return d=new c({model:this.model,getQuery:function(a){return function(){return a.history.getCurrentQuery()}}(this)}),this.renderChild(a,d,b)},b.prototype.placePagination=function(a){return this.renderWidget("pagination",a,k)},b.prototype.placePageSizer=function(a){return this.renderWidget("pagesizer",a,j)},b.prototype.placeTableSummary=function(a){return this.renderWidget("tablesummary",a,q)},b}(e)}).call(this)},{"../core-model":2,"../core-view":3,"../core/collection":5,"../core/type-assertions":10,"../messages":16,"../messages/table":28,"../models/column-headers":39,"../models/history":45,"../models/rows":57,"../models/selected-objects":58,"../models/table":61,"../models/uniq-items":62,"../options":63,"../templates":67,"../utils/cell-model-factory":75,"../utils/table-results":108,"./table/error-notice":214,"./table/inner":217,"./table/page-sizer":220,"./table/pagination":221,"./table/summary":227,underscore:310}],210:[function(a,b,c){(function(){var c,d,e,f,g,h,i={}.hasOwnProperty,j=function(a,b){function c(){this.constructor=a}for(var d in b)i.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};h=a("underscore"),c=a("../../core-view"),f=a("../../templates"),g=a("../../utils/build-skipset"),a("../../messages/table"),b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return j(b,a),b.prototype.tagName="tbody",b.prototype.parameters=["makeCell","collection","history"],b.prototype.collectionEvents=function(){return{reset:this.reRender,add:this.onRowAdded,remove:this.onRowRemoved}},b.prototype.template=function(){},b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this._skipSets={}},b.prototype.renderChildren=function(){var a;return this.collection.isEmpty()?this.handleEmptyTable():(a=document.createDocumentFragment("tbody"),this.collection.forEach(function(b){return function(c){return b.addRow(c,a)}}(this)),this.el.appendChild(a))},b.prototype.onRowAdded=function(a){return this.removeChild("apology"),this.addRow(a)},b.prototype.onRowRemoved=function(a){if(this.removeChild(a.id),this.collection.isEmpty())return this.handleEmptyTable()},b.prototype.addRow=function(a,b){var c,d;return null==b&&(b=this.el),c=this.skipped(a),d=new e({model:a,makeCell:this.makeCell,skipped:c}),this.renderChild(a.id,d,b)},b.prototype.handleEmptyTable=function(){return this.renderChild("apology",new d({history:this.history}))},b.prototype.skipped=function(a){var b,c;return null!=(b=this._skipSets)[c=a.get("query")]?b[c]:b[c]=function(b){return function(){var c,d;return d=a.get("cells").map(b.makeCell),c=g(d),d.forEach(function(a){return a.remove()}),c}}(this)()},b}(c),e=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return j(b,a),b.prototype.tagName="tr",b.prototype.parameters=["makeCell","skipped"],b.prototype.postRender=function(){var a,b,c,d,e,f;for(b=this.model.get("cells").map(this.makeCell),f=[],c=d=0,e=b.length;d<e;c=++d)a=b[c],this.skipped[a.model.get("column")]||f.push(this.renderChild(c,a));return f},b}(c),d=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return j(b,a),b.prototype.tagName="tr",b.prototype.className="im-empty-apology",b.prototype.template=f.template("no-results"),b.prototype.parameters=["history"],b.prototype.events=function(){return{"click .btn-undo":function(){return this.history.popState()}}},b.prototype.getData=function(){return h.extend(b.__super__.getData.apply(this,arguments),{selectList:this.history.getCurrentQuery().views,canUndo:this.history.length>1})},b}(c)}).call(this)},{"../../core-view":3,"../../messages/table":28,"../../templates":67,"../../utils/build-skipset":72,underscore:310}],211:[function(a,b,c){(function(){var c,d,e;d=a("../../models/nested-table"),e=a("./subtable"),c=a("./cell"),b.exports=function(a,b){var f,g;return a.root.replace(/\/service\/?$/,""),g=function(a){var c;return c=b.getFormatter(a.get("node"),a.get("column")),null!=c&&b.canUseFormatter(c)?c:null},f=function(h){return h instanceof d?new e({query:b.query,model:h,cellify:f,expandedSubtables:b.expandedSubtables}):new c({model:h,service:a,popovers:b.popoverFactory,selectedObjects:b.selectedObjects,tableState:b.tableState,formatter:g(h)})}}}).call(this)},{"../../models/nested-table":48,"./cell":212,"./subtable":226}],212:[function(a,b,c){(function(c){(function(){var d,e,f,g,h,i,j,k,l,m,n,o,p,q={}.hasOwnProperty,r=function(a,b){function c(){this.constructor=a}for(var d in b)q.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},s=[].indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(b in this&&this[b]===a)return b;return-1};o=a("underscore"),d=a("jquery"),f=a("../../core-view"),k=a("../../templates"),i=a("../../options"),h=a("../../messages"),e=a("../../models/cell"),g=a("../../formatting"),h.setWithPrefix("table.cell",{Link:"link",NullEntity:"No <%= type %>",PreviewTitle:function(a){var b;return b=a.types,b.join(i.get("DynamicObjects.NameDelimiter"))}}),j=a("../../models/selected-objects"),n=a("../../core/type-assertions"),m=k.template("classy-popover")({classes:"item-preview"}),p=function(a,b){return null!=b&&null!=a.model.findSharedAncestor(a,b)},l=o.memoize(p,function(a,b){return a+"<"+(null!=b?b:"!")}),b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return r(b,a),b.prototype.Model=e,b.prototype.tagName="td",b.prototype.className="im-result-field",b.prototype.id=function(){return o.uniqueId("im_table_cell_")},b.prototype.formatter=g.defaultFormatter,b.prototype.parameters=["model","service","selectedObjects","tableState","popovers"],b.prototype.optionalParameters=["formatter"],b.prototype.parameterTypes={model:n.InstanceOf(e,"models/cell"),selectedObjects:n.InstanceOf(j,"SelectedObjects"),formatter:n.Callable,tableState:n.Model,service:n.Service,popovers:new n.Structure("HasGet",{get:n.Function})},b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this.listen()},b.prototype.initState=function(){return this.setSelected(),this.setSelectable(),this.setHighlit(),this.setMinimised()},b.prototype.getPath=function(){return this.model.get("column")},b.prototype.getTypes=function(){var a,b,c,d,e,f;if(c=this.model.get("node"),null!=(b=this.model.get("entity").get("classes"))){for(f=[],d=0,e=b.length;d<e;d++)a=b[d],f.push(c.model.makePath(a));return f}return[c]},b.prototype.listen=function(){return this.listenToEntity(),this.listenToSelectedObjects(),this.listenToOptions(),this.listenToTableState()},b.prototype.listenToOptions=function(){return this.listenTo(i,"change:TableCell.IndicateOffHostLinks",this.reRender),this.listenTo(i,"change:TableCell.ExternalLinkIcons",this.reRender),this.listenTo(i,"change:TableCell.PreviewTrigger",this.onChangeTrigger)},b.prototype.listenToTableState=function(){var a;return a=this.tableState,this.listenTo(a,"change:selecting",this.setInputDisplay),this.listenTo(a,"change:previewOwner",this.closeOwnPreview),this.listenTo(a,"change:highlitNode",this.setHighlit),this.listenTo(a,"change:minimisedColumns",this.setMinimised)},b.prototype.listenToSelectedObjects=function(){var a;return a=this.selectedObjects,this.listenTo(a,"add remove reset",this.setSelected),this.listenTo(a,"add remove reset change:commonType change:node",this.setSelectable)},b.prototype.modelEvents=function(){return{"change:entity":this.onChangeEntity}},b.prototype.stateEvents=function(){return{"change:highlit change:selected":this.setActiveClass,"change:selectable":this.onChangeSelectable,"change:selected":this.setInputChecked,"change:showPreview":this.onChangeShowPreview,"change:minimised":this.reRender}},b.prototype.events=function(){var a,b,c;if(a={"show.bs.popover":this.onShowPreview,"hide.bs.popover":this.onHidePreview,"click a.im-cell-link":this.onClickCellLink},b=i.get("TableCell"),"hover"===(c=b.PreviewTrigger))a["mouseover .im-cell-link"]=this.showPreview,a["mouseout .im-cell-link"]=this.hidePreview,a.click=this.activateChooser;else{if("click"!==c)throw new Error("Unknown cell preview: "+c);a.click=this.clickTogglePreview}return a},b.prototype.onChangeTrigger=function(){return this.destroyPreview(),this.initPreview(),this.delegateEvents()},b.prototype.onClickCellLink=function(a){var b;return this.tableState.get("selecting")?void a.preventDefault():(b=d.Event("view.im.object"),b.object=this.model.get("entity").toJSON(),this.$el.trigger(b),b.isDefaultPrevented()?a.preventDefault():void 0)},b.prototype.closeOwnPreview=function(){var a,b;if(b=this.el.id,a=this.tableState.get("previewOwner"),b!==a)return this.hidePreview(),this._hidePreview()},b.prototype.listenToEntity=function(){return this.listenTo(this.model.get("entity"),"change",this.updateValue)},b.prototype.onShowPreview=function(){return this.tableState.set({previewOwner:this.el.id})},b.prototype.onHidePreview=function(){var a,b;if(b=this.el.id,a=this.tableState.get("previewOwner"),b===a)return this.tableState.set({previewOwner:null})},b.prototype.toggleSelection=function(){var a,b,c,d;if(a=this.model.get("entity"),c=a.get("id"),null!=a){
if(b=this.selectedObjects.get(c))return this.selectedObjects.remove(b);if(null==(d=this.getMostSuitableIdentity()))throw new Error("None of our identities is a compatible");return this.selectedObjects.add(d)}},b.prototype.getMostSuitableIdentity=function(){var a,b,c,d,e,f,g;return e=this.model.get("node"),a=e.model.getSubclassesOf(e.getType()),c=this.model.get("entity").get("id"),d=function(){var a,b,d,e;for(d=this.getTypes(),e=[],a=0,b=d.length;a<b;a++)g=d[a],e.push({class:String(g),id:c});return e}.call(this),this.selectedObjects.isEmpty()?o.find(d,function(b){var c;return c=b.class,s.call(a,c)>=0}):(b=e.model.makePath(this.selectedObjects.state.get("commonType")),o.all(d,function(a){return l(b,a.class)}),f=o.sortBy(d,function(a){return e.model.getAncestorsOf(a.class).length}),o.last(f))},b.prototype.setSelected=function(){return this.state.set({selected:null!=this.selectedObjects.get(this.model.get("entity"))})},b.prototype.setSelectable=function(){var a,b,c,d;return a=this.selectedObjects.state.get("commonType"),b=this.selectedObjects.state.get("node"),d=this.selectedObjects.size(),c=(null==b||b===String(this.model.get("node")))&&(0===d||this.isCompatibleWith(a)),this.state.set({selectable:c})},b.prototype.isCompatibleWith=function(a){return this.getTypes().some(function(b){return l(b,a)})},b.prototype.setHighlit=function(){var a,b;return b=this.model.get("node"),a=this.tableState.get("highlitNode"),this.state.set({highlit:null!=a&&String(b)===String(a)})},b.prototype.setMinimised=function(){var a,b;return b=this.model.get("column"),a=this.tableState.get("minimisedColumns").contains(b),this.state.set({minimised:a})},b.prototype.onChangeEntity=function(){var a;return a=this.model.previous("entity"),delete this._has_id,null!=a&&this.stopListening(a),this.listenToEntity()},b.prototype.clickTogglePreview=function(){return this.activateChooser()||this.state.toggle("showPreview")},b.prototype.activateChooser=function(){var a,b;if(this.hasID())return b=this.tableState.get("selecting"),a=this.state.get("selectable"),a&&b?this.toggleSelection():void 0},b.prototype.hasID=function(){return null!=this._has_id?this._has_id:this._has_id=null!=this.model.get("entity").get("id")},b.prototype.showPreview=function(){return this.state.set({showPreview:!0})},b.prototype.hidePreview=function(){return this.state.set({showPreview:!1})},b.prototype._showPreview=function(){var a,b;if(this.rendered){if(this.tableState.get("selecting"))return;return a=i.get("TableCell"),b=function(a){return function(){var b;if(a.state.get("showPreview"))return null!=(b=a.children.popover)?b.render():void 0}}(this),"hover"===a.PreviewTrigger?o.delay(b,a.HoverDelay):b()}},b.prototype._hidePreview=function(){var a,b;if(null!=(a=this.children.popover)?a.rendered:void 0)return null!=(b=this.popoverTarget)?b.popover("hide"):void 0},b.prototype.onChangeShowPreview=function(){return this.state.get("showPreview")?this._showPreview():this._hidePreview()},b.prototype.onChangeSelectable=function(){return this.setDisabledCellClass(),this.setInputDisabled()},b.prototype.updateValue=function(){return o.defer(function(a){return function(){return a.$(".im-displayed-value").html(a.getFormattedValue())}}(this))},b.prototype.setActiveClass=function(){var a,b,c;return c=this.state.pick("highlit","selected"),a=c.highlit,b=c.selected,this.$el.toggleClass("active",a||b)},b.prototype.setInputChecked=function(){return this.$("input").prop({checked:this.getInputState().checked})},b.prototype.setInputDisplay=function(){return this.$("input").css({display:this.getInputState().display})},b.prototype.setDisabledCellClass=function(){return this.$el.toggleClass("im-not-selectable",!this.state.get("selectable"))},b.prototype.setInputDisabled=function(){return this.$("input").prop({disabled:this.getInputState().disabled})},b.prototype.template=k.template("table-cell"),b.prototype.getData=function(){var a,b,d,e,f,g,h;e=i.get("TableCell"),d=e.IndicateOffHostLinks?c.location.host:/.*/,a=this.model.toJSON(),a.formattedValue=this.getFormattedValue(),a.input=this.getInputState(),a.icon=null,a.url=f=a.entity["report:uri"],a.isForeign=f&&!f.match(d),a.target=a.isForeign?"_blank":"",a.NULL_VALUE=k.null_value,h=e.ExternalLinkIcons;for(b in h)g=h[b],(null!=f?f.match(b):void 0)&&null==a.icon&&(a.icon=g);return o.extend(this.getBaseData(),a)},b.prototype.getFormattedValue=function(){var a,b,c;return c=this.model.pick("entity","value"),a=c.entity,b=c.value,null!=b?this.formatter.call(null,a,this.service,b):null},b.prototype.getInputState=function(){var a,b,c,d,e,f,g;return f=this.tableState.get("selecting"),g=this.state.pick("selected","selectable"),e=g.selected,d=g.selectable,a=e,b=!d,c=f?"inline":"none",{checked:a,disabled:b,display:c}},b.prototype.canHavePreview=function(){return this.hasID()&&!this.state.get("minimised")},b.prototype.postRender=function(){return this.setAttrClass(),this.setActiveClass(),this.setMinimisedClass(),this.setDisabledCellClass(),this.setFormatterClasses(),this.initPreview()},b.prototype.setAttrClass=function(){var a,b,c,d,e;if(i.get("TableCell.AddDataClasses")){for(a=this.model.get("column").getType(),this.$el.addClass("im-type-"+a.toLowerCase()),e=this.getTypes(),c=0,d=e.length;c<d;c++)b=e[c],this.$el.addClass(String(b));return this.$el.addClass(this.model.get("column").end.name)}},b.prototype.setMinimisedClass=function(){return this.$el.toggleClass("im-minimised",this.state.get("minimised"))},b.prototype.setFormatterClasses=function(){var a,b;if(a=this.formatter.classes,null!=a&&this.$el.addClass(a),null!=(b=this.formatter.target))return this.$el.addClass(b)},b.prototype.getPreviewContainer=function(){var a,b;for(b=[],a=[".im-query-results",".im-table-container",".panel","table","body"];a.length&&0===b.length;)b=this.$el.closest(a.shift());return b},b.prototype.removeAllChildren=function(){return this.destroyPreview(),null!=this.children.popover&&(this.stopListeningTo(this.children.popover),this.children.popover.rendered&&this.$el.popover("destroy")),b.__super__.removeAllChildren.apply(this,arguments)},b.prototype.destroyPreview=function(){var a;if(null!=this.children.popover)return this.stopListeningTo(this.children.popover),this.children.popover.rendered&&null!=(a=this.popoverTarget)&&a.popover("destroy"),delete this.popoverTarget,this.removeChild("popover")},b.prototype.popoverTarget=null,b.prototype.initPreview=function(){var a,b,c;if(null==this.children.popover&&this.canHavePreview())return a=this.popovers.get(this.model.get("entity")),c=i.get("TableCell.PreviewTrigger"),this.popoverTarget="hover"===c?this.$(".im-cell-link"):this.$el,b=h.getText.bind(h,"table.cell.PreviewTitle"),this.listenToOnce(a,"rendered",function(c){return function(){var d;return d=c.getPreviewContainer(),c.popoverTarget.popover({trigger:"manual",template:m,placement:"auto left",container:d,html:!0,title:function(){return b({types:c.model.get("typeNames")})},content:a.el})}}(this)),this.listenTo(a,"rendered",function(a){return function(){return a.popoverTarget.popover("show")}}(this)),this.children.popover=a},b}(f)}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../core-view":3,"../../core/type-assertions":10,"../../formatting":13,"../../messages":16,"../../models/cell":37,"../../models/selected-objects":58,"../../options":63,"../../templates":67,jquery:288,underscore:310}],213:[function(a,b,c){(function(){var c,d,e,f,g,h,i={}.hasOwnProperty,j=function(a,b){function c(){this.constructor=a}for(var d in b)i.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};h=a("underscore"),d=a("../facets/facet-view"),f=a("../../models/path"),g=a("../../utils/events").ignore,e="No query in call to new DropDownColumnSummary",c="No PathModel in call to new DropDownColumnSummary",b.exports=function(a){function b(a){var d,g;if(g=a.query,d=a.model,!g)throw new Error(e);if(!(d instanceof f))throw new Error(c);b.__super__.constructor.call(this,{query:g,view:d.pathInfo()})}return j(b,a),b.prototype.className=function(){return b.__super__.className.apply(this,arguments)+" im-dropdown-summary"},b.prototype.events=function(){return h.extend(b.__super__.events.apply(this,arguments),{click:g})},b.prototype.postRender=function(){return b.__super__.postRender.apply(this,arguments),this.$el.addClass(this.className())},b}(d)}).call(this)},{"../../models/path":56,"../../utils/events":81,"../facets/facet-view":151,underscore:310}],214:[function(a,b,c){(function(c){(function(){var d,e,f,g,h,i,j,k,l,m,n,o={}.hasOwnProperty,p=function(a,b){function c(){this.constructor=a}for(var d in b)o.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};n=a("underscore"),i=a("imjs"),a("../../options"),d=a("../../core-view"),f=a("../../templates"),e=a("../../messages"),j=a("../../utils/indent-xml"),k=a("../../utils/mailto"),m=a("../../utils/with-cdn-resource"),g=a("../../version"),a("../../messages/error"),l=n.partial(m,"prettify","prettyPrintOne"),h=function(a){return/(Type|Reference)Error/.test(String(a))?"client":"server"},b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return p(b,a),b.prototype.className="im-error-notice",b.prototype.parameters=["model","query"],b.prototype.helpers=function(){return n.extend(b.__super__.helpers.apply(this,arguments),{indent:j})},b.prototype.template=f.template("table-error"),b.prototype.getData=function(){var a,d,f,j,l,m;return f=this.model.get("error"),m=new Date,l=e.getText("error.mail.Subject"),a=this.query.service.help,d=h(f),console.error(f),j=k.href(a,l,"We encountered an error running a query from an\nembedded result table.\n\npage:       "+c.location+"\nservice:    "+this.query.service.root+"\nerror:      "+f+"\ndate-stamp: "+m+"\n\n-------------------------------\nIMJS:       "+i.VERSION+"\n-------------------------------\nIMTABLES:   "+g+"\n-------------------------------\nQUERY:      "+this.query.toXML()+"\n-------------------------------\nSTACK:      "+(null!=f?f.stack:void 0)),n.extend(b.__super__.getData.apply(this,arguments),{domain:d,mailto:j,query:this.query.toXML()})},b.prototype.postRender=function(){var a,b;return b=j(this.query.toXML()),a=this.$(".query-xml"),l(function(c){return a.html(c(n.escape(b)))})},b.prototype.events=function(){return{"click .im-show-query":function(){return this.$(".query-xml").slideToggle(),this.$(".im-show-query").toggleClass("active")},"click .im-show-error":function(){return this.$(".error-message").slideToggle(),this.$(".im-show-error").toggleClass("active")}}},b}(d)}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../core-view":3,"../../messages":16,"../../messages/error":22,"../../options":63,"../../templates":67,"../../utils/indent-xml":88,"../../utils/mailto":92,"../../utils/with-cdn-resource":110,"../../version":111,imjs:271,underscore:310}],215:[function(a,b,c){(function(){var c,d,e,f={}.hasOwnProperty,g=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};e=a("underscore"),d=a("../../core-view"),c=a("./header"),b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return g(b,a),b.prototype.tagName="thead",b.prototype.parameters=["history","expandedSubtables","blacklistedFormatters","columnHeaders"],b.prototype.template=function(){},b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this.listenTo(this.columnHeaders,"add reset sort",this.reRender),this.listenTo(this.columnHeaders,"remove",function(a){return this.removeChild(a.id)}),this},b.prototype.renderChildren=function(){var a,b,c,d;return a=document.createDocumentFragment(),d=document.createElement("tr"),a.appendChild(d),c=this.history.getCurrentQuery(),b={query:c,expandedSubtables:this.expandedSubtables,blacklistedFormatters:this.blacklistedFormatters},this.columnHeaders.each(this.renderHeader(d,b)),this.$el.html(a)},b.prototype.renderHeader=function(a,b){return function(d){return function(f,g){var h;return h=new c(e.extend({model:f},b)),d.renderChild(f.id,h,a)}}(this)},b}(d)}).call(this)},{"../../core-view":3,"./header":216,underscore:310}],216:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t=function(a,b){return function(){return a.apply(b,arguments)}},u={}.hasOwnProperty,v=function(a,b){function c(){this.constructor=a}for(var d in b)u.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},w=[].slice;s=a("underscore"),e=a("../../core-view"),d=a("../../core/collection"),m=a("../../templates"),a("../../messages"),j=a("../../options"),c=a("../../utils/css-class-set"),r=a("../../utils/sort-query-by-path"),q=a("../../utils/on-change"),h=a("../../models/header"),g=a("../formatted-sorting"),l=a("../constraints/single-column"),f=a("./column-summary"),k=a("./outer-join-summary"),p=a("../../utils/events").ignore,a("../../messages/table"),i=function(a,b){return function(){return a.get(b)}},n=function(){return Math.max(document.documentElement.clientHeight,window.innerHeight||0)},o=function(){return Math.max(document.documentElement.clientWidth,window.innerWidth||0)},b.exports=function(a){function b(){return this.toggleColumnVisibility=t(this.toggleColumnVisibility,this),this.showFilterSummary=t(this.showFilterSummary,this),this.showColumnSummary=t(this.showColumnSummary,this),this.showSummary=t(this.showSummary,this),b.__super__.constructor.apply(this,arguments)}return v(b,a),b.prototype.Model=h,b.prototype.tagName="th",b.prototype.className="im-column-th",b.prototype.RERENDER_EVENT=q(["composed","expanded","minimised","numOfCons","outerJoined","parts","path","sortable","sortDirection"]),b.prototype.template=m.template("column-header"),b.prototype.namePopoverTemplate=m.template("column_name_popover"),b.prototype.parameters=["query"],b.prototype.optionalParameters=["blacklistedFormatters","expandedSubtables"],b.prototype.expandedSubtables=new d,b.prototype.blacklistedFormatters=new d,b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this.listenTo(this.query,"showing:column-summary",this.removeMySummary),this.listenTo(j,"change:icons",this.reRender),this.createClassSets()},b.prototype.path=function(){return this.model.pathInfo()},b.prototype.createClassSets=function(){return this.classSets={},this.classSets.headerClasses=new c({"im-column-header":!0,"im-minimised-th":i(this.model,"minimised"),"im-is-composed":i(this.model,"composed"),"im-has-constraint":i(this.model,"numOfCons")}),this.classSets.colTitleClasses=new c({"im-col-title":!0,"im-hidden":i(this.model,"minimised")})},b.prototype.removeMySummary=function(a){if(!a.equals(this.model.pathInfo()))return this.removeChild("summary"),this.$(".dropdown.open").removeClass("open")},b.prototype.onSubtableExpanded=function(a){if(a.toString().match(this.model.getView()))return this.model.set({expanded:!0})},b.prototype.onSubtableCollapsed=function(a){if(a.toString().match(this.model.getView()))return this.model.set({expanded:!1})},b.prototype.getData=function(){var a,d,e,f,g,h,i;return i=this.model.get("parts"),a=3<=i.length?w.call(i,0,h=i.length-2):(h=0,[]),f=i[h++],e=i[h++],d=a.length,d?"non-root":"root",g=new c({"im-title-part im-parent":!0,"im-root-parent":!d,"im-non-root-parent":d,"im-last":!e}),s.extend({penultClasses:g,last:e,penult:f},this.classSets,b.__super__.getData.apply(this,arguments))},b.prototype.events=function(){return{"click .im-col-sort":"setSortOrder","click .im-col-minumaximiser":"toggleColumnVisibility","click .im-col-filters":"showFilterSummary","click .im-subtable-expander":this.toggleSubTable,"click .im-col-remover":"removeColumn","hidden.bs.dropdown":function(){return this.removeChild("summary")},"shown.bs.dropdown":"onDropdownShown","toggle .im-th-button":"summaryToggled","click .summary-img":this.showColumnSummary,"click .im-col-composed":this.addFormatterToBlacklist}},b.prototype.postRender=function(){return this.setTitlePopover(),this.announceExpandedState(),this.activateTooltips()},b.prototype.activateTooltips=function(){return this.$(".im-th-button").tooltip({placement:"top",container:this.el})},b.prototype.onDropdownShown=function(a){return s.defer(function(){var b,c;if(delete a.target.style.right,b=a.target.getBoundingClientRect(),b.left<0)return c=b.left+"px",a.target.style.right=c})},b.prototype.addFormatterToBlacklist=function(){return this.blacklistedFormatters.add({formatter:this.model.get("formatter")})},b.prototype.announceExpandedState=function(){if(this.model.get("expanded"))return this.query.trigger("expand:subtables",this.model.get("path"))},b.prototype.setTitlePopover=function(){if(j.get("TableHeader.FullPathPopoverEnabled"))return this.$(".im-col-title").popover({content:function(a){return function(){return a.namePopoverTemplate(a.getData())}}(this),container:this.el,placement:"bottom",html:!0})},b.prototype.summaryToggled=function(a,b){if(p(a),a.target===a.currentTarget)return b?void 0:this.removeChild("summary")},b.prototype.hideTooltips=function(){return this.$(".im-th-button").tooltip("hide")},b.prototype.removeColumn=function(a){var b,c;return p(a),this.hideTooltips(),c=this.model.getView(),this.query.removeFromSelect(function(){var a,d,e,f;for(e=this.query.views,f=[],a=0,d=e.length;a<d;a++)b=e[a],b.match(c)&&f.push(b);return f}.call(this))},b.prototype.checkHowFarOver=function(a){var b;if(b=this.$el.closest(".im-table-container"),a.offset().left+350>=b.offset().left+b.width())return this.$el.addClass("too-far-over")},b.prototype.showSummary=function(a,b,c){var d,e,f,g,h;if(p(c),e=this.$(a),f=this.path(),e.hasClass("open"))return this.query.trigger("hiding:column-summary",f),e.removeClass("open"),null!=(h=this.children.summary)&&h.$el.hide(),this.removeChild("summary"),!1;if(this.$(".dropdown.open").removeClass("open"),this.query.trigger("showing:column-summary",f),g=new b({query:this.query,model:this.model}),d=this.$(a+" .dropdown-menu"),!d.length)throw new Error(a+" not found");return d.empty(),this.renderChild("summary",g,d),e.addClass("open"),this.onDropdownShown({target:d[0]}),!0},b.prototype.ensureDropdownIsWithinTable=function(a,b,c){var d,e,f,g,h;if(null==c&&(c=360),e=a.getBoundingClientRect(),null!=(g=this.$el.closest("table")[0])){if(f=o(),d=this.$(b+" .dropdown-menu"),c>=f)return d.addClass("im-fullwidth-dropdown").css({width:f});if(d.css({width:null}),!(c>=o()))return h=g.getBoundingClientRect(),e.left+c>h.right?this.$(b+" .dropdown-menu").addClass("dropdown-menu-right"):void 0}},b.prototype.showColumnSummary=function(a){var b,c;if(b=this.model.get("isReference")?k:f,this.showSummary(".im-summary",b,a))return c=n(),this.$(".im-item-table").css({"max-height":Math.max(350,c/2)}),this.ensureDropdownIsWithinTable(a.target,".im-summary")},b.prototype.showFilterSummary=function(a){if(this.showSummary(".im-filter-summary",l,a))return this.ensureDropdownIsWithinTable(a.target,".im-filter-summary",500)},b.prototype.toggleColumnVisibility=function(a){return p(a),this.model.toggle("minimised")},b.prototype.setSortOrder=function(a){return p(a),this.model.get("replaces").length?this.showSummary(".im-col-sort",g,a):(r(this.query,this.model.getView()),this.$(".im-col-sort").removeClass("open"))},b.prototype.toggleSubTable=function(a){return p(a),this.expandedSubtables.toggle(this.model.pathInfo())},b}(e)}).call(this)},{"../../core-view":3,"../../core/collection":5,"../../messages":16,"../../messages/table":28,"../../models/header":44,"../../options":63,"../../templates":67,"../../utils/css-class-set":79,"../../utils/events":81,"../../utils/on-change":93,"../../utils/sort-query-by-path":105,"../constraints/single-column":135,"../formatted-sorting":169,"./column-summary":213,"./outer-join-summary":219,underscore:310}],217:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s=function(a,b){return function(){return a.apply(b,arguments)}},t={}.hasOwnProperty,u=function(a,b){function c(){this.constructor=a}for(var d in b)t.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};r=a("underscore"),e=a("../../core-view"),o=a("../../templates"),f=a("../../formatting"),h=a("../../models/path-set"),d=a("../../models/column-headers"),i=a("../../utils/popover-factory"),g=a("../../models/history"),n=a("../../models/table"),k=a("../../models/selected-objects"),j=a("../item-preview"),p=a("../../core/type-assertions"),c=a("./cell-factory"),l=a("./body"),m=a("./head"),q=function(a){return function(b,c){return a(c,b)}},b.exports=function(a){function b(){return this.canUseFormatter=s(this.canUseFormatter,this),b.__super__.constructor.apply(this,arguments)}return u(b,a),b.prototype.className="im-results-table table table-striped table-bordered",b.prototype.tagName="table",b.prototype.throbber=o.template("table-throbber"),b.prototype.parameters=["history","columnHeaders","rows","tableState","blacklistedFormatters","selectedObjects"],b.prototype.parameterTypes={history:p.InstanceOf(g,"History"),blacklistedFormatters:p.Collection,rows:p.Collection,tableState:p.InstanceOf(n,"TableModel"),columnHeaders:p.InstanceOf(d,"ColumnHeaders"),selectedObjects:p.InstanceOf(k,"SelectedObjects")},b.prototype.initialize=function(){var a;return b.__super__.initialize.apply(this,arguments),a=(this.query=this.history.getCurrentQuery()).service,this.expandedSubtables=new h,this.popoverFactory=new i(a,j),this.cellFactory=c(a,this),this.listenTo(this.blacklistedFormatters,"reset add remove",this.renderBody),this.listenTo(this.history,"changed:current",this.setQuery)},b.prototype.setQuery=function(){return this.query=this.history.getCurrentQuery()},b.prototype.getFormatter=q(f.getFormatter),b.prototype.canUseFormatter=function(a){return null!=a&&!this.blacklistedFormatters.findWhere({formatter:a})},b.prototype.renderChildren=function(){return this.renderHeaders(),this.renderBody()},b.prototype.renderHeaders=function(){return this.renderChild("head",new m(r.pick(this,m.prototype.parameters)))},b.prototype.renderBody=function(){return this.renderChild("body",new l({collection:this.rows,history:this.history,makeCell:this.cellFactory}))},b.prototype.remove=function(){return this.expandedSubtables.close(),delete this.expandedSubtables,this.popoverFactory.destroy(),delete this.popoverFactory,delete this.cellFactory,b.__super__.remove.apply(this,arguments)},b}(e)}).call(this)},{"../../core-view":3,"../../core/type-assertions":10,"../../formatting":13,"../../models/column-headers":39,"../../models/history":45,"../../models/path-set":55,"../../models/selected-objects":58,"../../models/table":61,"../../templates":67,"../../utils/popover-factory":98,"../item-preview":172,"./body":210,"./cell-factory":211,"./head":215,underscore:310}],218:[function(a,b,c){(function(){var c,d,e,f,g={}.hasOwnProperty,h=function(a,b){function c(){this.constructor=a}for(var d in b)g.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};f=a("underscore"),d=a("../modal"),e=a("../../templates").large_table_disuader,c={ACCEPT:"accept",CONSTRAIN:"constrain",BACK:"back",FWD:"forward",EXPORT:"export",DISMISS:"dismiss"},b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return h(b,a),b.prototype.className=function(){return"im-page-size-sanity-check fade "+b.__super__.className.apply(this,arguments)},b.prototype.template=f.template(e),b.prototype.act=function(){return this.resolve("accept")},b.prototype.events=function(){return f.extend(b.__super__.events.apply(this,arguments),{"click .btn-primary":function(a){return function(){return a.resolve(c.ACCEPT)}}(this),"click .add-filter-dialogue":function(a){return function(){return a.resolve(c.CONSTRAIN)}}(this),"click .page-backwards":function(a){return function(){return a.resolve(c.BACK)}}(this),"click .page-forwards":function(a){return function(){return a.resolve(c.FWD)}}(this),"click .download-menu":function(a){return function(){return a.resolve(c.EXPORT)}}(this)})},b}(d)}).call(this)},{"../../templates":67,"../modal":197,underscore:310}],219:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k={}.hasOwnProperty,l=function(a,b){function c(){this.constructor=a}for(var d in b)k.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};j=a("underscore"),d=a("../../core-view"),i=a("../../templates"),c=a("../../core/collection"),f=a("../../models/path"),e=a("./column-summary"),h=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return l(b,a),b.prototype.model=f,b}(c),g=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return l(b,a),b.prototype.parameters=["showPathSummary"],b.prototype.className="im-subpath im-outer-joined-path",b.prototype.tagName="li",b.prototype.template=j.template('<a href="#">'+i.column_manager_path_name+"</a>"),b.prototype.modelEvents=function(){return{change:this.reRender}},b.prototype.events=function(){return{click:this.onClick}},b.prototype.onClick=function(a){return a.stopPropagation(),a.preventDefault(),this.showPathSummary(this.model)},b}(d),b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return l(b,a),b.prototype.parameters=["query"],b.prototype.className="im-summary-selector",b.prototype.tagName="ul",b.prototype.initialize=function(){var a,c,d,e;for(b.__super__.initialize.apply(this,arguments),this.subColumns=new h,e=this.model.get("replaces"),c=0,d=e.length;c<d;c++)a=e[c],this.subColumns.add(this.query.makePath(a));return this.path=new f(this.query.makePath(this.model.get("path")))},b.prototype.getSubpaths=function(){return this.subColumns},b.prototype.postRender=function(){var a,b;return a=this.getSubpaths(),1===a.length?this.showPathSummary(a.first()):(b=function(a){return function(b){return a.showPathSummary(b)}}(this),this.getSubpaths().each(function(a){return function(c,d){return a.renderChild(d,new g({model:c,showPathSummary:b}))}}(this)))},b.prototype.showPathSummary=function(a){var b;return this.undelegateEvents(),this.removeAllChildren(),b=new e({query:this.query,model:a}),this.children.summ=b,b.setElement(this.el),b.render()},b}(d)}).call(this)},{"../../core-view":3,"../../core/collection":5,"../../models/path":56,"../../templates":67,"./column-summary":213,underscore:310}],220:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l={}.hasOwnProperty,m=function(a,b){function c(){this.constructor=a}for(var d in b)l.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},n=[].indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(b in this&&this[b]===a)return b;return-1};k=a("underscore"),i=a("./paging"),f=a("../has-dialogues"),c=a("../../core-view"),j=a("../../templates"),d=a("../../events"),h=a("../new-filter-dialogue"),e=a("../export-dialogue"),g=a("./large-table-disuader"),b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return m(b,a),b.include(i),b.include(f),b.prototype.tagName="form",b.prototype.className="im-page-sizer im-table-control form-inline",b.prototype.sizes=[[10],[25],[50],[100],[250]],b.prototype.parameters=["getQuery"],b.prototype.initialize=function(){var a,c;if(b.__super__.initialize.apply(this,arguments),null!=(c=this.model.get("size"))&&n.call(function(){var b,c,d,e;for(d=this.sizes,e=[],b=0,c=d.length;b<c;b++)a=d[b][0],e.push(a);return e}.call(this),c)<0)return this.sizes=[[c,c]].concat(this.sizes)},b.prototype.events=function(){return{submit:d.suppress,"change select":"changePageSize"}},b.prototype.modelEvents=function(){return{"change:size":function(a,b){return this.$("select").val(b)},"change:count":this.reRender}},b.prototype.changePageSize=function(a){var b,c,d,f,g;return c=this.$(a.target),g=parseInt(c.val(),10),d=this.model.get("size"),b=function(a){return function(){return a.model.set({size:g})}}(this),this.aboveSizeThreshold(g)?(f=this.whenAcceptable(g).then(function(a){return function(f){if("accept"===f)return b();switch(c.val(d),f){case"back":return a.goBack(1);case"forward":return a.goForward(1);case"constrain":return a.openDialogue(new h({query:a.getQuery()}));case"export":return a.openDialogue(e({query:a.getQuery()}));default:return console.debug("dismissed dialogue",f)}}}(this)),f.then(null,function(a){return console.error("Error handling dialogues",a)})):b()},b.prototype.whenAcceptable=function(a){return this.openDialogue(new g({model:{size:a}}))},b.prototype.template=j.template("page_sizer"),b.prototype.getData=function(){var a,b,c,d,e;return a=this.model.get("count"),d=this.model.get("size"),e=function(){var b,d,e,f;for(e=this.sizes,f=[],b=0,d=e.length;b<d;b++)c=e[b],(null==a||c[0]<a)&&f.push(c);return f}.call(this),e.length&&a<this.sizes[this.sizes.length-1][0]&&(b=k.find(e,function(b){return b[0]===a}),b?b[1]+=b[0]+" (All)":e.push([a,a+" (All)"])),{size:d,sizes:e}},b.prototype.pageSizeFeasibilityThreshold=250,b.prototype.aboveSizeThreshold=function(a){return!!(a&&a>=this.pageSizeFeasibilityThreshold)||!a&&this.model.get("count")>=this.pageSizeFeasibilityThreshold},b}(c)}).call(this)},{"../../core-view":3,"../../events":12,"../../templates":67,"../export-dialogue":138,"../has-dialogues":171,"../new-filter-dialogue":200,"./large-table-disuader":218,"./paging":222,underscore:310}],221:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j={}.hasOwnProperty,k=function(a,b){function c(){this.constructor=a}for(var d in b)j.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};d=200,i=a("underscore"),e=a("../../core-view"),c=a("./paging"),g='<ul class="pagination">\n    <li class="hidden-xs <%= gotoStart || \'im-goto-start\' %>" title="Go to start">\n        <a class="im-pagination-button">&#x21e4;</a>\n    </li>\n    <li class="hidden-xs hidden-sm <%= goFiveBack || \'im-go-back-5\' %>"\n        title="Go back five pages"\n        class="visible-desktop">\n        <a class="im-pagination-button">&#x219e;</a>\n    </li>\n    <li class="<%= goOneBack || \'im-go-back-1\' %>"\n        title="Go to previous page">\n        <a class="im-pagination-button">&larr;</a>\n    </li>\n    <li class="im-current-page">\n        <% if (useSelect) { %>\n          <form class="im-page-form form form-inline">\n            <select class="form-control">\n              <% for (i = 0; i < max; i++) { %>\n                <option\n                  <%= selected(i) ? \'selected\' : void 0 %>\n                  value="<%= i * size %>">\n                  page <%= i + 1 %>\n                </option>\n              <% } %>\n            </select>\n          </form>\n        <% } else { %>\n          <a href="#">&hellip;</a>\n          <form class="im-page-form form form-inline"\n                style="display:none;">\n            <div class="control-group">\n                <input type="number"\n                       value="<%= currentPage %>"\n                       max="<%= max %>"\n                       min="<%= min %>"\n                       class="form-control im-page-number">\n            </div>\n          </form>\n        <% } %>\n    </li>\n    <li class="<%= goOneForward || \'im-go-fwd-1\' %>"\n        title="Go to next page">\n        <a class="im-pagination-button">&rarr;</a>\n    </li>\n    <li class="hidden-xs hidden-sm <%= goFiveForward || \'im-go-fwd-5\' %>"\n        title="Go forward five pages"\n        class="visible-desktop">\n        <a class="im-pagination-button">&#x21a0;</a>\n    </li>\n    <li class="hidden-xs <%= gotoEnd || \'im-goto-end\' %>"\n        title="Go to last page">\n        <a class="im-pagination-button">&#x21e5;</a>\n    </li>\n</ul>\n',h=function(a){return a.replace(/\s+/g,"")},f=function(a){return"string"==typeof a?parseInt(h(a),10):a},b.exports=function(a){function b(){
return b.__super__.constructor.apply(this,arguments)}return k(b,a),b.include(c),b.prototype.tagName="nav",b.prototype.className="im-table-pagination im-table-control",b.prototype.RERENDER_EVENT="change:start change:count change:size",b.prototype.template=i.template(g),b.prototype.modelEvents=function(){return{"change:count":this.setVisible}},b.prototype.getData=function(){var a,b,c,e,f;return f=this.model.toJSON(),e=f.start,c=f.size,a=f.count,b=this.getMaxPage(),{max:b,min:1,size:c,currentPage:this.getCurrentPage(),gotoStart:0===e?"disabled":void 0,goFiveBack:e<5*c?"disabled":void 0,goOneBack:e<c?"disabled":void 0,gotoEnd:e>=a-c?"disabled":void 0,goFiveForward:e>=a-6*c?"disabled":void 0,goOneForward:e>=a-c?"disabled":void 0,selected:function(a){return e===a*c},useSelect:b<=d}},b.prototype.postRender=function(){return this.$("li").tooltip({placement:"top"}),this.setVisible()},b.prototype.setVisible=function(){var a;return a=this.getMaxPage(),this.$el.toggleClass("im-hidden",a<2)},b.prototype.events=function(){return{"submit .im-page-form":"pageFormSubmit","click .im-current-page a":"clickCurrentPage","change .im-page-form select":"goToChosenPage","blur .im-page-form input":"pageFormSubmit","click .im-goto-start":function(a){return function(){return a.goTo(0)}}(this),"click .im-go-back-5":function(a){return function(){return a.goBack(5)}}(this),"click .im-go-back-1":function(a){return function(){return a.goBack(1)}}(this),"click .im-go-fwd-5":function(a){return function(){return a.goForward(5)}}(this),"click .im-go-fwd-1":function(a){return function(){return a.goForward(1)}}(this),"click .im-goto-end":function(a){return function(){return a.goTo((a.getMaxPage()-1)*a.model.get("size"))}}(this)}},b.prototype.goToChosenPage=function(a){var b;return b=f(this.$(a.target).val()),this.goTo(b)},b.prototype.clickCurrentPage=function(a){var b,c;if(b=this.model.get("size"),c=this.model.get("count"),!(b>=c))return this.$(a.target).hide(),this.$("form").show().find("input").focus()},b.prototype.pageFormSubmit=function(a){var b,c,d,e;if(null!=a&&a.stopPropagation(),null!=a&&a.preventDefault(),e=this.$(".im-page-form"),c=this.$(".im-page-form input"),c.size())return b=f(c[0].value),b>=1?(d=Math.min(this.getMaxPage(),b),this.goTo((d-1)*this.model.get("size")),this.$(".im-current-page > a").show(),e.hide()):(e.find(".control-group").addClass("error"),inp.val(null))},b}(e)}).call(this)},{"../../core-view":3,"./paging":222,underscore:310}],222:[function(a,b,c){(function(){c.getCurrentPage=function(){var a,b,c;return c=this.model.toJSON(),b=c.start,a=c.size,Math.floor(b/a)+1},c.getMaxPage=function(){var a,b,c,d;return d=this.model.toJSON(),b=d.count,c=d.size,a=b%c==0?0:1,Math.floor(b/c)+a},c.goTo=function(a){return this.model.set({start:a})},c.goToPage=function(a){return this.model.set({start:(a-1)*this.model.get("size")})},c.goBack=function(a){var b,c,d;return d=this.model.toJSON(),c=d.start,b=d.size,this.goTo(Math.max(0,c-a*b))},c.goForward=function(a){var b,c,d;return d=this.model.toJSON(),c=d.start,b=d.size,this.goTo(Math.min(this.getMaxPage()*b,c+a*b))}}).call(this)},{}],223:[function(a,b,c){(function(){var c,d,e,f,g={}.hasOwnProperty,h=function(a,b){function c(){this.constructor=a}for(var d in b)g.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};f=a("underscore"),c=a("../../core-view"),e=a("../../templates"),a("../../messages/subtables"),d=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return h(b,a),b.prototype.tagName="th",b.prototype.parameters=["columnModel","model","query"],b.prototype.template=e.template("table-subtables-header"),b.prototype.getData=function(){return f.extend(b.__super__.getData.apply(this,arguments),this.columnModel.pick("columnName"))},b.prototype.modelEvents=function(){return{"change:displayName":this.reRender}},b.prototype.events=function(){return{"click a":this.removeView}},b.prototype.removeView=function(){var a;return this.query.removeFromSelect(null!=(a=this.model.get("replaces"))?a:this.model.get("path"))},b.prototype.postRender=function(){return this.$("[title]").tooltip()},b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this.listenTo(this.columnModel,"change:columnName",this.reRender)},b.prototype.remove=function(){return delete this.columnModel,b.__super__.remove.apply(this,arguments)},b}(c),b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return h(b,a),b.prototype.tagName="thead",b.prototype.template=function(){return"<tr></tr>"},b.prototype.parameters=["collection","columnModel","query"],b.prototype.collectionEvents=function(){return{"add remove":this.reRender}},b.prototype.renderChildren=function(){var a;return a=this.el.querySelector("tr"),this.collection.forEach(function(b){return function(c,e){return b.renderChild(e,new d({model:c,query:b.query,columnModel:b.columnModel}),a)}}(this))},b.prototype.remove=function(){return delete this.columnModel,b.__super__.remove.apply(this,arguments)},b}(c)}).call(this)},{"../../core-view":3,"../../messages/subtables":26,"../../templates":67,underscore:310}],224:[function(a,b,c){(function(){var c,d,e,f={}.hasOwnProperty,g=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};c=a("../../core-view"),d=a("./subtable-header"),e=a("../../utils/build-skipset"),b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return g(b,a),b.prototype.tagName="table",b.prototype.className="im-subtable table table-condensed table-striped",b.prototype.parameters=["query","headers","model","rows","cellify"],b.prototype.render=function(){var a,b,c,d,e,f;for(this.removeAllChildren(),this.rendered&&(this.el.innerHTML=""),this.headers.length>1&&this.renderHead(),c=document.createElement("tbody"),f=this.rows,a=d=0,e=f.length;d<e;a=++d)b=f[a],this.appendRow(b,a,c);return this.el.appendChild(c),this.trigger("rendered",this.rendered=!0),this},b.prototype.renderHead=function(a){var b;return b=new d({query:this.query,collection:this.headers,columnModel:this.model}),this.renderChild("thead",b,a)},b.prototype.buildSkipped=function(a){return null!=this._skipped?this._skipped:this._skipped=e(a,this.headers)},b.prototype.appendRow=function(a,b,c){var d,e,f,g,h,i,j,k,l;for(i=document.createElement("tr"),c.appendChild(i),f=function(){var b,c,e;for(e=[],b=0,c=a.length;b<c;b++)d=a[b],e.push(this.cellify(d));return e}.call(this),h=this.buildSkipped(f),l=[],g=j=0,k=f.length;j<k;g=++j)e=f[g],h[e.model.get("column")]||l.push(this.renderChild("cell-"+b+"-"+g,e,i));return l},b}(c)}).call(this)},{"../../core-view":3,"../../utils/build-skipset":72,"./subtable-header":223}],225:[function(a,b,c){(function(){var c,d,e,f={}.hasOwnProperty,g=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};c=a("../../core-view"),d=a("../../messages"),e=a("../../templates"),a("../../messages/subtables"),b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return g(b,a),b.prototype.className="im-subtable-summary",b.prototype.tagName="span",b.prototype.template=e.template("table-subtable-summary"),b.prototype.parameters=["model","state"],b.prototype.modelEvents=function(){return{"change:contentName":this.reRender}},b.prototype.events=function(){return{click:this.onClick}},b.prototype.onClick=function(a){return null!=a&&a.stopPropagation(),this.$el.tooltip("hide"),this.state.toggle("open")},b.prototype.postRender=function(){return this.$el.tooltip({title:this.model.get("rows").length?d.getText("subtables.OpenHint"):void 0,placement:"auto right"})},b}(c)}).call(this)},{"../../core-view":3,"../../messages":16,"../../messages/subtables":26,"../../templates":67}],226:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l,m,n,o={}.hasOwnProperty,p=function(a,b){function c(){this.constructor=a}for(var d in b)o.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};n=a("underscore"),d=a("../../core-view"),g=a("../../options"),c=a("../../core/collection"),l=a("../../templates"),m=a("../../core/type-assertions"),f=a("../../models/nested-table"),i=a("../../models/path"),k=a("./subtable-summary"),j=a("./subtable-inner"),a("../../utils/events").ignore,h=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return p(b,a),b.prototype.model=i,b}(c),e="Subtables.Initially.expanded",b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return p(b,a),b.prototype.tagName="td",b.prototype.className="im-result-subtable",b.prototype.Model=f,b.prototype.parameters=["query","cellify","expandedSubtables"],b.prototype.parameterTypes={query:m.Query,cellify:m.Function,expandedSubtables:m.Collection},b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this.headers=new h,this.listenTo(this.expandedSubtables,"add remove reset",this.onChangeExpandedSubtables),this.buildHeaders()},b.prototype.getPath=function(){return this.model.get("column")},b.prototype.initState=function(){var a;return a=g.get(e)||this.expandedSubtables.contains(this.getPath()),this.state.set({open:a})},b.prototype.stateEvents=function(){return{"change:open":this.onChangeOpen}},b.prototype.onChangeOpen=function(){var a;return a=this.el.querySelector(".im-table-wrapper"),this.state.get("open")?this.renderTable(a)?this.$(a).slideDown():void 0:this.$(a).slideUp()},b.prototype.onChangeExpandedSubtables=function(){return this.state.set({open:this.expandedSubtables.contains(this.getPath())})},b.prototype.template=l.template("table-subtable"),b.prototype.renderChildren=function(){return this.renderChildAt(".im-subtable-summary",new k({model:this.model,state:this.state})),this.onChangeOpen()},b.prototype.tableRendered=!1,b.prototype.renderTable=function(a){var b,c;return c=this.model.get("rows"),this.tableRendered||0===c.length?this.tableRendered:(b=new j(n.extend({rows:c},n.pick(this,j.prototype.parameters))),this.renderChild("inner",b,a),this.tableRendered=!0)},b.prototype.buildHeaders=function(){var a,b;if(null!=(b=this.model.get("rows")[0]))return this.headers.set(function(){var c,d,e;for(e=[],c=0,d=b.length;c<d;c++)a=b[c],e.push(new i(a.get("column")));return e}())},b}(d)}).call(this)},{"../../core-view":3,"../../core/collection":5,"../../core/type-assertions":10,"../../models/nested-table":48,"../../models/path":56,"../../options":63,"../../templates":67,"../../utils/events":81,"./subtable-inner":224,"./subtable-summary":225,underscore:310}],227:[function(a,b,c){(function(){var c,d,e,f={}.hasOwnProperty,g=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};e=a("underscore"),c=a("../../core-view"),d=a("../../templates"),a("../../messages/table"),b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return g(b,a),b.prototype.className="im-table-summary hidden-phone",b.prototype.RERENDER_EVENT="change:start change:size change:count",b.prototype.getData=function(){var a,c,d,f,g;return g=c=b.__super__.getData.apply(this,arguments),f=g.start,d=g.size,a=g.count,e.extend(c,{page:{count:a,first:f+1,last:0===d?0:Math.min(f+d,a)}})},b.prototype.template=d.template("count_summary"),b}(c)}).call(this)},{"../../core-view":3,"../../messages/table":28,"../../templates":67,underscore:310}],228:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k={}.hasOwnProperty,l=function(a,b){function c(){this.constructor=a}for(var d in b)k.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},m=[].indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(b in this&&this[b]===a)return b;return-1};j=a("underscore"),d=a("es6-promise").Promise,c=a("../messages"),e=a("../core-view"),c.set({"typeconstraints.BadType":"<%- type %> is not a legal value for this constraint. Choose another from the list.","typeconstraints.OneClass":"<%- name %> is the only legal value this constraint can have. You can always remove it though."}),i=a("../utils/to-named-path"),g=a("../templates/helpers"),h="<label class=\"span4\">\n    <%- messages.getText('conbuilder.IsA') %>\n</label>\n<% if (subclasses.length == 1) { %>\n  <select disabled class=\"form-control\">\n      <option><%- subclasses[0].text %></option>\n  </select>\n<% } else { %>\n  <%= select(subclasses, isSelected, 'form-control im-value-type') %>\n<% } %>\n  \n",f=function(a){var b,c;return c=a.path,b=a.name,{value:c,text:b}},b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return l(b,a),b.prototype.parameters=["query","model"],b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this.model.swap("type",function(a){return function(b){return null!=b?b:a.model.get("path").getType().name}}(this)),this.listenTo(c,"change",this.reRender),this.listenTo(this.state,"change:subclasses",this.reRender),this.setSubclasses()},b.prototype.getData=function(){var a,b;return b=this.model.get("type"),{select:g.select,messages:c,subclasses:function(){var b,c,d,e,g;for(e=null!=(d=this.state.get("subclasses"))?d:[],g=[],b=0,c=e.length;b<c;b++)a=e[b],g.push(f(a));return g}.call(this),isSelected:function(a){return b===a.value}}},b.prototype.events=function(){return{"change .im-value-type":"setType"}},b.prototype.setType=function(){return this.model.set({type:this.$(".im-value-type").val()})},b.prototype.template=j.template(h),b.prototype.setSubclasses=function(){if(!this.model.has("subclasses"))return this.getPossibleTypes().then(function(a){return function(b){var d;return 1===b.length&&(d=c.getText("typeconstraints.OneClass",b[0]),a.model.set({error:{message:d,level:"warning"}})),a.state.set({subclasses:b})}}(this))},b.prototype.getPossibleTypes=function(){var a,b,e,f,g,h,j,k,l,n;return n=this.model.toJSON(),b=n.path,l=n.type,h=this.query.getSubclasses(),g=this.query.model,delete h[b],a=g.getPathInfo(b.toString(),h).getType(),j=function(){var b,c,d,e;for(d=g.getSubclassesOf(a),e=[],b=0,c=d.length;b<c;b++)(k=d[b])!==a.name&&e.push(k);return e}(),e=function(){var a,b,c;for(c=[],a=0,b=j.length;a<b;a++)k=j[a],c.push(g.makePath(k));return c}(),f=e.map(i),m.call(j,l)<0&&(this.model.set({error:new Error(c.getText("typeconstraints.BadType",this.model.toJSON()))}),f.push(d.resolve({path:l,name:this.model.get("typeName")}))),d.all(f)},b}(e)}).call(this)},{"../core-view":3,"../messages":16,"../templates/helpers":68,"../utils/to-named-path":109,"es6-promise":257,underscore:310}],229:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l,m={}.hasOwnProperty,n=function(a,b){function c(){this.constructor=a}for(var d in b)m.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};l=a("underscore"),c=a("../core-view"),i=a("../templates"),f=a("../messages"),g=a("../options"),h=a("./undo-history/step"),j=function(a){return"state-"+a.get("revision")},d=-1,a("../messages/undo"),e=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return n(b,a),b.prototype.parameters=["more"],b.prototype.tagName="li",b.prototype.className="im-step im-ellipsis",b.prototype.template=function(){return l.escape(f.getText("undo.MoreSteps",{more:this.more})+" ...")},b.prototype.attributes=function(){return{title:f.getText("undo.ShowAllStates",{n:this.more})}},b.prototype.postRender=function(){return this.$el.tooltip({placement:"right"})},b.prototype.events=function(){return{click:function(a){return a.preventDefault(),a.stopPropagation(),this.state.toggle("showAll")}}},b}(c),k=function(a,b,c){var d;return d=c[b-1],0===b||b===c.length-1||a.get("count")!==d.get("count")},b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return n(b,a),b.prototype.parameters=["collection"],b.prototype.className="btn-group im-undo-history",b.prototype.template=i.template("undo-history"),b.prototype.events=function(){return{"click .btn.im-undo":"revertToPreviousState","click .im-toggle-trivial":"toggleTrivial"}},b.prototype.initState=function(){return this.state.set({showAll:!1,hideTrivial:!1})},b.prototype.stateEvents=function(){return{"change:showAll":this.reRender,"change:hideTrivial":this.reRender}},b.prototype.collectionEvents=function(){return{remove:this.removeStep,"add remove":this.reRender,"change:count":this.reRenderIfHidingTrivial}},b.prototype.toggleTrivial=function(a){return a.preventDefault(),a.stopPropagation(),this.state.toggle("hideTrivial")},b.prototype.revertToPreviousState=function(){return this.collection.popState()},b.prototype.reRenderIfHidingTrivial=function(){if(this.state.get("hideTrivial"))return this.reRender()},b.prototype.postRender=function(){return this.$(".im-toggle-trivial").tooltip({placement:"right"}),this.$list=this.$(".im-state-list"),this.renderStates(),this.$el.toggleClass("im-has-history",this.collection.size()>1),this.$el.toggleClass("im-hidden",this.collection.size()<=1)},b.prototype.renderStates=function(){var a,b,c,e,f,h,i,j,l,m,n,o,p,q,r,s;for(n=this.state.toJSON(),i=n.showAll,c=n.hideTrivial,a=this.collection,f=c?a.filter(k):a.models.slice(),j=f.length,b=g.get("UndoHistory.ShowAllStatesCutOff"),h=i||j<=b?function(){q=[];for(var a=o=j-1;o<=0?a<=0:a>=0;o<=0?a++:a--)q.push(a);return q}.apply(this):function(){r=[];for(var a=p=j-1,c=j-(b-1);p<=c?a<=c:a>=c;p<=c?a++:a--)r.push(a);return r}.apply(this).concat([d,0]),s=[],l=0,m=h.length;l<m;l++)e=h[l],e===d?s.push(this.renderEllipsis(j-b)):s.push(this.renderState(f[e]));return s},b.prototype.renderEllipsis=function(a){return this.renderChild("...",new e({more:a,state:this.state}),this.$list)},b.prototype.renderState=function(a){return this.renderChild(j(a),new h({model:a}),this.$list)},b.prototype.removeStep=function(a){return this.removeChild(j(a))},b}(c)}).call(this)},{"../core-view":3,"../messages":16,"../messages/undo":29,"../options":63,"../templates":67,"./undo-history/step":231,underscore:310}],230:[function(a,b,c){(function(){var c,d,e,f,g={}.hasOwnProperty,h=function(a,b){function c(){this.constructor=a}for(var d in b)g.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};f=a("underscore"),d=a("../../core-view"),e=a("../../templates"),c=a("../../utils/css-class-set"),b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return h(b,a),b.prototype.template=e.template("undo-history-step-section"),b.prototype.labelContent=function(){throw new Error("NOT IMPLEMENTED")},b.prototype.summaryLabel=function(){return thow(new Error("NOT IMPLEMENTED"))},b.prototype.initState=function(){return this.state.set({open:!1})},b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this.collectionClasses=new c({"well well-sm":!0,"im-hidden":function(a){return function(){return!a.state.get("open")}}(this)})},b.prototype.getData=function(){var a,c;return c=f.result(this,"summaryLabel"),a=this.collection.where({removed:!1}).length,f.extend(b.__super__.getData.apply(this,arguments),{count:a,summaryLabel:c,labelContent:this.labelContent,collectionClasses:this.collectionClasses})},b.prototype.events=function(){return{"click .im-section-summary":"toggleOpen"}},b.prototype.stateEvents=function(){return{"change:open":this.reRender}},b.prototype.collectionEvents=function(){return{change:this.reRender}},b.prototype.toggleOpen=function(a){return a.stopPropagation(),a.preventDefault(),this.state.toggle("open")},b}(d)}).call(this)},{"../../core-view":3,"../../templates":67,"../../utils/css-class-set":79,underscore:310}],231:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w={}.hasOwnProperty,x=function(a,b){function c(){this.constructor=a}for(var d in b)w.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},y=[].indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(b in this&&this[b]===a)return b;return-1};v=a("underscore"),g=a("../../core-view"),c=a("../../core/collection"),p=a("../../templates"),h=a("../../messages"),k=a("../../models/path"),e=a("../../models/constraint"),j=a("../../models/order-element"),l=a("./query-property-section"),a("../../messages/undo"),a("../../messages/constraints"),u=function(a){return function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return x(b,a),b.prototype.defaults=function(){return v.extend(b.__super__.defaults.apply(this,arguments),{added:!1,removed:!1})},b}(a)},i=function(a){function b(a){var c;c=a.path,b.__super__.constructor.call(this,c)}return x(b,a),b}(k),q=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return x(b,a),b.prototype.model=u(i),b}(c),d=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return x(b,a),b.prototype.model=u(e),b}(c),n=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return x(b,a),b.prototype.model=u(j),b}(c),s=function(a){return function(b){var c;return b=v.isString(b)?{path:b}:b,c={path:a.makePath(b.path)},b.type&&(c.type=a.model.makePath(b.type)),v.extend(c,v.omit(b,"path","type"))}},b.exports=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return x(b,a),b.prototype.className="im-step",b.prototype.tagName="li",b.prototype.template=p.template("undo-history-step"),b.prototype.getData=function(){return v.extend(b.__super__.getData.apply(this,arguments),{diff:this.getCountDiff()})},b.prototype.getCountDiff=function(){return this.state.has("prevCount")?this.model.get("count")-this.state.get("prevCount"):null},b.prototype.initialize=function(){var a,c,e,f;if(b.__super__.initialize.apply(this,arguments),c=this.model.get("query"),this.initPrevCount(),a=s(c),this.listenTo(this.model.collection,"add remove",this.setCurrent),this.views=new q(c.views.map(a)),this.constraints=new d(c.constraints.map(a)),this.sortOrder=new n(c.sortOrder.map(a)),e=this.model.get("title"),"Added"===(f=e.verb)||"Removed"===f||"Changed"===f)switch(e.label){case"column":return this.diffView();case"sort order element":return this.diffSortOrder();case"filter":return this.diffConstraints();case"Initial":return null;default:return console.error("Cannot diff",e.label)}},b.prototype.initPrevCount=function(){var a;if(a=this.getPrevModel())return this.state.set({prevCount:a.get("count")}),this.listenTo(a,"change:count",function(b){return function(){return b.state.set({prevCount:a.get("count")})}}(this))},b.prototype.getPrevModel=function(){var a;return a=this.model.collection.indexOf(this.model),0===a?null:this.model.collection.at(a-1)},b.prototype.diff=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p;for(h=this.getPrevModel(),d=this.model.get("query"),i=h.get("query"),n=d[a],f=j=0,l=n.length;j<l;f=++j)e=n[f],c(e,i)&&b.at(f).set({added:!0});for(g=s(i),o=i[a],p=[],f=k=0,m=o.length;k<m;f=++k)e=o[f],c(e,d)&&p.push(b.add(g(e),{at:f}).set({removed:!0}));return p},b.prototype.diffView=function(){return this.diff("views",this.views,function(a,b){var c;return c=b.views,y.call(c,a)<0})},b.prototype.diffSortOrder=function(){return this.diff("sortOrder",this.sortOrder,function(a,b){return!v.findWhere(b.sortOrder,a)})},b.prototype.diffConstraints=function(){return this.diff("constraints",this.constraints,function(a,b){return!v.findWhere(b.constraints,a)})},b.prototype.initState=function(){return this.setCurrent()},b.prototype.setCurrent=function(){var a,b,c;if(null!=(c=this.model)?c.collection:void 0)return a=this.model.collection.indexOf(this.model),b=this.model.collection.size(),this.state.set({current:a===b-1})},b.prototype.stateEvents=function(){return{change:this.reRender}},b.prototype.modelEvents=function(){return{change:this.reRender}},b.prototype.events=function(){return{"click .btn.im-state-revert":"revertToState",click:function(a){return a.preventDefault(),a.stopPropagation()}}},b.prototype.revertToState=function(){return this.model.collection.revertTo(this.model)},b.prototype.postRender=function(){var a;if(this.$details=this.$(".im-step-details"),this.$el.toggleClass("im-current-state",this.state.get("current")),this.$(".btn[title]").tooltip({placement:"right"}),this.state.get("current"))return this.renderAllSections();switch(a=this.model.get("title"),a.label){case"column":return this.renderViews();case"filter":return this.renderConstraints();case"sort order element":return this.renderSortOrder();case"Initial":return null;default:return console.error("Cannot render",a.label)}},b.prototype.renderAllSections=function(){return this.renderViews(),this.renderConstraints(),this.renderSortOrder()},b.prototype.renderViews=function(){return this.renderChild("views",new m({collection:this.views}),this.$details)},b.prototype.renderSortOrder=function(){return this.renderChild("so",new o({collection:this.sortOrder}),this.$details)},b.prototype.renderConstraints=function(){return this.renderChild("cons",new f({collection:this.constraints}),this.$details)},b}(g),m=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return x(b,a),b.prototype.summaryLabel="undo.ViewCount",b.prototype.labelContent=function(a){return a.displayName},b}(l),o=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return x(b,a),b.prototype.summaryLabel="undo.OrderElemCount",b.prototype.labelContent=function(a){return a.displayName+" "+a.direction},b}(l),t=function(a){return h.getText("constraints.NoOfValues",{n:a.values.length})},r=function(a){return h.getText("constraints.NoOfIds",{n:a.ids.length})},f=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return x(b,a),b.prototype.summaryLabel="undo.ConstraintCount",b.prototype.labelContent=function(a){var b;return b=function(){switch(a.CONSTRAINT_TYPE){case"MULTI_VALUE":return[a.displayName,a.op,a.values.length,t(a)];case"TYPE":return[a.displayName,h.getText("constraints.ISA"),a.typeName];case"IDS":return[a.displayName,a.op,r(a)];case"LOOKUP":return[a.displayName,a.op,a.value,h.getText("constraints.LookupIn"),a.extraValue];default:return[a.displayName,a.op,a.value]}}(),b.join(" ")},b}(l)}).call(this)},{"../../core-view":3,"../../core/collection":5,"../../messages":16,"../../messages/constraints":21,"../../messages/undo":29,"../../models/constraint":40,"../../models/order-element":53,"../../models/path":56,"../../templates":67,"./query-property-section":230,underscore:310}],232:[function(a,b,c){!function(){function a(a){this.message=a}var b=void 0!==c?c:this,d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";a.prototype=new Error,a.prototype.name="InvalidCharacterError",b.btoa||(b.btoa=function(b){for(var c,e,f=0,g=d,h="";b.charAt(0|f)||(g="=",f%1);h+=g.charAt(63&c>>8-f%1*8)){if((e=b.charCodeAt(f+=.75))>255)throw new a("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");c=c<<8|e}return h}),b.atob||(b.atob=function(b){if(b=b.replace(/=+$/,""),b.length%4==1)throw new a("'atob' failed: The string to be decoded is not correctly encoded.");for(var c,e,f=0,g=0,h="";e=b.charAt(g++);~e&&(c=f%4?64*c+e:e,f++%4)?h+=String.fromCharCode(255&c>>(-2*f&6)):0)e=d.indexOf(e);return h})}()},{}],233:[function(a,b,c){(function(d,e){function f(a,b){return"string"==typeof a?b==a:a&&"function"==typeof a.exec?a.exec(b):"boolean"==typeof a?a:"function"==typeof a&&a(b)}var g=a("jsonparse"),h=a("through");c.parse=function(a,b){var c=new g,d=h(function(a){"string"==typeof a&&(a=new e(a)),c.write(a)},function(a){a&&d.write(a),d.queue(null)});"string"==typeof a&&(a=a.split(".").map(function(a){return"*"===a||(""===a?{recurse:!0}:a)}));var i=0;return a&&a.length||(a=null),c.onValue=function(c){if(this.root||(d.root=c),a){for(var e=0,g=0;e<a.length;){var h,j=a[e];if(g++,j&&!j.recurse){if(!(h=g===this.stack.length?this:this.stack[g]))return;if(!f(j,h.key))return;e++}else{e++;var k=a[e];if(!k)return;for(;;){if(!(h=g===this.stack.length?this:this.stack[g]))return;if(f(k,h.key)){e++;break}g++}}}if(g===this.stack.length){i++;var l=this.stack.slice(1).map(function(a){return a.key}).concat([this.key]),m=this.value[this.key];null!=m&&null!=(m=b?b(m,l):m)&&d.queue(m),delete this.value[this.key]}}},c._onToken=c.onToken,c.onToken=function(b,e){c._onToken(b,e),0===this.stack.length&&d.root&&(a||d.queue(d.root),d.emit("root",d.root,i),i=0,d.root=null)},c.onError=function(a){d.emit("error",a)},d},c.stringify=function(a,b,c,d){d=d||0,!1===a?(a="",b="\n",c=""):null==a&&(a="[\n",b="\n,\n",c="\n]\n");var e,f=!0,g=!1;return e=h(function(c){g=!0;var h=JSON.stringify(c,null,d);f?(f=!1,e.queue(a+h)):e.queue(b+h)},function(b){g||e.queue(a),e.queue(c),e.queue(null)})},c.stringifyObject=function(a,b,c,d){d=d||0,!1===a?(a="",b="\n",c=""):null==a&&(a="{\n",b="\n,\n",c="\n}\n");var e=!0,f=!1;return stream=h(function(c){f=!0;var g=JSON.stringify(c[0])+":"+JSON.stringify(c[1],null,d);e?(e=!1,this.queue(a+g)):this.queue(b+g)},function(b){f||this.queue(a),this.queue(c),this.queue(null)}),stream},b.parent||"browser"===d.title||d.stdin.pipe(c.parse(d.argv[2])).pipe(c.stringify("[",",\n","]\n",2)).pipe(d.stdout)}).call(this,a("_process"),a("buffer").Buffer)},{_process:291,buffer:254,jsonparse:289,through:308}],234:[function(b,c,d){!function(){function b(){return{keys:Object.keys||function(a){if("object"!=typeof a&&"function"!=typeof a||null===a)throw new TypeError("keys() called on a non-object");var b,c=[];for(b in a)a.hasOwnProperty(b)&&(c[c.length]=b);return c},uniqueId:function(a){var b=++j+"";return a?a+b:b},has:function(a,b){return h.call(a,b)},each:function(a,b,c){if(null!=a)if(g&&a.forEach===g)a.forEach(b,c);else if(a.length===+a.length)for(var d=0,e=a.length;d<e;d++)b.call(c,a[d],d,a);else for(var f in a)this.has(a,f)&&b.call(c,a[f],f,a)},once:function(a){var b,c=!1;return function(){return c?b:(c=!0,b=a.apply(this,arguments),a=null,b)}}}}var e,f=this,g=Array.prototype.forEach,h=Object.prototype.hasOwnProperty,i=Array.prototype.slice,j=0,k=b();e={on:function(a,b,c){return m(this,"on",a,[b,c])&&b?(this._events||(this._events={}),(this._events[a]||(this._events[a]=[])).push({callback:b,context:c,ctx:c||this}),this):this},once:function(a,b,c){if(!m(this,"once",a,[b,c])||!b)return this;var d=this,e=k.once(function(){d.off(a,e),b.apply(this,arguments)});return e._callback=b,this.on(a,e,c)},off:function(a,b,c){var d,e,f,g,h,i,j,l;if(!this._events||!m(this,"off",a,[b,c]))return this;if(!a&&!b&&!c)return this._events={},this;for(g=a?[a]:k.keys(this._events),h=0,i=g.length;h<i;h++)if(a=g[h],f=this._events[a]){if(this._events[a]=d=[],b||c)for(j=0,l=f.length;j<l;j++)e=f[j],(b&&b!==e.callback&&b!==e.callback._callback||c&&c!==e.context)&&d.push(e);d.length||delete this._events[a]}return this},trigger:function(a){if(!this._events)return this;var b=i.call(arguments,1);if(!m(this,"trigger",a,b))return this;var c=this._events[a],d=this._events.all;return c&&n(c,b),d&&n(d,arguments),this},stopListening:function(a,b,c){var d=this._listeners;if(!d)return this;var e=!b&&!c;"object"==typeof b&&(c=this),a&&((d={})[a._listenerId]=a);for(var f in d)d[f].off(b,c,this),e&&delete this._listeners[f];return this}};var l=/\s+/,m=function(a,b,c,d){if(!c)return!0;if("object"==typeof c){for(var e in c)a[b].apply(a,[e,c[e]].concat(d));return!1}if(l.test(c)){for(var f=c.split(l),g=0,h=f.length;g<h;g++)a[b].apply(a,[f[g]].concat(d));return!1}return!0},n=function(a,b){var c,d=-1,e=a.length,f=b[0],g=b[1],h=b[2];switch(b.length){case 0:for(;++d<e;)(c=a[d]).callback.call(c.ctx);return;case 1:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f);return;case 2:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f,g);return;case 3:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f,g,h);return;default:for(;++d<e;)(c=a[d]).callback.apply(c.ctx,b)}},o={listenTo:"on",listenToOnce:"once"}
;k.each(o,function(a,b){e[b]=function(b,c,d){return(this._listeners||(this._listeners={}))[b._listenerId||(b._listenerId=k.uniqueId("l"))]=b,"object"==typeof c&&(d=this),b[a](c,d,this),this}}),e.bind=e.on,e.unbind=e.off,e.mixin=function(a){var b=["on","once","off","trigger","stopListening","listenTo","listenToOnce","bind","unbind"];return k.each(b,function(b){a[b]=this[b]},this),a},void 0!==d?(void 0!==c&&c.exports&&(d=c.exports=e),d.BackboneEvents=e):"function"==typeof a&&"object"==typeof a.amd?a(function(){return e}):f.BackboneEvents=e}()},{}],235:[function(a,b,c){b.exports=a("./backbone-events-standalone")},{"./backbone-events-standalone":234}],236:[function(b,c,d){(function(c){!function(e){var f="object"==typeof self&&self.self===self&&self||"object"==typeof c&&c.global===c&&c;if("function"==typeof a&&a.amd)a(["underscore","jquery","exports"],function(a,b,c){f.Backbone=e(f,c,a,b)});else if(void 0!==d){var g,h=b("underscore");try{g=b("jquery")}catch(a){}e(f,d,h,g)}else f.Backbone=e(f,{},f._,f.jQuery||f.Zepto||f.ender||f.$)}(function(a,b,c,d){var e=a.Backbone,f=Array.prototype.slice;b.VERSION="1.4.0",b.$=d,b.noConflict=function(){return a.Backbone=e,this},b.emulateHTTP=!1,b.emulateJSON=!1;var g,h=b.Events={},i=/\s+/,j=function(a,b,d,e,f){var g,h=0;if(d&&"object"==typeof d){void 0!==e&&"context"in f&&void 0===f.context&&(f.context=e);for(g=c.keys(d);h<g.length;h++)b=j(a,b,g[h],d[g[h]],f)}else if(d&&i.test(d))for(g=d.split(i);h<g.length;h++)b=a(b,g[h],e,f);else b=a(b,d,e,f);return b};h.on=function(a,b,c){if(this._events=j(k,this._events||{},a,b,{context:c,ctx:this,listening:g}),g){(this._listeners||(this._listeners={}))[g.id]=g,g.interop=!1}return this},h.listenTo=function(a,b,d){if(!a)return this;var e=a._listenId||(a._listenId=c.uniqueId("l")),f=this._listeningTo||(this._listeningTo={}),h=g=f[e];h||(this._listenId||(this._listenId=c.uniqueId("l")),h=g=f[e]=new q(this,a));var i=l(a,b,d,this);if(g=void 0,i)throw i;return h.interop&&h.on(b,d),this};var k=function(a,b,c,d){if(c){var e=a[b]||(a[b]=[]),f=d.context,g=d.ctx,h=d.listening;h&&h.count++,e.push({callback:c,context:f,ctx:f||g,listening:h})}return a},l=function(a,b,c,d){try{a.on(b,c,d)}catch(a){return a}};h.off=function(a,b,c){return this._events?(this._events=j(m,this._events,a,b,{context:c,listeners:this._listeners}),this):this},h.stopListening=function(a,b,d){var e=this._listeningTo;if(!e)return this;for(var f=a?[a._listenId]:c.keys(e),g=0;g<f.length;g++){var h=e[f[g]];if(!h)break;h.obj.off(b,d,this),h.interop&&h.off(b,d)}return c.isEmpty(e)&&(this._listeningTo=void 0),this};var m=function(a,b,d,e){if(a){var f,g=e.context,h=e.listeners,i=0;if(b||g||d){for(f=b?[b]:c.keys(a);i<f.length;i++){b=f[i];var j=a[b];if(!j)break;for(var k=[],l=0;l<j.length;l++){var m=j[l];if(d&&d!==m.callback&&d!==m.callback._callback||g&&g!==m.context)k.push(m);else{var n=m.listening;n&&n.off(b,d)}}k.length?a[b]=k:delete a[b]}return a}for(f=c.keys(h);i<f.length;i++)h[f[i]].cleanup()}};h.once=function(a,b,c){var d=j(n,{},a,b,this.off.bind(this));return"string"==typeof a&&null==c&&(b=void 0),this.on(d,b,c)},h.listenToOnce=function(a,b,c){var d=j(n,{},b,c,this.stopListening.bind(this,a));return this.listenTo(a,d)};var n=function(a,b,d,e){if(d){var f=a[b]=c.once(function(){e(b,f),d.apply(this,arguments)});f._callback=d}return a};h.trigger=function(a){if(!this._events)return this;for(var b=Math.max(0,arguments.length-1),c=Array(b),d=0;d<b;d++)c[d]=arguments[d+1];return j(o,this._events,a,void 0,c),this};var o=function(a,b,c,d){if(a){var e=a[b],f=a.all;e&&f&&(f=f.slice()),e&&p(e,d),f&&p(f,[b].concat(d))}return a},p=function(a,b){var c,d=-1,e=a.length,f=b[0],g=b[1],h=b[2];switch(b.length){case 0:for(;++d<e;)(c=a[d]).callback.call(c.ctx);return;case 1:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f);return;case 2:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f,g);return;case 3:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f,g,h);return;default:for(;++d<e;)(c=a[d]).callback.apply(c.ctx,b);return}},q=function(a,b){this.id=a._listenId,this.listener=a,this.obj=b,this.interop=!0,this.count=0,this._events=void 0};q.prototype.on=h.on,q.prototype.off=function(a,b){var c;this.interop?(this._events=j(m,this._events,a,b,{context:void 0,listeners:void 0}),c=!this._events):(this.count--,c=0===this.count),c&&this.cleanup()},q.prototype.cleanup=function(){delete this.listener._listeningTo[this.obj._listenId],this.interop||delete this.obj._listeners[this.id]},h.bind=h.on,h.unbind=h.off,c.extend(b,h);var r=b.Model=function(a,b){var d=a||{};b||(b={}),this.preinitialize.apply(this,arguments),this.cid=c.uniqueId(this.cidPrefix),this.attributes={},b.collection&&(this.collection=b.collection),b.parse&&(d=this.parse(d,b)||{});var e=c.result(this,"defaults");d=c.defaults(c.extend({},e,d),e),this.set(d,b),this.changed={},this.initialize.apply(this,arguments)};c.extend(r.prototype,h,{changed:null,validationError:null,idAttribute:"id",cidPrefix:"c",preinitialize:function(){},initialize:function(){},toJSON:function(a){return c.clone(this.attributes)},sync:function(){return b.sync.apply(this,arguments)},get:function(a){return this.attributes[a]},escape:function(a){return c.escape(this.get(a))},has:function(a){return null!=this.get(a)},matches:function(a){return!!c.iteratee(a,this)(this.attributes)},set:function(a,b,d){if(null==a)return this;var e;if("object"==typeof a?(e=a,d=b):(e={})[a]=b,d||(d={}),!this._validate(e,d))return!1;var f=d.unset,g=d.silent,h=[],i=this._changing;this._changing=!0,i||(this._previousAttributes=c.clone(this.attributes),this.changed={});var j=this.attributes,k=this.changed,l=this._previousAttributes;for(var m in e)b=e[m],c.isEqual(j[m],b)||h.push(m),c.isEqual(l[m],b)?delete k[m]:k[m]=b,f?delete j[m]:j[m]=b;if(this.idAttribute in e&&(this.id=this.get(this.idAttribute)),!g){h.length&&(this._pending=d);for(var n=0;n<h.length;n++)this.trigger("change:"+h[n],this,j[h[n]],d)}if(i)return this;if(!g)for(;this._pending;)d=this._pending,this._pending=!1,this.trigger("change",this,d);return this._pending=!1,this._changing=!1,this},unset:function(a,b){return this.set(a,void 0,c.extend({},b,{unset:!0}))},clear:function(a){var b={};for(var d in this.attributes)b[d]=void 0;return this.set(b,c.extend({},a,{unset:!0}))},hasChanged:function(a){return null==a?!c.isEmpty(this.changed):c.has(this.changed,a)},changedAttributes:function(a){if(!a)return!!this.hasChanged()&&c.clone(this.changed);var b,d=this._changing?this._previousAttributes:this.attributes,e={};for(var f in a){var g=a[f];c.isEqual(d[f],g)||(e[f]=g,b=!0)}return!!b&&e},previous:function(a){return null!=a&&this._previousAttributes?this._previousAttributes[a]:null},previousAttributes:function(){return c.clone(this._previousAttributes)},fetch:function(a){a=c.extend({parse:!0},a);var b=this,d=a.success;return a.success=function(c){var e=a.parse?b.parse(c,a):c;if(!b.set(e,a))return!1;d&&d.call(a.context,b,c,a),b.trigger("sync",b,c,a)},W(this,a),this.sync("read",this,a)},save:function(a,b,d){var e;null==a||"object"==typeof a?(e=a,d=b):(e={})[a]=b,d=c.extend({validate:!0,parse:!0},d);var f=d.wait;if(e&&!f){if(!this.set(e,d))return!1}else if(!this._validate(e,d))return!1;var g=this,h=d.success,i=this.attributes;d.success=function(a){g.attributes=i;var b=d.parse?g.parse(a,d):a;if(f&&(b=c.extend({},e,b)),b&&!g.set(b,d))return!1;h&&h.call(d.context,g,a,d),g.trigger("sync",g,a,d)},W(this,d),e&&f&&(this.attributes=c.extend({},i,e));var j=this.isNew()?"create":d.patch?"patch":"update";"patch"!==j||d.attrs||(d.attrs=e);var k=this.sync(j,this,d);return this.attributes=i,k},destroy:function(a){a=a?c.clone(a):{};var b=this,d=a.success,e=a.wait,f=function(){b.stopListening(),b.trigger("destroy",b,b.collection,a)};a.success=function(c){e&&f(),d&&d.call(a.context,b,c,a),b.isNew()||b.trigger("sync",b,c,a)};var g=!1;return this.isNew()?c.defer(a.success):(W(this,a),g=this.sync("delete",this,a)),e||f(),g},url:function(){var a=c.result(this,"urlRoot")||c.result(this.collection,"url")||V();if(this.isNew())return a;var b=this.get(this.idAttribute);return a.replace(/[^\/]$/,"$&/")+encodeURIComponent(b)},parse:function(a,b){return a},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(a){return this._validate({},c.extend({},a,{validate:!0}))},_validate:function(a,b){if(!b.validate||!this.validate)return!0;a=c.extend({},this.attributes,a);var d=this.validationError=this.validate(a,b)||null;return!d||(this.trigger("invalid",this,d,c.extend(b,{validationError:d})),!1)}});var s=b.Collection=function(a,b){b||(b={}),this.preinitialize.apply(this,arguments),b.model&&(this.model=b.model),void 0!==b.comparator&&(this.comparator=b.comparator),this._reset(),this.initialize.apply(this,arguments),a&&this.reset(a,c.extend({silent:!0},b))},t={add:!0,remove:!0,merge:!0},u={add:!0,remove:!1},v=function(a,b,c){c=Math.min(Math.max(c,0),a.length);var d,e=Array(a.length-c),f=b.length;for(d=0;d<e.length;d++)e[d]=a[d+c];for(d=0;d<f;d++)a[d+c]=b[d];for(d=0;d<e.length;d++)a[d+f+c]=e[d]};c.extend(s.prototype,h,{model:r,preinitialize:function(){},initialize:function(){},toJSON:function(a){return this.map(function(b){return b.toJSON(a)})},sync:function(){return b.sync.apply(this,arguments)},add:function(a,b){return this.set(a,c.extend({merge:!1},b,u))},remove:function(a,b){b=c.extend({},b);var d=!c.isArray(a);a=d?[a]:a.slice();var e=this._removeModels(a,b);return!b.silent&&e.length&&(b.changes={added:[],merged:[],removed:e},this.trigger("update",this,b)),d?e[0]:e},set:function(a,b){if(null!=a){b=c.extend({},t,b),b.parse&&!this._isModel(a)&&(a=this.parse(a,b)||[]);var d=!c.isArray(a);a=d?[a]:a.slice();var e=b.at;null!=e&&(e=+e),e>this.length&&(e=this.length),e<0&&(e+=this.length+1);var f,g,h=[],i=[],j=[],k=[],l={},m=b.add,n=b.merge,o=b.remove,p=!1,q=this.comparator&&null==e&&!1!==b.sort,r=c.isString(this.comparator)?this.comparator:null;for(g=0;g<a.length;g++){f=a[g];var s=this.get(f);if(s){if(n&&f!==s){var u=this._isModel(f)?f.attributes:f;b.parse&&(u=s.parse(u,b)),s.set(u,b),j.push(s),q&&!p&&(p=s.hasChanged(r))}l[s.cid]||(l[s.cid]=!0,h.push(s)),a[g]=s}else m&&(f=a[g]=this._prepareModel(f,b))&&(i.push(f),this._addReference(f,b),l[f.cid]=!0,h.push(f))}if(o){for(g=0;g<this.length;g++)f=this.models[g],l[f.cid]||k.push(f);k.length&&this._removeModels(k,b)}var w=!1,x=!q&&m&&o;if(h.length&&x?(w=this.length!==h.length||c.some(this.models,function(a,b){return a!==h[b]}),this.models.length=0,v(this.models,h,0),this.length=this.models.length):i.length&&(q&&(p=!0),v(this.models,i,null==e?this.length:e),this.length=this.models.length),p&&this.sort({silent:!0}),!b.silent){for(g=0;g<i.length;g++)null!=e&&(b.index=e+g),f=i[g],f.trigger("add",f,this,b);(p||w)&&this.trigger("sort",this,b),(i.length||k.length||j.length)&&(b.changes={added:i,removed:k,merged:j},this.trigger("update",this,b))}return d?a[0]:a}},reset:function(a,b){b=b?c.clone(b):{};for(var d=0;d<this.models.length;d++)this._removeReference(this.models[d],b);return b.previousModels=this.models,this._reset(),a=this.add(a,c.extend({silent:!0},b)),b.silent||this.trigger("reset",this,b),a},push:function(a,b){return this.add(a,c.extend({at:this.length},b))},pop:function(a){var b=this.at(this.length-1);return this.remove(b,a)},unshift:function(a,b){return this.add(a,c.extend({at:0},b))},shift:function(a){var b=this.at(0);return this.remove(b,a)},slice:function(){return f.apply(this.models,arguments)},get:function(a){if(null!=a)return this._byId[a]||this._byId[this.modelId(this._isModel(a)?a.attributes:a)]||a.cid&&this._byId[a.cid]},has:function(a){return null!=this.get(a)},at:function(a){return a<0&&(a+=this.length),this.models[a]},where:function(a,b){return this[b?"find":"filter"](a)},findWhere:function(a){return this.where(a,!0)},sort:function(a){var b=this.comparator;if(!b)throw new Error("Cannot sort a set without a comparator");a||(a={});var d=b.length;return c.isFunction(b)&&(b=b.bind(this)),1===d||c.isString(b)?this.models=this.sortBy(b):this.models.sort(b),a.silent||this.trigger("sort",this,a),this},pluck:function(a){return this.map(a+"")},fetch:function(a){a=c.extend({parse:!0},a);var b=a.success,d=this;return a.success=function(c){var e=a.reset?"reset":"set";d[e](c,a),b&&b.call(a.context,d,c,a),d.trigger("sync",d,c,a)},W(this,a),this.sync("read",this,a)},create:function(a,b){b=b?c.clone(b):{};var d=b.wait;if(!(a=this._prepareModel(a,b)))return!1;d||this.add(a,b);var e=this,f=b.success;return b.success=function(a,b,c){d&&e.add(a,c),f&&f.call(c.context,a,b,c)},a.save(null,b),a},parse:function(a,b){return a},clone:function(){return new this.constructor(this.models,{model:this.model,comparator:this.comparator})},modelId:function(a){return a[this.model.prototype.idAttribute||"id"]},values:function(){return new x(this,y)},keys:function(){return new x(this,z)},entries:function(){return new x(this,A)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(a,b){if(this._isModel(a))return a.collection||(a.collection=this),a;b=b?c.clone(b):{},b.collection=this;var d=new this.model(a,b);return d.validationError?(this.trigger("invalid",this,d.validationError,b),!1):d},_removeModels:function(a,b){for(var c=[],d=0;d<a.length;d++){var e=this.get(a[d]);if(e){var f=this.indexOf(e);this.models.splice(f,1),this.length--,delete this._byId[e.cid];var g=this.modelId(e.attributes);null!=g&&delete this._byId[g],b.silent||(b.index=f,e.trigger("remove",e,this,b)),c.push(e),this._removeReference(e,b)}}return c},_isModel:function(a){return a instanceof r},_addReference:function(a,b){this._byId[a.cid]=a;var c=this.modelId(a.attributes);null!=c&&(this._byId[c]=a),a.on("all",this._onModelEvent,this)},_removeReference:function(a,b){delete this._byId[a.cid];var c=this.modelId(a.attributes);null!=c&&delete this._byId[c],this===a.collection&&delete a.collection,a.off("all",this._onModelEvent,this)},_onModelEvent:function(a,b,c,d){if(b){if(("add"===a||"remove"===a)&&c!==this)return;if("destroy"===a&&this.remove(b,d),"change"===a){var e=this.modelId(b.previousAttributes()),f=this.modelId(b.attributes);e!==f&&(null!=e&&delete this._byId[e],null!=f&&(this._byId[f]=b))}}this.trigger.apply(this,arguments)}});var w="function"==typeof Symbol&&Symbol.iterator;w&&(s.prototype[w]=s.prototype.values);var x=function(a,b){this._collection=a,this._kind=b,this._index=0},y=1,z=2,A=3;w&&(x.prototype[w]=function(){return this}),x.prototype.next=function(){if(this._collection){if(this._index<this._collection.length){var a=this._collection.at(this._index);this._index++;var b;if(this._kind===y)b=a;else{var c=this._collection.modelId(a.attributes);b=this._kind===z?c:[c,a]}return{value:b,done:!1}}this._collection=void 0}return{value:void 0,done:!0}};var B=b.View=function(a){this.cid=c.uniqueId("view"),this.preinitialize.apply(this,arguments),c.extend(this,c.pick(a,D)),this._ensureElement(),this.initialize.apply(this,arguments)},C=/^(\S+)\s*(.*)$/,D=["model","collection","el","id","attributes","className","tagName","events"];c.extend(B.prototype,h,{tagName:"div",$:function(a){return this.$el.find(a)},preinitialize:function(){},initialize:function(){},render:function(){return this},remove:function(){return this._removeElement(),this.stopListening(),this},_removeElement:function(){this.$el.remove()},setElement:function(a){return this.undelegateEvents(),this._setElement(a),this.delegateEvents(),this},_setElement:function(a){this.$el=a instanceof b.$?a:b.$(a),this.el=this.$el[0]},delegateEvents:function(a){if(a||(a=c.result(this,"events")),!a)return this;this.undelegateEvents();for(var b in a){var d=a[b];if(c.isFunction(d)||(d=this[d]),d){var e=b.match(C);this.delegate(e[1],e[2],d.bind(this))}}return this},delegate:function(a,b,c){return this.$el.on(a+".delegateEvents"+this.cid,b,c),this},undelegateEvents:function(){return this.$el&&this.$el.off(".delegateEvents"+this.cid),this},undelegate:function(a,b,c){return this.$el.off(a+".delegateEvents"+this.cid,b,c),this},_createElement:function(a){return document.createElement(a)},_ensureElement:function(){if(this.el)this.setElement(c.result(this,"el"));else{var a=c.extend({},c.result(this,"attributes"));this.id&&(a.id=c.result(this,"id")),this.className&&(a.class=c.result(this,"className")),this.setElement(this._createElement(c.result(this,"tagName"))),this._setAttributes(a)}},_setAttributes:function(a){this.$el.attr(a)}});var E=function(a,b,c,d){switch(b){case 1:return function(){return a[c](this[d])};case 2:return function(b){return a[c](this[d],b)};case 3:return function(b,e){return a[c](this[d],G(b,this),e)};case 4:return function(b,e,f){return a[c](this[d],G(b,this),e,f)};default:return function(){var b=f.call(arguments);return b.unshift(this[d]),a[c].apply(a,b)}}},F=function(a,b,d,e){c.each(d,function(c,d){b[d]&&(a.prototype[d]=E(b,c,d,e))})},G=function(a,b){return c.isFunction(a)?a:c.isObject(a)&&!b._isModel(a)?H(a):c.isString(a)?function(b){return b.get(a)}:a},H=function(a){var b=c.matches(a);return function(a){return b(a.attributes)}},I={forEach:3,each:3,map:3,collect:3,reduce:0,foldl:0,inject:0,reduceRight:0,foldr:0,find:3,detect:3,filter:3,select:3,reject:3,every:3,all:3,some:3,any:3,include:3,includes:3,contains:3,invoke:0,max:3,min:3,toArray:1,size:1,first:3,head:3,take:3,initial:3,rest:3,tail:3,drop:3,last:3,without:0,difference:0,indexOf:3,shuffle:1,lastIndexOf:3,isEmpty:1,chain:1,sample:3,partition:3,groupBy:3,countBy:3,sortBy:3,indexBy:3,findIndex:3,findLastIndex:3},J={keys:1,values:1,pairs:1,invert:1,pick:0,omit:0,chain:1,isEmpty:1};c.each([[s,I,"models"],[r,J,"attributes"]],function(a){var b=a[0],d=a[1],e=a[2];b.mixin=function(a){var d=c.reduce(c.functions(a),function(a,b){return a[b]=0,a},{});F(b,a,d,e)},F(b,c,d,e)}),b.sync=function(a,d,e){var f=K[a];c.defaults(e||(e={}),{emulateHTTP:b.emulateHTTP,emulateJSON:b.emulateJSON});var g={type:f,dataType:"json"};if(e.url||(g.url=c.result(d,"url")||V()),null!=e.data||!d||"create"!==a&&"update"!==a&&"patch"!==a||(g.contentType="application/json",g.data=JSON.stringify(e.attrs||d.toJSON(e))),e.emulateJSON&&(g.contentType="application/x-www-form-urlencoded",g.data=g.data?{model:g.data}:{}),e.emulateHTTP&&("PUT"===f||"DELETE"===f||"PATCH"===f)){g.type="POST",e.emulateJSON&&(g.data._method=f);var h=e.beforeSend;e.beforeSend=function(a){if(a.setRequestHeader("X-HTTP-Method-Override",f),h)return h.apply(this,arguments)}}"GET"===g.type||e.emulateJSON||(g.processData=!1);var i=e.error;e.error=function(a,b,c){e.textStatus=b,e.errorThrown=c,i&&i.call(e.context,a,b,c)};var j=e.xhr=b.ajax(c.extend(g,e));return d.trigger("request",d,j,e),j};var K={create:"POST",update:"PUT",patch:"PATCH",delete:"DELETE",read:"GET"};b.ajax=function(){return b.$.ajax.apply(b.$,arguments)};var L=b.Router=function(a){a||(a={}),this.preinitialize.apply(this,arguments),a.routes&&(this.routes=a.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},M=/\((.*?)\)/g,N=/(\(\?)?:\w+/g,O=/\*\w+/g,P=/[\-{}\[\]+?.,\\\^$|#\s]/g;c.extend(L.prototype,h,{preinitialize:function(){},initialize:function(){},route:function(a,d,e){c.isRegExp(a)||(a=this._routeToRegExp(a)),c.isFunction(d)&&(e=d,d=""),e||(e=this[d]);var f=this;return b.history.route(a,function(c){var g=f._extractParameters(a,c);!1!==f.execute(e,g,d)&&(f.trigger.apply(f,["route:"+d].concat(g)),f.trigger("route",d,g),b.history.trigger("route",f,d,g))}),this},execute:function(a,b,c){a&&a.apply(this,b)},navigate:function(a,c){return b.history.navigate(a,c),this},_bindRoutes:function(){if(this.routes){this.routes=c.result(this,"routes");for(var a,b=c.keys(this.routes);null!=(a=b.pop());)this.route(a,this.routes[a])}},_routeToRegExp:function(a){return a=a.replace(P,"\\$&").replace(M,"(?:$1)?").replace(N,function(a,b){return b?a:"([^/?]+)"}).replace(O,"([^?]*?)"),new RegExp("^"+a+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(a,b){var d=a.exec(b).slice(1);return c.map(d,function(a,b){return b===d.length-1?a||null:a?decodeURIComponent(a):null})}});var Q=b.History=function(){this.handlers=[],this.checkUrl=this.checkUrl.bind(this),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},R=/^[#\/]|\s+$/g,S=/^\/+|\/+$/g,T=/#.*$/;Q.started=!1,c.extend(Q.prototype,h,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root&&!this.getSearch()},matchRoot:function(){return this.decodeFragment(this.location.pathname).slice(0,this.root.length-1)+"/"===this.root},decodeFragment:function(a){return decodeURI(a.replace(/%25/g,"%2525"))},getSearch:function(){var a=this.location.href.replace(/#.*/,"").match(/\?.+/);return a?a[0]:""},getHash:function(a){var b=(a||this).location.href.match(/#(.*)$/);return b?b[1]:""},getPath:function(){var a=this.decodeFragment(this.location.pathname+this.getSearch()).slice(this.root.length-1);return"/"===a.charAt(0)?a.slice(1):a},getFragment:function(a){return null==a&&(a=this._usePushState||!this._wantsHashChange?this.getPath():this.getHash()),a.replace(R,"")},start:function(a){if(Q.started)throw new Error("Backbone.history has already been started");if(Q.started=!0,this.options=c.extend({root:"/"},this.options,a),this.root=this.options.root,this._wantsHashChange=!1!==this.options.hashChange,this._hasHashChange="onhashchange"in window&&(void 0===document.documentMode||document.documentMode>7),this._useHashChange=this._wantsHashChange&&this._hasHashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!(!this.history||!this.history.pushState),this._usePushState=this._wantsPushState&&this._hasPushState,this.fragment=this.getFragment(),this.root=("/"+this.root+"/").replace(S,"/"),this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot()){var b=this.root.slice(0,-1)||"/";return this.location.replace(b+"#"+this.getPath()),!0}this._hasPushState&&this.atRoot()&&this.navigate(this.getHash(),{replace:!0})}if(!this._hasHashChange&&this._wantsHashChange&&!this._usePushState){this.iframe=document.createElement("iframe"),this.iframe.src="javascript:0",this.iframe.style.display="none",this.iframe.tabIndex=-1;var d=document.body,e=d.insertBefore(this.iframe,d.firstChild).contentWindow;e.document.open(),e.document.close(),e.location.hash="#"+this.fragment}var f=window.addEventListener||function(a,b){return attachEvent("on"+a,b)};if(this._usePushState?f("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe?f("hashchange",this.checkUrl,!1):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),!this.options.silent)return this.loadUrl()},stop:function(){var a=window.removeEventListener||function(a,b){return detachEvent("on"+a,b)};this._usePushState?a("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe&&a("hashchange",this.checkUrl,!1),this.iframe&&(document.body.removeChild(this.iframe),this.iframe=null),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),Q.started=!1},route:function(a,b){this.handlers.unshift({route:a,callback:b})},checkUrl:function(a){var b=this.getFragment();if(b===this.fragment&&this.iframe&&(b=this.getHash(this.iframe.contentWindow)),b===this.fragment)return!1;this.iframe&&this.navigate(b),this.loadUrl()},loadUrl:function(a){return!!this.matchRoot()&&(a=this.fragment=this.getFragment(a),c.some(this.handlers,function(b){if(b.route.test(a))return b.callback(a),!0}))},navigate:function(a,b){if(!Q.started)return!1;b&&!0!==b||(b={trigger:!!b}),a=this.getFragment(a||"");var c=this.root;""!==a&&"?"!==a.charAt(0)||(c=c.slice(0,-1)||"/");var d=c+a;a=a.replace(T,"");var e=this.decodeFragment(a);if(this.fragment!==e){if(this.fragment=e,this._usePushState)this.history[b.replace?"replaceState":"pushState"]({},document.title,d);else{if(!this._wantsHashChange)return this.location.assign(d);if(this._updateHash(this.location,a,b.replace),this.iframe&&a!==this.getHash(this.iframe.contentWindow)){var f=this.iframe.contentWindow;b.replace||(f.document.open(),f.document.close()),this._updateHash(f.location,a,b.replace)}}return b.trigger?this.loadUrl(a):void 0}},_updateHash:function(a,b,c){if(c){var d=a.href.replace(/(javascript:|#).*$/,"");a.replace(d+"#"+b)}else a.hash="#"+b}}),b.history=new Q;var U=function(a,b){var d,e=this;return d=a&&c.has(a,"constructor")?a.constructor:function(){return e.apply(this,arguments)},c.extend(d,e,b),d.prototype=c.create(e.prototype,a),d.prototype.constructor=d,d.__super__=e.prototype,d};r.extend=s.extend=L.extend=B.extend=Q.extend=U;var V=function(){throw new Error('A "url" property or function must be specified')},W=function(a,b){var c=b.error;b.error=function(d){c&&c.call(b.context,a,d,b),a.trigger("error",a,d,b)}};return b})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{jquery:288,underscore:310}],237:[function(a,b,c){!function(a){"use strict";function b(a){var b=a.charCodeAt(0);return b===f||b===k?62:b===g||b===l?63:b<h?-1:b<h+10?b-h+26+26:b<j+26?b-j:b<i+26?b-i+26:void 0}function c(a){function c(a){j[l++]=a}var d,f,g,h,i,j;if(a.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var k=a.length;i="="===a.charAt(k-2)?2:"="===a.charAt(k-1)?1:0,j=new e(3*a.length/4-i),g=i>0?a.length-4:a.length;var l=0;for(d=0,f=0;d<g;d+=4,f+=3)h=b(a.charAt(d))<<18|b(a.charAt(d+1))<<12|b(a.charAt(d+2))<<6|b(a.charAt(d+3)),c((16711680&h)>>16),c((65280&h)>>8),c(255&h);return 2===i?(h=b(a.charAt(d))<<2|b(a.charAt(d+1))>>4,c(255&h)):1===i&&(h=b(a.charAt(d))<<10|b(a.charAt(d+1))<<4|b(a.charAt(d+2))>>2,c(h>>8&255),c(255&h)),j}function d(a){function b(a){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(a)}function c(a){return b(a>>18&63)+b(a>>12&63)+b(a>>6&63)+b(63&a)}var d,e,f,g=a.length%3,h="";for(d=0,f=a.length-g;d<f;d+=3)e=(a[d]<<16)+(a[d+1]<<8)+a[d+2],h+=c(e);switch(g){case 1:e=a[a.length-1],h+=b(e>>2),h+=b(e<<4&63),h+="==";break;case 2:e=(a[a.length-2]<<8)+a[a.length-1],h+=b(e>>10),h+=b(e>>4&63),h+=b(e<<2&63),h+="="}return h}var e="undefined"!=typeof Uint8Array?Uint8Array:Array,f="+".charCodeAt(0),g="/".charCodeAt(0),h="0".charCodeAt(0),i="a".charCodeAt(0),j="A".charCodeAt(0),k="-".charCodeAt(0),l="_".charCodeAt(0);a.toByteArray=c,a.fromByteArray=d}(void 0===c?this.base64js={}:c)},{}],238:[function(a,b,c){a("../../js/transition.js"),a("../../js/alert.js"),a("../../js/button.js"),a("../../js/carousel.js"),a("../../js/collapse.js"),a("../../js/dropdown.js"),a("../../js/modal.js"),a("../../js/tooltip.js"),a("../../js/popover.js"),a("../../js/scrollspy.js"),a("../../js/tab.js"),a("../../js/affix.js")},{"../../js/affix.js":239,"../../js/alert.js":240,"../../js/button.js":241,"../../js/carousel.js":242,"../../js/collapse.js":243,"../../js/dropdown.js":244,"../../js/modal.js":245,"../../js/popover.js":246,"../../js/scrollspy.js":247,"../../js/tab.js":248,"../../js/tooltip.js":249,"../../js/transition.js":250}],239:[function(a,b,c){+function(a){"use strict";function b(b){return this.each(function(){var d=a(this),e=d.data("bs.affix"),f="object"==typeof b&&b;e||d.data("bs.affix",e=new c(this,f)),"string"==typeof b&&e[b]()})}var c=function(b,d){this.options=a.extend({},c.DEFAULTS,d);var e=this.options.target===c.DEFAULTS.target?a(this.options.target):a(document).find(this.options.target);this.$target=e.on("scroll.bs.affix.data-api",a.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",a.proxy(this.checkPositionWithEventLoop,this)),this.$element=a(b),this.affixed=null,this.unpin=null,this.pinnedOffset=null,this.checkPosition()};c.VERSION="3.4.1",c.RESET="affix affix-top affix-bottom",c.DEFAULTS={offset:0,target:window},c.prototype.getState=function(a,b,c,d){var e=this.$target.scrollTop(),f=this.$element.offset(),g=this.$target.height();if(null!=c&&"top"==this.affixed)return e<c&&"top";if("bottom"==this.affixed)return null!=c?!(e+this.unpin<=f.top)&&"bottom":!(e+g<=a-d)&&"bottom";var h=null==this.affixed,i=h?e:f.top,j=h?g:b;return null!=c&&e<=c?"top":null!=d&&i+j>=a-d&&"bottom"},c.prototype.getPinnedOffset=function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(c.RESET).addClass("affix");var a=this.$target.scrollTop(),b=this.$element.offset();return this.pinnedOffset=b.top-a},c.prototype.checkPositionWithEventLoop=function(){setTimeout(a.proxy(this.checkPosition,this),1)},c.prototype.checkPosition=function(){if(this.$element.is(":visible")){var b=this.$element.height(),d=this.options.offset,e=d.top,f=d.bottom,g=Math.max(a(document).height(),a(document.body).height());"object"!=typeof d&&(f=e=d),"function"==typeof e&&(e=d.top(this.$element)),"function"==typeof f&&(f=d.bottom(this.$element));var h=this.getState(g,b,e,f);if(this.affixed!=h){null!=this.unpin&&this.$element.css("top","");var i="affix"+(h?"-"+h:""),j=a.Event(i+".bs.affix");if(this.$element.trigger(j),j.isDefaultPrevented())return;this.affixed=h,this.unpin="bottom"==h?this.getPinnedOffset():null,this.$element.removeClass(c.RESET).addClass(i).trigger(i.replace("affix","affixed")+".bs.affix")}"bottom"==h&&this.$element.offset({top:g-b-f})}};var d=a.fn.affix;a.fn.affix=b,a.fn.affix.Constructor=c,a.fn.affix.noConflict=function(){return a.fn.affix=d,this},a(window).on("load",function(){a('[data-spy="affix"]').each(function(){var c=a(this),d=c.data();d.offset=d.offset||{},null!=d.offsetBottom&&(d.offset.bottom=d.offsetBottom),null!=d.offsetTop&&(d.offset.top=d.offsetTop),b.call(c,d)})})}(jQuery)},{}],240:[function(a,b,c){+function(a){"use strict";function b(b){return this.each(function(){var c=a(this),e=c.data("bs.alert");e||c.data("bs.alert",e=new d(this)),"string"==typeof b&&e[b].call(c)})}var c='[data-dismiss="alert"]',d=function(b){a(b).on("click",c,this.close)};d.VERSION="3.4.1",d.TRANSITION_DURATION=150,d.prototype.close=function(b){function c(){g.detach().trigger("closed.bs.alert").remove()}var e=a(this),f=e.attr("data-target");f||(f=e.attr("href"),f=f&&f.replace(/.*(?=#[^\s]*$)/,"")),f="#"===f?[]:f;var g=a(document).find(f);b&&b.preventDefault(),g.length||(g=e.closest(".alert")),g.trigger(b=a.Event("close.bs.alert")),b.isDefaultPrevented()||(g.removeClass("in"),a.support.transition&&g.hasClass("fade")?g.one("bsTransitionEnd",c).emulateTransitionEnd(d.TRANSITION_DURATION):c())};var e=a.fn.alert;a.fn.alert=b,a.fn.alert.Constructor=d,a.fn.alert.noConflict=function(){return a.fn.alert=e,this},a(document).on("click.bs.alert.data-api",c,d.prototype.close)}(jQuery)},{}],241:[function(a,b,c){+function(a){"use strict";function b(b){return this.each(function(){var d=a(this),e=d.data("bs.button"),f="object"==typeof b&&b;e||d.data("bs.button",e=new c(this,f)),"toggle"==b?e.toggle():b&&e.setState(b)})}var c=function(b,d){this.$element=a(b),this.options=a.extend({},c.DEFAULTS,d),this.isLoading=!1};c.VERSION="3.4.1",c.DEFAULTS={loadingText:"loading..."},c.prototype.setState=function(b){var c="disabled",d=this.$element,e=d.is("input")?"val":"html",f=d.data();b+="Text",null==f.resetText&&d.data("resetText",d[e]()),setTimeout(a.proxy(function(){d[e](null==f[b]?this.options[b]:f[b]),"loadingText"==b?(this.isLoading=!0,d.addClass(c).attr(c,c).prop(c,!0)):this.isLoading&&(this.isLoading=!1,d.removeClass(c).removeAttr(c).prop(c,!1))},this),0)},c.prototype.toggle=function(){var a=!0,b=this.$element.closest('[data-toggle="buttons"]');if(b.length){var c=this.$element.find("input");"radio"==c.prop("type")?(c.prop("checked")&&(a=!1),b.find(".active").removeClass("active"),this.$element.addClass("active")):"checkbox"==c.prop("type")&&(c.prop("checked")!==this.$element.hasClass("active")&&(a=!1),this.$element.toggleClass("active")),c.prop("checked",this.$element.hasClass("active")),a&&c.trigger("change")}else this.$element.attr("aria-pressed",!this.$element.hasClass("active")),this.$element.toggleClass("active")};var d=a.fn.button;a.fn.button=b,a.fn.button.Constructor=c,a.fn.button.noConflict=function(){return a.fn.button=d,this},a(document).on("click.bs.button.data-api",'[data-toggle^="button"]',function(c){var d=a(c.target).closest(".btn");b.call(d,"toggle"),
a(c.target).is('input[type="radio"], input[type="checkbox"]')||(c.preventDefault(),d.is("input,button")?d.trigger("focus"):d.find("input:visible,button:visible").first().trigger("focus"))}).on("focus.bs.button.data-api blur.bs.button.data-api",'[data-toggle^="button"]',function(b){a(b.target).closest(".btn").toggleClass("focus",/^focus(in)?$/.test(b.type))})}(jQuery)},{}],242:[function(a,b,c){+function(a){"use strict";function b(b){return this.each(function(){var d=a(this),e=d.data("bs.carousel"),f=a.extend({},c.DEFAULTS,d.data(),"object"==typeof b&&b),g="string"==typeof b?b:f.slide;e||d.data("bs.carousel",e=new c(this,f)),"number"==typeof b?e.to(b):g?e[g]():f.interval&&e.pause().cycle()})}var c=function(b,c){this.$element=a(b),this.$indicators=this.$element.find(".carousel-indicators"),this.options=c,this.paused=null,this.sliding=null,this.interval=null,this.$active=null,this.$items=null,this.options.keyboard&&this.$element.on("keydown.bs.carousel",a.proxy(this.keydown,this)),"hover"==this.options.pause&&!("ontouchstart"in document.documentElement)&&this.$element.on("mouseenter.bs.carousel",a.proxy(this.pause,this)).on("mouseleave.bs.carousel",a.proxy(this.cycle,this))};c.VERSION="3.4.1",c.TRANSITION_DURATION=600,c.DEFAULTS={interval:5e3,pause:"hover",wrap:!0,keyboard:!0},c.prototype.keydown=function(a){if(!/input|textarea/i.test(a.target.tagName)){switch(a.which){case 37:this.prev();break;case 39:this.next();break;default:return}a.preventDefault()}},c.prototype.cycle=function(b){return b||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(a.proxy(this.next,this),this.options.interval)),this},c.prototype.getItemIndex=function(a){return this.$items=a.parent().children(".item"),this.$items.index(a||this.$active)},c.prototype.getItemForDirection=function(a,b){var c=this.getItemIndex(b);if(("prev"==a&&0===c||"next"==a&&c==this.$items.length-1)&&!this.options.wrap)return b;var d="prev"==a?-1:1,e=(c+d)%this.$items.length;return this.$items.eq(e)},c.prototype.to=function(a){var b=this,c=this.getItemIndex(this.$active=this.$element.find(".item.active"));if(!(a>this.$items.length-1||a<0))return this.sliding?this.$element.one("slid.bs.carousel",function(){b.to(a)}):c==a?this.pause().cycle():this.slide(a>c?"next":"prev",this.$items.eq(a))},c.prototype.pause=function(b){return b||(this.paused=!0),this.$element.find(".next, .prev").length&&a.support.transition&&(this.$element.trigger(a.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this},c.prototype.next=function(){if(!this.sliding)return this.slide("next")},c.prototype.prev=function(){if(!this.sliding)return this.slide("prev")},c.prototype.slide=function(b,d){var e=this.$element.find(".item.active"),f=d||this.getItemForDirection(b,e),g=this.interval,h="next"==b?"left":"right",i=this;if(f.hasClass("active"))return this.sliding=!1;var j=f[0],k=a.Event("slide.bs.carousel",{relatedTarget:j,direction:h});if(this.$element.trigger(k),!k.isDefaultPrevented()){if(this.sliding=!0,g&&this.pause(),this.$indicators.length){this.$indicators.find(".active").removeClass("active");var l=a(this.$indicators.children()[this.getItemIndex(f)]);l&&l.addClass("active")}var m=a.Event("slid.bs.carousel",{relatedTarget:j,direction:h});return a.support.transition&&this.$element.hasClass("slide")?(f.addClass(b),"object"==typeof f&&f.length&&f[0].offsetWidth,e.addClass(h),f.addClass(h),e.one("bsTransitionEnd",function(){f.removeClass([b,h].join(" ")).addClass("active"),e.removeClass(["active",h].join(" ")),i.sliding=!1,setTimeout(function(){i.$element.trigger(m)},0)}).emulateTransitionEnd(c.TRANSITION_DURATION)):(e.removeClass("active"),f.addClass("active"),this.sliding=!1,this.$element.trigger(m)),g&&this.cycle(),this}};var d=a.fn.carousel;a.fn.carousel=b,a.fn.carousel.Constructor=c,a.fn.carousel.noConflict=function(){return a.fn.carousel=d,this};var e=function(c){var d=a(this),e=d.attr("href");e&&(e=e.replace(/.*(?=#[^\s]+$)/,""));var f=d.attr("data-target")||e,g=a(document).find(f);if(g.hasClass("carousel")){var h=a.extend({},g.data(),d.data()),i=d.attr("data-slide-to");i&&(h.interval=!1),b.call(g,h),i&&g.data("bs.carousel").to(i),c.preventDefault()}};a(document).on("click.bs.carousel.data-api","[data-slide]",e).on("click.bs.carousel.data-api","[data-slide-to]",e),a(window).on("load",function(){a('[data-ride="carousel"]').each(function(){var c=a(this);b.call(c,c.data())})})}(jQuery)},{}],243:[function(a,b,c){+function(a){"use strict";function b(b){var c,d=b.attr("data-target")||(c=b.attr("href"))&&c.replace(/.*(?=#[^\s]+$)/,"");return a(document).find(d)}function c(b){return this.each(function(){var c=a(this),e=c.data("bs.collapse"),f=a.extend({},d.DEFAULTS,c.data(),"object"==typeof b&&b);!e&&f.toggle&&/show|hide/.test(b)&&(f.toggle=!1),e||c.data("bs.collapse",e=new d(this,f)),"string"==typeof b&&e[b]()})}var d=function(b,c){this.$element=a(b),this.options=a.extend({},d.DEFAULTS,c),this.$trigger=a('[data-toggle="collapse"][href="#'+b.id+'"],[data-toggle="collapse"][data-target="#'+b.id+'"]'),this.transitioning=null,this.options.parent?this.$parent=this.getParent():this.addAriaAndCollapsedClass(this.$element,this.$trigger),this.options.toggle&&this.toggle()};d.VERSION="3.4.1",d.TRANSITION_DURATION=350,d.DEFAULTS={toggle:!0},d.prototype.dimension=function(){return this.$element.hasClass("width")?"width":"height"},d.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var b,e=this.$parent&&this.$parent.children(".panel").children(".in, .collapsing");if(!(e&&e.length&&(b=e.data("bs.collapse"))&&b.transitioning)){var f=a.Event("show.bs.collapse");if(this.$element.trigger(f),!f.isDefaultPrevented()){e&&e.length&&(c.call(e,"hide"),b||e.data("bs.collapse",null));var g=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[g](0).attr("aria-expanded",!0),this.$trigger.removeClass("collapsed").attr("aria-expanded",!0),this.transitioning=1;var h=function(){this.$element.removeClass("collapsing").addClass("collapse in")[g](""),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!a.support.transition)return h.call(this);var i=a.camelCase(["scroll",g].join("-"));this.$element.one("bsTransitionEnd",a.proxy(h,this)).emulateTransitionEnd(d.TRANSITION_DURATION)[g](this.$element[0][i])}}}},d.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var b=a.Event("hide.bs.collapse");if(this.$element.trigger(b),!b.isDefaultPrevented()){var c=this.dimension();this.$element[c](this.$element[c]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse in").attr("aria-expanded",!1),this.$trigger.addClass("collapsed").attr("aria-expanded",!1),this.transitioning=1;var e=function(){this.transitioning=0,this.$element.removeClass("collapsing").addClass("collapse").trigger("hidden.bs.collapse")};if(!a.support.transition)return e.call(this);this.$element[c](0).one("bsTransitionEnd",a.proxy(e,this)).emulateTransitionEnd(d.TRANSITION_DURATION)}}},d.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()},d.prototype.getParent=function(){return a(document).find(this.options.parent).find('[data-toggle="collapse"][data-parent="'+this.options.parent+'"]').each(a.proxy(function(c,d){var e=a(d);this.addAriaAndCollapsedClass(b(e),e)},this)).end()},d.prototype.addAriaAndCollapsedClass=function(a,b){var c=a.hasClass("in");a.attr("aria-expanded",c),b.toggleClass("collapsed",!c).attr("aria-expanded",c)};var e=a.fn.collapse;a.fn.collapse=c,a.fn.collapse.Constructor=d,a.fn.collapse.noConflict=function(){return a.fn.collapse=e,this},a(document).on("click.bs.collapse.data-api",'[data-toggle="collapse"]',function(d){var e=a(this);e.attr("data-target")||d.preventDefault();var f=b(e),g=f.data("bs.collapse"),h=g?"toggle":e.data();c.call(f,h)})}(jQuery)},{}],244:[function(a,b,c){+function(a){"use strict";function b(b){var c=b.attr("data-target");c||(c=b.attr("href"),c=c&&/#[A-Za-z]/.test(c)&&c.replace(/.*(?=#[^\s]*$)/,""));var d="#"!==c?a(document).find(c):null;return d&&d.length?d:b.parent()}function c(c){c&&3===c.which||(a(e).remove(),a(f).each(function(){var d=a(this),e=b(d),f={relatedTarget:this};e.hasClass("open")&&(c&&"click"==c.type&&/input|textarea/i.test(c.target.tagName)&&a.contains(e[0],c.target)||(e.trigger(c=a.Event("hide.bs.dropdown",f)),c.isDefaultPrevented()||(d.attr("aria-expanded","false"),e.removeClass("open").trigger(a.Event("hidden.bs.dropdown",f)))))}))}function d(b){return this.each(function(){var c=a(this),d=c.data("bs.dropdown");d||c.data("bs.dropdown",d=new g(this)),"string"==typeof b&&d[b].call(c)})}var e=".dropdown-backdrop",f='[data-toggle="dropdown"]',g=function(b){a(b).on("click.bs.dropdown",this.toggle)};g.VERSION="3.4.1",g.prototype.toggle=function(d){var e=a(this);if(!e.is(".disabled, :disabled")){var f=b(e),g=f.hasClass("open");if(c(),!g){"ontouchstart"in document.documentElement&&!f.closest(".navbar-nav").length&&a(document.createElement("div")).addClass("dropdown-backdrop").insertAfter(a(this)).on("click",c);var h={relatedTarget:this};if(f.trigger(d=a.Event("show.bs.dropdown",h)),d.isDefaultPrevented())return;e.trigger("focus").attr("aria-expanded","true"),f.toggleClass("open").trigger(a.Event("shown.bs.dropdown",h))}return!1}},g.prototype.keydown=function(c){if(/(38|40|27|32)/.test(c.which)&&!/input|textarea/i.test(c.target.tagName)){var d=a(this);if(c.preventDefault(),c.stopPropagation(),!d.is(".disabled, :disabled")){var e=b(d),g=e.hasClass("open");if(!g&&27!=c.which||g&&27==c.which)return 27==c.which&&e.find(f).trigger("focus"),d.trigger("click");var h=" li:not(.disabled):visible a",i=e.find(".dropdown-menu"+h);if(i.length){var j=i.index(c.target);38==c.which&&j>0&&j--,40==c.which&&j<i.length-1&&j++,~j||(j=0),i.eq(j).trigger("focus")}}}};var h=a.fn.dropdown;a.fn.dropdown=d,a.fn.dropdown.Constructor=g,a.fn.dropdown.noConflict=function(){return a.fn.dropdown=h,this},a(document).on("click.bs.dropdown.data-api",c).on("click.bs.dropdown.data-api",".dropdown form",function(a){a.stopPropagation()}).on("click.bs.dropdown.data-api",f,g.prototype.toggle).on("keydown.bs.dropdown.data-api",f,g.prototype.keydown).on("keydown.bs.dropdown.data-api",".dropdown-menu",g.prototype.keydown)}(jQuery)},{}],245:[function(a,b,c){+function(a){"use strict";function b(b,d){return this.each(function(){var e=a(this),f=e.data("bs.modal"),g=a.extend({},c.DEFAULTS,e.data(),"object"==typeof b&&b);f||e.data("bs.modal",f=new c(this,g)),"string"==typeof b?f[b](d):g.show&&f.show(d)})}var c=function(b,c){this.options=c,this.$body=a(document.body),this.$element=a(b),this.$dialog=this.$element.find(".modal-dialog"),this.$backdrop=null,this.isShown=null,this.originalBodyPad=null,this.scrollbarWidth=0,this.ignoreBackdropClick=!1,this.fixedContent=".navbar-fixed-top, .navbar-fixed-bottom",this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,a.proxy(function(){this.$element.trigger("loaded.bs.modal")},this))};c.VERSION="3.4.1",c.TRANSITION_DURATION=300,c.BACKDROP_TRANSITION_DURATION=150,c.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},c.prototype.toggle=function(a){return this.isShown?this.hide():this.show(a)},c.prototype.show=function(b){var d=this,e=a.Event("show.bs.modal",{relatedTarget:b});this.$element.trigger(e),this.isShown||e.isDefaultPrevented()||(this.isShown=!0,this.checkScrollbar(),this.setScrollbar(),this.$body.addClass("modal-open"),this.escape(),this.resize(),this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',a.proxy(this.hide,this)),this.$dialog.on("mousedown.dismiss.bs.modal",function(){d.$element.one("mouseup.dismiss.bs.modal",function(b){a(b.target).is(d.$element)&&(d.ignoreBackdropClick=!0)})}),this.backdrop(function(){var e=a.support.transition&&d.$element.hasClass("fade");d.$element.parent().length||d.$element.appendTo(d.$body),d.$element.show().scrollTop(0),d.adjustDialog(),e&&d.$element[0].offsetWidth,d.$element.addClass("in"),d.enforceFocus();var f=a.Event("shown.bs.modal",{relatedTarget:b});e?d.$dialog.one("bsTransitionEnd",function(){d.$element.trigger("focus").trigger(f)}).emulateTransitionEnd(c.TRANSITION_DURATION):d.$element.trigger("focus").trigger(f)}))},c.prototype.hide=function(b){b&&b.preventDefault(),b=a.Event("hide.bs.modal"),this.$element.trigger(b),this.isShown&&!b.isDefaultPrevented()&&(this.isShown=!1,this.escape(),this.resize(),a(document).off("focusin.bs.modal"),this.$element.removeClass("in").off("click.dismiss.bs.modal").off("mouseup.dismiss.bs.modal"),this.$dialog.off("mousedown.dismiss.bs.modal"),a.support.transition&&this.$element.hasClass("fade")?this.$element.one("bsTransitionEnd",a.proxy(this.hideModal,this)).emulateTransitionEnd(c.TRANSITION_DURATION):this.hideModal())},c.prototype.enforceFocus=function(){a(document).off("focusin.bs.modal").on("focusin.bs.modal",a.proxy(function(a){document===a.target||this.$element[0]===a.target||this.$element.has(a.target).length||this.$element.trigger("focus")},this))},c.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keydown.dismiss.bs.modal",a.proxy(function(a){27==a.which&&this.hide()},this)):this.isShown||this.$element.off("keydown.dismiss.bs.modal")},c.prototype.resize=function(){this.isShown?a(window).on("resize.bs.modal",a.proxy(this.handleUpdate,this)):a(window).off("resize.bs.modal")},c.prototype.hideModal=function(){var a=this;this.$element.hide(),this.backdrop(function(){a.$body.removeClass("modal-open"),a.resetAdjustments(),a.resetScrollbar(),a.$element.trigger("hidden.bs.modal")})},c.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},c.prototype.backdrop=function(b){var d=this,e=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var f=a.support.transition&&e;if(this.$backdrop=a(document.createElement("div")).addClass("modal-backdrop "+e).appendTo(this.$body),this.$element.on("click.dismiss.bs.modal",a.proxy(function(a){if(this.ignoreBackdropClick)return void(this.ignoreBackdropClick=!1);a.target===a.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus():this.hide())},this)),f&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!b)return;f?this.$backdrop.one("bsTransitionEnd",b).emulateTransitionEnd(c.BACKDROP_TRANSITION_DURATION):b()}else if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass("in");var g=function(){d.removeBackdrop(),b&&b()};a.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one("bsTransitionEnd",g).emulateTransitionEnd(c.BACKDROP_TRANSITION_DURATION):g()}else b&&b()},c.prototype.handleUpdate=function(){this.adjustDialog()},c.prototype.adjustDialog=function(){var a=this.$element[0].scrollHeight>document.documentElement.clientHeight;this.$element.css({paddingLeft:!this.bodyIsOverflowing&&a?this.scrollbarWidth:"",paddingRight:this.bodyIsOverflowing&&!a?this.scrollbarWidth:""})},c.prototype.resetAdjustments=function(){this.$element.css({paddingLeft:"",paddingRight:""})},c.prototype.checkScrollbar=function(){var a=window.innerWidth;if(!a){var b=document.documentElement.getBoundingClientRect();a=b.right-Math.abs(b.left)}this.bodyIsOverflowing=document.body.clientWidth<a,this.scrollbarWidth=this.measureScrollbar()},c.prototype.setScrollbar=function(){var b=parseInt(this.$body.css("padding-right")||0,10);this.originalBodyPad=document.body.style.paddingRight||"";var c=this.scrollbarWidth;this.bodyIsOverflowing&&(this.$body.css("padding-right",b+c),a(this.fixedContent).each(function(b,d){var e=d.style.paddingRight,f=a(d).css("padding-right");a(d).data("padding-right",e).css("padding-right",parseFloat(f)+c+"px")}))},c.prototype.resetScrollbar=function(){this.$body.css("padding-right",this.originalBodyPad),a(this.fixedContent).each(function(b,c){var d=a(c).data("padding-right");a(c).removeData("padding-right"),c.style.paddingRight=d||""})},c.prototype.measureScrollbar=function(){var a=document.createElement("div");a.className="modal-scrollbar-measure",this.$body.append(a);var b=a.offsetWidth-a.clientWidth;return this.$body[0].removeChild(a),b};var d=a.fn.modal;a.fn.modal=b,a.fn.modal.Constructor=c,a.fn.modal.noConflict=function(){return a.fn.modal=d,this},a(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(c){var d=a(this),e=d.attr("href"),f=d.attr("data-target")||e&&e.replace(/.*(?=#[^\s]+$)/,""),g=a(document).find(f),h=g.data("bs.modal")?"toggle":a.extend({remote:!/#/.test(e)&&e},g.data(),d.data());d.is("a")&&c.preventDefault(),g.one("show.bs.modal",function(a){a.isDefaultPrevented()||g.one("hidden.bs.modal",function(){d.is(":visible")&&d.trigger("focus")})}),b.call(g,h,this)})}(jQuery)},{}],246:[function(a,b,c){+function(a){"use strict";function b(b){return this.each(function(){var d=a(this),e=d.data("bs.popover"),f="object"==typeof b&&b;!e&&/destroy|hide/.test(b)||(e||d.data("bs.popover",e=new c(this,f)),"string"==typeof b&&e[b]())})}var c=function(a,b){this.init("popover",a,b)};if(!a.fn.tooltip)throw new Error("Popover requires tooltip.js");c.VERSION="3.4.1",c.DEFAULTS=a.extend({},a.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),c.prototype=a.extend({},a.fn.tooltip.Constructor.prototype),c.prototype.constructor=c,c.prototype.getDefaults=function(){return c.DEFAULTS},c.prototype.setContent=function(){var a=this.tip(),b=this.getTitle(),c=this.getContent();if(this.options.html){var d=typeof c;this.options.sanitize&&(b=this.sanitizeHtml(b),"string"===d&&(c=this.sanitizeHtml(c))),a.find(".popover-title").html(b),a.find(".popover-content").children().detach().end()["string"===d?"html":"append"](c)}else a.find(".popover-title").text(b),a.find(".popover-content").children().detach().end().text(c);a.removeClass("fade top bottom left right in"),a.find(".popover-title").html()||a.find(".popover-title").hide()},c.prototype.hasContent=function(){return this.getTitle()||this.getContent()},c.prototype.getContent=function(){var a=this.$element,b=this.options;return a.attr("data-content")||("function"==typeof b.content?b.content.call(a[0]):b.content)},c.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")};var d=a.fn.popover;a.fn.popover=b,a.fn.popover.Constructor=c,a.fn.popover.noConflict=function(){return a.fn.popover=d,this}}(jQuery)},{}],247:[function(a,b,c){+function(a){"use strict";function b(c,d){this.$body=a(document.body),this.$scrollElement=a(a(c).is(document.body)?window:c),this.options=a.extend({},b.DEFAULTS,d),this.selector=(this.options.target||"")+" .nav li > a",this.offsets=[],this.targets=[],this.activeTarget=null,this.scrollHeight=0,this.$scrollElement.on("scroll.bs.scrollspy",a.proxy(this.process,this)),this.refresh(),this.process()}function c(c){return this.each(function(){var d=a(this),e=d.data("bs.scrollspy"),f="object"==typeof c&&c;e||d.data("bs.scrollspy",e=new b(this,f)),"string"==typeof c&&e[c]()})}b.VERSION="3.4.1",b.DEFAULTS={offset:10},b.prototype.getScrollHeight=function(){return this.$scrollElement[0].scrollHeight||Math.max(this.$body[0].scrollHeight,document.documentElement.scrollHeight)},b.prototype.refresh=function(){var b=this,c="offset",d=0;this.offsets=[],this.targets=[],this.scrollHeight=this.getScrollHeight(),a.isWindow(this.$scrollElement[0])||(c="position",d=this.$scrollElement.scrollTop()),this.$body.find(this.selector).map(function(){var b=a(this),e=b.data("target")||b.attr("href"),f=/^#./.test(e)&&a(e);return f&&f.length&&f.is(":visible")&&[[f[c]().top+d,e]]||null}).sort(function(a,b){return a[0]-b[0]}).each(function(){b.offsets.push(this[0]),b.targets.push(this[1])})},b.prototype.process=function(){var a,b=this.$scrollElement.scrollTop()+this.options.offset,c=this.getScrollHeight(),d=this.options.offset+c-this.$scrollElement.height(),e=this.offsets,f=this.targets,g=this.activeTarget;if(this.scrollHeight!=c&&this.refresh(),b>=d)return g!=(a=f[f.length-1])&&this.activate(a);if(g&&b<e[0])return this.activeTarget=null,this.clear();for(a=e.length;a--;)g!=f[a]&&b>=e[a]&&(void 0===e[a+1]||b<e[a+1])&&this.activate(f[a])},b.prototype.activate=function(b){this.activeTarget=b,this.clear();var c=this.selector+'[data-target="'+b+'"],'+this.selector+'[href="'+b+'"]',d=a(c).parents("li").addClass("active");d.parent(".dropdown-menu").length&&(d=d.closest("li.dropdown").addClass("active")),d.trigger("activate.bs.scrollspy")},b.prototype.clear=function(){a(this.selector).parentsUntil(this.options.target,".active").removeClass("active")};var d=a.fn.scrollspy;a.fn.scrollspy=c,a.fn.scrollspy.Constructor=b,a.fn.scrollspy.noConflict=function(){return a.fn.scrollspy=d,this},a(window).on("load.bs.scrollspy.data-api",function(){a('[data-spy="scroll"]').each(function(){var b=a(this);c.call(b,b.data())})})}(jQuery)},{}],248:[function(a,b,c){+function(a){"use strict";function b(b){return this.each(function(){var d=a(this),e=d.data("bs.tab");e||d.data("bs.tab",e=new c(this)),"string"==typeof b&&e[b]()})}var c=function(b){this.element=a(b)};c.VERSION="3.4.1",c.TRANSITION_DURATION=150,c.prototype.show=function(){var b=this.element,c=b.closest("ul:not(.dropdown-menu)"),d=b.data("target");if(d||(d=b.attr("href"),d=d&&d.replace(/.*(?=#[^\s]*$)/,"")),!b.parent("li").hasClass("active")){var e=c.find(".active:last a"),f=a.Event("hide.bs.tab",{relatedTarget:b[0]}),g=a.Event("show.bs.tab",{relatedTarget:e[0]});if(e.trigger(f),b.trigger(g),!g.isDefaultPrevented()&&!f.isDefaultPrevented()){var h=a(document).find(d);this.activate(b.closest("li"),c),this.activate(h,h.parent(),function(){e.trigger({type:"hidden.bs.tab",relatedTarget:b[0]}),b.trigger({type:"shown.bs.tab",relatedTarget:e[0]})})}}},c.prototype.activate=function(b,d,e){function f(){g.removeClass("active").find("> .dropdown-menu > .active").removeClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!1),b.addClass("active").find('[data-toggle="tab"]').attr("aria-expanded",!0),h?(b[0].offsetWidth,b.addClass("in")):b.removeClass("fade"),b.parent(".dropdown-menu").length&&b.closest("li.dropdown").addClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!0),e&&e()}var g=d.find("> .active"),h=e&&a.support.transition&&(g.length&&g.hasClass("fade")||!!d.find("> .fade").length);g.length&&h?g.one("bsTransitionEnd",f).emulateTransitionEnd(c.TRANSITION_DURATION):f(),g.removeClass("in")};var d=a.fn.tab;a.fn.tab=b,a.fn.tab.Constructor=c,a.fn.tab.noConflict=function(){return a.fn.tab=d,this};var e=function(c){c.preventDefault(),b.call(a(this),"show")};a(document).on("click.bs.tab.data-api",'[data-toggle="tab"]',e).on("click.bs.tab.data-api",'[data-toggle="pill"]',e)}(jQuery)},{}],249:[function(a,b,c){+function(a){"use strict";function b(b,c){var d=b.nodeName.toLowerCase();if(-1!==a.inArray(d,c))return-1===a.inArray(d,f)||Boolean(b.nodeValue.match(i)||b.nodeValue.match(j));for(var e=a(c).filter(function(a,b){return b instanceof RegExp}),g=0,h=e.length;g<h;g++)if(d.match(e[g]))return!0;return!1}function c(c,d,e){if(0===c.length)return c;if(e&&"function"==typeof e)return e(c);if(!document.implementation||!document.implementation.createHTMLDocument)return c;var f=document.implementation.createHTMLDocument("sanitization");f.body.innerHTML=c;for(var g=a.map(d,function(a,b){return b}),h=a(f.body).find("*"),i=0,j=h.length;i<j;i++){var k=h[i],l=k.nodeName.toLowerCase();if(-1!==a.inArray(l,g))for(var m=a.map(k.attributes,function(a){return a}),n=[].concat(d["*"]||[],d[l]||[]),o=0,p=m.length;o<p;o++)b(m[o],n)||k.removeAttribute(m[o].nodeName);else k.parentNode.removeChild(k)}return f.body.innerHTML}function d(b){return this.each(function(){var c=a(this),d=c.data("bs.tooltip"),e="object"==typeof b&&b;!d&&/destroy|hide/.test(b)||(d||c.data("bs.tooltip",d=new k(this,e)),"string"==typeof b&&d[b]())})}var e=["sanitize","whiteList","sanitizeFn"],f=["background","cite","href","itemtype","longdesc","poster","src","xlink:href"],g=/^aria-[\w-]*$/i,h={"*":["class","dir","id","lang","role",g],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],div:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},i=/^(?:(?:https?|mailto|ftp|tel|file):|[^&:\/?#]*(?:[\/?#]|$))/gi,j=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i,k=function(a,b){this.type=null,this.options=null,this.enabled=null,this.timeout=null,this.hoverState=null,this.$element=null,this.inState=null,this.init("tooltip",a,b)};k.VERSION="3.4.1",k.TRANSITION_DURATION=150,k.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0},sanitize:!0,sanitizeFn:null,whiteList:h},k.prototype.init=function(b,c,d){if(this.enabled=!0,this.type=b,this.$element=a(c),this.options=this.getOptions(d),this.$viewport=this.options.viewport&&a(document).find(a.isFunction(this.options.viewport)?this.options.viewport.call(this,this.$element):this.options.viewport.selector||this.options.viewport),this.inState={click:!1,hover:!1,focus:!1},this.$element[0]instanceof document.constructor&&!this.options.selector)throw new Error("`selector` option must be specified when initializing "+this.type+" on the window.document object!");for(var e=this.options.trigger.split(" "),f=e.length;f--;){var g=e[f];if("click"==g)this.$element.on("click."+this.type,this.options.selector,a.proxy(this.toggle,this));else if("manual"!=g){var h="hover"==g?"mouseenter":"focusin",i="hover"==g?"mouseleave":"focusout";this.$element.on(h+"."+this.type,this.options.selector,a.proxy(this.enter,this)),this.$element.on(i+"."+this.type,this.options.selector,a.proxy(this.leave,this))}}this.options.selector?this._options=a.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},k.prototype.getDefaults=function(){return k.DEFAULTS},k.prototype.getOptions=function(b){var d=this.$element.data();for(var f in d)d.hasOwnProperty(f)&&-1!==a.inArray(f,e)&&delete d[f];return b=a.extend({},this.getDefaults(),d,b),b.delay&&"number"==typeof b.delay&&(b.delay={show:b.delay,hide:b.delay}),b.sanitize&&(b.template=c(b.template,b.whiteList,b.sanitizeFn)),b},k.prototype.getDelegateOptions=function(){var b={},c=this.getDefaults();return this._options&&a.each(this._options,function(a,d){c[a]!=d&&(b[a]=d)}),b},k.prototype.enter=function(b){var c=b instanceof this.constructor?b:a(b.currentTarget).data("bs."+this.type);return c||(c=new this.constructor(b.currentTarget,this.getDelegateOptions()),a(b.currentTarget).data("bs."+this.type,c)),b instanceof a.Event&&(c.inState["focusin"==b.type?"focus":"hover"]=!0),c.tip().hasClass("in")||"in"==c.hoverState?void(c.hoverState="in"):(clearTimeout(c.timeout),c.hoverState="in",c.options.delay&&c.options.delay.show?void(c.timeout=setTimeout(function(){"in"==c.hoverState&&c.show()},c.options.delay.show)):c.show())},k.prototype.isInStateTrue=function(){for(var a in this.inState)if(this.inState[a])return!0;return!1},k.prototype.leave=function(b){var c=b instanceof this.constructor?b:a(b.currentTarget).data("bs."+this.type);if(c||(c=new this.constructor(b.currentTarget,this.getDelegateOptions()),a(b.currentTarget).data("bs."+this.type,c)),b instanceof a.Event&&(c.inState["focusout"==b.type?"focus":"hover"]=!1),!c.isInStateTrue()){if(clearTimeout(c.timeout),c.hoverState="out",!c.options.delay||!c.options.delay.hide)return c.hide();c.timeout=setTimeout(function(){"out"==c.hoverState&&c.hide()},c.options.delay.hide)}},k.prototype.show=function(){var b=a.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(b);var c=a.contains(this.$element[0].ownerDocument.documentElement,this.$element[0]);if(b.isDefaultPrevented()||!c)return;var d=this,e=this.tip(),f=this.getUID(this.type);this.setContent(),e.attr("id",f),this.$element.attr("aria-describedby",f),this.options.animation&&e.addClass("fade");var g="function"==typeof this.options.placement?this.options.placement.call(this,e[0],this.$element[0]):this.options.placement,h=/\s?auto?\s?/i,i=h.test(g);i&&(g=g.replace(h,"")||"top"),e.detach().css({top:0,left:0,display:"block"}).addClass(g).data("bs."+this.type,this),this.options.container?e.appendTo(a(document).find(this.options.container)):e.insertAfter(this.$element),this.$element.trigger("inserted.bs."+this.type);var j=this.getPosition(),l=e[0].offsetWidth,m=e[0].offsetHeight;if(i){var n=g,o=this.getPosition(this.$viewport);g="bottom"==g&&j.bottom+m>o.bottom?"top":"top"==g&&j.top-m<o.top?"bottom":"right"==g&&j.right+l>o.width?"left":"left"==g&&j.left-l<o.left?"right":g,e.removeClass(n).addClass(g)}var p=this.getCalculatedOffset(g,j,l,m);this.applyPlacement(p,g);var q=function(){var a=d.hoverState;d.$element.trigger("shown.bs."+d.type),d.hoverState=null,"out"==a&&d.leave(d)};a.support.transition&&this.$tip.hasClass("fade")?e.one("bsTransitionEnd",q).emulateTransitionEnd(k.TRANSITION_DURATION):q()}},k.prototype.applyPlacement=function(b,c){var d=this.tip(),e=d[0].offsetWidth,f=d[0].offsetHeight,g=parseInt(d.css("margin-top"),10),h=parseInt(d.css("margin-left"),10);isNaN(g)&&(g=0),isNaN(h)&&(h=0),b.top+=g,b.left+=h,a.offset.setOffset(d[0],a.extend({using:function(a){d.css({top:Math.round(a.top),left:Math.round(a.left)})}},b),0),d.addClass("in");var i=d[0].offsetWidth,j=d[0].offsetHeight;"top"==c&&j!=f&&(b.top=b.top+f-j);var k=this.getViewportAdjustedDelta(c,b,i,j);k.left?b.left+=k.left:b.top+=k.top;var l=/top|bottom/.test(c),m=l?2*k.left-e+i:2*k.top-f+j,n=l?"offsetWidth":"offsetHeight";d.offset(b),this.replaceArrow(m,d[0][n],l)},k.prototype.replaceArrow=function(a,b,c){this.arrow().css(c?"left":"top",50*(1-a/b)+"%").css(c?"top":"left","")},k.prototype.setContent=function(){var a=this.tip(),b=this.getTitle();this.options.html?(this.options.sanitize&&(b=c(b,this.options.whiteList,this.options.sanitizeFn)),a.find(".tooltip-inner").html(b)):a.find(".tooltip-inner").text(b),a.removeClass("fade in top bottom left right")},k.prototype.hide=function(b){function c(){"in"!=d.hoverState&&e.detach(),d.$element&&d.$element.removeAttr("aria-describedby").trigger("hidden.bs."+d.type),b&&b()}var d=this,e=a(this.$tip),f=a.Event("hide.bs."+this.type);if(this.$element.trigger(f),!f.isDefaultPrevented())return e.removeClass("in"),a.support.transition&&e.hasClass("fade")?e.one("bsTransitionEnd",c).emulateTransitionEnd(k.TRANSITION_DURATION):c(),this.hoverState=null,this},k.prototype.fixTitle=function(){var a=this.$element;(a.attr("title")||"string"!=typeof a.attr("data-original-title"))&&a.attr("data-original-title",a.attr("title")||"").attr("title","")},k.prototype.hasContent=function(){return this.getTitle()},k.prototype.getPosition=function(b){b=b||this.$element;var c=b[0],d="BODY"==c.tagName,e=c.getBoundingClientRect();null==e.width&&(e=a.extend({},e,{width:e.right-e.left,height:e.bottom-e.top}));var f=window.SVGElement&&c instanceof window.SVGElement,g=d?{top:0,left:0}:f?null:b.offset(),h={scroll:d?document.documentElement.scrollTop||document.body.scrollTop:b.scrollTop()},i=d?{width:a(window).width(),height:a(window).height()}:null;return a.extend({},e,h,i,g)},k.prototype.getCalculatedOffset=function(a,b,c,d){return"bottom"==a?{top:b.top+b.height,left:b.left+b.width/2-c/2}:"top"==a?{top:b.top-d,left:b.left+b.width/2-c/2}:"left"==a?{top:b.top+b.height/2-d/2,left:b.left-c}:{top:b.top+b.height/2-d/2,left:b.left+b.width}},k.prototype.getViewportAdjustedDelta=function(a,b,c,d){var e={top:0,left:0};if(!this.$viewport)return e;var f=this.options.viewport&&this.options.viewport.padding||0,g=this.getPosition(this.$viewport);if(/right|left/.test(a)){
var h=b.top-f-g.scroll,i=b.top+f-g.scroll+d;h<g.top?e.top=g.top-h:i>g.top+g.height&&(e.top=g.top+g.height-i)}else{var j=b.left-f,k=b.left+f+c;j<g.left?e.left=g.left-j:k>g.right&&(e.left=g.left+g.width-k)}return e},k.prototype.getTitle=function(){var a=this.$element,b=this.options;return a.attr("data-original-title")||("function"==typeof b.title?b.title.call(a[0]):b.title)},k.prototype.getUID=function(a){do{a+=~~(1e6*Math.random())}while(document.getElementById(a));return a},k.prototype.tip=function(){if(!this.$tip&&(this.$tip=a(this.options.template),1!=this.$tip.length))throw new Error(this.type+" `template` option must consist of exactly 1 top-level element!");return this.$tip},k.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},k.prototype.enable=function(){this.enabled=!0},k.prototype.disable=function(){this.enabled=!1},k.prototype.toggleEnabled=function(){this.enabled=!this.enabled},k.prototype.toggle=function(b){var c=this;b&&((c=a(b.currentTarget).data("bs."+this.type))||(c=new this.constructor(b.currentTarget,this.getDelegateOptions()),a(b.currentTarget).data("bs."+this.type,c))),b?(c.inState.click=!c.inState.click,c.isInStateTrue()?c.enter(c):c.leave(c)):c.tip().hasClass("in")?c.leave(c):c.enter(c)},k.prototype.destroy=function(){var a=this;clearTimeout(this.timeout),this.hide(function(){a.$element.off("."+a.type).removeData("bs."+a.type),a.$tip&&a.$tip.detach(),a.$tip=null,a.$arrow=null,a.$viewport=null,a.$element=null})},k.prototype.sanitizeHtml=function(a){return c(a,this.options.whiteList,this.options.sanitizeFn)};var l=a.fn.tooltip;a.fn.tooltip=d,a.fn.tooltip.Constructor=k,a.fn.tooltip.noConflict=function(){return a.fn.tooltip=l,this}}(jQuery)},{}],250:[function(a,b,c){+function(a){"use strict";function b(){var a=document.createElement("bootstrap"),b={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var c in b)if(void 0!==a.style[c])return{end:b[c]};return!1}a.fn.emulateTransitionEnd=function(b){var c=!1,d=this;a(this).one("bsTransitionEnd",function(){c=!0});var e=function(){c||a(d).trigger(a.support.transition.end)};return setTimeout(e,b),this},a(function(){a.support.transition=b(),a.support.transition&&(a.event.special.bsTransitionEnd={bindType:a.support.transition.end,delegateType:a.support.transition.end,handle:function(b){if(a(b.target).is(this))return b.handleObj.handler.apply(this,arguments)}})})}(jQuery)},{}],251:[function(a,b,c){},{}],252:[function(a,b,c){b.exports=a(251)},{"/Users/codhek/im-tables/node_modules/browser-resolve/empty.js":251}],253:[function(b,c,d){(function(b){!function(e){function f(a){throw RangeError(I[a])}function g(a,b){for(var c=a.length;c--;)a[c]=b(a[c]);return a}function h(a,b){return g(a.split(H),b).join(".")}function i(a){for(var b,c,d=[],e=0,f=a.length;e<f;)b=a.charCodeAt(e++),b>=55296&&b<=56319&&e<f?(c=a.charCodeAt(e++),56320==(64512&c)?d.push(((1023&b)<<10)+(1023&c)+65536):(d.push(b),e--)):d.push(b);return d}function j(a){return g(a,function(a){var b="";return a>65535&&(a-=65536,b+=L(a>>>10&1023|55296),a=56320|1023&a),b+=L(a)}).join("")}function k(a){return a-48<10?a-22:a-65<26?a-65:a-97<26?a-97:x}function l(a,b){return a+22+75*(a<26)-((0!=b)<<5)}function m(a,b,c){var d=0;for(a=c?K(a/B):a>>1,a+=K(a/b);a>J*z>>1;d+=x)a=K(a/J);return K(d+(J+1)*a/(a+A))}function n(a){var b,c,d,e,g,h,i,l,n,o,p=[],q=a.length,r=0,s=D,t=C;for(c=a.lastIndexOf(E),c<0&&(c=0),d=0;d<c;++d)a.charCodeAt(d)>=128&&f("not-basic"),p.push(a.charCodeAt(d));for(e=c>0?c+1:0;e<q;){for(g=r,h=1,i=x;e>=q&&f("invalid-input"),l=k(a.charCodeAt(e++)),(l>=x||l>K((w-r)/h))&&f("overflow"),r+=l*h,n=i<=t?y:i>=t+z?z:i-t,!(l<n);i+=x)o=x-n,h>K(w/o)&&f("overflow"),h*=o;b=p.length+1,t=m(r-g,b,0==g),K(r/b)>w-s&&f("overflow"),s+=K(r/b),r%=b,p.splice(r++,0,s)}return j(p)}function o(a){var b,c,d,e,g,h,j,k,n,o,p,q,r,s,t,u=[];for(a=i(a),q=a.length,b=D,c=0,g=C,h=0;h<q;++h)(p=a[h])<128&&u.push(L(p));for(d=e=u.length,e&&u.push(E);d<q;){for(j=w,h=0;h<q;++h)(p=a[h])>=b&&p<j&&(j=p);for(r=d+1,j-b>K((w-c)/r)&&f("overflow"),c+=(j-b)*r,b=j,h=0;h<q;++h)if(p=a[h],p<b&&++c>w&&f("overflow"),p==b){for(k=c,n=x;o=n<=g?y:n>=g+z?z:n-g,!(k<o);n+=x)t=k-o,s=x-o,u.push(L(l(o+t%s,0))),k=K(t/s);u.push(L(l(k,0))),g=m(c,r,d==e),c=0,++d}++c,++b}return u.join("")}function p(a){return h(a,function(a){return F.test(a)?n(a.slice(4).toLowerCase()):a})}function q(a){return h(a,function(a){return G.test(a)?"xn--"+o(a):a})}var r="object"==typeof d&&d,s="object"==typeof c&&c&&c.exports==r&&c,t="object"==typeof b&&b;t.global!==t&&t.window!==t||(e=t);var u,v,w=2147483647,x=36,y=1,z=26,A=38,B=700,C=72,D=128,E="-",F=/^xn--/,G=/[^ -~]/,H=/\x2E|\u3002|\uFF0E|\uFF61/g,I={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},J=x-y,K=Math.floor,L=String.fromCharCode;if(u={version:"1.2.4",ucs2:{decode:i,encode:j},decode:n,encode:o,toASCII:q,toUnicode:p},"function"==typeof a&&"object"==typeof a.amd&&a.amd)a("punycode",function(){return u});else if(r&&!r.nodeType)if(s)s.exports=u;else for(v in u)u.hasOwnProperty(v)&&(r[v]=u[v]);else e.punycode=u}(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],254:[function(a,b,c){(function(b){"use strict";function d(){function a(){}try{var b=new Uint8Array(1);return b.foo=function(){return 42},b.constructor=a,42===b.foo()&&b.constructor===a&&"function"==typeof b.subarray&&0===b.subarray(1,1).byteLength}catch(a){return!1}}function e(){return f.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function f(a){return this instanceof f?(f.TYPED_ARRAY_SUPPORT||(this.length=0,this.parent=void 0),"number"==typeof a?g(this,a):"string"==typeof a?h(this,a,arguments.length>1?arguments[1]:"utf8"):i(this,a)):arguments.length>1?new f(a,arguments[1]):new f(a)}function g(a,b){if(a=p(a,b<0?0:0|q(b)),!f.TYPED_ARRAY_SUPPORT)for(var c=0;c<b;c++)a[c]=0;return a}function h(a,b,c){return"string"==typeof c&&""!==c||(c="utf8"),a=p(a,0|s(b,c)),a.write(b,c),a}function i(a,b){if(f.isBuffer(b))return j(a,b);if(Y(b))return k(a,b);if(null==b)throw new TypeError("must start with number, buffer, array or string");if("undefined"!=typeof ArrayBuffer){if(b.buffer instanceof ArrayBuffer)return l(a,b);if(b instanceof ArrayBuffer)return m(a,b)}return b.length?n(a,b):o(a,b)}function j(a,b){var c=0|q(b.length);return a=p(a,c),b.copy(a,0,0,c),a}function k(a,b){var c=0|q(b.length);a=p(a,c);for(var d=0;d<c;d+=1)a[d]=255&b[d];return a}function l(a,b){var c=0|q(b.length);a=p(a,c);for(var d=0;d<c;d+=1)a[d]=255&b[d];return a}function m(a,b){return f.TYPED_ARRAY_SUPPORT?(b.byteLength,a=f._augment(new Uint8Array(b))):a=l(a,new Uint8Array(b)),a}function n(a,b){var c=0|q(b.length);a=p(a,c);for(var d=0;d<c;d+=1)a[d]=255&b[d];return a}function o(a,b){var c,d=0;"Buffer"===b.type&&Y(b.data)&&(c=b.data,d=0|q(c.length)),a=p(a,d);for(var e=0;e<d;e+=1)a[e]=255&c[e];return a}function p(a,b){return f.TYPED_ARRAY_SUPPORT?(a=f._augment(new Uint8Array(b)),a.__proto__=f.prototype):(a.length=b,a._isBuffer=!0),0!==b&&b<=f.poolSize>>>1&&(a.parent=Z),a}function q(a){if(a>=e())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+e().toString(16)+" bytes");return 0|a}function r(a,b){if(!(this instanceof r))return new r(a,b);var c=new f(a,b);return delete c.parent,c}function s(a,b){"string"!=typeof a&&(a=""+a);var c=a.length;if(0===c)return 0;for(var d=!1;;)switch(b){case"ascii":case"binary":case"raw":case"raws":return c;case"utf8":case"utf-8":return R(a).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*c;case"hex":return c>>>1;case"base64":return U(a).length;default:if(d)return R(a).length;b=(""+b).toLowerCase(),d=!0}}function t(a,b,c){var d=!1;if(b|=0,c=void 0===c||c===1/0?this.length:0|c,a||(a="utf8"),b<0&&(b=0),c>this.length&&(c=this.length),c<=b)return"";for(;;)switch(a){case"hex":return F(this,b,c);case"utf8":case"utf-8":return B(this,b,c);case"ascii":return D(this,b,c);case"binary":return E(this,b,c);case"base64":return A(this,b,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return G(this,b,c);default:if(d)throw new TypeError("Unknown encoding: "+a);a=(a+"").toLowerCase(),d=!0}}function u(a,b,c,d){c=Number(c)||0;var e=a.length-c;d?(d=Number(d))>e&&(d=e):d=e;var f=b.length;if(f%2!=0)throw new Error("Invalid hex string");d>f/2&&(d=f/2);for(var g=0;g<d;g++){var h=parseInt(b.substr(2*g,2),16);if(isNaN(h))throw new Error("Invalid hex string");a[c+g]=h}return g}function v(a,b,c,d){return V(R(b,a.length-c),a,c,d)}function w(a,b,c,d){return V(S(b),a,c,d)}function x(a,b,c,d){return w(a,b,c,d)}function y(a,b,c,d){return V(U(b),a,c,d)}function z(a,b,c,d){return V(T(b,a.length-c),a,c,d)}function A(a,b,c){return 0===b&&c===a.length?W.fromByteArray(a):W.fromByteArray(a.slice(b,c))}function B(a,b,c){c=Math.min(a.length,c);for(var d=[],e=b;e<c;){var f=a[e],g=null,h=f>239?4:f>223?3:f>191?2:1;if(e+h<=c){var i,j,k,l;switch(h){case 1:f<128&&(g=f);break;case 2:i=a[e+1],128==(192&i)&&(l=(31&f)<<6|63&i)>127&&(g=l);break;case 3:i=a[e+1],j=a[e+2],128==(192&i)&&128==(192&j)&&(l=(15&f)<<12|(63&i)<<6|63&j)>2047&&(l<55296||l>57343)&&(g=l);break;case 4:i=a[e+1],j=a[e+2],k=a[e+3],128==(192&i)&&128==(192&j)&&128==(192&k)&&(l=(15&f)<<18|(63&i)<<12|(63&j)<<6|63&k)>65535&&l<1114112&&(g=l)}}null===g?(g=65533,h=1):g>65535&&(g-=65536,d.push(g>>>10&1023|55296),g=56320|1023&g),d.push(g),e+=h}return C(d)}function C(a){var b=a.length;if(b<=$)return String.fromCharCode.apply(String,a);for(var c="",d=0;d<b;)c+=String.fromCharCode.apply(String,a.slice(d,d+=$));return c}function D(a,b,c){var d="";c=Math.min(a.length,c);for(var e=b;e<c;e++)d+=String.fromCharCode(127&a[e]);return d}function E(a,b,c){var d="";c=Math.min(a.length,c);for(var e=b;e<c;e++)d+=String.fromCharCode(a[e]);return d}function F(a,b,c){var d=a.length;(!b||b<0)&&(b=0),(!c||c<0||c>d)&&(c=d);for(var e="",f=b;f<c;f++)e+=Q(a[f]);return e}function G(a,b,c){for(var d=a.slice(b,c),e="",f=0;f<d.length;f+=2)e+=String.fromCharCode(d[f]+256*d[f+1]);return e}function H(a,b,c){if(a%1!=0||a<0)throw new RangeError("offset is not uint");if(a+b>c)throw new RangeError("Trying to access beyond buffer length")}function I(a,b,c,d,e,g){if(!f.isBuffer(a))throw new TypeError("buffer must be a Buffer instance");if(b>e||b<g)throw new RangeError("value is out of bounds");if(c+d>a.length)throw new RangeError("index out of range")}function J(a,b,c,d){b<0&&(b=65535+b+1);for(var e=0,f=Math.min(a.length-c,2);e<f;e++)a[c+e]=(b&255<<8*(d?e:1-e))>>>8*(d?e:1-e)}function K(a,b,c,d){b<0&&(b=4294967295+b+1);for(var e=0,f=Math.min(a.length-c,4);e<f;e++)a[c+e]=b>>>8*(d?e:3-e)&255}function L(a,b,c,d,e,f){if(b>e||b<f)throw new RangeError("value is out of bounds");if(c+d>a.length)throw new RangeError("index out of range");if(c<0)throw new RangeError("index out of range")}function M(a,b,c,d,e){return e||L(a,b,c,4,3.4028234663852886e38,-3.4028234663852886e38),X.write(a,b,c,d,23,4),c+4}function N(a,b,c,d,e){return e||L(a,b,c,8,1.7976931348623157e308,-1.7976931348623157e308),X.write(a,b,c,d,52,8),c+8}function O(a){if(a=P(a).replace(aa,""),a.length<2)return"";for(;a.length%4!=0;)a+="=";return a}function P(a){return a.trim?a.trim():a.replace(/^\s+|\s+$/g,"")}function Q(a){return a<16?"0"+a.toString(16):a.toString(16)}function R(a,b){b=b||1/0;for(var c,d=a.length,e=null,f=[],g=0;g<d;g++){if((c=a.charCodeAt(g))>55295&&c<57344){if(!e){if(c>56319){(b-=3)>-1&&f.push(239,191,189);continue}if(g+1===d){(b-=3)>-1&&f.push(239,191,189);continue}e=c;continue}if(c<56320){(b-=3)>-1&&f.push(239,191,189),e=c;continue}c=65536+(e-55296<<10|c-56320)}else e&&(b-=3)>-1&&f.push(239,191,189);if(e=null,c<128){if((b-=1)<0)break;f.push(c)}else if(c<2048){if((b-=2)<0)break;f.push(c>>6|192,63&c|128)}else if(c<65536){if((b-=3)<0)break;f.push(c>>12|224,c>>6&63|128,63&c|128)}else{if(!(c<1114112))throw new Error("Invalid code point");if((b-=4)<0)break;f.push(c>>18|240,c>>12&63|128,c>>6&63|128,63&c|128)}}return f}function S(a){for(var b=[],c=0;c<a.length;c++)b.push(255&a.charCodeAt(c));return b}function T(a,b){for(var c,d,e,f=[],g=0;g<a.length&&!((b-=2)<0);g++)c=a.charCodeAt(g),d=c>>8,e=c%256,f.push(e),f.push(d);return f}function U(a){return W.toByteArray(O(a))}function V(a,b,c,d){for(var e=0;e<d&&!(e+c>=b.length||e>=a.length);e++)b[e+c]=a[e];return e}var W=a("base64-js"),X=a("ieee754"),Y=a("isarray");c.Buffer=f,c.SlowBuffer=r,c.INSPECT_MAX_BYTES=50,f.poolSize=8192;var Z={};f.TYPED_ARRAY_SUPPORT=void 0!==b.TYPED_ARRAY_SUPPORT?b.TYPED_ARRAY_SUPPORT:d(),f.TYPED_ARRAY_SUPPORT?(f.prototype.__proto__=Uint8Array.prototype,f.__proto__=Uint8Array):(f.prototype.length=void 0,f.prototype.parent=void 0),f.isBuffer=function(a){return!(null==a||!a._isBuffer)},f.compare=function(a,b){if(!f.isBuffer(a)||!f.isBuffer(b))throw new TypeError("Arguments must be Buffers");if(a===b)return 0;for(var c=a.length,d=b.length,e=0,g=Math.min(c,d);e<g&&a[e]===b[e];)++e;return e!==g&&(c=a[e],d=b[e]),c<d?-1:d<c?1:0},f.isEncoding=function(a){switch(String(a).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},f.concat=function(a,b){if(!Y(a))throw new TypeError("list argument must be an Array of Buffers.");if(0===a.length)return new f(0);var c;if(void 0===b)for(b=0,c=0;c<a.length;c++)b+=a[c].length;var d=new f(b),e=0;for(c=0;c<a.length;c++){var g=a[c];g.copy(d,e),e+=g.length}return d},f.byteLength=s,f.prototype.toString=function(){var a=0|this.length;return 0===a?"":0===arguments.length?B(this,0,a):t.apply(this,arguments)},f.prototype.equals=function(a){if(!f.isBuffer(a))throw new TypeError("Argument must be a Buffer");return this===a||0===f.compare(this,a)},f.prototype.inspect=function(){var a="",b=c.INSPECT_MAX_BYTES;return this.length>0&&(a=this.toString("hex",0,b).match(/.{2}/g).join(" "),this.length>b&&(a+=" ... ")),"<Buffer "+a+">"},f.prototype.compare=function(a){if(!f.isBuffer(a))throw new TypeError("Argument must be a Buffer");return this===a?0:f.compare(this,a)},f.prototype.indexOf=function(a,b){function c(a,b,c){for(var d=-1,e=0;c+e<a.length;e++)if(a[c+e]===b[-1===d?0:e-d]){if(-1===d&&(d=e),e-d+1===b.length)return c+d}else d=-1;return-1}if(b>2147483647?b=2147483647:b<-2147483648&&(b=-2147483648),b>>=0,0===this.length)return-1;if(b>=this.length)return-1;if(b<0&&(b=Math.max(this.length+b,0)),"string"==typeof a)return 0===a.length?-1:String.prototype.indexOf.call(this,a,b);if(f.isBuffer(a))return c(this,a,b);if("number"==typeof a)return f.TYPED_ARRAY_SUPPORT&&"function"===Uint8Array.prototype.indexOf?Uint8Array.prototype.indexOf.call(this,a,b):c(this,[a],b);throw new TypeError("val must be string, number or Buffer")},f.prototype.get=function(a){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(a)},f.prototype.set=function(a,b){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(a,b)},f.prototype.write=function(a,b,c,d){if(void 0===b)d="utf8",c=this.length,b=0;else if(void 0===c&&"string"==typeof b)d=b,c=this.length,b=0;else if(isFinite(b))b|=0,isFinite(c)?(c|=0,void 0===d&&(d="utf8")):(d=c,c=void 0);else{var e=d;d=b,b=0|c,c=e}var f=this.length-b;if((void 0===c||c>f)&&(c=f),a.length>0&&(c<0||b<0)||b>this.length)throw new RangeError("attempt to write outside buffer bounds");d||(d="utf8");for(var g=!1;;)switch(d){case"hex":return u(this,a,b,c);case"utf8":case"utf-8":return v(this,a,b,c);case"ascii":return w(this,a,b,c);case"binary":return x(this,a,b,c);case"base64":return y(this,a,b,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return z(this,a,b,c);default:if(g)throw new TypeError("Unknown encoding: "+d);d=(""+d).toLowerCase(),g=!0}},f.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var $=4096;f.prototype.slice=function(a,b){var c=this.length;a=~~a,b=void 0===b?c:~~b,a<0?(a+=c)<0&&(a=0):a>c&&(a=c),b<0?(b+=c)<0&&(b=0):b>c&&(b=c),b<a&&(b=a);var d;if(f.TYPED_ARRAY_SUPPORT)d=f._augment(this.subarray(a,b));else{var e=b-a;d=new f(e,void 0);for(var g=0;g<e;g++)d[g]=this[g+a]}return d.length&&(d.parent=this.parent||this),d},f.prototype.readUIntLE=function(a,b,c){a|=0,b|=0,c||H(a,b,this.length);for(var d=this[a],e=1,f=0;++f<b&&(e*=256);)d+=this[a+f]*e;return d},f.prototype.readUIntBE=function(a,b,c){a|=0,b|=0,c||H(a,b,this.length);for(var d=this[a+--b],e=1;b>0&&(e*=256);)d+=this[a+--b]*e;return d},f.prototype.readUInt8=function(a,b){return b||H(a,1,this.length),this[a]},f.prototype.readUInt16LE=function(a,b){return b||H(a,2,this.length),this[a]|this[a+1]<<8},f.prototype.readUInt16BE=function(a,b){return b||H(a,2,this.length),this[a]<<8|this[a+1]},f.prototype.readUInt32LE=function(a,b){return b||H(a,4,this.length),(this[a]|this[a+1]<<8|this[a+2]<<16)+16777216*this[a+3]},f.prototype.readUInt32BE=function(a,b){return b||H(a,4,this.length),16777216*this[a]+(this[a+1]<<16|this[a+2]<<8|this[a+3])},f.prototype.readIntLE=function(a,b,c){a|=0,b|=0,c||H(a,b,this.length);for(var d=this[a],e=1,f=0;++f<b&&(e*=256);)d+=this[a+f]*e;return e*=128,d>=e&&(d-=Math.pow(2,8*b)),d},f.prototype.readIntBE=function(a,b,c){a|=0,b|=0,c||H(a,b,this.length);for(var d=b,e=1,f=this[a+--d];d>0&&(e*=256);)f+=this[a+--d]*e;return e*=128,f>=e&&(f-=Math.pow(2,8*b)),f},f.prototype.readInt8=function(a,b){return b||H(a,1,this.length),128&this[a]?-1*(255-this[a]+1):this[a]},f.prototype.readInt16LE=function(a,b){b||H(a,2,this.length);var c=this[a]|this[a+1]<<8;return 32768&c?4294901760|c:c},f.prototype.readInt16BE=function(a,b){b||H(a,2,this.length);var c=this[a+1]|this[a]<<8;return 32768&c?4294901760|c:c},f.prototype.readInt32LE=function(a,b){return b||H(a,4,this.length),this[a]|this[a+1]<<8|this[a+2]<<16|this[a+3]<<24},f.prototype.readInt32BE=function(a,b){return b||H(a,4,this.length),this[a]<<24|this[a+1]<<16|this[a+2]<<8|this[a+3]},f.prototype.readFloatLE=function(a,b){return b||H(a,4,this.length),X.read(this,a,!0,23,4)},f.prototype.readFloatBE=function(a,b){return b||H(a,4,this.length),X.read(this,a,!1,23,4)},f.prototype.readDoubleLE=function(a,b){return b||H(a,8,this.length),X.read(this,a,!0,52,8)},f.prototype.readDoubleBE=function(a,b){return b||H(a,8,this.length),X.read(this,a,!1,52,8)},f.prototype.writeUIntLE=function(a,b,c,d){a=+a,b|=0,c|=0,d||I(this,a,b,c,Math.pow(2,8*c),0);var e=1,f=0;for(this[b]=255&a;++f<c&&(e*=256);)this[b+f]=a/e&255;return b+c},f.prototype.writeUIntBE=function(a,b,c,d){a=+a,b|=0,c|=0,d||I(this,a,b,c,Math.pow(2,8*c),0);var e=c-1,f=1;for(this[b+e]=255&a;--e>=0&&(f*=256);)this[b+e]=a/f&255;return b+c},f.prototype.writeUInt8=function(a,b,c){return a=+a,b|=0,c||I(this,a,b,1,255,0),f.TYPED_ARRAY_SUPPORT||(a=Math.floor(a)),this[b]=255&a,b+1},f.prototype.writeUInt16LE=function(a,b,c){return a=+a,b|=0,c||I(this,a,b,2,65535,0),f.TYPED_ARRAY_SUPPORT?(this[b]=255&a,this[b+1]=a>>>8):J(this,a,b,!0),b+2},f.prototype.writeUInt16BE=function(a,b,c){return a=+a,b|=0,c||I(this,a,b,2,65535,0),f.TYPED_ARRAY_SUPPORT?(this[b]=a>>>8,this[b+1]=255&a):J(this,a,b,!1),b+2},f.prototype.writeUInt32LE=function(a,b,c){return a=+a,b|=0,c||I(this,a,b,4,4294967295,0),f.TYPED_ARRAY_SUPPORT?(this[b+3]=a>>>24,this[b+2]=a>>>16,this[b+1]=a>>>8,this[b]=255&a):K(this,a,b,!0),b+4},f.prototype.writeUInt32BE=function(a,b,c){return a=+a,b|=0,c||I(this,a,b,4,4294967295,0),f.TYPED_ARRAY_SUPPORT?(this[b]=a>>>24,this[b+1]=a>>>16,this[b+2]=a>>>8,this[b+3]=255&a):K(this,a,b,!1),b+4},f.prototype.writeIntLE=function(a,b,c,d){if(a=+a,b|=0,!d){var e=Math.pow(2,8*c-1);I(this,a,b,c,e-1,-e)}var f=0,g=1,h=a<0?1:0;for(this[b]=255&a;++f<c&&(g*=256);)this[b+f]=(a/g>>0)-h&255;return b+c},f.prototype.writeIntBE=function(a,b,c,d){if(a=+a,b|=0,!d){var e=Math.pow(2,8*c-1);I(this,a,b,c,e-1,-e)}var f=c-1,g=1,h=a<0?1:0;for(this[b+f]=255&a;--f>=0&&(g*=256);)this[b+f]=(a/g>>0)-h&255;return b+c},f.prototype.writeInt8=function(a,b,c){return a=+a,b|=0,c||I(this,a,b,1,127,-128),f.TYPED_ARRAY_SUPPORT||(a=Math.floor(a)),a<0&&(a=255+a+1),this[b]=255&a,b+1},f.prototype.writeInt16LE=function(a,b,c){return a=+a,b|=0,c||I(this,a,b,2,32767,-32768),f.TYPED_ARRAY_SUPPORT?(this[b]=255&a,this[b+1]=a>>>8):J(this,a,b,!0),b+2},f.prototype.writeInt16BE=function(a,b,c){return a=+a,b|=0,c||I(this,a,b,2,32767,-32768),f.TYPED_ARRAY_SUPPORT?(this[b]=a>>>8,this[b+1]=255&a):J(this,a,b,!1),b+2},f.prototype.writeInt32LE=function(a,b,c){return a=+a,b|=0,c||I(this,a,b,4,2147483647,-2147483648),f.TYPED_ARRAY_SUPPORT?(this[b]=255&a,this[b+1]=a>>>8,this[b+2]=a>>>16,this[b+3]=a>>>24):K(this,a,b,!0),b+4},f.prototype.writeInt32BE=function(a,b,c){return a=+a,b|=0,c||I(this,a,b,4,2147483647,-2147483648),a<0&&(a=4294967295+a+1),f.TYPED_ARRAY_SUPPORT?(this[b]=a>>>24,this[b+1]=a>>>16,this[b+2]=a>>>8,this[b+3]=255&a):K(this,a,b,!1),b+4},f.prototype.writeFloatLE=function(a,b,c){return M(this,a,b,!0,c)},f.prototype.writeFloatBE=function(a,b,c){return M(this,a,b,!1,c)},f.prototype.writeDoubleLE=function(a,b,c){return N(this,a,b,!0,c)},f.prototype.writeDoubleBE=function(a,b,c){return N(this,a,b,!1,c)},f.prototype.copy=function(a,b,c,d){if(c||(c=0),d||0===d||(d=this.length),b>=a.length&&(b=a.length),b||(b=0),d>0&&d<c&&(d=c),d===c)return 0;if(0===a.length||0===this.length)return 0;if(b<0)throw new RangeError("targetStart out of bounds");if(c<0||c>=this.length)throw new RangeError("sourceStart out of bounds");if(d<0)throw new RangeError("sourceEnd out of bounds");d>this.length&&(d=this.length),a.length-b<d-c&&(d=a.length-b+c);var e,g=d-c;if(this===a&&c<b&&b<d)for(e=g-1;e>=0;e--)a[e+b]=this[e+c];else if(g<1e3||!f.TYPED_ARRAY_SUPPORT)for(e=0;e<g;e++)a[e+b]=this[e+c];else a._set(this.subarray(c,c+g),b);return g},f.prototype.fill=function(a,b,c){if(a||(a=0),b||(b=0),c||(c=this.length),c<b)throw new RangeError("end < start");if(c!==b&&0!==this.length){if(b<0||b>=this.length)throw new RangeError("start out of bounds");if(c<0||c>this.length)throw new RangeError("end out of bounds");var d;if("number"==typeof a)for(d=b;d<c;d++)this[d]=a;else{var e=R(a.toString()),f=e.length;for(d=b;d<c;d++)this[d]=e[d%f]}return this}},f.prototype.toArrayBuffer=function(){if("undefined"!=typeof Uint8Array){if(f.TYPED_ARRAY_SUPPORT)return new f(this).buffer;for(var a=new Uint8Array(this.length),b=0,c=a.length;b<c;b+=1)a[b]=this[b];return a.buffer}throw new TypeError("Buffer.toArrayBuffer not supported in this browser")};var _=f.prototype;f._augment=function(a){return a.constructor=f,a._isBuffer=!0,a._set=a.set,a.get=_.get,a.set=_.set,a.write=_.write,a.toString=_.toString,a.toLocaleString=_.toString,a.toJSON=_.toJSON,a.equals=_.equals,a.compare=_.compare,a.indexOf=_.indexOf,a.copy=_.copy,a.slice=_.slice,a.readUIntLE=_.readUIntLE,a.readUIntBE=_.readUIntBE,a.readUInt8=_.readUInt8,a.readUInt16LE=_.readUInt16LE,a.readUInt16BE=_.readUInt16BE,a.readUInt32LE=_.readUInt32LE,a.readUInt32BE=_.readUInt32BE,a.readIntLE=_.readIntLE,a.readIntBE=_.readIntBE,a.readInt8=_.readInt8,a.readInt16LE=_.readInt16LE,a.readInt16BE=_.readInt16BE,a.readInt32LE=_.readInt32LE,a.readInt32BE=_.readInt32BE,a.readFloatLE=_.readFloatLE,a.readFloatBE=_.readFloatBE,a.readDoubleLE=_.readDoubleLE,a.readDoubleBE=_.readDoubleBE,a.writeUInt8=_.writeUInt8,a.writeUIntLE=_.writeUIntLE,a.writeUIntBE=_.writeUIntBE,a.writeUInt16LE=_.writeUInt16LE,a.writeUInt16BE=_.writeUInt16BE,a.writeUInt32LE=_.writeUInt32LE,a.writeUInt32BE=_.writeUInt32BE,a.writeIntLE=_.writeIntLE,a.writeIntBE=_.writeIntBE,a.writeInt8=_.writeInt8,a.writeInt16LE=_.writeInt16LE,a.writeInt16BE=_.writeInt16BE,a.writeInt32LE=_.writeInt32LE,a.writeInt32BE=_.writeInt32BE,a.writeFloatLE=_.writeFloatLE,a.writeFloatBE=_.writeFloatBE,a.writeDoubleLE=_.writeDoubleLE,a.writeDoubleBE=_.writeDoubleBE,a.fill=_.fill,a.inspect=_.inspect,a.toArrayBuffer=_.toArrayBuffer,a};var aa=/[^+\/0-9A-Za-z-_]/g}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"base64-js":237,ieee754:262,isarray:280}],255:[function(a,b,c){(function(a){function b(a){return Array.isArray?Array.isArray(a):"[object Array]"===q(a)}function d(a){return"boolean"==typeof a}function e(a){return null===a}function f(a){return null==a}function g(a){return"number"==typeof a}function h(a){return"string"==typeof a}function i(a){return"symbol"==typeof a}function j(a){return void 0===a}function k(a){return"[object RegExp]"===q(a)}function l(a){return"object"==typeof a&&null!==a}function m(a){return"[object Date]"===q(a)}function n(a){return"[object Error]"===q(a)||a instanceof Error}function o(a){return"function"==typeof a}function p(a){return null===a||"boolean"==typeof a||"number"==typeof a||"string"==typeof a||"symbol"==typeof a||void 0===a}function q(a){return Object.prototype.toString.call(a)}c.isArray=b,c.isBoolean=d,c.isNull=e,c.isNullOrUndefined=f,c.isNumber=g,c.isString=h,c.isSymbol=i,c.isUndefined=j,c.isRegExp=k,c.isObject=l,c.isDate=m,c.isError=n,c.isFunction=o,c.isPrimitive=p,c.isBuffer=a.isBuffer}).call(this,{isBuffer:a("../../is-buffer/index.js")})},{"../../is-buffer/index.js":279}],256:[function(a,b,c){b.exports=function(){function a(a,b){return a<b?-1:a>b?1:a>=b?0:NaN}function b(a){return null!=a&&!isNaN(a)}function c(a){return{left:function(b,c,d,e){for(arguments.length<3&&(d=0),arguments.length<4&&(e=b.length);d<e;){var f=d+e>>>1;a(b[f],c)<0?d=f+1:e=f}return d},right:function(b,c,d,e){for(arguments.length<3&&(d=0),arguments.length<4&&(e=b.length);d<e;){var f=d+e>>>1;a(b[f],c)>0?e=f:d=f+1}return d}}}function d(a){return a.length}function e(a){for(var b=1;a*b%1;)b*=10;return b}function f(a,b){try{for(var c in b)Object.defineProperty(a.prototype,c,{value:b[c],enumerable:!1})}catch(c){a.prototype=b}}function g(){}function h(a){return dg+a in this}function i(a){return(a=dg+a)in this&&delete this[a]}function j(){var a=[];return this.forEach(function(b){a.push(b)}),a}function k(){var a=0;for(var b in this)b.charCodeAt(0)===eg&&++a;return a}function l(){for(var a in this)if(a.charCodeAt(0)===eg)return!1;return!0}function m(){}function n(a,b,c){return function(){var d=c.apply(b,arguments);return d===b?a:d}}function o(a,b){if(b in a)return b;b=b.charAt(0).toUpperCase()+b.substring(1);for(var c=0,d=fg.length;c<d;++c){var e=fg[c]+b;if(e in a)return e}}function p(){}function q(){}function r(a){function b(){for(var b,d=c,e=-1,f=d.length;++e<f;)(b=d[e].on)&&b.apply(this,arguments);return a}var c=[],d=new g;return b.on=function(b,e){var f,g=d.get(b);return arguments.length<2?g&&g.on:(g&&(g.on=null,c=c.slice(0,f=c.indexOf(g)).concat(c.slice(f+1)),d.remove(b)),e&&c.push(d.set(b,{on:e})),a)},b}function s(){Sf.event.preventDefault()}function t(){for(var a,b=Sf.event;a=b.sourceEvent;)b=a;return b}function u(a){for(var b=new q,c=0,d=arguments.length;++c<d;)b[arguments[c]]=r(b);return b.of=function(c,d){return function(e){try{var f=e.sourceEvent=Sf.event;e.target=a,Sf.event=e,b[e.type].apply(c,d)}finally{Sf.event=f}}},b}function v(a){return hg(a,mg),a}function w(a){return"function"==typeof a?a:function(){return ig(a,this)}}function x(a){return"function"==typeof a?a:function(){return jg(a,this)}}function y(a,b){function c(){this.removeAttribute(a)}function d(){this.removeAttributeNS(a.space,a.local)}function e(){this.setAttribute(a,b)}function f(){this.setAttributeNS(a.space,a.local,b)}function g(){var c=b.apply(this,arguments);null==c?this.removeAttribute(a):this.setAttribute(a,c)}function h(){var c=b.apply(this,arguments);null==c?this.removeAttributeNS(a.space,a.local):this.setAttributeNS(a.space,a.local,c)}return a=Sf.ns.qualify(a),null==b?a.local?d:c:"function"==typeof b?a.local?h:g:a.local?f:e}function z(a){return a.trim().replace(/\s+/g," ")}function A(a){return new RegExp("(?:^|\\s+)"+Sf.requote(a)+"(?:\\s+|$)","g")}function B(a){return(a+"").trim().split(/^|\s+/)}function C(a,b){function c(){for(var c=-1;++c<e;)a[c](this,b)}function d(){for(var c=-1,d=b.apply(this,arguments);++c<e;)a[c](this,d)}a=B(a).map(D);var e=a.length;return"function"==typeof b?d:c}function D(a){var b=A(a);return function(c,d){if(e=c.classList)return d?e.add(a):e.remove(a);var e=c.getAttribute("class")||"";d?(b.lastIndex=0,b.test(e)||c.setAttribute("class",z(e+" "+a))):c.setAttribute("class",z(e.replace(b," ")))}}function E(a,b,c){function d(){this.style.removeProperty(a)}function e(){this.style.setProperty(a,b,c)}function f(){var d=b.apply(this,arguments);null==d?this.style.removeProperty(a):this.style.setProperty(a,d,c)}return null==b?d:"function"==typeof b?f:e}function F(a,b){function c(){delete this[a]}function d(){this[a]=b}function e(){var c=b.apply(this,arguments);null==c?delete this[a]:this[a]=c}return null==b?c:"function"==typeof b?e:d}function G(a){return"function"==typeof a?a:(a=Sf.ns.qualify(a)).local?function(){return this.ownerDocument.createElementNS(a.space,a.local)}:function(){return this.ownerDocument.createElementNS(this.namespaceURI,a)}}function H(a){return{__data__:a}}function I(a){return function(){return lg(this,a)}}function J(b){return arguments.length||(b=a),function(a,c){return a&&c?b(a.__data__,c.__data__):!a-!c}}function K(a,b){for(var c=0,d=a.length;c<d;c++)for(var e,f=a[c],g=0,h=f.length;g<h;g++)(e=f[g])&&b(e,g,c);return a}function L(a){return hg(a,og),a}function M(a){var b,c;return function(d,e,f){var g,h=a[f].update,i=h.length;for(f!=c&&(c=f,b=0),e>=b&&(b=e+1);!(g=h[b])&&++b<i;);return g}}function N(){var a=this.__transition__;a&&++a.active}function O(a,b,c){function d(){var b=this[g];b&&(this.removeEventListener(a,b,b.$),delete this[g])}function e(){var e=i(b,Uf(arguments));d.call(this),this.addEventListener(a,this[g]=e,e.$=c),e._=b}function f(){var b,c=new RegExp("^__on([^.]+)"+Sf.requote(a)+"$");for(var d in this)if(b=d.match(c)){var e=this[d];this.removeEventListener(b[1],e,e.$),delete this[d]}}var g="__on"+a,h=a.indexOf("."),i=P;h>0&&(a=a.substring(0,h));var j=qg.get(a);return j&&(a=j,i=Q),h?b?e:d:b?p:f}function P(a,b){return function(c){var d=Sf.event;Sf.event=c,b[0]=this.__data__;try{a.apply(this,b)}finally{Sf.event=d}}}function Q(a,b){var c=P(a,b);return function(a){var b=this,d=a.relatedTarget;d&&(d===b||8&d.compareDocumentPosition(b))||c.call(b,a)}}function R(){var a=".dragsuppress-"+ ++sg,b="click"+a,c=Sf.select(Xf).on("touchmove"+a,s).on("dragstart"+a,s).on("selectstart"+a,s);if(rg){var d=Wf.style,e=d[rg];d[rg]="none"}return function(f){function g(){c.on(b,null)}c.on(a,null),rg&&(d[rg]=e),f&&(c.on(b,function(){s(),g()},!0),setTimeout(g,0))}}function S(a,b){b.changedTouches&&(b=b.changedTouches[0]);var c=a.ownerSVGElement||a;if(c.createSVGPoint){var d=c.createSVGPoint();if(tg<0&&(Xf.scrollX||Xf.scrollY)){c=Sf.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important");var e=c[0][0].getScreenCTM();tg=!(e.f||e.e),c.remove()}return tg?(d.x=b.pageX,d.y=b.pageY):(d.x=b.clientX,d.y=b.clientY),d=d.matrixTransform(a.getScreenCTM().inverse()),[d.x,d.y]}var f=a.getBoundingClientRect();return[b.clientX-f.left-a.clientLeft,b.clientY-f.top-a.clientTop]}function T(){return Sf.event.changedTouches[0].identifier}function U(){return Sf.event.target}function V(){return Xf}function W(a){return a>0?1:a<0?-1:0}function X(a,b,c){return(b[0]-a[0])*(c[1]-a[1])-(b[1]-a[1])*(c[0]-a[0])}function Y(a){return a>1?0:a<-1?ug:Math.acos(a)}function Z(a){return a>1?wg:a<-1?-wg:Math.asin(a)}function $(a){return((a=Math.exp(a))-1/a)/2}function _(a){return((a=Math.exp(a))+1/a)/2}function aa(a){return((a=Math.exp(2*a))-1)/(a+1)}function ba(a){return(a=Math.sin(a/2))*a}function ca(){}function da(a,b,c){return this instanceof da?(this.h=+a,this.s=+b,void(this.l=+c)):arguments.length<2?a instanceof da?new da(a.h,a.s,a.l):ra(""+a,sa,da):new da(a,b,c)}function ea(a,b,c){function d(a){return a>360?a-=360:a<0&&(a+=360),a<60?f+(g-f)*a/60:a<180?g:a<240?f+(g-f)*(240-a)/60:f}function e(a){return Math.round(255*d(a))}var f,g;return a=isNaN(a)?0:(a%=360)<0?a+360:a,b=isNaN(b)?0:b<0?0:b>1?1:b,c=c<0?0:c>1?1:c,g=c<=.5?c*(1+b):c+b-c*b,f=2*c-g,
new na(e(a+120),e(a),e(a-120))}function fa(a,b,c){return this instanceof fa?(this.h=+a,this.c=+b,void(this.l=+c)):arguments.length<2?a instanceof fa?new fa(a.h,a.c,a.l):a instanceof ha?ja(a.l,a.a,a.b):ja((a=ta((a=Sf.rgb(a)).r,a.g,a.b)).l,a.a,a.b):new fa(a,b,c)}function ga(a,b,c){return isNaN(a)&&(a=0),isNaN(b)&&(b=0),new ha(c,Math.cos(a*=zg)*b,Math.sin(a)*b)}function ha(a,b,c){return this instanceof ha?(this.l=+a,this.a=+b,void(this.b=+c)):arguments.length<2?a instanceof ha?new ha(a.l,a.a,a.b):a instanceof fa?ga(a.l,a.c,a.h):ta((a=na(a)).r,a.g,a.b):new ha(a,b,c)}function ia(a,b,c){var d=(a+16)/116,e=d+b/500,f=d-c/200;return e=ka(e)*Kg,d=ka(d)*Lg,f=ka(f)*Mg,new na(ma(3.2404542*e-1.5371385*d-.4985314*f),ma(-.969266*e+1.8760108*d+.041556*f),ma(.0556434*e-.2040259*d+1.0572252*f))}function ja(a,b,c){return a>0?new fa(Math.atan2(c,b)*Ag,Math.sqrt(b*b+c*c),a):new fa(NaN,NaN,a)}function ka(a){return a>.206893034?a*a*a:(a-4/29)/7.787037}function la(a){return a>.008856?Math.pow(a,1/3):7.787037*a+4/29}function ma(a){return Math.round(255*(a<=.00304?12.92*a:1.055*Math.pow(a,1/2.4)-.055))}function na(a,b,c){return this instanceof na?(this.r=~~a,this.g=~~b,void(this.b=~~c)):arguments.length<2?a instanceof na?new na(a.r,a.g,a.b):ra(""+a,na,ea):new na(a,b,c)}function oa(a){return new na(a>>16,a>>8&255,255&a)}function pa(a){return oa(a)+""}function qa(a){return a<16?"0"+Math.max(0,a).toString(16):Math.min(255,a).toString(16)}function ra(a,b,c){var d,e,f,g=0,h=0,i=0;if(d=/([a-z]+)\((.*)\)/i.exec(a))switch(e=d[2].split(","),d[1]){case"hsl":return c(parseFloat(e[0]),parseFloat(e[1])/100,parseFloat(e[2])/100);case"rgb":return b(va(e[0]),va(e[1]),va(e[2]))}return(f=Pg.get(a))?b(f.r,f.g,f.b):(null==a||"#"!==a.charAt(0)||isNaN(f=parseInt(a.substring(1),16))||(4===a.length?(g=(3840&f)>>4,g|=g>>4,h=240&f,h|=h>>4,i=15&f,i|=i<<4):7===a.length&&(g=(16711680&f)>>16,h=(65280&f)>>8,i=255&f)),b(g,h,i))}function sa(a,b,c){var d,e,f=Math.min(a/=255,b/=255,c/=255),g=Math.max(a,b,c),h=g-f,i=(g+f)/2;return h?(e=i<.5?h/(g+f):h/(2-g-f),d=a==g?(b-c)/h+(b<c?6:0):b==g?(c-a)/h+2:(a-b)/h+4,d*=60):(d=NaN,e=i>0&&i<1?0:d),new da(d,e,i)}function ta(a,b,c){a=ua(a),b=ua(b),c=ua(c);var d=la((.4124564*a+.3575761*b+.1804375*c)/Kg),e=la((.2126729*a+.7151522*b+.072175*c)/Lg);return ha(116*e-16,500*(d-e),200*(e-la((.0193339*a+.119192*b+.9503041*c)/Mg)))}function ua(a){return(a/=255)<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4)}function va(a){var b=parseFloat(a);return"%"===a.charAt(a.length-1)?Math.round(2.55*b):b}function wa(a){return"function"==typeof a?a:function(){return a}}function xa(a){return a}function ya(a){return function(b,c,d){return 2===arguments.length&&"function"==typeof c&&(d=c,c=null),za(b,c,a,d)}}function za(a,b,c,d){function e(){var a,b=i.status;if(!b&&i.responseText||b>=200&&b<300||304===b){try{a=c.call(f,i)}catch(a){return void g.error.call(f,a)}g.load.call(f,a)}else g.error.call(f,i)}var f={},g=Sf.dispatch("beforesend","progress","load","error"),h={},i=new XMLHttpRequest,j=null;return!Xf.XDomainRequest||"withCredentials"in i||!/^(http(s)?:)?\/\//.test(a)||(i=new XDomainRequest),"onload"in i?i.onload=i.onerror=e:i.onreadystatechange=function(){i.readyState>3&&e()},i.onprogress=function(a){var b=Sf.event;Sf.event=a;try{g.progress.call(f,i)}finally{Sf.event=b}},f.header=function(a,b){return a=(a+"").toLowerCase(),arguments.length<2?h[a]:(null==b?delete h[a]:h[a]=b+"",f)},f.mimeType=function(a){return arguments.length?(b=null==a?null:a+"",f):b},f.responseType=function(a){return arguments.length?(j=a,f):j},f.response=function(a){return c=a,f},["get","post"].forEach(function(a){f[a]=function(){return f.send.apply(f,[a].concat(Uf(arguments)))}}),f.send=function(c,d,e){if(2===arguments.length&&"function"==typeof d&&(e=d,d=null),i.open(c,a,!0),null==b||"accept"in h||(h.accept=b+",*/*"),i.setRequestHeader)for(var k in h)i.setRequestHeader(k,h[k]);return null!=b&&i.overrideMimeType&&i.overrideMimeType(b),null!=j&&(i.responseType=j),null!=e&&f.on("error",e).on("load",function(a){e(null,a)}),g.beforesend.call(f,i),i.send(null==d?null:d),f},f.abort=function(){return i.abort(),f},Sf.rebind(f,g,"on"),null==d?f:f.get(Aa(d))}function Aa(a){return 1===a.length?function(b,c){a(null==b?c:null)}:a}function Ba(){var a=Ca(),b=Da()-a;b>24?(isFinite(b)&&(clearTimeout(Tg),Tg=setTimeout(Ba,b)),Sg=0):(Sg=1,Vg(Ba))}function Ca(){var a=Date.now();for(Ug=Qg;Ug;)a>=Ug.t&&(Ug.f=Ug.c(a-Ug.t)),Ug=Ug.n;return a}function Da(){for(var a,b=Qg,c=1/0;b;)b.f?b=a?a.n=b.n:Qg=b.n:(b.t<c&&(c=b.t),b=(a=b).n);return Rg=a,c}function Ea(a,b){return b-(a?Math.ceil(Math.log(a)/Math.LN10):1)}function Fa(a,b){var c=Math.pow(10,3*cg(8-b));return{scale:b>8?function(a){return a/c}:function(a){return a*c},symbol:a}}function Ga(a){var b=a.decimal,c=a.thousands,d=a.grouping,e=a.currency,f=d?function(a){for(var b=a.length,e=[],f=0,g=d[0];b>0&&g>0;)e.push(a.substring(b-=g,b+g)),g=d[f=(f+1)%d.length];return e.reverse().join(c)}:xa;return function(a){var c=Xg.exec(a),d=c[1]||" ",g=c[2]||">",h=c[3]||"",i=c[4]||"",j=c[5],k=+c[6],l=c[7],m=c[8],n=c[9],o=1,p="",q="",r=!1;switch(m&&(m=+m.substring(1)),(j||"0"===d&&"="===g)&&(j=d="0",g="=",l&&(k-=Math.floor((k-1)/4))),n){case"n":l=!0,n="g";break;case"%":o=100,q="%",n="f";break;case"p":o=100,q="%",n="r";break;case"b":case"o":case"x":case"X":"#"===i&&(p="0"+n.toLowerCase());case"c":case"d":r=!0,m=0;break;case"s":o=-1,n="r"}"$"===i&&(p=e[0],q=e[1]),"r"!=n||m||(n="g"),null!=m&&("g"==n?m=Math.max(1,Math.min(21,m)):"e"!=n&&"f"!=n||(m=Math.max(0,Math.min(20,m)))),n=Yg.get(n)||Ha;var s=j&&l;return function(a){var c=q;if(r&&a%1)return"";var e=a<0||0===a&&1/a<0?(a=-a,"-"):h;if(o<0){var i=Sf.formatPrefix(a,m);a=i.scale(a),c=i.symbol+q}else a*=o;a=n(a,m);var t=a.lastIndexOf("."),u=t<0?a:a.substring(0,t),v=t<0?"":b+a.substring(t+1);!j&&l&&(u=f(u));var w=p.length+u.length+v.length+(s?0:e.length),x=w<k?new Array(w=k-w+1).join(d):"";return s&&(u=f(x+u)),e+=p,a=u+v,("<"===g?e+a+x:">"===g?x+e+a:"^"===g?x.substring(0,w>>=1)+e+a+x.substring(w):e+(s?a:x+a))+c}}}function Ha(a){return a+""}function Ia(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])}function Ja(a,b,c){function d(b){var c=a(b),d=f(c,1);return b-c<d-b?c:d}function e(c){return b(c=a(new $g(c-1)),1),c}function f(a,c){return b(a=new $g(+a),c),a}function g(a,d,f){var g=e(a),h=[];if(f>1)for(;g<d;)c(g)%f||h.push(new Date(+g)),b(g,1);else for(;g<d;)h.push(new Date(+g)),b(g,1);return h}function h(a,b,c){try{$g=Ia;var d=new Ia;return d._=a,g(d,b,c)}finally{$g=Date}}a.floor=a,a.round=d,a.ceil=e,a.offset=f,a.range=g;var i=a.utc=Ka(a);return i.floor=i,i.round=Ka(d),i.ceil=Ka(e),i.offset=Ka(f),i.range=h,a}function Ka(a){return function(b,c){try{$g=Ia;var d=new Ia;return d._=b,a(d,c)._}finally{$g=Date}}}function La(a){function b(a){function b(b){for(var c,e,f,g=[],h=-1,i=0;++h<d;)37===a.charCodeAt(h)&&(g.push(a.substring(i,h)),null!=(e=ah[c=a.charAt(++h)])&&(c=a.charAt(++h)),(f=C[c])&&(c=f(b,null==e?"e"===c?" ":"0":e)),g.push(c),i=h+1);return g.push(a.substring(i,h)),g.join("")}var d=a.length;return b.parse=function(b){var d={y:1900,m:0,d:1,H:0,M:0,S:0,L:0,Z:null};if(c(d,a,b,0)!=b.length)return null;"p"in d&&(d.H=d.H%12+12*d.p);var e=null!=d.Z&&$g!==Ia,f=new(e?Ia:$g);return"j"in d?f.setFullYear(d.y,0,d.j):"w"in d&&("W"in d||"U"in d)?(f.setFullYear(d.y,0,1),f.setFullYear(d.y,0,"W"in d?(d.w+6)%7+7*d.W-(f.getDay()+5)%7:d.w+7*d.U-(f.getDay()+6)%7)):f.setFullYear(d.y,d.m,d.d),f.setHours(d.H+Math.floor(d.Z/100),d.M+d.Z%100,d.S,d.L),e?f._:f},b.toString=function(){return a},b}function c(a,b,c,d){for(var e,f,g,h=0,i=b.length,j=c.length;h<i;){if(d>=j)return-1;if(37===(e=b.charCodeAt(h++))){if(g=b.charAt(h++),!(f=D[g in ah?b.charAt(h++):g])||(d=f(a,c,d))<0)return-1}else if(e!=c.charCodeAt(d++))return-1}return d}function d(a,b,c){w.lastIndex=0;var d=w.exec(b.substring(c));return d?(a.w=x.get(d[0].toLowerCase()),c+d[0].length):-1}function e(a,b,c){u.lastIndex=0;var d=u.exec(b.substring(c));return d?(a.w=v.get(d[0].toLowerCase()),c+d[0].length):-1}function f(a,b,c){A.lastIndex=0;var d=A.exec(b.substring(c));return d?(a.m=B.get(d[0].toLowerCase()),c+d[0].length):-1}function g(a,b,c){y.lastIndex=0;var d=y.exec(b.substring(c));return d?(a.m=z.get(d[0].toLowerCase()),c+d[0].length):-1}function h(a,b,d){return c(a,C.c.toString(),b,d)}function i(a,b,d){return c(a,C.x.toString(),b,d)}function j(a,b,d){return c(a,C.X.toString(),b,d)}function k(a,b,c){var d=t.get(b.substring(c,c+=2).toLowerCase());return null==d?-1:(a.p=d,c)}var l=a.dateTime,m=a.date,n=a.time,o=a.periods,p=a.days,q=a.shortDays,r=a.months,s=a.shortMonths;b.utc=function(a){function c(a){try{$g=Ia;var b=new $g;return b._=a,d(b)}finally{$g=Date}}var d=b(a);return c.parse=function(a){try{$g=Ia;var b=d.parse(a);return b&&b._}finally{$g=Date}},c.toString=d.toString,c},b.multi=b.utc.multi=db;var t=Sf.map(),u=Na(p),v=Oa(p),w=Na(q),x=Oa(q),y=Na(r),z=Oa(r),A=Na(s),B=Oa(s);o.forEach(function(a,b){t.set(a.toLowerCase(),b)});var C={a:function(a){return q[a.getDay()]},A:function(a){return p[a.getDay()]},b:function(a){return s[a.getMonth()]},B:function(a){return r[a.getMonth()]},c:b(l),d:function(a,b){return Ma(a.getDate(),b,2)},e:function(a,b){return Ma(a.getDate(),b,2)},H:function(a,b){return Ma(a.getHours(),b,2)},I:function(a,b){return Ma(a.getHours()%12||12,b,2)},j:function(a,b){return Ma(1+Zg.dayOfYear(a),b,3)},L:function(a,b){return Ma(a.getMilliseconds(),b,3)},m:function(a,b){return Ma(a.getMonth()+1,b,2)},M:function(a,b){return Ma(a.getMinutes(),b,2)},p:function(a){return o[+(a.getHours()>=12)]},S:function(a,b){return Ma(a.getSeconds(),b,2)},U:function(a,b){return Ma(Zg.sundayOfYear(a),b,2)},w:function(a){return a.getDay()},W:function(a,b){return Ma(Zg.mondayOfYear(a),b,2)},x:b(m),X:b(n),y:function(a,b){return Ma(a.getFullYear()%100,b,2)},Y:function(a,b){return Ma(a.getFullYear()%1e4,b,4)},Z:bb,"%":function(){return"%"}},D={a:d,A:e,b:f,B:g,c:h,d:Xa,e:Xa,H:Za,I:Za,j:Ya,L:ab,m:Wa,M:$a,p:k,S:_a,U:Qa,w:Pa,W:Ra,x:i,X:j,y:Ta,Y:Sa,Z:Ua,"%":cb};return b}function Ma(a,b,c){var d=a<0?"-":"",e=(d?-a:a)+"",f=e.length;return d+(f<c?new Array(c-f+1).join(b)+e:e)}function Na(a){return new RegExp("^(?:"+a.map(Sf.requote).join("|")+")","i")}function Oa(a){for(var b=new g,c=-1,d=a.length;++c<d;)b.set(a[c].toLowerCase(),c);return b}function Pa(a,b,c){bh.lastIndex=0;var d=bh.exec(b.substring(c,c+1));return d?(a.w=+d[0],c+d[0].length):-1}function Qa(a,b,c){bh.lastIndex=0;var d=bh.exec(b.substring(c));return d?(a.U=+d[0],c+d[0].length):-1}function Ra(a,b,c){bh.lastIndex=0;var d=bh.exec(b.substring(c));return d?(a.W=+d[0],c+d[0].length):-1}function Sa(a,b,c){bh.lastIndex=0;var d=bh.exec(b.substring(c,c+4));return d?(a.y=+d[0],c+d[0].length):-1}function Ta(a,b,c){bh.lastIndex=0;var d=bh.exec(b.substring(c,c+2));return d?(a.y=Va(+d[0]),c+d[0].length):-1}function Ua(a,b,c){return/^[+-]\d{4}$/.test(b=b.substring(c,c+5))?(a.Z=-b,c+5):-1}function Va(a){return a+(a>68?1900:2e3)}function Wa(a,b,c){bh.lastIndex=0;var d=bh.exec(b.substring(c,c+2));return d?(a.m=d[0]-1,c+d[0].length):-1}function Xa(a,b,c){bh.lastIndex=0;var d=bh.exec(b.substring(c,c+2));return d?(a.d=+d[0],c+d[0].length):-1}function Ya(a,b,c){bh.lastIndex=0;var d=bh.exec(b.substring(c,c+3));return d?(a.j=+d[0],c+d[0].length):-1}function Za(a,b,c){bh.lastIndex=0;var d=bh.exec(b.substring(c,c+2));return d?(a.H=+d[0],c+d[0].length):-1}function $a(a,b,c){bh.lastIndex=0;var d=bh.exec(b.substring(c,c+2));return d?(a.M=+d[0],c+d[0].length):-1}function _a(a,b,c){bh.lastIndex=0;var d=bh.exec(b.substring(c,c+2));return d?(a.S=+d[0],c+d[0].length):-1}function ab(a,b,c){bh.lastIndex=0;var d=bh.exec(b.substring(c,c+3));return d?(a.L=+d[0],c+d[0].length):-1}function bb(a){var b=a.getTimezoneOffset(),c=b>0?"-":"+",d=~~(cg(b)/60),e=cg(b)%60;return c+Ma(d,"0",2)+Ma(e,"0",2)}function cb(a,b,c){ch.lastIndex=0;var d=ch.exec(b.substring(c,c+1));return d?c+d[0].length:-1}function db(a){for(var b=a.length,c=-1;++c<b;)a[c][0]=this(a[c][0]);return function(b){for(var c=0,d=a[c];!d[1](b);)d=a[++c];return d[0](b)}}function eb(){}function fb(a,b,c){var d=c.s=a+b,e=d-a,f=d-e;c.t=a-f+(b-e)}function gb(a,b){a&&gh.hasOwnProperty(a.type)&&gh[a.type](a,b)}function hb(a,b,c){var d,e=-1,f=a.length-c;for(b.lineStart();++e<f;)d=a[e],b.point(d[0],d[1],d[2]);b.lineEnd()}function ib(a,b){var c=-1,d=a.length;for(b.polygonStart();++c<d;)hb(a[c],b,1);b.polygonEnd()}function jb(){function a(a,b){a*=zg,b=b*zg/2+ug/4;var c=a-d,g=c>=0?1:-1,h=g*c,i=Math.cos(b),j=Math.sin(b),k=f*j,l=e*i+k*Math.cos(h),m=k*g*Math.sin(h);ih.add(Math.atan2(m,l)),d=a,e=i,f=j}var b,c,d,e,f;jh.point=function(g,h){jh.point=a,d=(b=g)*zg,e=Math.cos(h=(c=h)*zg/2+ug/4),f=Math.sin(h)},jh.lineEnd=function(){a(b,c)}}function kb(a){var b=a[0],c=a[1],d=Math.cos(c);return[d*Math.cos(b),d*Math.sin(b),Math.sin(c)]}function lb(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]}function mb(a,b){return[a[1]*b[2]-a[2]*b[1],a[2]*b[0]-a[0]*b[2],a[0]*b[1]-a[1]*b[0]]}function nb(a,b){a[0]+=b[0],a[1]+=b[1],a[2]+=b[2]}function ob(a,b){return[a[0]*b,a[1]*b,a[2]*b]}function pb(a){var b=Math.sqrt(a[0]*a[0]+a[1]*a[1]+a[2]*a[2]);a[0]/=b,a[1]/=b,a[2]/=b}function qb(a){return[Math.atan2(a[1],a[0]),Z(a[2])]}function rb(a,b){return cg(a[0]-b[0])<xg&&cg(a[1]-b[1])<xg}function sb(a,b){a*=zg;var c=Math.cos(b*=zg);tb(c*Math.cos(a),c*Math.sin(a),Math.sin(b))}function tb(a,b,c){++kh,mh+=(a-mh)/kh,nh+=(b-nh)/kh,oh+=(c-oh)/kh}function ub(){function a(a,e){a*=zg;var f=Math.cos(e*=zg),g=f*Math.cos(a),h=f*Math.sin(a),i=Math.sin(e),j=Math.atan2(Math.sqrt((j=c*i-d*h)*j+(j=d*g-b*i)*j+(j=b*h-c*g)*j),b*g+c*h+d*i);lh+=j,ph+=j*(b+(b=g)),qh+=j*(c+(c=h)),rh+=j*(d+(d=i)),tb(b,c,d)}var b,c,d;vh.point=function(e,f){e*=zg;var g=Math.cos(f*=zg);b=g*Math.cos(e),c=g*Math.sin(e),d=Math.sin(f),vh.point=a,tb(b,c,d)}}function vb(){vh.point=sb}function wb(){function a(a,b){a*=zg;var c=Math.cos(b*=zg),g=c*Math.cos(a),h=c*Math.sin(a),i=Math.sin(b),j=e*i-f*h,k=f*g-d*i,l=d*h-e*g,m=Math.sqrt(j*j+k*k+l*l),n=d*g+e*h+f*i,o=m&&-Y(n)/m,p=Math.atan2(m,n);sh+=o*j,th+=o*k,uh+=o*l,lh+=p,ph+=p*(d+(d=g)),qh+=p*(e+(e=h)),rh+=p*(f+(f=i)),tb(d,e,f)}var b,c,d,e,f;vh.point=function(g,h){b=g,c=h,vh.point=a,g*=zg;var i=Math.cos(h*=zg);d=i*Math.cos(g),e=i*Math.sin(g),f=Math.sin(h),tb(d,e,f)},vh.lineEnd=function(){a(b,c),vh.lineEnd=vb,vh.point=sb}}function xb(){return!0}function yb(a,b,c,d,e){var f=[],g=[];if(a.forEach(function(a){if(!((b=a.length-1)<=0)){var b,c=a[0],d=a[b];if(rb(c,d)){e.lineStart();for(var h=0;h<b;++h)e.point((c=a[h])[0],c[1]);return void e.lineEnd()}var i=new Ab(c,a,null,!0),j=new Ab(c,null,i,!1);i.o=j,f.push(i),g.push(j),i=new Ab(d,a,null,!1),j=new Ab(d,null,i,!0),i.o=j,f.push(i),g.push(j)}}),g.sort(b),zb(f),zb(g),f.length){for(var h=0,i=c,j=g.length;h<j;++h)g[h].e=i=!i;for(var k,l,m=f[0];;){for(var n=m,o=!0;n.v;)if((n=n.n)===m)return;k=n.z,e.lineStart();do{if(n.v=n.o.v=!0,n.e){if(o)for(var h=0,j=k.length;h<j;++h)e.point((l=k[h])[0],l[1]);else d(n.x,n.n.x,1,e);n=n.n}else{if(o){k=n.p.z;for(var h=k.length-1;h>=0;--h)e.point((l=k[h])[0],l[1])}else d(n.x,n.p.x,-1,e);n=n.p}n=n.o,k=n.z,o=!o}while(!n.v);e.lineEnd()}}}function zb(a){if(b=a.length){for(var b,c,d=0,e=a[0];++d<b;)e.n=c=a[d],c.p=e,e=c;e.n=c=a[0],c.p=e}}function Ab(a,b,c,d){this.x=a,this.z=b,this.o=c,this.e=d,this.v=!1,this.n=this.p=null}function Bb(a,b,c,d){return function(e,f){function g(b,c){var d=e(b,c);a(b=d[0],c=d[1])&&f.point(b,c)}function h(a,b){var c=e(a,b);q.point(c[0],c[1])}function i(){s.point=h,q.lineStart()}function j(){s.point=g,q.lineEnd()}function k(a,b){p.push([a,b]);var c=e(a,b);u.point(c[0],c[1])}function l(){u.lineStart(),p=[]}function m(){k(p[0][0],p[0][1]),u.lineEnd();var a,b=u.clean(),c=t.buffer(),d=c.length;if(p.pop(),o.push(p),p=null,d)if(1&b){a=c[0];var e,d=a.length-1,g=-1;if(d>0){for(v||(f.polygonStart(),v=!0),f.lineStart();++g<d;)f.point((e=a[g])[0],e[1]);f.lineEnd()}}else d>1&&2&b&&c.push(c.pop().concat(c.shift())),n.push(c.filter(Cb))}var n,o,p,q=b(f),r=e.invert(d[0],d[1]),s={point:g,lineStart:i,lineEnd:j,polygonStart:function(){s.point=k,s.lineStart=l,s.lineEnd=m,n=[],o=[]},polygonEnd:function(){s.point=g,s.lineStart=i,s.lineEnd=j,n=Sf.merge(n);var a=Fb(r,o);n.length?(v||(f.polygonStart(),v=!0),yb(n,Eb,a,c,f)):a&&(v||(f.polygonStart(),v=!0),f.lineStart(),c(null,null,1,f),f.lineEnd()),v&&(f.polygonEnd(),v=!1),n=o=null},sphere:function(){f.polygonStart(),f.lineStart(),c(null,null,1,f),f.lineEnd(),f.polygonEnd()}},t=Db(),u=b(t),v=!1;return s}}function Cb(a){return a.length>1}function Db(){var a,b=[];return{lineStart:function(){b.push(a=[])},point:function(b,c){a.push([b,c])},lineEnd:p,buffer:function(){var c=b;return b=[],a=null,c},rejoin:function(){b.length>1&&b.push(b.pop().concat(b.shift()))}}}function Eb(a,b){return((a=a.x)[0]<0?a[1]-wg-xg:wg-a[1])-((b=b.x)[0]<0?b[1]-wg-xg:wg-b[1])}function Fb(a,b){var c=a[0],d=a[1],e=[Math.sin(c),-Math.cos(c),0],f=0,g=0;ih.reset();for(var h=0,i=b.length;h<i;++h){var j=b[h],k=j.length;if(k)for(var l=j[0],m=l[0],n=l[1]/2+ug/4,o=Math.sin(n),p=Math.cos(n),q=1;;){q===k&&(q=0),a=j[q];var r=a[0],s=a[1]/2+ug/4,t=Math.sin(s),u=Math.cos(s),v=r-m,w=v>=0?1:-1,x=w*v,y=x>ug,z=o*t;if(ih.add(Math.atan2(z*w*Math.sin(x),p*u+z*Math.cos(x))),f+=y?v+w*vg:v,y^m>=c^r>=c){var A=mb(kb(l),kb(a));pb(A);var B=mb(e,A);pb(B);var C=(y^v>=0?-1:1)*Z(B[2]);(d>C||d===C&&(A[0]||A[1]))&&(g+=y^v>=0?1:-1)}if(!q++)break;m=r,o=t,p=u,l=a}}return(f<-xg||f<xg&&ih<0)^1&g}function Gb(a){var b,c=NaN,d=NaN,e=NaN;return{lineStart:function(){a.lineStart(),b=1},point:function(f,g){var h=f>0?ug:-ug,i=cg(f-c);cg(i-ug)<xg?(a.point(c,d=(d+g)/2>0?wg:-wg),a.point(e,d),a.lineEnd(),a.lineStart(),a.point(h,d),a.point(f,d),b=0):e!==h&&i>=ug&&(cg(c-e)<xg&&(c-=e*xg),cg(f-h)<xg&&(f-=h*xg),d=Hb(c,d,f,g),a.point(e,d),a.lineEnd(),a.lineStart(),a.point(h,d),b=0),a.point(c=f,d=g),e=h},lineEnd:function(){a.lineEnd(),c=d=NaN},clean:function(){return 2-b}}}function Hb(a,b,c,d){var e,f,g=Math.sin(a-c);return cg(g)>xg?Math.atan((Math.sin(b)*(f=Math.cos(d))*Math.sin(c)-Math.sin(d)*(e=Math.cos(b))*Math.sin(a))/(e*f*g)):(b+d)/2}function Ib(a,b,c,d){var e;if(null==a)e=c*wg,d.point(-ug,e),d.point(0,e),d.point(ug,e),d.point(ug,0),d.point(ug,-e),d.point(0,-e),d.point(-ug,-e),d.point(-ug,0),d.point(-ug,e);else if(cg(a[0]-b[0])>xg){var f=a[0]<b[0]?ug:-ug;e=c*f/2,d.point(-f,e),d.point(0,e),d.point(f,e)}else d.point(b[0],b[1])}function Jb(a){function b(a,b){return Math.cos(a)*Math.cos(b)>f}function c(a){var c,f,i,j,k;return{lineStart:function(){j=i=!1,k=1},point:function(l,m){var n,o=[l,m],p=b(l,m),q=g?p?0:e(l,m):p?e(l+(l<0?ug:-ug),m):0;if(!c&&(j=i=p)&&a.lineStart(),p!==i&&(n=d(c,o),(rb(c,n)||rb(o,n))&&(o[0]+=xg,o[1]+=xg,p=b(o[0],o[1]))),p!==i)k=0,p?(a.lineStart(),n=d(o,c),a.point(n[0],n[1])):(n=d(c,o),a.point(n[0],n[1]),a.lineEnd()),c=n;else if(h&&c&&g^p){var r;q&f||!(r=d(o,c,!0))||(k=0,g?(a.lineStart(),a.point(r[0][0],r[0][1]),a.point(r[1][0],r[1][1]),a.lineEnd()):(a.point(r[1][0],r[1][1]),a.lineEnd(),a.lineStart(),a.point(r[0][0],r[0][1])))}!p||c&&rb(c,o)||a.point(o[0],o[1]),c=o,i=p,f=q},lineEnd:function(){i&&a.lineEnd(),c=null},clean:function(){return k|(j&&i)<<1}}}function d(a,b,c){var d=kb(a),e=kb(b),g=[1,0,0],h=mb(d,e),i=lb(h,h),j=h[0],k=i-j*j;if(!k)return!c&&a;var l=f*i/k,m=-f*j/k,n=mb(g,h),o=ob(g,l);nb(o,ob(h,m));var p=n,q=lb(o,p),r=lb(p,p),s=q*q-r*(lb(o,o)-1);if(!(s<0)){var t=Math.sqrt(s),u=ob(p,(-q-t)/r);if(nb(u,o),u=qb(u),!c)return u;var v,w=a[0],x=b[0],y=a[1],z=b[1];x<w&&(v=w,w=x,x=v);var A=x-w,B=cg(A-ug)<xg,C=B||A<xg;if(!B&&z<y&&(v=y,y=z,z=v),C?B?y+z>0^u[1]<(cg(u[0]-w)<xg?y:z):y<=u[1]&&u[1]<=z:A>ug^(w<=u[0]&&u[0]<=x)){var D=ob(p,(-q+t)/r);return nb(D,o),[u,qb(D)]}}}function e(b,c){var d=g?a:ug-a,e=0;return b<-d?e|=1:b>d&&(e|=2),c<-d?e|=4:c>d&&(e|=8),e}var f=Math.cos(a),g=f>0,h=cg(f)>xg;return Bb(b,c,jc(a,6*zg),g?[0,-a]:[-ug,a-ug])}function Kb(a,b,c,d){return function(e){var f,g=e.a,h=e.b,i=g.x,j=g.y,k=h.x,l=h.y,m=0,n=1,o=k-i,p=l-j;if(f=a-i,o||!(f>0)){if(f/=o,o<0){if(f<m)return;f<n&&(n=f)}else if(o>0){if(f>n)return;f>m&&(m=f)}if(f=c-i,o||!(f<0)){if(f/=o,o<0){if(f>n)return;f>m&&(m=f)}else if(o>0){if(f<m)return;f<n&&(n=f)}if(f=b-j,p||!(f>0)){if(f/=p,p<0){if(f<m)return;f<n&&(n=f)}else if(p>0){if(f>n)return;f>m&&(m=f)}if(f=d-j,p||!(f<0)){if(f/=p,p<0){if(f>n)return;f>m&&(m=f)}else if(p>0){if(f<m)return;f<n&&(n=f)}return m>0&&(e.a={x:i+m*o,y:j+m*p}),n<1&&(e.b={x:i+n*o,y:j+n*p}),e}}}}}}function Lb(a,b,c,d){function e(d,e){return cg(d[0]-a)<xg?e>0?0:3:cg(d[0]-c)<xg?e>0?2:1:cg(d[1]-b)<xg?e>0?1:0:e>0?3:2}function f(a,b){return g(a.x,b.x)}function g(a,b){var c=e(a,1),d=e(b,1);return c!==d?c-d:0===c?b[1]-a[1]:1===c?a[0]-b[0]:2===c?a[1]-b[1]:b[0]-a[0]}return function(h){function i(a){for(var b=0,c=q.length,d=a[1],e=0;e<c;++e)for(var f,g=1,h=q[e],i=h.length,j=h[0];g<i;++g)f=h[g],j[1]<=d?f[1]>d&&X(j,f,a)>0&&++b:f[1]<=d&&X(j,f,a)<0&&--b,j=f;return 0!==b}function j(f,h,i,j){var k=0,l=0;if(null==f||(k=e(f,i))!==(l=e(h,i))||g(f,h)<0^i>0)do{j.point(0===k||3===k?a:c,k>1?d:b)}while((k=(k+i+4)%4)!==l);else j.point(h[0],h[1])}function k(e,f){return a<=e&&e<=c&&b<=f&&f<=d}function l(a,b){k(a,b)&&h.point(a,b)}function m(){D.point=o,q&&q.push(r=[]),y=!0,x=!1,v=w=NaN}function n(){p&&(o(s,t),u&&x&&B.rejoin(),p.push(B.buffer())),D.point=l,x&&h.lineEnd()}function o(a,b){a=Math.max(-xh,Math.min(xh,a)),b=Math.max(-xh,Math.min(xh,b));var c=k(a,b);if(q&&r.push([a,b]),y)s=a,t=b,u=c,y=!1,c&&(h.lineStart(),h.point(a,b));else if(c&&x)h.point(a,b);else{var d={a:{x:v,y:w},b:{x:a,y:b}};C(d)?(x||(h.lineStart(),h.point(d.a.x,d.a.y)),h.point(d.b.x,d.b.y),c||h.lineEnd(),z=!1):c&&(h.lineStart(),h.point(a,b),z=!1)}v=a,w=b,x=c}var p,q,r,s,t,u,v,w,x,y,z,A=h,B=Db(),C=Kb(a,b,c,d),D={point:l,lineStart:m,lineEnd:n,polygonStart:function(){h=B,p=[],q=[],z=!0},polygonEnd:function(){h=A,p=Sf.merge(p);var b=i([a,d]),c=z&&b,e=p.length;(c||e)&&(h.polygonStart(),c&&(h.lineStart(),j(null,null,1,h),h.lineEnd()),e&&yb(p,f,b,j,h),h.polygonEnd()),p=q=r=null}};return D}}function Mb(a,b){function c(c,d){return c=a(c,d),b(c[0],c[1])}return a.invert&&b.invert&&(c.invert=function(c,d){return(c=b.invert(c,d))&&a.invert(c[0],c[1])}),c}function Nb(a){var b=0,c=ug/3,d=bc(a),e=d(b,c);return e.parallels=function(a){return arguments.length?d(b=a[0]*ug/180,c=a[1]*ug/180):[b/ug*180,c/ug*180]},e}function Ob(a,b){function c(a,b){var c=Math.sqrt(f-2*e*Math.sin(b))/e;return[c*Math.sin(a*=e),g-c*Math.cos(a)]}var d=Math.sin(a),e=(d+Math.sin(b))/2,f=1+d*(2*e-d),g=Math.sqrt(f)/e;return c.invert=function(a,b){var c=g-b;return[Math.atan2(a,c)/e,Z((f-(a*a+c*c)*e*e)/(2*e))]},c}function Pb(){function a(a,b){zh+=e*a-d*b,d=a,e=b}var b,c,d,e;Eh.point=function(f,g){Eh.point=a,b=d=f,c=e=g},Eh.lineEnd=function(){a(b,c)}}function Qb(a,b){a<Ah&&(Ah=a),a>Ch&&(Ch=a),b<Bh&&(Bh=b),b>Dh&&(Dh=b)}function Rb(){function a(a,b){g.push("M",a,",",b,f)}function b(a,b){g.push("M",a,",",b),h.point=c}function c(a,b){g.push("L",a,",",b)}function d(){h.point=a}function e(){g.push("Z")}var f=Sb(4.5),g=[],h={point:a,lineStart:function(){h.point=b},lineEnd:d,polygonStart:function(){h.lineEnd=e},polygonEnd:function(){h.lineEnd=d,h.point=a},pointRadius:function(a){return f=Sb(a),h},result:function(){if(g.length){var a=g.join("");return g=[],a}}};return h}function Sb(a){return"m0,"+a+"a"+a+","+a+" 0 1,1 0,"+-2*a+"a"+a+","+a+" 0 1,1 0,"+2*a+"z"}function Tb(a,b){mh+=a,nh+=b,++oh}function Ub(){function a(a,d){var e=a-b,f=d-c,g=Math.sqrt(e*e+f*f);ph+=g*(b+a)/2,qh+=g*(c+d)/2,rh+=g,Tb(b=a,c=d)}var b,c;Gh.point=function(d,e){Gh.point=a,Tb(b=d,c=e)}}function Vb(){Gh.point=Tb}function Wb(){function a(a,b){var c=a-d,f=b-e,g=Math.sqrt(c*c+f*f);ph+=g*(d+a)/2,qh+=g*(e+b)/2,rh+=g,g=e*a-d*b,sh+=g*(d+a),th+=g*(e+b),uh+=3*g,Tb(d=a,e=b)}var b,c,d,e;Gh.point=function(f,g){Gh.point=a,Tb(b=d=f,c=e=g)},Gh.lineEnd=function(){a(b,c)}}function Xb(a){function b(b,c){a.moveTo(b,c),a.arc(b,c,g,0,vg)}function c(b,c){a.moveTo(b,c),h.point=d}function d(b,c){a.lineTo(b,c)}function e(){h.point=b}function f(){a.closePath()}var g=4.5,h={point:b,lineStart:function(){h.point=c},lineEnd:e,polygonStart:function(){h.lineEnd=f},polygonEnd:function(){h.lineEnd=e,h.point=b},pointRadius:function(a){return g=a,h},result:p};return h}function Yb(a){function b(a){return(h?d:c)(a)}function c(b){return _b(b,function(c,d){c=a(c,d),b.point(c[0],c[1])})}function d(b){function c(c,d){c=a(c,d),b.point(c[0],c[1])}function d(){t=NaN,y.point=f,b.lineStart()}function f(c,d){var f=kb([c,d]),g=a(c,d);e(t,u,s,v,w,x,t=g[0],u=g[1],s=c,v=f[0],w=f[1],x=f[2],h,b),b.point(t,u)}function g(){y.point=c,b.lineEnd()}function i(){d(),y.point=j,y.lineEnd=k}function j(a,b){f(l=a,m=b),n=t,o=u,p=v,q=w,r=x,y.point=f}function k(){e(t,u,s,v,w,x,n,o,l,p,q,r,h,b),y.lineEnd=g,g()}var l,m,n,o,p,q,r,s,t,u,v,w,x,y={point:c,lineStart:d,lineEnd:g,polygonStart:function(){b.polygonStart(),y.lineStart=i},polygonEnd:function(){b.polygonEnd(),y.lineStart=d}};return y}function e(b,c,d,h,i,j,k,l,m,n,o,p,q,r){var s=k-b,t=l-c,u=s*s+t*t;if(u>4*f&&q--){var v=h+n,w=i+o,x=j+p,y=Math.sqrt(v*v+w*w+x*x),z=Math.asin(x/=y),A=cg(cg(x)-1)<xg||cg(d-m)<xg?(d+m)/2:Math.atan2(w,v),B=a(A,z),C=B[0],D=B[1],E=C-b,F=D-c,G=t*E-s*F;(G*G/u>f||cg((s*E+t*F)/u-.5)>.3||h*n+i*o+j*p<g)&&(e(b,c,d,h,i,j,C,D,A,v/=y,w/=y,x,q,r),r.point(C,D),e(C,D,A,v,w,x,k,l,m,n,o,p,q,r))}}var f=.5,g=Math.cos(30*zg),h=16;return b.precision=function(a){return arguments.length?(h=(f=a*a)>0&&16,b):Math.sqrt(f)},b}function Zb(a){var b=Yb(function(b,c){return a([b*Ag,c*Ag])});return function(a){return cc(b(a))}}function $b(a){this.stream=a}function _b(a,b){return{point:b,sphere:function(){a.sphere()},lineStart:function(){a.lineStart()},lineEnd:function(){a.lineEnd()},polygonStart:function(){a.polygonStart()},polygonEnd:function(){a.polygonEnd()}}}function ac(a){return bc(function(){return a})()}function bc(a){function b(a){return a=h(a[0]*zg,a[1]*zg),[a[0]*m+i,j-a[1]*m]}function c(a){return(a=h.invert((a[0]-i)/m,(j-a[1])/m))&&[a[0]*Ag,a[1]*Ag]}function d(){h=Mb(g=fc(r,s,t),f);var a=f(p,q);return i=n-a[0]*m,j=o+a[1]*m,e()}function e(){return k&&(k.valid=!1,k=null),b}var f,g,h,i,j,k,l=Yb(function(a,b){return a=f(a,b),[a[0]*m+i,j-a[1]*m]}),m=150,n=480,o=250,p=0,q=0,r=0,s=0,t=0,u=wh,v=xa,w=null,x=null;return b.stream=function(a){return k&&(k.valid=!1),k=cc(u(g,l(v(a)))),k.valid=!0,k},b.clipAngle=function(a){return arguments.length?(u=null==a?(w=a,wh):Jb((w=+a)*zg),e()):w},b.clipExtent=function(a){return arguments.length?(x=a,v=a?Lb(a[0][0],a[0][1],a[1][0],a[1][1]):xa,e()):x},b.scale=function(a){return arguments.length?(m=+a,d()):m},b.translate=function(a){return arguments.length?(n=+a[0],o=+a[1],d()):[n,o]},b.center=function(a){return arguments.length?(p=a[0]%360*zg,q=a[1]%360*zg,d()):[p*Ag,q*Ag]},b.rotate=function(a){return arguments.length?(r=a[0]%360*zg,s=a[1]%360*zg,t=a.length>2?a[2]%360*zg:0,d()):[r*Ag,s*Ag,t*Ag]},Sf.rebind(b,l,"precision"),function(){return f=a.apply(this,arguments),b.invert=f.invert&&c,d()}}function cc(a){return _b(a,function(b,c){a.point(b*zg,c*zg)})}function dc(a,b){return[a,b]}function ec(a,b){return[a>ug?a-vg:a<-ug?a+vg:a,b]}function fc(a,b,c){return a?b||c?Mb(hc(a),ic(b,c)):hc(a):b||c?ic(b,c):ec}function gc(a){return function(b,c){return b+=a,[b>ug?b-vg:b<-ug?b+vg:b,c]}}function hc(a){var b=gc(a);return b.invert=gc(-a),b}function ic(a,b){function c(a,b){var c=Math.cos(b),h=Math.cos(a)*c,i=Math.sin(a)*c,j=Math.sin(b),k=j*d+h*e;return[Math.atan2(i*f-k*g,h*d-j*e),Z(k*f+i*g)]}var d=Math.cos(a),e=Math.sin(a),f=Math.cos(b),g=Math.sin(b);return c.invert=function(a,b){var c=Math.cos(b),h=Math.cos(a)*c,i=Math.sin(a)*c,j=Math.sin(b),k=j*f-i*g;return[Math.atan2(i*f+j*g,h*d+k*e),Z(k*d-h*e)]},c}function jc(a,b){var c=Math.cos(a),d=Math.sin(a);return function(e,f,g,h){var i=g*b;null!=e?(e=kc(c,e),f=kc(c,f),(g>0?e<f:e>f)&&(e+=g*vg)):(e=a+g*vg,f=a-.5*i);for(var j,k=e;g>0?k>f:k<f;k-=i)h.point((j=qb([c,-d*Math.cos(k),-d*Math.sin(k)]))[0],j[1])}}function kc(a,b){var c=kb(b);c[0]-=a,pb(c);var d=Y(-c[1]);return((-c[2]<0?-d:d)+2*Math.PI-xg)%(2*Math.PI)}function lc(a,b,c){var d=Sf.range(a,b-xg,c).concat(b);return function(a){return d.map(function(b){return[a,b]})}}function mc(a,b,c){var d=Sf.range(a,b-xg,c).concat(b);return function(a){return d.map(function(b){return[b,a]})}}function nc(a){return a.source}function oc(a){return a.target}function pc(a,b,c,d){var e=Math.cos(b),f=Math.sin(b),g=Math.cos(d),h=Math.sin(d),i=e*Math.cos(a),j=e*Math.sin(a),k=g*Math.cos(c),l=g*Math.sin(c),m=2*Math.asin(Math.sqrt(ba(d-b)+e*g*ba(c-a))),n=1/Math.sin(m),o=m?function(a){var b=Math.sin(a*=m)*n,c=Math.sin(m-a)*n,d=c*i+b*k,e=c*j+b*l,g=c*f+b*h;return[Math.atan2(e,d)*Ag,Math.atan2(g,Math.sqrt(d*d+e*e))*Ag]}:function(){return[a*Ag,b*Ag]};return o.distance=m,o}function qc(){function a(a,e){var f=Math.sin(e*=zg),g=Math.cos(e),h=cg((a*=zg)-b),i=Math.cos(h);Hh+=Math.atan2(Math.sqrt((h=g*Math.sin(h))*h+(h=d*f-c*g*i)*h),c*f+d*g*i),b=a,c=f,d=g}var b,c,d;Ih.point=function(e,f){b=e*zg,c=Math.sin(f*=zg),d=Math.cos(f),Ih.point=a},Ih.lineEnd=function(){Ih.point=Ih.lineEnd=p}}function rc(a,b){function c(b,c){var d=Math.cos(b),e=Math.cos(c),f=a(d*e);return[f*e*Math.sin(b),f*Math.sin(c)]}return c.invert=function(a,c){var d=Math.sqrt(a*a+c*c),e=b(d),f=Math.sin(e),g=Math.cos(e);return[Math.atan2(a*f,d*g),Math.asin(d&&c*f/d)]},c}function sc(a,b){function c(a,b){g>0?b<-wg+xg&&(b=-wg+xg):b>wg-xg&&(b=wg-xg);var c=g/Math.pow(e(b),f);return[c*Math.sin(f*a),g-c*Math.cos(f*a)]}var d=Math.cos(a),e=function(a){return Math.tan(ug/4+a/2)},f=a===b?Math.sin(a):Math.log(d/Math.cos(b))/Math.log(e(b)/e(a)),g=d*Math.pow(e(a),f)/f;return f?(c.invert=function(a,b){var c=g-b,d=W(f)*Math.sqrt(a*a+c*c);return[Math.atan2(a,c)/f,2*Math.atan(Math.pow(g/d,1/f))-wg]},c):uc}function tc(a,b){function c(a,b){var c=f-b;return[c*Math.sin(e*a),f-c*Math.cos(e*a)]}var d=Math.cos(a),e=a===b?Math.sin(a):(d-Math.cos(b))/(b-a),f=d/e+a;return cg(e)<xg?dc:(c.invert=function(a,b){var c=f-b;return[Math.atan2(a,c)/e,f-W(e)*Math.sqrt(a*a+c*c)]},c)}function uc(a,b){return[a,Math.log(Math.tan(ug/4+b/2))]}function vc(a){var b,c=ac(a),d=c.scale,e=c.translate,f=c.clipExtent;return c.scale=function(){var a=d.apply(c,arguments);return a===c?b?c.clipExtent(null):c:a},c.translate=function(){var a=e.apply(c,arguments);return a===c?b?c.clipExtent(null):c:a},c.clipExtent=function(a){var g=f.apply(c,arguments);if(g===c){if(b=null==a){var h=ug*d(),i=e();f([[i[0]-h,i[1]-h],[i[0]+h,i[1]+h]])}}else b&&(g=null);return g},c.clipExtent(null)}function wc(a,b){return[Math.log(Math.tan(ug/4+b/2)),-a]}function xc(a){return a[0]}function yc(a){return a[1]}function zc(a){for(var b=a.length,c=[0,1],d=2,e=2;e<b;e++){for(;d>1&&X(a[c[d-2]],a[c[d-1]],a[e])<=0;)--d;c[d++]=e}return c.slice(0,d)}function Ac(a,b){return a[0]-b[0]||a[1]-b[1]}function Bc(a,b,c){return(c[0]-b[0])*(a[1]-b[1])<(c[1]-b[1])*(a[0]-b[0])}function Cc(a,b,c,d){var e=a[0],f=c[0],g=b[0]-e,h=d[0]-f,i=a[1],j=c[1],k=b[1]-i,l=d[1]-j,m=(h*(i-j)-l*(e-f))/(l*g-h*k);return[e+m*g,i+m*k]}function Dc(a){var b=a[0],c=a[a.length-1];return!(b[0]-c[0]||b[1]-c[1])}function Ec(){Zc(this),this.edge=this.site=this.circle=null}function Fc(a){var b=Uh.pop()||new Ec;return b.site=a,b}function Gc(a){Qc(a),Rh.remove(a),Uh.push(a),Zc(a)}function Hc(a){var b=a.circle,c=b.x,d=b.cy,e={x:c,y:d},f=a.P,g=a.N,h=[a];Gc(a);for(var i=f;i.circle&&cg(c-i.circle.x)<xg&&cg(d-i.circle.cy)<xg;)f=i.P,h.unshift(i),Gc(i),i=f;h.unshift(i),Qc(i);for(var j=g;j.circle&&cg(c-j.circle.x)<xg&&cg(d-j.circle.cy)<xg;)g=j.N,h.push(j),Gc(j),j=g;h.push(j),Qc(j);var k,l=h.length;for(k=1;k<l;++k)j=h[k],i=h[k-1],Wc(j.edge,i.site,j.site,e);i=h[0],j=h[l-1],j.edge=Uc(i.site,j.site,null,e),Pc(i),Pc(j)}function Ic(a){for(var b,c,d,e,f=a.x,g=a.y,h=Rh._;h;)if((d=Jc(h,g)-f)>xg)h=h.L;else{if(!((e=f-Kc(h,g))>xg)){d>-xg?(b=h.P,c=h):e>-xg?(b=h,c=h.N):b=c=h;break}if(!h.R){b=h;break}h=h.R}var i=Fc(a);if(Rh.insert(b,i),b||c){if(b===c)return Qc(b),c=Fc(b.site),Rh.insert(i,c),i.edge=c.edge=Uc(b.site,i.site),Pc(b),void Pc(c);if(!c)return void(i.edge=Uc(b.site,i.site));Qc(b),Qc(c);var j=b.site,k=j.x,l=j.y,m=a.x-k,n=a.y-l,o=c.site,p=o.x-k,q=o.y-l,r=2*(m*q-n*p),s=m*m+n*n,t=p*p+q*q,u={x:(q*s-n*t)/r+k,y:(m*t-p*s)/r+l};Wc(c.edge,j,o,u),i.edge=Uc(j,a,null,u),c.edge=Uc(a,o,null,u),Pc(b),Pc(c)}}
function Jc(a,b){var c=a.site,d=c.x,e=c.y,f=e-b;if(!f)return d;var g=a.P;if(!g)return-1/0;c=g.site;var h=c.x,i=c.y,j=i-b;if(!j)return h;var k=h-d,l=1/f-1/j,m=k/j;return l?(-m+Math.sqrt(m*m-2*l*(k*k/(-2*j)-i+j/2+e-f/2)))/l+d:(d+h)/2}function Kc(a,b){var c=a.N;if(c)return Jc(c,b);var d=a.site;return d.y===b?d.x:1/0}function Lc(a){this.site=a,this.edges=[]}function Mc(a){for(var b,c,d,e,f,g,h,i,j,k,l=a[0][0],m=a[1][0],n=a[0][1],o=a[1][1],p=Qh,q=p.length;q--;)if((f=p[q])&&f.prepare())for(h=f.edges,i=h.length,g=0;g<i;)k=h[g].end(),d=k.x,e=k.y,j=h[++g%i].start(),b=j.x,c=j.y,(cg(d-b)>xg||cg(e-c)>xg)&&(h.splice(g,0,new Xc(Vc(f.site,k,cg(d-l)<xg&&o-e>xg?{x:l,y:cg(b-l)<xg?c:o}:cg(e-o)<xg&&m-d>xg?{x:cg(c-o)<xg?b:m,y:o}:cg(d-m)<xg&&e-n>xg?{x:m,y:cg(b-m)<xg?c:n}:cg(e-n)<xg&&d-l>xg?{x:cg(c-n)<xg?b:l,y:n}:null),f.site,null)),++i)}function Nc(a,b){return b.angle-a.angle}function Oc(){Zc(this),this.x=this.y=this.arc=this.site=this.cy=null}function Pc(a){var b=a.P,c=a.N;if(b&&c){var d=b.site,e=a.site,f=c.site;if(d!==f){var g=e.x,h=e.y,i=d.x-g,j=d.y-h,k=f.x-g,l=f.y-h,m=2*(i*l-j*k);if(!(m>=-yg)){var n=i*i+j*j,o=k*k+l*l,p=(l*n-j*o)/m,q=(i*o-k*n)/m,l=q+h,r=Vh.pop()||new Oc;r.arc=a,r.site=e,r.x=p+g,r.y=l+Math.sqrt(p*p+q*q),r.cy=l,a.circle=r;for(var s=null,t=Th._;t;)if(r.y<t.y||r.y===t.y&&r.x<=t.x){if(!t.L){s=t.P;break}t=t.L}else{if(!t.R){s=t;break}t=t.R}Th.insert(s,r),s||(Sh=r)}}}}function Qc(a){var b=a.circle;b&&(b.P||(Sh=b.N),Th.remove(b),Vh.push(b),Zc(b),a.circle=null)}function Rc(a){for(var b,c=Ph,d=Kb(a[0][0],a[0][1],a[1][0],a[1][1]),e=c.length;e--;)b=c[e],(!Sc(b,a)||!d(b)||cg(b.a.x-b.b.x)<xg&&cg(b.a.y-b.b.y)<xg)&&(b.a=b.b=null,c.splice(e,1))}function Sc(a,b){var c=a.b;if(c)return!0;var d,e,f=a.a,g=b[0][0],h=b[1][0],i=b[0][1],j=b[1][1],k=a.l,l=a.r,m=k.x,n=k.y,o=l.x,p=l.y,q=(m+o)/2,r=(n+p)/2;if(p===n){if(q<g||q>=h)return;if(m>o){if(f){if(f.y>=j)return}else f={x:q,y:i};c={x:q,y:j}}else{if(f){if(f.y<i)return}else f={x:q,y:j};c={x:q,y:i}}}else if(d=(m-o)/(p-n),e=r-d*q,d<-1||d>1)if(m>o){if(f){if(f.y>=j)return}else f={x:(i-e)/d,y:i};c={x:(j-e)/d,y:j}}else{if(f){if(f.y<i)return}else f={x:(j-e)/d,y:j};c={x:(i-e)/d,y:i}}else if(n<p){if(f){if(f.x>=h)return}else f={x:g,y:d*g+e};c={x:h,y:d*h+e}}else{if(f){if(f.x<g)return}else f={x:h,y:d*h+e};c={x:g,y:d*g+e}}return a.a=f,a.b=c,!0}function Tc(a,b){this.l=a,this.r=b,this.a=this.b=null}function Uc(a,b,c,d){var e=new Tc(a,b);return Ph.push(e),c&&Wc(e,a,b,c),d&&Wc(e,b,a,d),Qh[a.i].edges.push(new Xc(e,a,b)),Qh[b.i].edges.push(new Xc(e,b,a)),e}function Vc(a,b,c){var d=new Tc(a,null);return d.a=b,d.b=c,Ph.push(d),d}function Wc(a,b,c,d){a.a||a.b?a.l===c?a.b=d:a.a=d:(a.a=d,a.l=b,a.r=c)}function Xc(a,b,c){var d=a.a,e=a.b;this.edge=a,this.site=b,this.angle=c?Math.atan2(c.y-b.y,c.x-b.x):a.l===b?Math.atan2(e.x-d.x,d.y-e.y):Math.atan2(d.x-e.x,e.y-d.y)}function Yc(){this._=null}function Zc(a){a.U=a.C=a.L=a.R=a.P=a.N=null}function $c(a,b){var c=b,d=b.R,e=c.U;e?e.L===c?e.L=d:e.R=d:a._=d,d.U=e,c.U=d,c.R=d.L,c.R&&(c.R.U=c),d.L=c}function _c(a,b){var c=b,d=b.L,e=c.U;e?e.L===c?e.L=d:e.R=d:a._=d,d.U=e,c.U=d,c.L=d.R,c.L&&(c.L.U=c),d.R=c}function ad(a){for(;a.L;)a=a.L;return a}function bd(a,b){var c,d,e,f=a.sort(cd).pop();for(Ph=[],Qh=new Array(a.length),Rh=new Yc,Th=new Yc;;)if(e=Sh,f&&(!e||f.y<e.y||f.y===e.y&&f.x<e.x))f.x===c&&f.y===d||(Qh[f.i]=new Lc(f),Ic(f),c=f.x,d=f.y),f=a.pop();else{if(!e)break;Hc(e.arc)}b&&(Rc(b),Mc(b));var g={cells:Qh,edges:Ph};return Rh=Th=Ph=Qh=null,g}function cd(a,b){return b.y-a.y||b.x-a.x}function dd(a,b,c){return(a.x-c.x)*(b.y-a.y)-(a.x-b.x)*(c.y-a.y)}function ed(a){return a.x}function fd(a){return a.y}function gd(){return{leaf:!0,nodes:[],point:null,x:null,y:null}}function hd(a,b,c,d,e,f){if(!a(b,c,d,e,f)){var g=.5*(c+e),h=.5*(d+f),i=b.nodes;i[0]&&hd(a,i[0],c,d,g,h),i[1]&&hd(a,i[1],g,d,e,h),i[2]&&hd(a,i[2],c,h,g,f),i[3]&&hd(a,i[3],g,h,e,f)}}function id(a,b){a=Sf.rgb(a),b=Sf.rgb(b);var c=a.r,d=a.g,e=a.b,f=b.r-c,g=b.g-d,h=b.b-e;return function(a){return"#"+qa(Math.round(c+f*a))+qa(Math.round(d+g*a))+qa(Math.round(e+h*a))}}function jd(a,b){var c,d={},e={};for(c in a)c in b?d[c]=md(a[c],b[c]):e[c]=a[c];for(c in b)c in a||(e[c]=b[c]);return function(a){for(c in d)e[c]=d[c](a);return e}}function kd(a,b){return b-=a=+a,function(c){return a+b*c}}function ld(a,b){var c,d,e,f=Xh.lastIndex=Yh.lastIndex=0,g=-1,h=[],i=[];for(a+="",b+="";(c=Xh.exec(a))&&(d=Yh.exec(b));)(e=d.index)>f&&(e=b.substring(f,e),h[g]?h[g]+=e:h[++g]=e),(c=c[0])===(d=d[0])?h[g]?h[g]+=d:h[++g]=d:(h[++g]=null,i.push({i:g,x:kd(c,d)})),f=Yh.lastIndex;return f<b.length&&(e=b.substring(f),h[g]?h[g]+=e:h[++g]=e),h.length<2?i[0]?(b=i[0].x,function(a){return b(a)+""}):function(){return b}:(b=i.length,function(a){for(var c,d=0;d<b;++d)h[(c=i[d]).i]=c.x(a);return h.join("")})}function md(a,b){for(var c,d=Sf.interpolators.length;--d>=0&&!(c=Sf.interpolators[d](a,b)););return c}function nd(a,b){var c,d=[],e=[],f=a.length,g=b.length,h=Math.min(a.length,b.length);for(c=0;c<h;++c)d.push(md(a[c],b[c]));for(;c<f;++c)e[c]=a[c];for(;c<g;++c)e[c]=b[c];return function(a){for(c=0;c<h;++c)e[c]=d[c](a);return e}}function od(a){return function(b){return b<=0?0:b>=1?1:a(b)}}function pd(a){return function(b){return 1-a(1-b)}}function qd(a){return function(b){return.5*(b<.5?a(2*b):2-a(2-2*b))}}function rd(a){return a*a}function sd(a){return a*a*a}function td(a){if(a<=0)return 0;if(a>=1)return 1;var b=a*a,c=b*a;return 4*(a<.5?c:3*(a-b)+c-.75)}function ud(a){return function(b){return Math.pow(b,a)}}function vd(a){return 1-Math.cos(a*wg)}function wd(a){return Math.pow(2,10*(a-1))}function xd(a){return 1-Math.sqrt(1-a*a)}function yd(a,b){var c;return arguments.length<2&&(b=.45),arguments.length?c=b/vg*Math.asin(1/a):(a=1,c=b/4),function(d){return 1+a*Math.pow(2,-10*d)*Math.sin((d-c)*vg/b)}}function zd(a){return a||(a=1.70158),function(b){return b*b*((a+1)*b-a)}}function Ad(a){return a<1/2.75?7.5625*a*a:a<2/2.75?7.5625*(a-=1.5/2.75)*a+.75:a<2.5/2.75?7.5625*(a-=2.25/2.75)*a+.9375:7.5625*(a-=2.625/2.75)*a+.984375}function Bd(a,b){a=Sf.hcl(a),b=Sf.hcl(b);var c=a.h,d=a.c,e=a.l,f=b.h-c,g=b.c-d,h=b.l-e;return isNaN(g)&&(g=0,d=isNaN(d)?b.c:d),isNaN(f)?(f=0,c=isNaN(c)?b.h:c):f>180?f-=360:f<-180&&(f+=360),function(a){return ga(c+f*a,d+g*a,e+h*a)+""}}function Cd(a,b){a=Sf.hsl(a),b=Sf.hsl(b);var c=a.h,d=a.s,e=a.l,f=b.h-c,g=b.s-d,h=b.l-e;return isNaN(g)&&(g=0,d=isNaN(d)?b.s:d),isNaN(f)?(f=0,c=isNaN(c)?b.h:c):f>180?f-=360:f<-180&&(f+=360),function(a){return ea(c+f*a,d+g*a,e+h*a)+""}}function Dd(a,b){a=Sf.lab(a),b=Sf.lab(b);var c=a.l,d=a.a,e=a.b,f=b.l-c,g=b.a-d,h=b.b-e;return function(a){return ia(c+f*a,d+g*a,e+h*a)+""}}function Ed(a,b){return b-=a,function(c){return Math.round(a+b*c)}}function Fd(a){var b=[a.a,a.b],c=[a.c,a.d],d=Hd(b),e=Gd(b,c),f=Hd(Id(c,b,-e))||0;b[0]*c[1]<c[0]*b[1]&&(b[0]*=-1,b[1]*=-1,d*=-1,e*=-1),this.rotate=(d?Math.atan2(b[1],b[0]):Math.atan2(-c[0],c[1]))*Ag,this.translate=[a.e,a.f],this.scale=[d,f],this.skew=f?Math.atan2(e,f)*Ag:0}function Gd(a,b){return a[0]*b[0]+a[1]*b[1]}function Hd(a){var b=Math.sqrt(Gd(a,a));return b&&(a[0]/=b,a[1]/=b),b}function Id(a,b,c){return a[0]+=c*b[0],a[1]+=c*b[1],a}function Jd(a,b){var c,d=[],e=[],f=Sf.transform(a),g=Sf.transform(b),h=f.translate,i=g.translate,j=f.rotate,k=g.rotate,l=f.skew,m=g.skew,n=f.scale,o=g.scale;return h[0]!=i[0]||h[1]!=i[1]?(d.push("translate(",null,",",null,")"),e.push({i:1,x:kd(h[0],i[0])},{i:3,x:kd(h[1],i[1])})):i[0]||i[1]?d.push("translate("+i+")"):d.push(""),j!=k?(j-k>180?k+=360:k-j>180&&(j+=360),e.push({i:d.push(d.pop()+"rotate(",null,")")-2,x:kd(j,k)})):k&&d.push(d.pop()+"rotate("+k+")"),l!=m?e.push({i:d.push(d.pop()+"skewX(",null,")")-2,x:kd(l,m)}):m&&d.push(d.pop()+"skewX("+m+")"),n[0]!=o[0]||n[1]!=o[1]?(c=d.push(d.pop()+"scale(",null,",",null,")"),e.push({i:c-4,x:kd(n[0],o[0])},{i:c-2,x:kd(n[1],o[1])})):1==o[0]&&1==o[1]||d.push(d.pop()+"scale("+o+")"),c=e.length,function(a){for(var b,f=-1;++f<c;)d[(b=e[f]).i]=b.x(a);return d.join("")}}function Kd(a,b){return b=b-(a=+a)?1/(b-a):0,function(c){return(c-a)*b}}function Ld(a,b){return b=b-(a=+a)?1/(b-a):0,function(c){return Math.max(0,Math.min(1,(c-a)*b))}}function Md(a){for(var b=a.source,c=a.target,d=Od(b,c),e=[b];b!==d;)b=b.parent,e.push(b);for(var f=e.length;c!==d;)e.splice(f,0,c),c=c.parent;return e}function Nd(a){for(var b=[],c=a.parent;null!=c;)b.push(a),a=c,c=c.parent;return b.push(a),b}function Od(a,b){if(a===b)return a;for(var c=Nd(a),d=Nd(b),e=c.pop(),f=d.pop(),g=null;e===f;)g=e,e=c.pop(),f=d.pop();return g}function Pd(a){a.fixed|=2}function Qd(a){a.fixed&=-7}function Rd(a){a.fixed|=4,a.px=a.x,a.py=a.y}function Sd(a){a.fixed&=-5}function Td(a,b,c){var d=0,e=0;if(a.charge=0,!a.leaf)for(var f,g=a.nodes,h=g.length,i=-1;++i<h;)null!=(f=g[i])&&(Td(f,b,c),a.charge+=f.charge,d+=f.charge*f.cx,e+=f.charge*f.cy);if(a.point){a.leaf||(a.point.x+=Math.random()-.5,a.point.y+=Math.random()-.5);var j=b*c[a.point.index];a.charge+=a.pointCharge=j,d+=j*a.point.x,e+=j*a.point.y}a.cx=d/a.charge,a.cy=e/a.charge}function Ud(a,b){return Sf.rebind(a,b,"sort","children","value"),a.nodes=a,a.links=$d,a}function Vd(a,b){for(var c=[a];null!=(a=c.pop());)if(b(a),(e=a.children)&&(d=e.length))for(var d,e;--d>=0;)c.push(e[d])}function Wd(a,b){for(var c=[a],d=[];null!=(a=c.pop());)if(d.push(a),(f=a.children)&&(e=f.length))for(var e,f,g=-1;++g<e;)c.push(f[g]);for(;null!=(a=d.pop());)b(a)}function Xd(a){return a.children}function Yd(a){return a.value}function Zd(a,b){return b.value-a.value}function $d(a){return Sf.merge(a.map(function(a){return(a.children||[]).map(function(b){return{source:a,target:b}})}))}function _d(a){return a.x}function ae(a){return a.y}function be(a,b,c){a.y0=b,a.y=c}function ce(a){return Sf.range(a.length)}function de(a){for(var b=-1,c=a[0].length,d=[];++b<c;)d[b]=0;return d}function ee(a){for(var b,c=1,d=0,e=a[0][1],f=a.length;c<f;++c)(b=a[c][1])>e&&(d=c,e=b);return d}function fe(a){return a.reduce(ge,0)}function ge(a,b){return a+b[1]}function he(a,b){return ie(a,Math.ceil(Math.log(b.length)/Math.LN2+1))}function ie(a,b){for(var c=-1,d=+a[0],e=(a[1]-d)/b,f=[];++c<=b;)f[c]=e*c+d;return f}function je(a){return[Sf.min(a),Sf.max(a)]}function ke(a,b){return a.value-b.value}function le(a,b){var c=a._pack_next;a._pack_next=b,b._pack_prev=a,b._pack_next=c,c._pack_prev=b}function me(a,b){a._pack_next=b,b._pack_prev=a}function ne(a,b){var c=b.x-a.x,d=b.y-a.y,e=a.r+b.r;return.999*e*e>c*c+d*d}function oe(a){function b(a){k=Math.min(a.x-a.r,k),l=Math.max(a.x+a.r,l),m=Math.min(a.y-a.r,m),n=Math.max(a.y+a.r,n)}if((c=a.children)&&(j=c.length)){var c,d,e,f,g,h,i,j,k=1/0,l=-1/0,m=1/0,n=-1/0;if(c.forEach(pe),d=c[0],d.x=-d.r,d.y=0,b(d),j>1&&(e=c[1],e.x=e.r,e.y=0,b(e),j>2))for(f=c[2],se(d,e,f),b(f),le(d,f),d._pack_prev=f,le(f,e),e=d._pack_next,g=3;g<j;g++){se(d,e,f=c[g]);var o=0,p=1,q=1;for(h=e._pack_next;h!==e;h=h._pack_next,p++)if(ne(h,f)){o=1;break}if(1==o)for(i=d._pack_prev;i!==h._pack_prev&&!ne(i,f);i=i._pack_prev,q++);o?(p<q||p==q&&e.r<d.r?me(d,e=h):me(d=i,e),g--):(le(d,f),e=f,b(f))}var r=(k+l)/2,s=(m+n)/2,t=0;for(g=0;g<j;g++)f=c[g],f.x-=r,f.y-=s,t=Math.max(t,f.r+Math.sqrt(f.x*f.x+f.y*f.y));a.r=t,c.forEach(qe)}}function pe(a){a._pack_next=a._pack_prev=a}function qe(a){delete a._pack_next,delete a._pack_prev}function re(a,b,c,d){var e=a.children;if(a.x=b+=d*a.x,a.y=c+=d*a.y,a.r*=d,e)for(var f=-1,g=e.length;++f<g;)re(e[f],b,c,d)}function se(a,b,c){var d=a.r+c.r,e=b.x-a.x,f=b.y-a.y;if(d&&(e||f)){var g=b.r+c.r,h=e*e+f*f;g*=g,d*=d;var i=.5+(d-g)/(2*h),j=Math.sqrt(Math.max(0,2*g*(d+h)-(d-=h)*d-g*g))/(2*h);c.x=a.x+i*e+j*f,c.y=a.y+i*f-j*e}else c.x=a.x+d,c.y=a.y}function te(a,b){return a.parent==b.parent?1:2}function ue(a){var b=a.children;return b.length?b[0]:a.t}function ve(a){var b,c=a.children;return(b=c.length)?c[b-1]:a.t}function we(a,b,c){var d=c/(b.i-a.i);b.c-=d,b.s+=c,a.c+=d,b.z+=c,b.m+=c}function xe(a){for(var b,c=0,d=0,e=a.children,f=e.length;--f>=0;)b=e[f],b.z+=c,b.m+=c,c+=b.s+(d+=b.c)}function ye(a,b,c){return a.a.parent===b.parent?a.a:c}function ze(a){return 1+Sf.max(a,function(a){return a.y})}function Ae(a){return a.reduce(function(a,b){return a+b.x},0)/a.length}function Be(a){var b=a.children;return b&&b.length?Be(b[0]):a}function Ce(a){var b,c=a.children;return c&&(b=c.length)?Ce(c[b-1]):a}function De(a){return{x:a.x,y:a.y,dx:a.dx,dy:a.dy}}function Ee(a,b){var c=a.x+b[3],d=a.y+b[0],e=a.dx-b[1]-b[3],f=a.dy-b[0]-b[2];return e<0&&(c+=e/2,e=0),f<0&&(d+=f/2,f=0),{x:c,y:d,dx:e,dy:f}}function Fe(a){var b=a[0],c=a[a.length-1];return b<c?[b,c]:[c,b]}function Ge(a){return a.rangeExtent?a.rangeExtent():Fe(a.range())}function He(a,b,c,d){var e=c(a[0],a[1]),f=d(b[0],b[1]);return function(a){return f(e(a))}}function Ie(a,b){var c,d=0,e=a.length-1,f=a[d],g=a[e];return g<f&&(c=d,d=e,e=c,c=f,f=g,g=c),a[d]=b.floor(f),a[e]=b.ceil(g),a}function Je(a){return a?{floor:function(b){return Math.floor(b/a)*a},ceil:function(b){return Math.ceil(b/a)*a}}:hi}function Ke(a,b,c,d){var e=[],f=[],g=0,h=Math.min(a.length,b.length)-1;for(a[h]<a[0]&&(a=a.slice().reverse(),b=b.slice().reverse());++g<=h;)e.push(c(a[g-1],a[g])),f.push(d(b[g-1],b[g]));return function(b){var c=Sf.bisect(a,b,1,h)-1;return f[c](e[c](b))}}function Le(a,b,c,d){function e(){var e=Math.min(a.length,b.length)>2?Ke:He,i=d?Ld:Kd;return g=e(a,b,i,c),h=e(b,a,i,md),f}function f(a){return g(a)}var g,h;return f.invert=function(a){return h(a)},f.domain=function(b){return arguments.length?(a=b.map(Number),e()):a},f.range=function(a){return arguments.length?(b=a,e()):b},f.rangeRound=function(a){return f.range(a).interpolate(Ed)},f.clamp=function(a){return arguments.length?(d=a,e()):d},f.interpolate=function(a){return arguments.length?(c=a,e()):c},f.ticks=function(b){return Pe(a,b)},f.tickFormat=function(b,c){return Qe(a,b,c)},f.nice=function(b){return Ne(a,b),e()},f.copy=function(){return Le(a,b,c,d)},e()}function Me(a,b){return Sf.rebind(a,b,"range","rangeRound","interpolate","clamp")}function Ne(a,b){return Ie(a,Je(Oe(a,b)[2]))}function Oe(a,b){null==b&&(b=10);var c=Fe(a),d=c[1]-c[0],e=Math.pow(10,Math.floor(Math.log(d/b)/Math.LN10)),f=b/d*e;return f<=.15?e*=10:f<=.35?e*=5:f<=.75&&(e*=2),c[0]=Math.ceil(c[0]/e)*e,c[1]=Math.floor(c[1]/e)*e+.5*e,c[2]=e,c}function Pe(a,b){return Sf.range.apply(Sf,Oe(a,b))}function Qe(a,b,c){var d=Oe(a,b);if(c){var e=Xg.exec(c);if(e.shift(),"s"===e[8]){var f=Sf.formatPrefix(Math.max(cg(d[0]),cg(d[1])));return e[7]||(e[7]="."+Re(f.scale(d[2]))),e[8]="f",c=Sf.format(e.join("")),function(a){return c(f.scale(a))+f.symbol}}e[7]||(e[7]="."+Se(e[8],d)),c=e.join("")}else c=",."+Re(d[2])+"f";return Sf.format(c)}function Re(a){return-Math.floor(Math.log(a)/Math.LN10+.01)}function Se(a,b){var c=Re(b[2]);return a in ii?Math.abs(c-Re(Math.max(cg(b[0]),cg(b[1]))))+ +("e"!==a):c-2*("%"===a)}function Te(a,b,c,d){function e(a){return(c?Math.log(a<0?0:a):-Math.log(a>0?0:-a))/Math.log(b)}function f(a){return c?Math.pow(b,a):-Math.pow(b,-a)}function g(b){return a(e(b))}return g.invert=function(b){return f(a.invert(b))},g.domain=function(b){return arguments.length?(c=b[0]>=0,a.domain((d=b.map(Number)).map(e)),g):d},g.base=function(c){return arguments.length?(b=+c,a.domain(d.map(e)),g):b},g.nice=function(){var b=Ie(d.map(e),c?Math:ki);return a.domain(b),d=b.map(f),g},g.ticks=function(){var a=Fe(d),g=[],h=a[0],i=a[1],j=Math.floor(e(h)),k=Math.ceil(e(i)),l=b%1?2:b;if(isFinite(k-j)){if(c){for(;j<k;j++)for(var m=1;m<l;m++)g.push(f(j)*m);g.push(f(j))}else for(g.push(f(j));j++<k;)for(var m=l-1;m>0;m--)g.push(f(j)*m);for(j=0;g[j]<h;j++);for(k=g.length;g[k-1]>i;k--);g=g.slice(j,k)}return g},g.tickFormat=function(a,b){if(!arguments.length)return ji;arguments.length<2?b=ji:"function"!=typeof b&&(b=Sf.format(b));var d,h=Math.max(.1,a/g.ticks().length),i=c?(d=1e-12,Math.ceil):(d=-1e-12,Math.floor);return function(a){return a/f(i(e(a)+d))<=h?b(a):""}},g.copy=function(){return Te(a.copy(),b,c,d)},Me(g,a)}function Ue(a,b,c){function d(b){return a(e(b))}var e=Ve(b),f=Ve(1/b);return d.invert=function(b){return f(a.invert(b))},d.domain=function(b){return arguments.length?(a.domain((c=b.map(Number)).map(e)),d):c},d.ticks=function(a){return Pe(c,a)},d.tickFormat=function(a,b){return Qe(c,a,b)},d.nice=function(a){return d.domain(Ne(c,a))},d.exponent=function(g){return arguments.length?(e=Ve(b=g),f=Ve(1/b),a.domain(c.map(e)),d):b},d.copy=function(){return Ue(a.copy(),b,c)},Me(d,a)}function Ve(a){return function(b){return b<0?-Math.pow(-b,a):Math.pow(b,a)}}function We(a,b){function c(c){return f[((e.get(c)||("range"===b.t?e.set(c,a.push(c)):NaN))-1)%f.length]}function d(b,c){return Sf.range(a.length).map(function(a){return b+c*a})}var e,f,h;return c.domain=function(d){if(!arguments.length)return a;a=[],e=new g;for(var f,h=-1,i=d.length;++h<i;)e.has(f=d[h])||e.set(f,a.push(f));return c[b.t].apply(c,b.a)},c.range=function(a){return arguments.length?(f=a,h=0,b={t:"range",a:arguments},c):f},c.rangePoints=function(e,g){arguments.length<2&&(g=0);var i=e[0],j=e[1],k=(j-i)/(Math.max(1,a.length-1)+g);return f=d(a.length<2?(i+j)/2:i+k*g/2,k),h=0,b={t:"rangePoints",a:arguments},c},c.rangeBands=function(e,g,i){arguments.length<2&&(g=0),arguments.length<3&&(i=g);var j=e[1]<e[0],k=e[j-0],l=e[1-j],m=(l-k)/(a.length-g+2*i);return f=d(k+m*i,m),j&&f.reverse(),h=m*(1-g),b={t:"rangeBands",a:arguments},c},c.rangeRoundBands=function(e,g,i){arguments.length<2&&(g=0),arguments.length<3&&(i=g);var j=e[1]<e[0],k=e[j-0],l=e[1-j],m=Math.floor((l-k)/(a.length-g+2*i)),n=l-k-(a.length-g)*m;return f=d(k+Math.round(n/2),m),j&&f.reverse(),h=Math.round(m*(1-g)),b={t:"rangeRoundBands",a:arguments},c},c.rangeBand=function(){return h},c.rangeExtent=function(){return Fe(b.a[0])},c.copy=function(){return We(a,b)},c.domain(a)}function Xe(c,d){function e(){var a=0,b=d.length;for(g=[];++a<b;)g[a-1]=Sf.quantile(c,a/b);return f}function f(a){if(!isNaN(a=+a))return d[Sf.bisect(g,a)]}var g;return f.domain=function(d){return arguments.length?(c=d.filter(b).sort(a),e()):c},f.range=function(a){return arguments.length?(d=a,e()):d},f.quantiles=function(){return g},f.invertExtent=function(a){return a=d.indexOf(a),a<0?[NaN,NaN]:[a>0?g[a-1]:c[0],a<g.length?g[a]:c[c.length-1]]},f.copy=function(){return Xe(c,d)},e()}function Ye(a,b,c){function d(b){return c[Math.max(0,Math.min(g,Math.floor(f*(b-a))))]}function e(){return f=c.length/(b-a),g=c.length-1,d}var f,g;return d.domain=function(c){return arguments.length?(a=+c[0],b=+c[c.length-1],e()):[a,b]},d.range=function(a){return arguments.length?(c=a,e()):c},d.invertExtent=function(b){return b=c.indexOf(b),b=b<0?NaN:b/f+a,[b,b+1/f]},d.copy=function(){return Ye(a,b,c)},e()}function Ze(a,b){function c(c){if(c<=c)return b[Sf.bisect(a,c)]}return c.domain=function(b){return arguments.length?(a=b,c):a},c.range=function(a){return arguments.length?(b=a,c):b},c.invertExtent=function(c){return c=b.indexOf(c),[a[c-1],a[c]]},c.copy=function(){return Ze(a,b)},c}function $e(a){function b(a){return+a}return b.invert=b,b.domain=b.range=function(c){return arguments.length?(a=c.map(b),b):a},b.ticks=function(b){return Pe(a,b)},b.tickFormat=function(b,c){return Qe(a,b,c)},b.copy=function(){return $e(a)},b}function _e(a){return a.innerRadius}function af(a){return a.outerRadius}function bf(a){return a.startAngle}function cf(a){return a.endAngle}function df(a){function b(b){function g(){j.push("M",f(a(k),h))}for(var i,j=[],k=[],l=-1,m=b.length,n=wa(c),o=wa(d);++l<m;)e.call(this,i=b[l],l)?k.push([+n.call(this,i,l),+o.call(this,i,l)]):k.length&&(g(),k=[]);return k.length&&g(),j.length?j.join(""):null}var c=xc,d=yc,e=xb,f=ef,g=f.key,h=.7;return b.x=function(a){return arguments.length?(c=a,b):c},b.y=function(a){return arguments.length?(d=a,b):d},b.defined=function(a){return arguments.length?(e=a,b):e},b.interpolate=function(a){return arguments.length?(g="function"==typeof a?f=a:(f=ri.get(a)||ef).key,b):g},b.tension=function(a){return arguments.length?(h=a,b):h},b}function ef(a){return a.join("L")}function ff(a){return ef(a)+"Z"}function gf(a){for(var b=0,c=a.length,d=a[0],e=[d[0],",",d[1]];++b<c;)e.push("H",(d[0]+(d=a[b])[0])/2,"V",d[1]);return c>1&&e.push("H",d[0]),e.join("")}function hf(a){for(var b=0,c=a.length,d=a[0],e=[d[0],",",d[1]];++b<c;)e.push("V",(d=a[b])[1],"H",d[0]);return e.join("")}function jf(a){for(var b=0,c=a.length,d=a[0],e=[d[0],",",d[1]];++b<c;)e.push("H",(d=a[b])[0],"V",d[1]);return e.join("")}function kf(a,b){return a.length<4?ef(a):a[1]+nf(a.slice(1,a.length-1),of(a,b))}function lf(a,b){return a.length<3?ef(a):a[0]+nf((a.push(a[0]),a),of([a[a.length-2]].concat(a,[a[1]]),b))}function mf(a,b){return a.length<3?ef(a):a[0]+nf(a,of(a,b))}function nf(a,b){if(b.length<1||a.length!=b.length&&a.length!=b.length+2)return ef(a);var c=a.length!=b.length,d="",e=a[0],f=a[1],g=b[0],h=g,i=1;if(c&&(d+="Q"+(f[0]-2*g[0]/3)+","+(f[1]-2*g[1]/3)+","+f[0]+","+f[1],e=a[1],i=2),b.length>1){h=b[1],f=a[i],i++,d+="C"+(e[0]+g[0])+","+(e[1]+g[1])+","+(f[0]-h[0])+","+(f[1]-h[1])+","+f[0]+","+f[1];for(var j=2;j<b.length;j++,i++)f=a[i],h=b[j],d+="S"+(f[0]-h[0])+","+(f[1]-h[1])+","+f[0]+","+f[1]}if(c){var k=a[i];d+="Q"+(f[0]+2*h[0]/3)+","+(f[1]+2*h[1]/3)+","+k[0]+","+k[1]}return d}function of(a,b){for(var c,d=[],e=(1-b)/2,f=a[0],g=a[1],h=1,i=a.length;++h<i;)c=f,f=g,g=a[h],d.push([e*(g[0]-c[0]),e*(g[1]-c[1])]);return d}function pf(a){if(a.length<3)return ef(a);var b=1,c=a.length,d=a[0],e=d[0],f=d[1],g=[e,e,e,(d=a[1])[0]],h=[f,f,f,d[1]],i=[e,",",f,"L",tf(ui,g),",",tf(ui,h)];for(a.push(a[c-1]);++b<=c;)d=a[b],g.shift(),g.push(d[0]),h.shift(),h.push(d[1]),uf(i,g,h);return a.pop(),i.push("L",d),i.join("")}function qf(a){if(a.length<4)return ef(a);for(var b,c=[],d=-1,e=a.length,f=[0],g=[0];++d<3;)b=a[d],f.push(b[0]),g.push(b[1]);for(c.push(tf(ui,f)+","+tf(ui,g)),--d;++d<e;)b=a[d],f.shift(),f.push(b[0]),g.shift(),g.push(b[1]),uf(c,f,g);return c.join("")}function rf(a){for(var b,c,d=-1,e=a.length,f=e+4,g=[],h=[];++d<4;)c=a[d%e],g.push(c[0]),h.push(c[1]);for(b=[tf(ui,g),",",tf(ui,h)],--d;++d<f;)c=a[d%e],g.shift(),g.push(c[0]),h.shift(),h.push(c[1]),uf(b,g,h);return b.join("")}function sf(a,b){var c=a.length-1;if(c)for(var d,e,f=a[0][0],g=a[0][1],h=a[c][0]-f,i=a[c][1]-g,j=-1;++j<=c;)d=a[j],e=j/c,d[0]=b*d[0]+(1-b)*(f+e*h),d[1]=b*d[1]+(1-b)*(g+e*i);return pf(a)}function tf(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]}function uf(a,b,c){a.push("C",tf(si,b),",",tf(si,c),",",tf(ti,b),",",tf(ti,c),",",tf(ui,b),",",tf(ui,c))}function vf(a,b){return(b[1]-a[1])/(b[0]-a[0])}function wf(a){for(var b=0,c=a.length-1,d=[],e=a[0],f=a[1],g=d[0]=vf(e,f);++b<c;)d[b]=(g+(g=vf(e=f,f=a[b+1])))/2;return d[b]=g,d}function xf(a){for(var b,c,d,e,f=[],g=wf(a),h=-1,i=a.length-1;++h<i;)b=vf(a[h],a[h+1]),cg(b)<xg?g[h]=g[h+1]=0:(c=g[h]/b,d=g[h+1]/b,(e=c*c+d*d)>9&&(e=3*b/Math.sqrt(e),g[h]=e*c,g[h+1]=e*d));for(h=-1;++h<=i;)e=(a[Math.min(i,h+1)][0]-a[Math.max(0,h-1)][0])/(6*(1+g[h]*g[h])),f.push([e||0,g[h]*e||0]);return f}function yf(a){return a.length<3?ef(a):a[0]+nf(a,xf(a))}function zf(a){for(var b,c,d,e=-1,f=a.length;++e<f;)b=a[e],c=b[0],d=b[1]+pi,b[0]=c*Math.cos(d),b[1]=c*Math.sin(d);return a}function Af(a){function b(b){function i(){p.push("M",h(a(r),l),k,j(a(q.reverse()),l),"Z")}for(var m,n,o,p=[],q=[],r=[],s=-1,t=b.length,u=wa(c),v=wa(e),w=c===d?function(){return n}:wa(d),x=e===f?function(){return o}:wa(f);++s<t;)g.call(this,m=b[s],s)?(q.push([n=+u.call(this,m,s),o=+v.call(this,m,s)]),r.push([+w.call(this,m,s),+x.call(this,m,s)])):q.length&&(i(),q=[],r=[]);return q.length&&i(),p.length?p.join(""):null}var c=xc,d=xc,e=0,f=yc,g=xb,h=ef,i=h.key,j=h,k="L",l=.7;return b.x=function(a){return arguments.length?(c=d=a,b):d},b.x0=function(a){return arguments.length?(c=a,b):c},b.x1=function(a){return arguments.length?(d=a,b):d},b.y=function(a){return arguments.length?(e=f=a,b):f},b.y0=function(a){return arguments.length?(e=a,b):e},b.y1=function(a){return arguments.length?(f=a,b):f},b.defined=function(a){return arguments.length?(g=a,b):g},b.interpolate=function(a){return arguments.length?(i="function"==typeof a?h=a:(h=ri.get(a)||ef).key,j=h.reverse||h,k=h.closed?"M":"L",b):i},b.tension=function(a){return arguments.length?(l=a,b):l},b}function Bf(a){return a.radius}function Cf(a){return[a.x,a.y]}function Df(a){return function(){var b=a.apply(this,arguments),c=b[0],d=b[1]+pi;return[c*Math.cos(d),c*Math.sin(d)]}}function Ef(){return 64}function Ff(){return"circle"}function Gf(a){var b=Math.sqrt(a/ug);return"M0,"+b+"A"+b+","+b+" 0 1,1 0,"+-b+"A"+b+","+b+" 0 1,1 0,"+b+"Z"}function Hf(a,b){return hg(a,Ai),a.id=b,a}function If(a,b,c,d){var e=a.id;return K(a,"function"==typeof c?function(a,f,g){a.__transition__[e].tween.set(b,d(c.call(a,a.__data__,f,g)))}:(c=d(c),function(a){a.__transition__[e].tween.set(b,c)}))}function Jf(a){return null==a&&(a=""),function(){this.textContent=a}}function Kf(a,b,c,d){var e=a.__transition__||(a.__transition__={active:0,count:0}),f=e[c];if(!f){var h=d.time;f=e[c]={tween:new g,time:h,ease:d.ease,delay:d.delay,duration:d.duration},++e.count,Sf.timer(function(d){function g(d){if(e.active>c)return j();e.active=c,f.event&&f.event.start.call(a,k,b),f.tween.forEach(function(c,d){(d=d.call(a,k,b))&&p.push(d)}),Sf.timer(function(){return o.c=i(d||1)?xb:i,1},0,h)}function i(d){if(e.active!==c)return j();for(var g=d/n,h=l(g),i=p.length;i>0;)p[--i].call(a,h);return g>=1?(f.event&&f.event.end.call(a,k,b),j()):void 0}function j(){return--e.count?delete e[c]:delete a.__transition__,1}var k=a.__data__,l=f.ease,m=f.delay,n=f.duration,o=Ug,p=[];if(o.t=m+h,m<=d)return g(d-m);o.c=g},0,h)}}function Lf(a,b){a.attr("transform",function(a){return"translate("+b(a)+",0)"})}function Mf(a,b){a.attr("transform",function(a){return"translate(0,"+b(a)+")"})}function Nf(a){return a.toISOString()}function Of(a,b,c){function d(b){return a(b)}function e(a,c){var d=a[1]-a[0],e=d/c,f=Sf.bisect(Ji,e);return f==Ji.length?[b.year,Oe(a.map(function(a){return a/31536e6}),c)[2]]:f?b[e/Ji[f-1]<Ji[f]/e?f-1:f]:[Mi,Oe(a,c)[2]]}return d.invert=function(b){return Pf(a.invert(b))},d.domain=function(b){return arguments.length?(a.domain(b),d):a.domain().map(Pf)},d.nice=function(a,b){function c(c){return!isNaN(c)&&!a.range(c,Pf(+c+1),b).length}var f=d.domain(),g=Fe(f),h=null==a?e(g,10):"number"==typeof a&&e(g,a);return h&&(a=h[0],b=h[1]),d.domain(Ie(f,b>1?{floor:function(b){for(;c(b=a.floor(b));)b=Pf(b-1);return b},ceil:function(b){for(;c(b=a.ceil(b));)b=Pf(+b+1);return b}}:a))},d.ticks=function(a,b){var c=Fe(d.domain()),f=null==a?e(c,10):"number"==typeof a?e(c,a):!a.range&&[{range:a},b];return f&&(a=f[0],b=f[1]),a.range(c[0],Pf(+c[1]+1),b<1?1:b)},d.tickFormat=function(){return c},d.copy=function(){return Of(a.copy(),b,c)},Me(d,a)}function Pf(a){return new Date(a)}function Qf(a){return JSON.parse(a.responseText)}function Rf(a){var b=Vf.createRange();return b.selectNode(Vf.body),b.createContextualFragment(a.responseText)}var Sf={version:"3.4.11"};Date.now||(Date.now=function(){return+new Date});var Tf=[].slice,Uf=function(a){return Tf.call(a)},Vf=document,Wf=Vf.documentElement,Xf=window;try{Uf(Wf.childNodes)[0].nodeType}catch(a){Uf=function(a){for(var b=a.length,c=new Array(b);b--;)c[b]=a[b];return c}}try{Vf.createElement("div").style.setProperty("opacity",0,"")}catch(a){var Yf=Xf.Element.prototype,Zf=Yf.setAttribute,$f=Yf.setAttributeNS,_f=Xf.CSSStyleDeclaration.prototype,ag=_f.setProperty;Yf.setAttribute=function(a,b){Zf.call(this,a,b+"")},Yf.setAttributeNS=function(a,b,c){$f.call(this,a,b,c+"")},_f.setProperty=function(a,b,c){ag.call(this,a,b+"",c)}}Sf.ascending=a,Sf.descending=function(a,b){return b<a?-1:b>a?1:b>=a?0:NaN},Sf.min=function(a,b){var c,d,e=-1,f=a.length;if(1===arguments.length){for(;++e<f&&!(null!=(c=a[e])&&c<=c);)c=void 0;for(;++e<f;)null!=(d=a[e])&&c>d&&(c=d)}else{for(;++e<f&&!(null!=(c=b.call(a,a[e],e))&&c<=c);)c=void 0;for(;++e<f;)null!=(d=b.call(a,a[e],e))&&c>d&&(c=d)}return c},Sf.max=function(a,b){var c,d,e=-1,f=a.length;if(1===arguments.length){for(;++e<f&&!(null!=(c=a[e])&&c<=c);)c=void 0;for(;++e<f;)null!=(d=a[e])&&d>c&&(c=d)}else{for(;++e<f&&!(null!=(c=b.call(a,a[e],e))&&c<=c);)c=void 0;for(;++e<f;)null!=(d=b.call(a,a[e],e))&&d>c&&(c=d)}return c},Sf.extent=function(a,b){var c,d,e,f=-1,g=a.length;if(1===arguments.length){for(;++f<g&&!(null!=(c=e=a[f])&&c<=c);)c=e=void 0;for(;++f<g;)null!=(d=a[f])&&(c>d&&(c=d),e<d&&(e=d))}else{for(;++f<g&&!(null!=(c=e=b.call(a,a[f],f))&&c<=c);)c=void 0;for(;++f<g;)null!=(d=b.call(a,a[f],f))&&(c>d&&(c=d),e<d&&(e=d))}return[c,e]},Sf.sum=function(a,b){var c,d=0,e=a.length,f=-1;if(1===arguments.length)for(;++f<e;)isNaN(c=+a[f])||(d+=c);else for(;++f<e;)isNaN(c=+b.call(a,a[f],f))||(d+=c);return d},Sf.mean=function(a,c){var d,e=0,f=a.length,g=-1,h=f;if(1===arguments.length)for(;++g<f;)b(d=a[g])?e+=d:--h;else for(;++g<f;)b(d=c.call(a,a[g],g))?e+=d:--h;return h?e/h:void 0},Sf.quantile=function(a,b){var c=(a.length-1)*b+1,d=Math.floor(c),e=+a[d-1],f=c-d;return f?e+f*(a[d]-e):e},Sf.median=function(c,d){return arguments.length>1&&(c=c.map(d)),c=c.filter(b),c.length?Sf.quantile(c.sort(a),.5):void 0};var bg=c(a);Sf.bisectLeft=bg.left,Sf.bisect=Sf.bisectRight=bg.right,Sf.bisector=function(b){return c(1===b.length?function(c,d){return a(b(c),d)}:b)},Sf.shuffle=function(a){for(var b,c,d=a.length;d;)c=Math.random()*d--|0,b=a[d],a[d]=a[c],a[c]=b;return a},Sf.permute=function(a,b){for(var c=b.length,d=new Array(c);c--;)d[c]=a[b[c]];return d},Sf.pairs=function(a){for(var b=0,c=a.length-1,d=a[0],e=new Array(c<0?0:c);b<c;)e[b]=[d,d=a[++b]];return e},Sf.zip=function(){if(!(e=arguments.length))return[];for(var a=-1,b=Sf.min(arguments,d),c=new Array(b);++a<b;)for(var e,f=-1,g=c[a]=new Array(e);++f<e;)g[f]=arguments[f][a];return c},Sf.transpose=function(a){return Sf.zip.apply(Sf,a)},Sf.keys=function(a){var b=[];for(var c in a)b.push(c);return b},Sf.values=function(a){var b=[];for(var c in a)b.push(a[c]);return b},Sf.entries=function(a){var b=[];for(var c in a)b.push({key:c,value:a[c]});return b},Sf.merge=function(a){for(var b,c,d,e=a.length,f=-1,g=0;++f<e;)g+=a[f].length;for(c=new Array(g);--e>=0;)for(d=a[e],b=d.length;--b>=0;)c[--g]=d[b];return c};var cg=Math.abs;Sf.range=function(a,b,c){if(arguments.length<3&&(c=1,arguments.length<2&&(b=a,a=0)),(b-a)/c==1/0)throw new Error("infinite range");var d,f=[],g=e(cg(c)),h=-1;if(a*=g,b*=g,c*=g,c<0)for(;(d=a+c*++h)>b;)f.push(d/g);else for(;(d=a+c*++h)<b;)f.push(d/g);return f},Sf.map=function(a){var b=new g;if(a instanceof g)a.forEach(function(a,c){b.set(a,c)});else for(var c in a)b.set(c,a[c]);return b},f(g,{has:h,get:function(a){return this[dg+a]},set:function(a,b){return this[dg+a]=b},remove:i,keys:j,values:function(){var a=[];return this.forEach(function(b,c){a.push(c)}),a},entries:function(){var a=[];return this.forEach(function(b,c){a.push({key:b,value:c})}),a},size:k,empty:l,forEach:function(a){for(var b in this)b.charCodeAt(0)===eg&&a.call(this,b.substring(1),this[b])}});var dg="\0",eg=dg.charCodeAt(0);Sf.nest=function(){function a(b,h,i){if(i>=f.length)return d?d.call(e,h):c?h.sort(c):h;for(var j,k,l,m,n=-1,o=h.length,p=f[i++],q=new g;++n<o;)(m=q.get(j=p(k=h[n])))?m.push(k):q.set(j,[k]);return b?(k=b(),l=function(c,d){k.set(c,a(b,d,i))}):(k={},l=function(c,d){k[c]=a(b,d,i)}),q.forEach(l),k}function b(a,c){if(c>=f.length)return a;var d=[],e=h[c++];return a.forEach(function(a,e){d.push({key:a,values:b(e,c)})}),e?d.sort(function(a,b){return e(a.key,b.key)}):d}var c,d,e={},f=[],h=[];return e.map=function(b,c){return a(c,b,0)},e.entries=function(c){return b(a(Sf.map,c,0),0)},e.key=function(a){return f.push(a),e},e.sortKeys=function(a){return h[f.length-1]=a,e},e.sortValues=function(a){return c=a,e},e.rollup=function(a){return d=a,e},e},Sf.set=function(a){var b=new m;if(a)for(var c=0,d=a.length;c<d;++c)b.add(a[c]);return b},f(m,{has:h,add:function(a){return this[dg+a]=!0,a},remove:function(a){return(a=dg+a)in this&&delete this[a]},values:j,size:k,empty:l,forEach:function(a){for(var b in this)b.charCodeAt(0)===eg&&a.call(this,b.substring(1))}}),Sf.behavior={},Sf.rebind=function(a,b){for(var c,d=1,e=arguments.length;++d<e;)a[c=arguments[d]]=n(a,b,b[c]);return a};var fg=["webkit","ms","moz","Moz","o","O"];Sf.dispatch=function(){
for(var a=new q,b=-1,c=arguments.length;++b<c;)a[arguments[b]]=r(a);return a},q.prototype.on=function(a,b){var c=a.indexOf("."),d="";if(c>=0&&(d=a.substring(c+1),a=a.substring(0,c)),a)return arguments.length<2?this[a].on(d):this[a].on(d,b);if(2===arguments.length){if(null==b)for(a in this)this.hasOwnProperty(a)&&this[a].on(d,null);return this}},Sf.event=null,Sf.requote=function(a){return a.replace(gg,"\\$&")};var gg=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,hg={}.__proto__?function(a,b){a.__proto__=b}:function(a,b){for(var c in b)a[c]=b[c]},ig=function(a,b){return b.querySelector(a)},jg=function(a,b){return b.querySelectorAll(a)},kg=Wf.matches||Wf[o(Wf,"matchesSelector")],lg=function(a,b){return kg.call(a,b)};"function"==typeof Sizzle&&(ig=function(a,b){return Sizzle(a,b)[0]||null},jg=Sizzle,lg=Sizzle.matchesSelector),Sf.selection=function(){return pg};var mg=Sf.selection.prototype=[];mg.select=function(a){var b,c,d,e,f=[];a=w(a);for(var g=-1,h=this.length;++g<h;){f.push(b=[]),b.parentNode=(d=this[g]).parentNode;for(var i=-1,j=d.length;++i<j;)(e=d[i])?(b.push(c=a.call(e,e.__data__,i,g)),c&&"__data__"in e&&(c.__data__=e.__data__)):b.push(null)}return v(f)},mg.selectAll=function(a){var b,c,d=[];a=x(a);for(var e=-1,f=this.length;++e<f;)for(var g=this[e],h=-1,i=g.length;++h<i;)(c=g[h])&&(d.push(b=Uf(a.call(c,c.__data__,h,e))),b.parentNode=c);return v(d)};var ng={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};Sf.ns={prefix:ng,qualify:function(a){var b=a.indexOf(":"),c=a;return b>=0&&(c=a.substring(0,b),a=a.substring(b+1)),ng.hasOwnProperty(c)?{space:ng[c],local:a}:a}},mg.attr=function(a,b){if(arguments.length<2){if("string"==typeof a){var c=this.node();return a=Sf.ns.qualify(a),a.local?c.getAttributeNS(a.space,a.local):c.getAttribute(a)}for(b in a)this.each(y(b,a[b]));return this}return this.each(y(a,b))},mg.classed=function(a,b){if(arguments.length<2){if("string"==typeof a){var c=this.node(),d=(a=B(a)).length,e=-1;if(b=c.classList){for(;++e<d;)if(!b.contains(a[e]))return!1}else for(b=c.getAttribute("class");++e<d;)if(!A(a[e]).test(b))return!1;return!0}for(b in a)this.each(C(b,a[b]));return this}return this.each(C(a,b))},mg.style=function(a,b,c){var d=arguments.length;if(d<3){if("string"!=typeof a){d<2&&(b="");for(c in a)this.each(E(c,a[c],b));return this}if(d<2)return Xf.getComputedStyle(this.node(),null).getPropertyValue(a);c=""}return this.each(E(a,b,c))},mg.property=function(a,b){if(arguments.length<2){if("string"==typeof a)return this.node()[a];for(b in a)this.each(F(b,a[b]));return this}return this.each(F(a,b))},mg.text=function(a){return arguments.length?this.each("function"==typeof a?function(){var b=a.apply(this,arguments);this.textContent=null==b?"":b}:null==a?function(){this.textContent=""}:function(){this.textContent=a}):this.node().textContent},mg.html=function(a){return arguments.length?this.each("function"==typeof a?function(){var b=a.apply(this,arguments);this.innerHTML=null==b?"":b}:null==a?function(){this.innerHTML=""}:function(){this.innerHTML=a}):this.node().innerHTML},mg.append=function(a){return a=G(a),this.select(function(){return this.appendChild(a.apply(this,arguments))})},mg.insert=function(a,b){return a=G(a),b=w(b),this.select(function(){return this.insertBefore(a.apply(this,arguments),b.apply(this,arguments)||null)})},mg.remove=function(){return this.each(function(){var a=this.parentNode;a&&a.removeChild(this)})},mg.data=function(a,b){function c(a,c){var d,e,f,h=a.length,l=c.length,m=Math.min(h,l),n=new Array(l),o=new Array(l),p=new Array(h);if(b){var q,r=new g,s=new g,t=[];for(d=-1;++d<h;)q=b.call(e=a[d],e.__data__,d),r.has(q)?p[d]=e:r.set(q,e),t.push(q);for(d=-1;++d<l;)q=b.call(c,f=c[d],d),(e=r.get(q))?(n[d]=e,e.__data__=f):s.has(q)||(o[d]=H(f)),s.set(q,f),r.remove(q);for(d=-1;++d<h;)r.has(t[d])&&(p[d]=a[d])}else{for(d=-1;++d<m;)e=a[d],f=c[d],e?(e.__data__=f,n[d]=e):o[d]=H(f);for(;d<l;++d)o[d]=H(c[d]);for(;d<h;++d)p[d]=a[d]}o.update=n,o.parentNode=n.parentNode=p.parentNode=a.parentNode,i.push(o),j.push(n),k.push(p)}var d,e,f=-1,h=this.length;if(!arguments.length){for(a=new Array(h=(d=this[0]).length);++f<h;)(e=d[f])&&(a[f]=e.__data__);return a}var i=L([]),j=v([]),k=v([]);if("function"==typeof a)for(;++f<h;)c(d=this[f],a.call(d,d.parentNode.__data__,f));else for(;++f<h;)c(d=this[f],a);return j.enter=function(){return i},j.exit=function(){return k},j},mg.datum=function(a){return arguments.length?this.property("__data__",a):this.property("__data__")},mg.filter=function(a){var b,c,d,e=[];"function"!=typeof a&&(a=I(a));for(var f=0,g=this.length;f<g;f++){e.push(b=[]),b.parentNode=(c=this[f]).parentNode;for(var h=0,i=c.length;h<i;h++)(d=c[h])&&a.call(d,d.__data__,h,f)&&b.push(d)}return v(e)},mg.order=function(){for(var a=-1,b=this.length;++a<b;)for(var c,d=this[a],e=d.length-1,f=d[e];--e>=0;)(c=d[e])&&(f&&f!==c.nextSibling&&f.parentNode.insertBefore(c,f),f=c);return this},mg.sort=function(a){a=J.apply(this,arguments);for(var b=-1,c=this.length;++b<c;)this[b].sort(a);return this.order()},mg.each=function(a){return K(this,function(b,c,d){a.call(b,b.__data__,c,d)})},mg.call=function(a){var b=Uf(arguments);return a.apply(b[0]=this,b),this},mg.empty=function(){return!this.node()},mg.node=function(){for(var a=0,b=this.length;a<b;a++)for(var c=this[a],d=0,e=c.length;d<e;d++){var f=c[d];if(f)return f}return null},mg.size=function(){var a=0;return this.each(function(){++a}),a};var og=[];Sf.selection.enter=L,Sf.selection.enter.prototype=og,og.append=mg.append,og.empty=mg.empty,og.node=mg.node,og.call=mg.call,og.size=mg.size,og.select=function(a){for(var b,c,d,e,f,g=[],h=-1,i=this.length;++h<i;){d=(e=this[h]).update,g.push(b=[]),b.parentNode=e.parentNode;for(var j=-1,k=e.length;++j<k;)(f=e[j])?(b.push(d[j]=c=a.call(e.parentNode,f.__data__,j,h)),c.__data__=f.__data__):b.push(null)}return v(g)},og.insert=function(a,b){return arguments.length<2&&(b=M(this)),mg.insert.call(this,a,b)},mg.transition=function(){for(var a,b,c=wi||++Bi,d=[],e=xi||{time:Date.now(),ease:td,delay:0,duration:250},f=-1,g=this.length;++f<g;){d.push(a=[]);for(var h=this[f],i=-1,j=h.length;++i<j;)(b=h[i])&&Kf(b,i,c,e),a.push(b)}return Hf(d,c)},mg.interrupt=function(){return this.each(N)},Sf.select=function(a){var b=["string"==typeof a?ig(a,Vf):a];return b.parentNode=Wf,v([b])},Sf.selectAll=function(a){var b=Uf("string"==typeof a?jg(a,Vf):a);return b.parentNode=Wf,v([b])};var pg=Sf.select(Wf);mg.on=function(a,b,c){var d=arguments.length;if(d<3){if("string"!=typeof a){d<2&&(b=!1);for(c in a)this.each(O(c,a[c],b));return this}if(d<2)return(d=this.node()["__on"+a])&&d._;c=!1}return this.each(O(a,b,c))};var qg=Sf.map({mouseenter:"mouseover",mouseleave:"mouseout"});qg.forEach(function(a){"on"+a in Vf&&qg.remove(a)});var rg="onselectstart"in Vf?null:o(Wf.style,"userSelect"),sg=0;Sf.mouse=function(a){return S(a,t())};var tg=/WebKit/.test(Xf.navigator.userAgent)?-1:0;Sf.touches=function(a,b){return arguments.length<2&&(b=t().touches),b?Uf(b).map(function(b){var c=S(a,b);return c.identifier=b.identifier,c}):[]},Sf.behavior.drag=function(){function a(){this.on("mousedown.drag",e).on("touchstart.drag",f)}function b(a,b,e,f,g){return function(){function h(){var a,c,d=b(m,p);d&&(a=d[0]-t[0],c=d[1]-t[1],o|=a|c,t=d,n({type:"drag",x:d[0]+j[0],y:d[1]+j[1],dx:a,dy:c}))}function i(){b(m,p)&&(r.on(f+q,null).on(g+q,null),s(o&&Sf.event.target===l),n({type:"dragend"}))}var j,k=this,l=Sf.event.target,m=k.parentNode,n=c.of(k,arguments),o=0,p=a(),q=".drag"+(null==p?"":"-"+p),r=Sf.select(e()).on(f+q,h).on(g+q,i),s=R(),t=b(m,p);d?(j=d.apply(k,arguments),j=[j.x-t[0],j.y-t[1]]):j=[0,0],n({type:"dragstart"})}}var c=u(a,"drag","dragstart","dragend"),d=null,e=b(p,Sf.mouse,V,"mousemove","mouseup"),f=b(T,Sf.touch,U,"touchmove","touchend");return a.origin=function(b){return arguments.length?(d=b,a):d},Sf.rebind(a,c,"on")};var ug=Math.PI,vg=2*ug,wg=ug/2,xg=1e-6,yg=xg*xg,zg=ug/180,Ag=180/ug,Bg=Math.SQRT2,Cg=2,Dg=4;Sf.interpolateZoom=function(a,b){function c(a){var b=a*s;if(r){var c=_(p),g=f/(Cg*m)*(c*aa(Bg*b+p)-$(p));return[d+g*j,e+g*k,f*c/_(Bg*b+p)]}return[d+a*j,e+a*k,f*Math.exp(Bg*b)]}var d=a[0],e=a[1],f=a[2],g=b[0],h=b[1],i=b[2],j=g-d,k=h-e,l=j*j+k*k,m=Math.sqrt(l),n=(i*i-f*f+Dg*l)/(2*f*Cg*m),o=(i*i-f*f-Dg*l)/(2*i*Cg*m),p=Math.log(Math.sqrt(n*n+1)-n),q=Math.log(Math.sqrt(o*o+1)-o),r=q-p,s=(r||Math.log(i/f))/Bg;return c.duration=1e3*s,c},Sf.behavior.zoom=function(){function a(a){a.on(B,j).on(Gg+".zoom",l).on("dblclick.zoom",m).on(E,k)}function b(a){return[(a[0]-y.x)/y.k,(a[1]-y.y)/y.k]}function c(a){return[a[0]*y.k+y.x,a[1]*y.k+y.y]}function d(a){y.k=Math.max(A[0],Math.min(A[1],a))}function e(a,b){b=c(b),y.x+=a[0]-b[0],y.y+=a[1]-b[1]}function f(){v&&v.domain(t.range().map(function(a){return(a-y.x)/y.k}).map(t.invert)),x&&x.domain(w.range().map(function(a){return(a-y.y)/y.k}).map(w.invert))}function g(a){a({type:"zoomstart"})}function h(a){f(),a({type:"zoom",scale:y.k,translate:[y.x,y.y]})}function i(a){a({type:"zoomend"})}function j(){function a(){k=1,e(Sf.mouse(d),m),h(j)}function c(){l.on(C,null).on(D,null),n(k&&Sf.event.target===f),i(j)}var d=this,f=Sf.event.target,j=F.of(d,arguments),k=0,l=Sf.select(Xf).on(C,a).on(D,c),m=b(Sf.mouse(d)),n=R();N.call(d),g(j)}function k(){function a(){var a=Sf.touches(n);return m=y.k,a.forEach(function(a){a.identifier in p&&(p[a.identifier]=b(a))}),a}function c(){var b=Sf.event.target;Sf.select(b).on(u,f).on(v,l),w.push(b);for(var c=Sf.event.changedTouches,g=0,i=c.length;g<i;++g)p[c[g].identifier]=null;var j=a(),k=Date.now();if(1===j.length){if(k-r<500){var m=j[0],n=p[m.identifier];d(2*y.k),e(m,n),s(),h(o)}r=k}else if(j.length>1){var m=j[0],t=j[1],x=m[0]-t[0],z=m[1]-t[1];q=x*x+z*z}}function f(){for(var a,b,c,f,g=Sf.touches(n),i=0,j=g.length;i<j;++i,f=null)if(c=g[i],f=p[c.identifier]){if(b)break;a=c,b=f}if(f){var k=(k=c[0]-a[0])*k+(k=c[1]-a[1])*k,l=q&&Math.sqrt(k/q);a=[(a[0]+c[0])/2,(a[1]+c[1])/2],b=[(b[0]+f[0])/2,(b[1]+f[1])/2],d(l*m)}r=null,e(a,b),h(o)}function l(){if(Sf.event.touches.length){for(var b=Sf.event.changedTouches,c=0,d=b.length;c<d;++c)delete p[b[c].identifier];for(var e in p)return void a()}Sf.selectAll(w).on(t,null),x.on(B,j).on(E,k),z(),i(o)}var m,n=this,o=F.of(n,arguments),p={},q=0,t=".zoom-"+Sf.event.changedTouches[0].identifier,u="touchmove"+t,v="touchend"+t,w=[],x=Sf.select(n).on(B,null).on(E,c),z=R();N.call(n),c(),g(o)}function l(){var a=F.of(this,arguments);q?clearTimeout(q):(n=b(o=p||Sf.mouse(this)),N.call(this),g(a)),q=setTimeout(function(){q=null,i(a)},50),s(),d(Math.pow(2,.002*Eg())*y.k),e(o,n),h(a)}function m(){var a=F.of(this,arguments),c=Sf.mouse(this),f=b(c),j=Math.log(y.k)/Math.LN2;g(a),d(Math.pow(2,Sf.event.shiftKey?Math.ceil(j)-1:Math.floor(j)+1)),e(c,f),h(a),i(a)}var n,o,p,q,r,t,v,w,x,y={x:0,y:0,k:1},z=[960,500],A=Fg,B="mousedown.zoom",C="mousemove.zoom",D="mouseup.zoom",E="touchstart.zoom",F=u(a,"zoomstart","zoom","zoomend");return a.event=function(a){a.each(function(){var a=F.of(this,arguments),b=y;wi?Sf.select(this).transition().each("start.zoom",function(){y=this.__chart__||{x:0,y:0,k:1},g(a)}).tween("zoom:zoom",function(){var c=z[0],d=z[1],e=c/2,f=d/2,g=Sf.interpolateZoom([(e-y.x)/y.k,(f-y.y)/y.k,c/y.k],[(e-b.x)/b.k,(f-b.y)/b.k,c/b.k]);return function(b){var d=g(b),i=c/d[2];this.__chart__=y={x:e-d[0]*i,y:f-d[1]*i,k:i},h(a)}}).each("end.zoom",function(){i(a)}):(this.__chart__=y,g(a),h(a),i(a))})},a.translate=function(b){return arguments.length?(y={x:+b[0],y:+b[1],k:y.k},f(),a):[y.x,y.y]},a.scale=function(b){return arguments.length?(y={x:y.x,y:y.y,k:+b},f(),a):y.k},a.scaleExtent=function(b){return arguments.length?(A=null==b?Fg:[+b[0],+b[1]],a):A},a.center=function(b){return arguments.length?(p=b&&[+b[0],+b[1]],a):p},a.size=function(b){return arguments.length?(z=b&&[+b[0],+b[1]],a):z},a.x=function(b){return arguments.length?(v=b,t=b.copy(),y={x:0,y:0,k:1},a):v},a.y=function(b){return arguments.length?(x=b,w=b.copy(),y={x:0,y:0,k:1},a):x},Sf.rebind(a,F,"on")};var Eg,Fg=[0,1/0],Gg="onwheel"in Vf?(Eg=function(){return-Sf.event.deltaY*(Sf.event.deltaMode?120:1)},"wheel"):"onmousewheel"in Vf?(Eg=function(){return Sf.event.wheelDelta},"mousewheel"):(Eg=function(){return-Sf.event.detail},"MozMousePixelScroll");Sf.color=ca,ca.prototype.toString=function(){return this.rgb()+""},Sf.hsl=da;var Hg=da.prototype=new ca;Hg.brighter=function(a){return a=Math.pow(.7,arguments.length?a:1),new da(this.h,this.s,this.l/a)},Hg.darker=function(a){return a=Math.pow(.7,arguments.length?a:1),new da(this.h,this.s,a*this.l)},Hg.rgb=function(){return ea(this.h,this.s,this.l)},Sf.hcl=fa;var Ig=fa.prototype=new ca;Ig.brighter=function(a){return new fa(this.h,this.c,Math.min(100,this.l+Jg*(arguments.length?a:1)))},Ig.darker=function(a){return new fa(this.h,this.c,Math.max(0,this.l-Jg*(arguments.length?a:1)))},Ig.rgb=function(){return ga(this.h,this.c,this.l).rgb()},Sf.lab=ha;var Jg=18,Kg=.95047,Lg=1,Mg=1.08883,Ng=ha.prototype=new ca;Ng.brighter=function(a){return new ha(Math.min(100,this.l+Jg*(arguments.length?a:1)),this.a,this.b)},Ng.darker=function(a){return new ha(Math.max(0,this.l-Jg*(arguments.length?a:1)),this.a,this.b)},Ng.rgb=function(){return ia(this.l,this.a,this.b)},Sf.rgb=na;var Og=na.prototype=new ca;Og.brighter=function(a){a=Math.pow(.7,arguments.length?a:1);var b=this.r,c=this.g,d=this.b,e=30;return b||c||d?(b&&b<e&&(b=e),c&&c<e&&(c=e),d&&d<e&&(d=e),new na(Math.min(255,b/a),Math.min(255,c/a),Math.min(255,d/a))):new na(e,e,e)},Og.darker=function(a){return a=Math.pow(.7,arguments.length?a:1),new na(a*this.r,a*this.g,a*this.b)},Og.hsl=function(){return sa(this.r,this.g,this.b)},Og.toString=function(){return"#"+qa(this.r)+qa(this.g)+qa(this.b)};var Pg=Sf.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});Pg.forEach(function(a,b){Pg.set(a,oa(b))}),Sf.functor=wa,Sf.xhr=ya(xa),Sf.dsv=function(a,b){function c(a,c,f){arguments.length<3&&(f=c,c=null);var g=za(a,b,null==c?d:e(c),f);return g.row=function(a){return arguments.length?g.response(null==(c=a)?d:e(a)):c},g}function d(a){return c.parse(a.responseText)}function e(a){return function(b){return c.parse(b.responseText,a)}}function f(b){return b.map(g).join(a)}function g(a){return h.test(a)?'"'+a.replace(/\"/g,'""')+'"':a}var h=new RegExp('["'+a+"\n]"),i=a.charCodeAt(0);return c.parse=function(a,b){var d;return c.parseRows(a,function(a,c){if(d)return d(a,c-1);var e=new Function("d","return {"+a.map(function(a,b){return JSON.stringify(a)+": d["+b+"]"}).join(",")+"}");d=b?function(a,c){return b(e(a),c)}:e})},c.parseRows=function(a,b){function c(){if(k>=j)return g;if(e)return e=!1,f;var b=k;if(34===a.charCodeAt(b)){for(var c=b;c++<j;)if(34===a.charCodeAt(c)){if(34!==a.charCodeAt(c+1))break;++c}k=c+2;var d=a.charCodeAt(c+1);return 13===d?(e=!0,10===a.charCodeAt(c+2)&&++k):10===d&&(e=!0),a.substring(b+1,c).replace(/""/g,'"')}for(;k<j;){var d=a.charCodeAt(k++),h=1;if(10===d)e=!0;else if(13===d)e=!0,10===a.charCodeAt(k)&&(++k,++h);else if(d!==i)continue;return a.substring(b,k-h)}return a.substring(b)}for(var d,e,f={},g={},h=[],j=a.length,k=0,l=0;(d=c())!==g;){for(var m=[];d!==f&&d!==g;)m.push(d),d=c();b&&!(m=b(m,l++))||h.push(m)}return h},c.format=function(b){if(Array.isArray(b[0]))return c.formatRows(b);var d=new m,e=[];return b.forEach(function(a){for(var b in a)d.has(b)||e.push(d.add(b))}),[e.map(g).join(a)].concat(b.map(function(b){return e.map(function(a){return g(b[a])}).join(a)})).join("\n")},c.formatRows=function(a){return a.map(f).join("\n")},c},Sf.csv=Sf.dsv(",","text/csv"),Sf.tsv=Sf.dsv("\t","text/tab-separated-values"),Sf.touch=function(a,b,c){if(arguments.length<3&&(c=b,b=t().changedTouches),b)for(var d,e=0,f=b.length;e<f;++e)if((d=b[e]).identifier===c)return S(a,d)};var Qg,Rg,Sg,Tg,Ug,Vg=Xf[o(Xf,"requestAnimationFrame")]||function(a){setTimeout(a,17)};Sf.timer=function(a,b,c){var d=arguments.length;d<2&&(b=0),d<3&&(c=Date.now());var e=c+b,f={c:a,t:e,f:!1,n:null};Rg?Rg.n=f:Qg=f,Rg=f,Sg||(Tg=clearTimeout(Tg),Sg=1,Vg(Ba))},Sf.timer.flush=function(){Ca(),Da()},Sf.round=function(a,b){return b?Math.round(a*(b=Math.pow(10,b)))/b:Math.round(a)};var Wg=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"].map(Fa);Sf.formatPrefix=function(a,b){var c=0;return a&&(a<0&&(a*=-1),b&&(a=Sf.round(a,Ea(a,b))),c=1+Math.floor(1e-12+Math.log(a)/Math.LN10),c=Math.max(-24,Math.min(24,3*Math.floor((c-1)/3)))),Wg[8+c/3]};var Xg=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,Yg=Sf.map({b:function(a){return a.toString(2)},c:function(a){return String.fromCharCode(a)},o:function(a){return a.toString(8)},x:function(a){return a.toString(16)},X:function(a){return a.toString(16).toUpperCase()},g:function(a,b){return a.toPrecision(b)},e:function(a,b){return a.toExponential(b)},f:function(a,b){return a.toFixed(b)},r:function(a,b){return(a=Sf.round(a,Ea(a,b))).toFixed(Math.max(0,Math.min(20,Ea(a*(1+1e-15),b))))}}),Zg=Sf.time={},$g=Date;Ia.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){_g.setUTCDate.apply(this._,arguments)},setDay:function(){_g.setUTCDay.apply(this._,arguments)},setFullYear:function(){_g.setUTCFullYear.apply(this._,arguments)},setHours:function(){_g.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){_g.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){_g.setUTCMinutes.apply(this._,arguments)},setMonth:function(){_g.setUTCMonth.apply(this._,arguments)},setSeconds:function(){_g.setUTCSeconds.apply(this._,arguments)},setTime:function(){_g.setTime.apply(this._,arguments)}};var _g=Date.prototype;Zg.year=Ja(function(a){return a=Zg.day(a),a.setMonth(0,1),a},function(a,b){a.setFullYear(a.getFullYear()+b)},function(a){return a.getFullYear()}),Zg.years=Zg.year.range,Zg.years.utc=Zg.year.utc.range,Zg.day=Ja(function(a){var b=new $g(2e3,0);return b.setFullYear(a.getFullYear(),a.getMonth(),a.getDate()),b},function(a,b){a.setDate(a.getDate()+b)},function(a){return a.getDate()-1}),Zg.days=Zg.day.range,Zg.days.utc=Zg.day.utc.range,Zg.dayOfYear=function(a){var b=Zg.year(a);return Math.floor((a-b-6e4*(a.getTimezoneOffset()-b.getTimezoneOffset()))/864e5)},["sunday","monday","tuesday","wednesday","thursday","friday","saturday"].forEach(function(a,b){b=7-b;var c=Zg[a]=Ja(function(a){return(a=Zg.day(a)).setDate(a.getDate()-(a.getDay()+b)%7),a},function(a,b){a.setDate(a.getDate()+7*Math.floor(b))},function(a){var c=Zg.year(a).getDay();return Math.floor((Zg.dayOfYear(a)+(c+b)%7)/7)-(c!==b)});Zg[a+"s"]=c.range,Zg[a+"s"].utc=c.utc.range,Zg[a+"OfYear"]=function(a){var c=Zg.year(a).getDay();return Math.floor((Zg.dayOfYear(a)+(c+b)%7)/7)}}),Zg.week=Zg.sunday,Zg.weeks=Zg.sunday.range,Zg.weeks.utc=Zg.sunday.utc.range,Zg.weekOfYear=Zg.sundayOfYear;var ah={"-":"",_:" ",0:"0"},bh=/^\s*\d+/,ch=/^%/;Sf.locale=function(a){return{numberFormat:Ga(a),timeFormat:La(a)}};var dh=Sf.locale({decimal:".",thousands:",",grouping:[3],currency:["$",""],dateTime:"%a %b %e %X %Y",date:"%m/%d/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});Sf.format=dh.numberFormat,Sf.geo={},eb.prototype={s:0,t:0,add:function(a){fb(a,this.t,eh),fb(eh.s,this.s,this),this.s?this.t+=eh.t:this.s=eh.t},reset:function(){this.s=this.t=0},valueOf:function(){return this.s}};var eh=new eb;Sf.geo.stream=function(a,b){a&&fh.hasOwnProperty(a.type)?fh[a.type](a,b):gb(a,b)};var fh={Feature:function(a,b){gb(a.geometry,b)},FeatureCollection:function(a,b){for(var c=a.features,d=-1,e=c.length;++d<e;)gb(c[d].geometry,b)}},gh={Sphere:function(a,b){b.sphere()},Point:function(a,b){a=a.coordinates,b.point(a[0],a[1],a[2])},MultiPoint:function(a,b){for(var c=a.coordinates,d=-1,e=c.length;++d<e;)a=c[d],b.point(a[0],a[1],a[2])},LineString:function(a,b){hb(a.coordinates,b,0)},MultiLineString:function(a,b){for(var c=a.coordinates,d=-1,e=c.length;++d<e;)hb(c[d],b,0)},Polygon:function(a,b){ib(a.coordinates,b)},MultiPolygon:function(a,b){for(var c=a.coordinates,d=-1,e=c.length;++d<e;)ib(c[d],b)},GeometryCollection:function(a,b){for(var c=a.geometries,d=-1,e=c.length;++d<e;)gb(c[d],b)}};Sf.geo.area=function(a){return hh=0,Sf.geo.stream(a,jh),hh};var hh,ih=new eb,jh={sphere:function(){hh+=4*ug},point:p,lineStart:p,lineEnd:p,polygonStart:function(){ih.reset(),jh.lineStart=jb},polygonEnd:function(){var a=2*ih;hh+=a<0?4*ug+a:a,jh.lineStart=jh.lineEnd=jh.point=p}};Sf.geo.bounds=function(){function a(a,b){t.push(u=[k=a,m=a]),b<l&&(l=b),b>n&&(n=b)}function b(b,c){var d=kb([b*zg,c*zg]);if(r){var e=mb(r,d),f=[e[1],-e[0],0],g=mb(f,e);pb(g),g=qb(g);var i=b-o,j=i>0?1:-1,p=g[0]*Ag*j,q=cg(i)>180;if(q^(j*o<p&&p<j*b)){var s=g[1]*Ag;s>n&&(n=s)}else if(p=(p+360)%360-180,q^(j*o<p&&p<j*b)){var s=-g[1]*Ag;s<l&&(l=s)}else c<l&&(l=c),c>n&&(n=c);q?b<o?h(k,b)>h(k,m)&&(m=b):h(b,m)>h(k,m)&&(k=b):m>=k?(b<k&&(k=b),b>m&&(m=b)):b>o?h(k,b)>h(k,m)&&(m=b):h(b,m)>h(k,m)&&(k=b)}else a(b,c);r=d,o=b}function c(){v.point=b}function d(){u[0]=k,u[1]=m,v.point=a,r=null}function e(a,c){if(r){var d=a-o;s+=cg(d)>180?d+(d>0?360:-360):d}else p=a,q=c;jh.point(a,c),b(a,c)}function f(){jh.lineStart()}function g(){e(p,q),jh.lineEnd(),cg(s)>xg&&(k=-(m=180)),u[0]=k,u[1]=m,r=null}function h(a,b){return(b-=a)<0?b+360:b}function i(a,b){return a[0]-b[0]}function j(a,b){return b[0]<=b[1]?b[0]<=a&&a<=b[1]:a<b[0]||b[1]<a}var k,l,m,n,o,p,q,r,s,t,u,v={point:a,lineStart:c,lineEnd:d,polygonStart:function(){v.point=e,v.lineStart=f,v.lineEnd=g,s=0,jh.polygonStart()},polygonEnd:function(){jh.polygonEnd(),v.point=a,v.lineStart=c,v.lineEnd=d,ih<0?(k=-(m=180),l=-(n=90)):s>xg?n=90:s<-xg&&(l=-90),u[0]=k,u[1]=m}};return function(a){n=m=-(k=l=1/0),t=[],Sf.geo.stream(a,v);var b=t.length;if(b){t.sort(i);for(var c,d=1,e=t[0],f=[e];d<b;++d)c=t[d],j(c[0],e)||j(c[1],e)?(h(e[0],c[1])>h(e[0],e[1])&&(e[1]=c[1]),h(c[0],e[1])>h(e[0],e[1])&&(e[0]=c[0])):f.push(e=c);for(var g,c,o=-1/0,b=f.length-1,d=0,e=f[b];d<=b;e=c,++d)c=f[d],(g=h(e[1],c[0]))>o&&(o=g,k=c[0],m=e[1])}return t=u=null,k===1/0||l===1/0?[[NaN,NaN],[NaN,NaN]]:[[k,l],[m,n]]}}(),Sf.geo.centroid=function(a){kh=lh=mh=nh=oh=ph=qh=rh=sh=th=uh=0,Sf.geo.stream(a,vh);var b=sh,c=th,d=uh,e=b*b+c*c+d*d;return e<yg&&(b=ph,c=qh,d=rh,lh<xg&&(b=mh,c=nh,d=oh),(e=b*b+c*c+d*d)<yg)?[NaN,NaN]:[Math.atan2(c,b)*Ag,Z(d/Math.sqrt(e))*Ag]};var kh,lh,mh,nh,oh,ph,qh,rh,sh,th,uh,vh={sphere:p,point:sb,lineStart:ub,lineEnd:vb,polygonStart:function(){vh.lineStart=wb},polygonEnd:function(){vh.lineStart=ub}},wh=Bb(xb,Gb,Ib,[-ug,-ug/2]),xh=1e9;Sf.geo.clipExtent=function(){var a,b,c,d,e,f,g={stream:function(a){return e&&(e.valid=!1),e=f(a),e.valid=!0,e},extent:function(h){return arguments.length?(f=Lb(a=+h[0][0],b=+h[0][1],c=+h[1][0],d=+h[1][1]),e&&(e.valid=!1,e=null),g):[[a,b],[c,d]]}};return g.extent([[0,0],[960,500]])},(Sf.geo.conicEqualArea=function(){return Nb(Ob)}).raw=Ob,Sf.geo.albers=function(){return Sf.geo.conicEqualArea().rotate([96,0]).center([-.6,38.7]).parallels([29.5,45.5]).scale(1070)},Sf.geo.albersUsa=function(){function a(a){var f=a[0],g=a[1];return b=null,c(f,g),b||(d(f,g),b)||e(f,g),b}var b,c,d,e,f=Sf.geo.albers(),g=Sf.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),h=Sf.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),i={point:function(a,c){b=[a,c]}};return a.invert=function(a){var b=f.scale(),c=f.translate(),d=(a[0]-c[0])/b,e=(a[1]-c[1])/b;return(e>=.12&&e<.234&&d>=-.425&&d<-.214?g:e>=.166&&e<.234&&d>=-.214&&d<-.115?h:f).invert(a)},a.stream=function(a){var b=f.stream(a),c=g.stream(a),d=h.stream(a);return{point:function(a,e){b.point(a,e),c.point(a,e),d.point(a,e)},sphere:function(){b.sphere(),c.sphere(),d.sphere()},lineStart:function(){b.lineStart(),c.lineStart(),d.lineStart()},lineEnd:function(){b.lineEnd(),c.lineEnd(),d.lineEnd()},polygonStart:function(){b.polygonStart(),c.polygonStart(),d.polygonStart()},polygonEnd:function(){b.polygonEnd(),c.polygonEnd(),d.polygonEnd()}}},a.precision=function(b){return arguments.length?(f.precision(b),g.precision(b),h.precision(b),a):f.precision()},a.scale=function(b){return arguments.length?(f.scale(b),g.scale(.35*b),h.scale(b),a.translate(f.translate())):f.scale()},a.translate=function(b){if(!arguments.length)return f.translate();var j=f.scale(),k=+b[0],l=+b[1];return c=f.translate(b).clipExtent([[k-.455*j,l-.238*j],[k+.455*j,l+.238*j]]).stream(i).point,d=g.translate([k-.307*j,l+.201*j]).clipExtent([[k-.425*j+xg,l+.12*j+xg],[k-.214*j-xg,l+.234*j-xg]]).stream(i).point,e=h.translate([k-.205*j,l+.212*j]).clipExtent([[k-.214*j+xg,l+.166*j+xg],[k-.115*j-xg,l+.234*j-xg]]).stream(i).point,a},a.scale(1070)};var yh,zh,Ah,Bh,Ch,Dh,Eh={point:p,lineStart:p,lineEnd:p,polygonStart:function(){zh=0,Eh.lineStart=Pb},polygonEnd:function(){Eh.lineStart=Eh.lineEnd=Eh.point=p,yh+=cg(zh/2)}},Fh={point:Qb,lineStart:p,lineEnd:p,polygonStart:p,polygonEnd:p},Gh={point:Tb,lineStart:Ub,lineEnd:Vb,polygonStart:function(){Gh.lineStart=Wb},polygonEnd:function(){Gh.point=Tb,Gh.lineStart=Ub,Gh.lineEnd=Vb}};Sf.geo.path=function(){function a(a){return a&&("function"==typeof h&&f.pointRadius(+h.apply(this,arguments)),g&&g.valid||(g=e(f)),Sf.geo.stream(a,g)),f.result()}function b(){return g=null,a}var c,d,e,f,g,h=4.5;return a.area=function(a){return yh=0,Sf.geo.stream(a,e(Eh)),yh},a.centroid=function(a){return mh=nh=oh=ph=qh=rh=sh=th=uh=0,Sf.geo.stream(a,e(Gh)),uh?[sh/uh,th/uh]:rh?[ph/rh,qh/rh]:oh?[mh/oh,nh/oh]:[NaN,NaN]},a.bounds=function(a){return Ch=Dh=-(Ah=Bh=1/0),Sf.geo.stream(a,e(Fh)),[[Ah,Bh],[Ch,Dh]]},a.projection=function(a){return arguments.length?(e=(c=a)?a.stream||Zb(a):xa,b()):c},a.context=function(a){return arguments.length?(f=null==(d=a)?new Rb:new Xb(a),"function"!=typeof h&&f.pointRadius(h),b()):d},a.pointRadius=function(b){return arguments.length?(h="function"==typeof b?b:(f.pointRadius(+b),+b),a):h},a.projection(Sf.geo.albersUsa()).context(null)},Sf.geo.transform=function(a){return{stream:function(b){var c=new $b(b);for(var d in a)c[d]=a[d];return c}}},$b.prototype={point:function(a,b){this.stream.point(a,b)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}},Sf.geo.projection=ac,Sf.geo.projectionMutator=bc,(Sf.geo.equirectangular=function(){return ac(dc)}).raw=dc.invert=dc,Sf.geo.rotation=function(a){function b(b){return b=a(b[0]*zg,b[1]*zg),b[0]*=Ag,b[1]*=Ag,b}return a=fc(a[0]%360*zg,a[1]*zg,a.length>2?a[2]*zg:0),b.invert=function(b){return b=a.invert(b[0]*zg,b[1]*zg),b[0]*=Ag,b[1]*=Ag,b},b},ec.invert=dc,Sf.geo.circle=function(){function a(){var a="function"==typeof d?d.apply(this,arguments):d,b=fc(-a[0]*zg,-a[1]*zg,0).invert,e=[];return c(null,null,1,{point:function(a,c){e.push(a=b(a,c)),a[0]*=Ag,a[1]*=Ag}}),{type:"Polygon",coordinates:[e]}}var b,c,d=[0,0],e=6;return a.origin=function(b){return arguments.length?(d=b,a):d},a.angle=function(d){return arguments.length?(c=jc((b=+d)*zg,e*zg),a):b},a.precision=function(d){return arguments.length?(c=jc(b*zg,(e=+d)*zg),a):e},a.angle(90)},Sf.geo.distance=function(a,b){var c,d=(b[0]-a[0])*zg,e=a[1]*zg,f=b[1]*zg,g=Math.sin(d),h=Math.cos(d),i=Math.sin(e),j=Math.cos(e),k=Math.sin(f),l=Math.cos(f);return Math.atan2(Math.sqrt((c=l*g)*c+(c=j*k-i*l*h)*c),i*k+j*l*h)},Sf.geo.graticule=function(){function a(){return{type:"MultiLineString",coordinates:b()}}function b(){return Sf.range(Math.ceil(f/q)*q,e,q).map(m).concat(Sf.range(Math.ceil(j/r)*r,i,r).map(n)).concat(Sf.range(Math.ceil(d/o)*o,c,o).filter(function(a){return cg(a%q)>xg}).map(k)).concat(Sf.range(Math.ceil(h/p)*p,g,p).filter(function(a){return cg(a%r)>xg}).map(l))}var c,d,e,f,g,h,i,j,k,l,m,n,o=10,p=o,q=90,r=360,s=2.5;return a.lines=function(){return b().map(function(a){return{type:"LineString",coordinates:a}})},a.outline=function(){return{type:"Polygon",coordinates:[m(f).concat(n(i).slice(1),m(e).reverse().slice(1),n(j).reverse().slice(1))]}},a.extent=function(b){return arguments.length?a.majorExtent(b).minorExtent(b):a.minorExtent()},a.majorExtent=function(b){return arguments.length?(f=+b[0][0],e=+b[1][0],j=+b[0][1],i=+b[1][1],f>e&&(b=f,f=e,e=b),j>i&&(b=j,j=i,i=b),a.precision(s)):[[f,j],[e,i]]},a.minorExtent=function(b){return arguments.length?(d=+b[0][0],c=+b[1][0],h=+b[0][1],g=+b[1][1],d>c&&(b=d,d=c,c=b),h>g&&(b=h,h=g,g=b),a.precision(s)):[[d,h],[c,g]]},a.step=function(b){return arguments.length?a.majorStep(b).minorStep(b):a.minorStep()},a.majorStep=function(b){return arguments.length?(q=+b[0],r=+b[1],a):[q,r]},a.minorStep=function(b){return arguments.length?(o=+b[0],p=+b[1],a):[o,p]},a.precision=function(b){return arguments.length?(s=+b,
k=lc(h,g,90),l=mc(d,c,s),m=lc(j,i,90),n=mc(f,e,s),a):s},a.majorExtent([[-180,-90+xg],[180,90-xg]]).minorExtent([[-180,-80-xg],[180,80+xg]])},Sf.geo.greatArc=function(){function a(){return{type:"LineString",coordinates:[b||d.apply(this,arguments),c||e.apply(this,arguments)]}}var b,c,d=nc,e=oc;return a.distance=function(){return Sf.geo.distance(b||d.apply(this,arguments),c||e.apply(this,arguments))},a.source=function(c){return arguments.length?(d=c,b="function"==typeof c?null:c,a):d},a.target=function(b){return arguments.length?(e=b,c="function"==typeof b?null:b,a):e},a.precision=function(){return arguments.length?a:0},a},Sf.geo.interpolate=function(a,b){return pc(a[0]*zg,a[1]*zg,b[0]*zg,b[1]*zg)},Sf.geo.length=function(a){return Hh=0,Sf.geo.stream(a,Ih),Hh};var Hh,Ih={sphere:p,point:p,lineStart:qc,lineEnd:p,polygonStart:p,polygonEnd:p},Jh=rc(function(a){return Math.sqrt(2/(1+a))},function(a){return 2*Math.asin(a/2)});(Sf.geo.azimuthalEqualArea=function(){return ac(Jh)}).raw=Jh;var Kh=rc(function(a){var b=Math.acos(a);return b&&b/Math.sin(b)},xa);(Sf.geo.azimuthalEquidistant=function(){return ac(Kh)}).raw=Kh,(Sf.geo.conicConformal=function(){return Nb(sc)}).raw=sc,(Sf.geo.conicEquidistant=function(){return Nb(tc)}).raw=tc;var Lh=rc(function(a){return 1/a},Math.atan);(Sf.geo.gnomonic=function(){return ac(Lh)}).raw=Lh,uc.invert=function(a,b){return[a,2*Math.atan(Math.exp(b))-wg]},(Sf.geo.mercator=function(){return vc(uc)}).raw=uc;var Mh=rc(function(){return 1},Math.asin);(Sf.geo.orthographic=function(){return ac(Mh)}).raw=Mh;var Nh=rc(function(a){return 1/(1+a)},function(a){return 2*Math.atan(a)});(Sf.geo.stereographic=function(){return ac(Nh)}).raw=Nh,wc.invert=function(a,b){return[-b,2*Math.atan(Math.exp(a))-wg]},(Sf.geo.transverseMercator=function(){var a=vc(wc),b=a.center,c=a.rotate;return a.center=function(a){return a?b([-a[1],a[0]]):(a=b(),[a[1],-a[0]])},a.rotate=function(a){return a?c([a[0],a[1],a.length>2?a[2]+90:90]):(a=c(),[a[0],a[1],a[2]-90])},c([0,0,90])}).raw=wc,Sf.geom={},Sf.geom.hull=function(a){function b(a){if(a.length<3)return[];var b,e=wa(c),f=wa(d),g=a.length,h=[],i=[];for(b=0;b<g;b++)h.push([+e.call(this,a[b],b),+f.call(this,a[b],b),b]);for(h.sort(Ac),b=0;b<g;b++)i.push([h[b][0],-h[b][1]]);var j=zc(h),k=zc(i),l=k[0]===j[0],m=k[k.length-1]===j[j.length-1],n=[];for(b=j.length-1;b>=0;--b)n.push(a[h[j[b]][2]]);for(b=+l;b<k.length-m;++b)n.push(a[h[k[b]][2]]);return n}var c=xc,d=yc;return arguments.length?b(a):(b.x=function(a){return arguments.length?(c=a,b):c},b.y=function(a){return arguments.length?(d=a,b):d},b)},Sf.geom.polygon=function(a){return hg(a,Oh),a};var Oh=Sf.geom.polygon.prototype=[];Oh.area=function(){for(var a,b=-1,c=this.length,d=this[c-1],e=0;++b<c;)a=d,d=this[b],e+=a[1]*d[0]-a[0]*d[1];return.5*e},Oh.centroid=function(a){var b,c,d=-1,e=this.length,f=0,g=0,h=this[e-1];for(arguments.length||(a=-1/(6*this.area()));++d<e;)b=h,h=this[d],c=b[0]*h[1]-h[0]*b[1],f+=(b[0]+h[0])*c,g+=(b[1]+h[1])*c;return[f*a,g*a]},Oh.clip=function(a){for(var b,c,d,e,f,g,h=Dc(a),i=-1,j=this.length-Dc(this),k=this[j-1];++i<j;){for(b=a.slice(),a.length=0,e=this[i],f=b[(d=b.length-h)-1],c=-1;++c<d;)g=b[c],Bc(g,k,e)?(Bc(f,k,e)||a.push(Cc(f,g,k,e)),a.push(g)):Bc(f,k,e)&&a.push(Cc(f,g,k,e)),f=g;h&&a.push(a[0]),k=e}return a};var Ph,Qh,Rh,Sh,Th,Uh=[],Vh=[];Lc.prototype.prepare=function(){for(var a,b=this.edges,c=b.length;c--;)a=b[c].edge,a.b&&a.a||b.splice(c,1);return b.sort(Nc),b.length},Xc.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}},Yc.prototype={insert:function(a,b){var c,d,e;if(a){if(b.P=a,b.N=a.N,a.N&&(a.N.P=b),a.N=b,a.R){for(a=a.R;a.L;)a=a.L;a.L=b}else a.R=b;c=a}else this._?(a=ad(this._),b.P=null,b.N=a,a.P=a.L=b,c=a):(b.P=b.N=null,this._=b,c=null);for(b.L=b.R=null,b.U=c,b.C=!0,a=b;c&&c.C;)d=c.U,c===d.L?(e=d.R,e&&e.C?(c.C=e.C=!1,d.C=!0,a=d):(a===c.R&&($c(this,c),a=c,c=a.U),c.C=!1,d.C=!0,_c(this,d))):(e=d.L,e&&e.C?(c.C=e.C=!1,d.C=!0,a=d):(a===c.L&&(_c(this,c),a=c,c=a.U),c.C=!1,d.C=!0,$c(this,d))),c=a.U;this._.C=!1},remove:function(a){a.N&&(a.N.P=a.P),a.P&&(a.P.N=a.N),a.N=a.P=null;var b,c,d,e=a.U,f=a.L,g=a.R;if(c=f?g?ad(g):f:g,e?e.L===a?e.L=c:e.R=c:this._=c,f&&g?(d=c.C,c.C=a.C,c.L=f,f.U=c,c!==g?(e=c.U,c.U=a.U,a=c.R,e.L=a,c.R=g,g.U=c):(c.U=e,e=c,a=c.R)):(d=a.C,a=c),a&&(a.U=e),!d){if(a&&a.C)return void(a.C=!1);do{if(a===this._)break;if(a===e.L){if(b=e.R,b.C&&(b.C=!1,e.C=!0,$c(this,e),b=e.R),b.L&&b.L.C||b.R&&b.R.C){b.R&&b.R.C||(b.L.C=!1,b.C=!0,_c(this,b),b=e.R),b.C=e.C,e.C=b.R.C=!1,$c(this,e),a=this._;break}}else if(b=e.L,b.C&&(b.C=!1,e.C=!0,_c(this,e),b=e.L),b.L&&b.L.C||b.R&&b.R.C){b.L&&b.L.C||(b.R.C=!1,b.C=!0,$c(this,b),b=e.L),b.C=e.C,e.C=b.L.C=!1,_c(this,e),a=this._;break}b.C=!0,a=e,e=e.U}while(!a.C);a&&(a.C=!1)}}},Sf.geom.voronoi=function(a){function b(a){var b=new Array(a.length),d=h[0][0],e=h[0][1],f=h[1][0],g=h[1][1];return bd(c(a),h).cells.forEach(function(c,h){var i=c.edges,j=c.site;(b[h]=i.length?i.map(function(a){var b=a.start();return[b.x,b.y]}):j.x>=d&&j.x<=f&&j.y>=e&&j.y<=g?[[d,g],[f,g],[f,e],[d,e]]:[]).point=a[h]}),b}function c(a){return a.map(function(a,b){return{x:Math.round(f(a,b)/xg)*xg,y:Math.round(g(a,b)/xg)*xg,i:b}})}var d=xc,e=yc,f=d,g=e,h=Wh;return a?b(a):(b.links=function(a){return bd(c(a)).edges.filter(function(a){return a.l&&a.r}).map(function(b){return{source:a[b.l.i],target:a[b.r.i]}})},b.triangles=function(a){var b=[];return bd(c(a)).cells.forEach(function(c,d){for(var e,f=c.site,g=c.edges.sort(Nc),h=-1,i=g.length,j=g[i-1].edge,k=j.l===f?j.r:j.l;++h<i;)j,e=k,j=g[h].edge,k=j.l===f?j.r:j.l,d<e.i&&d<k.i&&dd(f,e,k)<0&&b.push([a[d],a[e.i],a[k.i]])}),b},b.x=function(a){return arguments.length?(f=wa(d=a),b):d},b.y=function(a){return arguments.length?(g=wa(e=a),b):e},b.clipExtent=function(a){return arguments.length?(h=null==a?Wh:a,b):h===Wh?null:h},b.size=function(a){return arguments.length?b.clipExtent(a&&[[0,0],a]):h===Wh?null:h&&h[1]},b)};var Wh=[[-1e6,-1e6],[1e6,1e6]];Sf.geom.delaunay=function(a){return Sf.geom.voronoi().triangles(a)},Sf.geom.quadtree=function(a,b,c,d,e){function f(a){function f(a,b,c,d,e,f,g,h){if(!isNaN(c)&&!isNaN(d))if(a.leaf){var i=a.x,k=a.y;if(null!=i)if(cg(i-c)+cg(k-d)<.01)j(a,b,c,d,e,f,g,h);else{var l=a.point;a.x=a.y=a.point=null,j(a,l,i,k,e,f,g,h),j(a,b,c,d,e,f,g,h)}else a.x=c,a.y=d,a.point=b}else j(a,b,c,d,e,f,g,h)}function j(a,b,c,d,e,g,h,i){var j=.5*(e+h),k=.5*(g+i),l=c>=j,m=d>=k,n=(m<<1)+l;a.leaf=!1,a=a.nodes[n]||(a.nodes[n]=gd()),l?e=j:h=j,m?g=k:i=k,f(a,b,c,d,e,g,h,i)}var k,l,m,n,o,p,q,r,s,t=wa(h),u=wa(i);if(null!=b)p=b,q=c,r=d,s=e;else if(r=s=-(p=q=1/0),l=[],m=[],o=a.length,g)for(n=0;n<o;++n)k=a[n],k.x<p&&(p=k.x),k.y<q&&(q=k.y),k.x>r&&(r=k.x),k.y>s&&(s=k.y),l.push(k.x),m.push(k.y);else for(n=0;n<o;++n){var v=+t(k=a[n],n),w=+u(k,n);v<p&&(p=v),w<q&&(q=w),v>r&&(r=v),w>s&&(s=w),l.push(v),m.push(w)}var x=r-p,y=s-q;x>y?s=q+x:r=p+y;var z=gd();if(z.add=function(a){f(z,a,+t(a,++n),+u(a,n),p,q,r,s)},z.visit=function(a){hd(a,z,p,q,r,s)},n=-1,null==b){for(;++n<o;)f(z,a[n],l[n],m[n],p,q,r,s);--n}else a.forEach(z.add);return l=m=a=k=null,z}var g,h=xc,i=yc;return(g=arguments.length)?(h=ed,i=fd,3===g&&(e=c,d=b,c=b=0),f(a)):(f.x=function(a){return arguments.length?(h=a,f):h},f.y=function(a){return arguments.length?(i=a,f):i},f.extent=function(a){return arguments.length?(null==a?b=c=d=e=null:(b=+a[0][0],c=+a[0][1],d=+a[1][0],e=+a[1][1]),f):null==b?null:[[b,c],[d,e]]},f.size=function(a){return arguments.length?(null==a?b=c=d=e=null:(b=c=0,d=+a[0],e=+a[1]),f):null==b?null:[d-b,e-c]},f)},Sf.interpolateRgb=id,Sf.interpolateObject=jd,Sf.interpolateNumber=kd,Sf.interpolateString=ld;var Xh=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Yh=new RegExp(Xh.source,"g");Sf.interpolate=md,Sf.interpolators=[function(a,b){var c=typeof b;return("string"===c?Pg.has(b)||/^(#|rgb\(|hsl\()/.test(b)?id:ld:b instanceof ca?id:Array.isArray(b)?nd:"object"===c&&isNaN(b)?jd:kd)(a,b)}],Sf.interpolateArray=nd;var Zh=function(){return xa},$h=Sf.map({linear:Zh,poly:ud,quad:function(){return rd},cubic:function(){return sd},sin:function(){return vd},exp:function(){return wd},circle:function(){return xd},elastic:yd,back:zd,bounce:function(){return Ad}}),_h=Sf.map({in:xa,out:pd,"in-out":qd,"out-in":function(a){return qd(pd(a))}});Sf.ease=function(a){var b=a.indexOf("-"),c=b>=0?a.substring(0,b):a,d=b>=0?a.substring(b+1):"in";return c=$h.get(c)||Zh,d=_h.get(d)||xa,od(d(c.apply(null,Tf.call(arguments,1))))},Sf.interpolateHcl=Bd,Sf.interpolateHsl=Cd,Sf.interpolateLab=Dd,Sf.interpolateRound=Ed,Sf.transform=function(a){var b=Vf.createElementNS(Sf.ns.prefix.svg,"g");return(Sf.transform=function(a){if(null!=a){b.setAttribute("transform",a);var c=b.transform.baseVal.consolidate()}return new Fd(c?c.matrix:ai)})(a)},Fd.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var ai={a:1,b:0,c:0,d:1,e:0,f:0};Sf.interpolateTransform=Jd,Sf.layout={},Sf.layout.bundle=function(){return function(a){for(var b=[],c=-1,d=a.length;++c<d;)b.push(Md(a[c]));return b}},Sf.layout.chord=function(){function a(){var a,j,l,m,n,o={},p=[],q=Sf.range(f),r=[];for(c=[],d=[],a=0,m=-1;++m<f;){for(j=0,n=-1;++n<f;)j+=e[m][n];p.push(j),r.push(Sf.range(f)),a+=j}for(g&&q.sort(function(a,b){return g(p[a],p[b])}),h&&r.forEach(function(a,b){a.sort(function(a,c){return h(e[b][a],e[b][c])})}),a=(vg-k*f)/a,j=0,m=-1;++m<f;){for(l=j,n=-1;++n<f;){var s=q[m],t=r[s][n],u=e[s][t],v=j,w=j+=u*a;o[s+"-"+t]={index:s,subindex:t,startAngle:v,endAngle:w,value:u}}d[s]={index:s,startAngle:l,endAngle:j,value:(j-l)/a},j+=k}for(m=-1;++m<f;)for(n=m-1;++n<f;){var x=o[m+"-"+n],y=o[n+"-"+m];(x.value||y.value)&&c.push(x.value<y.value?{source:y,target:x}:{source:x,target:y})}i&&b()}function b(){c.sort(function(a,b){return i((a.source.value+a.target.value)/2,(b.source.value+b.target.value)/2)})}var c,d,e,f,g,h,i,j={},k=0;return j.matrix=function(a){return arguments.length?(f=(e=a)&&e.length,c=d=null,j):e},j.padding=function(a){return arguments.length?(k=a,c=d=null,j):k},j.sortGroups=function(a){return arguments.length?(g=a,c=d=null,j):g},j.sortSubgroups=function(a){return arguments.length?(h=a,c=null,j):h},j.sortChords=function(a){return arguments.length?(i=a,c&&b(),j):i},j.chords=function(){return c||a(),c},j.groups=function(){return d||a(),d},j},Sf.layout.force=function(){function a(a){return function(b,c,d,e){if(b.point!==a){var f=b.cx-a.x,g=b.cy-a.y,h=e-c,i=f*f+g*g;if(h*h/q<i){if(i<o){var j=b.charge/i;a.px-=f*j,a.py-=g*j}return!0}if(b.point&&i&&i<o){var j=b.pointCharge/i;a.px-=f*j,a.py-=g*j}}return!b.charge}}function b(a){a.px=Sf.event.x,a.py=Sf.event.y,h.resume()}var c,d,e,f,g,h={},i=Sf.dispatch("start","tick","end"),j=[1,1],k=.9,l=bi,m=ci,n=-30,o=di,p=.1,q=.64,r=[],s=[];return h.tick=function(){if((d*=.99)<.005)return i.end({type:"end",alpha:d=0}),!0;var b,c,h,l,m,o,q,t,u,v=r.length,w=s.length;for(c=0;c<w;++c)h=s[c],l=h.source,m=h.target,t=m.x-l.x,u=m.y-l.y,(o=t*t+u*u)&&(o=d*f[c]*((o=Math.sqrt(o))-e[c])/o,t*=o,u*=o,m.x-=t*(q=l.weight/(m.weight+l.weight)),m.y-=u*q,l.x+=t*(q=1-q),l.y+=u*q);if((q=d*p)&&(t=j[0]/2,u=j[1]/2,c=-1,q))for(;++c<v;)h=r[c],h.x+=(t-h.x)*q,h.y+=(u-h.y)*q;if(n)for(Td(b=Sf.geom.quadtree(r),d,g),c=-1;++c<v;)(h=r[c]).fixed||b.visit(a(h));for(c=-1;++c<v;)h=r[c],h.fixed?(h.x=h.px,h.y=h.py):(h.x-=(h.px-(h.px=h.x))*k,h.y-=(h.py-(h.py=h.y))*k);i.tick({type:"tick",alpha:d})},h.nodes=function(a){return arguments.length?(r=a,h):r},h.links=function(a){return arguments.length?(s=a,h):s},h.size=function(a){return arguments.length?(j=a,h):j},h.linkDistance=function(a){return arguments.length?(l="function"==typeof a?a:+a,h):l},h.distance=h.linkDistance,h.linkStrength=function(a){return arguments.length?(m="function"==typeof a?a:+a,h):m},h.friction=function(a){return arguments.length?(k=+a,h):k},h.charge=function(a){return arguments.length?(n="function"==typeof a?a:+a,h):n},h.chargeDistance=function(a){return arguments.length?(o=a*a,h):Math.sqrt(o)},h.gravity=function(a){return arguments.length?(p=+a,h):p},h.theta=function(a){return arguments.length?(q=a*a,h):Math.sqrt(q)},h.alpha=function(a){return arguments.length?(a=+a,d?d=a>0?a:0:a>0&&(i.start({type:"start",alpha:d=a}),Sf.timer(h.tick)),h):d},h.start=function(){function a(a,d){if(!c){for(c=new Array(i),h=0;h<i;++h)c[h]=[];for(h=0;h<j;++h){var e=s[h];c[e.source.index].push(e.target),c[e.target.index].push(e.source)}}for(var f,g=c[b],h=-1,j=g.length;++h<j;)if(!isNaN(f=g[h][a]))return f;return Math.random()*d}var b,c,d,i=r.length,k=s.length,o=j[0],p=j[1];for(b=0;b<i;++b)(d=r[b]).index=b,d.weight=0;for(b=0;b<k;++b)d=s[b],"number"==typeof d.source&&(d.source=r[d.source]),"number"==typeof d.target&&(d.target=r[d.target]),++d.source.weight,++d.target.weight;for(b=0;b<i;++b)d=r[b],isNaN(d.x)&&(d.x=a("x",o)),isNaN(d.y)&&(d.y=a("y",p)),isNaN(d.px)&&(d.px=d.x),isNaN(d.py)&&(d.py=d.y);if(e=[],"function"==typeof l)for(b=0;b<k;++b)e[b]=+l.call(this,s[b],b);else for(b=0;b<k;++b)e[b]=l;if(f=[],"function"==typeof m)for(b=0;b<k;++b)f[b]=+m.call(this,s[b],b);else for(b=0;b<k;++b)f[b]=m;if(g=[],"function"==typeof n)for(b=0;b<i;++b)g[b]=+n.call(this,r[b],b);else for(b=0;b<i;++b)g[b]=n;return h.resume()},h.resume=function(){return h.alpha(.1)},h.stop=function(){return h.alpha(0)},h.drag=function(){if(c||(c=Sf.behavior.drag().origin(xa).on("dragstart.force",Pd).on("drag.force",b).on("dragend.force",Qd)),!arguments.length)return c;this.on("mouseover.force",Rd).on("mouseout.force",Sd).call(c)},Sf.rebind(h,i,"on")};var bi=20,ci=1,di=1/0;Sf.layout.hierarchy=function(){function a(e){var f,g=[e],h=[];for(e.depth=0;null!=(f=g.pop());)if(h.push(f),(j=c.call(a,f,f.depth))&&(i=j.length)){for(var i,j,k;--i>=0;)g.push(k=j[i]),k.parent=f,k.depth=f.depth+1;d&&(f.value=0),f.children=j}else d&&(f.value=+d.call(a,f,f.depth)||0),delete f.children;return Wd(e,function(a){var c,e;b&&(c=a.children)&&c.sort(b),d&&(e=a.parent)&&(e.value+=a.value)}),h}var b=Zd,c=Xd,d=Yd;return a.sort=function(c){return arguments.length?(b=c,a):b},a.children=function(b){return arguments.length?(c=b,a):c},a.value=function(b){return arguments.length?(d=b,a):d},a.revalue=function(b){return d&&(Vd(b,function(a){a.children&&(a.value=0)}),Wd(b,function(b){var c;b.children||(b.value=+d.call(a,b,b.depth)||0),(c=b.parent)&&(c.value+=b.value)})),b},a},Sf.layout.partition=function(){function a(b,c,d,e){var f=b.children;if(b.x=c,b.y=b.depth*e,b.dx=d,b.dy=e,f&&(g=f.length)){var g,h,i,j=-1;for(d=b.value?d/b.value:0;++j<g;)a(h=f[j],c,i=h.value*d,e),c+=i}}function b(a){var c=a.children,d=0;if(c&&(e=c.length))for(var e,f=-1;++f<e;)d=Math.max(d,b(c[f]));return 1+d}function c(c,f){var g=d.call(this,c,f);return a(g[0],0,e[0],e[1]/b(g[0])),g}var d=Sf.layout.hierarchy(),e=[1,1];return c.size=function(a){return arguments.length?(e=a,c):e},Ud(c,d)},Sf.layout.pie=function(){function a(f){var g=f.map(function(c,d){return+b.call(a,c,d)}),h=+("function"==typeof d?d.apply(this,arguments):d),i=(("function"==typeof e?e.apply(this,arguments):e)-h)/Sf.sum(g),j=Sf.range(f.length);null!=c&&j.sort(c===ei?function(a,b){return g[b]-g[a]}:function(a,b){return c(f[a],f[b])});var k=[];return j.forEach(function(a){var b;k[a]={data:f[a],value:b=g[a],startAngle:h,endAngle:h+=b*i}}),k}var b=Number,c=ei,d=0,e=vg;return a.value=function(c){return arguments.length?(b=c,a):b},a.sort=function(b){return arguments.length?(c=b,a):c},a.startAngle=function(b){return arguments.length?(d=b,a):d},a.endAngle=function(b){return arguments.length?(e=b,a):e},a};var ei={};Sf.layout.stack=function(){function a(h,i){var j=h.map(function(c,d){return b.call(a,c,d)}),k=j.map(function(b){return b.map(function(b,c){return[f.call(a,b,c),g.call(a,b,c)]})}),l=c.call(a,k,i);j=Sf.permute(j,l),k=Sf.permute(k,l);var m,n,o,p=d.call(a,k,i),q=j.length,r=j[0].length;for(n=0;n<r;++n)for(e.call(a,j[0][n],o=p[n],k[0][n][1]),m=1;m<q;++m)e.call(a,j[m][n],o+=k[m-1][n][1],k[m][n][1]);return h}var b=xa,c=ce,d=de,e=be,f=_d,g=ae;return a.values=function(c){return arguments.length?(b=c,a):b},a.order=function(b){return arguments.length?(c="function"==typeof b?b:fi.get(b)||ce,a):c},a.offset=function(b){return arguments.length?(d="function"==typeof b?b:gi.get(b)||de,a):d},a.x=function(b){return arguments.length?(f=b,a):f},a.y=function(b){return arguments.length?(g=b,a):g},a.out=function(b){return arguments.length?(e=b,a):e},a};var fi=Sf.map({"inside-out":function(a){var b,c,d=a.length,e=a.map(ee),f=a.map(fe),g=Sf.range(d).sort(function(a,b){return e[a]-e[b]}),h=0,i=0,j=[],k=[];for(b=0;b<d;++b)c=g[b],h<i?(h+=f[c],j.push(c)):(i+=f[c],k.push(c));return k.reverse().concat(j)},reverse:function(a){return Sf.range(a.length).reverse()},default:ce}),gi=Sf.map({silhouette:function(a){var b,c,d,e=a.length,f=a[0].length,g=[],h=0,i=[];for(c=0;c<f;++c){for(b=0,d=0;b<e;b++)d+=a[b][c][1];d>h&&(h=d),g.push(d)}for(c=0;c<f;++c)i[c]=(h-g[c])/2;return i},wiggle:function(a){var b,c,d,e,f,g,h,i,j,k=a.length,l=a[0],m=l.length,n=[];for(n[0]=i=j=0,c=1;c<m;++c){for(b=0,e=0;b<k;++b)e+=a[b][c][1];for(b=0,f=0,h=l[c][0]-l[c-1][0];b<k;++b){for(d=0,g=(a[b][c][1]-a[b][c-1][1])/(2*h);d<b;++d)g+=(a[d][c][1]-a[d][c-1][1])/h;f+=g*a[b][c][1]}n[c]=i-=e?f/e*h:0,i<j&&(j=i)}for(c=0;c<m;++c)n[c]-=j;return n},expand:function(a){var b,c,d,e=a.length,f=a[0].length,g=1/e,h=[];for(c=0;c<f;++c){for(b=0,d=0;b<e;b++)d+=a[b][c][1];if(d)for(b=0;b<e;b++)a[b][c][1]/=d;else for(b=0;b<e;b++)a[b][c][1]=g}for(c=0;c<f;++c)h[c]=0;return h},zero:de});Sf.layout.histogram=function(){function a(a,f){for(var g,h,i=[],j=a.map(c,this),k=d.call(this,j,f),l=e.call(this,k,j,f),f=-1,m=j.length,n=l.length-1,o=b?1:1/m;++f<n;)g=i[f]=[],g.dx=l[f+1]-(g.x=l[f]),g.y=0;if(n>0)for(f=-1;++f<m;)(h=j[f])>=k[0]&&h<=k[1]&&(g=i[Sf.bisect(l,h,1,n)-1],g.y+=o,g.push(a[f]));return i}var b=!0,c=Number,d=je,e=he;return a.value=function(b){return arguments.length?(c=b,a):c},a.range=function(b){return arguments.length?(d=wa(b),a):d},a.bins=function(b){return arguments.length?(e="number"==typeof b?function(a){return ie(a,b)}:wa(b),a):e},a.frequency=function(c){return arguments.length?(b=!!c,a):b},a},Sf.layout.pack=function(){function a(a,f){var g=c.call(this,a,f),h=g[0],i=e[0],j=e[1],k=null==b?Math.sqrt:"function"==typeof b?b:function(){return b};if(h.x=h.y=0,Wd(h,function(a){a.r=+k(a.value)}),Wd(h,oe),d){var l=d*(b?1:Math.max(2*h.r/i,2*h.r/j))/2;Wd(h,function(a){a.r+=l}),Wd(h,oe),Wd(h,function(a){a.r-=l})}return re(h,i/2,j/2,b?1:1/Math.max(2*h.r/i,2*h.r/j)),g}var b,c=Sf.layout.hierarchy().sort(ke),d=0,e=[1,1];return a.size=function(b){return arguments.length?(e=b,a):e},a.radius=function(c){return arguments.length?(b=null==c||"function"==typeof c?c:+c,a):b},a.padding=function(b){return arguments.length?(d=+b,a):d},Ud(a,c)},Sf.layout.tree=function(){function a(a,e){var k=g.call(this,a,e),l=k[0],m=b(l);if(Wd(m,c),m.parent.m=-m.z,Vd(m,d),j)Vd(l,f);else{var n=l,o=l,p=l;Vd(l,function(a){a.x<n.x&&(n=a),a.x>o.x&&(o=a),a.depth>p.depth&&(p=a)});var q=h(n,o)/2-n.x,r=i[0]/(o.x+h(o,n)/2+q),s=i[1]/(p.depth||1);Vd(l,function(a){a.x=(a.x+q)*r,a.y=a.depth*s})}return k}function b(a){for(var b,c={A:null,children:[a]},d=[c];null!=(b=d.pop());)for(var e,f=b.children,g=0,h=f.length;g<h;++g)d.push((f[g]=e={_:f[g],parent:b,children:(e=f[g].children)&&e.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:g}).a=e);return c.children[0]}function c(a){var b=a.children,c=a.parent.children,d=a.i?c[a.i-1]:null;if(b.length){xe(a);var f=(b[0].z+b[b.length-1].z)/2;d?(a.z=d.z+h(a._,d._),a.m=a.z-f):a.z=f}else d&&(a.z=d.z+h(a._,d._));a.parent.A=e(a,d,a.parent.A||c[0])}function d(a){a._.x=a.z+a.parent.m,a.m+=a.parent.m}function e(a,b,c){if(b){for(var d,e=a,f=a,g=b,i=e.parent.children[0],j=e.m,k=f.m,l=g.m,m=i.m;g=ve(g),e=ue(e),g&&e;)i=ue(i),f=ve(f),f.a=a,d=g.z+l-e.z-j+h(g._,e._),d>0&&(we(ye(g,a,c),a,d),j+=d,k+=d),l+=g.m,j+=e.m,m+=i.m,k+=f.m;g&&!ve(f)&&(f.t=g,f.m+=l-k),e&&!ue(i)&&(i.t=e,i.m+=j-m,c=a)}return c}function f(a){a.x*=i[0],a.y=a.depth*i[1]}var g=Sf.layout.hierarchy().sort(null).value(null),h=te,i=[1,1],j=null;return a.separation=function(b){return arguments.length?(h=b,a):h},a.size=function(b){return arguments.length?(j=null==(i=b)?f:null,a):j?null:i},a.nodeSize=function(b){return arguments.length?(j=null==(i=b)?null:f,a):j?i:null},Ud(a,g)},Sf.layout.cluster=function(){function a(a,f){var g,h=b.call(this,a,f),i=h[0],j=0;Wd(i,function(a){var b=a.children;b&&b.length?(a.x=Ae(b),a.y=ze(b)):(a.x=g?j+=c(a,g):0,a.y=0,g=a)});var k=Be(i),l=Ce(i),m=k.x-c(k,l)/2,n=l.x+c(l,k)/2;return Wd(i,e?function(a){a.x=(a.x-i.x)*d[0],a.y=(i.y-a.y)*d[1]}:function(a){a.x=(a.x-m)/(n-m)*d[0],a.y=(1-(i.y?a.y/i.y:1))*d[1]}),h}var b=Sf.layout.hierarchy().sort(null).value(null),c=te,d=[1,1],e=!1;return a.separation=function(b){return arguments.length?(c=b,a):c},a.size=function(b){return arguments.length?(e=null==(d=b),a):e?null:d},a.nodeSize=function(b){return arguments.length?(e=null!=(d=b),a):e?d:null},Ud(a,b)},Sf.layout.treemap=function(){function a(a,b){for(var c,d,e=-1,f=a.length;++e<f;)d=(c=a[e]).value*(b<0?0:b),c.area=isNaN(d)||d<=0?0:d}function b(c){var f=c.children;if(f&&f.length){var g,h,i,j=l(c),k=[],m=f.slice(),o=1/0,p="slice"===n?j.dx:"dice"===n?j.dy:"slice-dice"===n?1&c.depth?j.dy:j.dx:Math.min(j.dx,j.dy);for(a(m,j.dx*j.dy/c.value),k.area=0;(i=m.length)>0;)k.push(g=m[i-1]),k.area+=g.area,"squarify"!==n||(h=d(k,p))<=o?(m.pop(),o=h):(k.area-=k.pop().area,e(k,p,j,!1),p=Math.min(j.dx,j.dy),k.length=k.area=0,o=1/0);k.length&&(e(k,p,j,!0),k.length=k.area=0),f.forEach(b)}}function c(b){var d=b.children;if(d&&d.length){var f,g=l(b),h=d.slice(),i=[];for(a(h,g.dx*g.dy/b.value),i.area=0;f=h.pop();)i.push(f),i.area+=f.area,null!=f.z&&(e(i,f.z?g.dx:g.dy,g,!h.length),i.length=i.area=0);d.forEach(c)}}function d(a,b){for(var c,d=a.area,e=0,f=1/0,g=-1,h=a.length;++g<h;)(c=a[g].area)&&(c<f&&(f=c),c>e&&(e=c));return d*=d,b*=b,d?Math.max(b*e*o/d,d/(b*f*o)):1/0}function e(a,b,c,d){var e,f=-1,g=a.length,h=c.x,j=c.y,k=b?i(a.area/b):0;if(b==c.dx){for((d||k>c.dy)&&(k=c.dy);++f<g;)e=a[f],e.x=h,e.y=j,e.dy=k,h+=e.dx=Math.min(c.x+c.dx-h,k?i(e.area/k):0);e.z=!0,e.dx+=c.x+c.dx-h,c.y+=k,c.dy-=k}else{for((d||k>c.dx)&&(k=c.dx);++f<g;)e=a[f],e.x=h,e.y=j,e.dx=k,j+=e.dy=Math.min(c.y+c.dy-j,k?i(e.area/k):0);e.z=!1,e.dy+=c.y+c.dy-j,c.x+=k,c.dx-=k}}function f(d){var e=g||h(d),f=e[0];return f.x=0,f.y=0,f.dx=j[0],f.dy=j[1],g&&h.revalue(f),a([f],f.dx*f.dy/f.value),(g?c:b)(f),m&&(g=e),e}var g,h=Sf.layout.hierarchy(),i=Math.round,j=[1,1],k=null,l=De,m=!1,n="squarify",o=.5*(1+Math.sqrt(5));return f.size=function(a){return arguments.length?(j=a,f):j},f.padding=function(a){function b(b){var c=a.call(f,b,b.depth);return null==c?De(b):Ee(b,"number"==typeof c?[c,c,c,c]:c)}function c(b){return Ee(b,a)}if(!arguments.length)return k;var d;return l=null==(k=a)?De:"function"==(d=typeof a)?b:"number"===d?(a=[a,a,a,a],c):c,f},f.round=function(a){return arguments.length?(i=a?Math.round:Number,f):i!=Number},f.sticky=function(a){return arguments.length?(m=a,g=null,f):m},f.ratio=function(a){return arguments.length?(o=a,f):o},f.mode=function(a){return arguments.length?(n=a+"",f):n},Ud(f,h)},Sf.random={normal:function(a,b){var c=arguments.length;return c<2&&(b=1),c<1&&(a=0),function(){var c,d,e;do{c=2*Math.random()-1,d=2*Math.random()-1,e=c*c+d*d}while(!e||e>1);return a+b*c*Math.sqrt(-2*Math.log(e)/e)}},logNormal:function(){var a=Sf.random.normal.apply(Sf,arguments);return function(){return Math.exp(a())}},bates:function(a){var b=Sf.random.irwinHall(a);return function(){return b()/a}},irwinHall:function(a){return function(){for(var b=0,c=0;c<a;c++)b+=Math.random();return b}}},Sf.scale={};var hi={floor:xa,ceil:xa};Sf.scale.linear=function(){return Le([0,1],[0,1],md,!1)};var ii={s:1,g:1,p:1,r:1,e:1};Sf.scale.log=function(){return Te(Sf.scale.linear().domain([0,1]),10,!0,[1,10])};var ji=Sf.format(".0e"),ki={floor:function(a){return-Math.ceil(-a)},ceil:function(a){return-Math.floor(-a)}};Sf.scale.pow=function(){return Ue(Sf.scale.linear(),1,[0,1])},Sf.scale.sqrt=function(){return Sf.scale.pow().exponent(.5)},Sf.scale.ordinal=function(){return We([],{t:"range",a:[[]]})},Sf.scale.category10=function(){return Sf.scale.ordinal().range(li)},Sf.scale.category20=function(){return Sf.scale.ordinal().range(mi)},Sf.scale.category20b=function(){return Sf.scale.ordinal().range(ni)},Sf.scale.category20c=function(){return Sf.scale.ordinal().range(oi)};var li=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(pa),mi=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(pa),ni=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(pa),oi=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(pa);Sf.scale.quantile=function(){return Xe([],[])},Sf.scale.quantize=function(){return Ye(0,1,[0,1])},Sf.scale.threshold=function(){return Ze([.5],[0,1])},Sf.scale.identity=function(){return $e([0,1])},Sf.svg={},Sf.svg.arc=function(){function a(){var a=b.apply(this,arguments),f=c.apply(this,arguments),g=d.apply(this,arguments)+pi,h=e.apply(this,arguments)+pi,i=(h<g&&(i=g,g=h,h=i),h-g),j=i<ug?"0":"1",k=Math.cos(g),l=Math.sin(g),m=Math.cos(h),n=Math.sin(h);return i>=qi?a?"M0,"+f+"A"+f+","+f+" 0 1,1 0,"+-f+"A"+f+","+f+" 0 1,1 0,"+f+"M0,"+a+"A"+a+","+a+" 0 1,0 0,"+-a+"A"+a+","+a+" 0 1,0 0,"+a+"Z":"M0,"+f+"A"+f+","+f+" 0 1,1 0,"+-f+"A"+f+","+f+" 0 1,1 0,"+f+"Z":a?"M"+f*k+","+f*l+"A"+f+","+f+" 0 "+j+",1 "+f*m+","+f*n+"L"+a*m+","+a*n+"A"+a+","+a+" 0 "+j+",0 "+a*k+","+a*l+"Z":"M"+f*k+","+f*l+"A"+f+","+f+" 0 "+j+",1 "+f*m+","+f*n+"L0,0Z"}var b=_e,c=af,d=bf,e=cf;return a.innerRadius=function(c){return arguments.length?(b=wa(c),a):b},a.outerRadius=function(b){return arguments.length?(c=wa(b),a):c},a.startAngle=function(b){return arguments.length?(d=wa(b),a):d},a.endAngle=function(b){return arguments.length?(e=wa(b),a):e},a.centroid=function(){var a=(b.apply(this,arguments)+c.apply(this,arguments))/2,f=(d.apply(this,arguments)+e.apply(this,arguments))/2+pi;return[Math.cos(f)*a,Math.sin(f)*a]},a};var pi=-wg,qi=vg-xg;Sf.svg.line=function(){return df(xa)};var ri=Sf.map({linear:ef,"linear-closed":ff,step:gf,"step-before":hf,"step-after":jf,basis:pf,"basis-open":qf,"basis-closed":rf,bundle:sf,cardinal:mf,"cardinal-open":kf,"cardinal-closed":lf,monotone:yf});ri.forEach(function(a,b){b.key=a,b.closed=/-closed$/.test(a)});var si=[0,2/3,1/3,0],ti=[0,1/3,2/3,0],ui=[0,1/6,2/3,1/6];Sf.svg.line.radial=function(){var a=df(zf);return a.radius=a.x,delete a.x,a.angle=a.y,delete a.y,a},hf.reverse=jf,jf.reverse=hf,Sf.svg.area=function(){return Af(xa)},Sf.svg.area.radial=function(){var a=Af(zf);return a.radius=a.x,delete a.x,a.innerRadius=a.x0,delete a.x0,a.outerRadius=a.x1,delete a.x1,a.angle=a.y,delete a.y,a.startAngle=a.y0,delete a.y0,a.endAngle=a.y1,delete a.y1,a},Sf.svg.chord=function(){function a(a,h){var i=b(this,f,a,h),j=b(this,g,a,h);return"M"+i.p0+d(i.r,i.p1,i.a1-i.a0)+(c(i,j)?e(i.r,i.p1,i.r,i.p0):e(i.r,i.p1,j.r,j.p0)+d(j.r,j.p1,j.a1-j.a0)+e(j.r,j.p1,i.r,i.p0))+"Z"}function b(a,b,c,d){var e=b.call(a,c,d),f=h.call(a,e,d),g=i.call(a,e,d)+pi,k=j.call(a,e,d)+pi;return{r:f,a0:g,a1:k,p0:[f*Math.cos(g),f*Math.sin(g)],p1:[f*Math.cos(k),f*Math.sin(k)]}}function c(a,b){return a.a0==b.a0&&a.a1==b.a1}function d(a,b,c){return"A"+a+","+a+" 0 "+ +(c>ug)+",1 "+b}function e(a,b,c,d){return"Q 0,0 "+d}var f=nc,g=oc,h=Bf,i=bf,j=cf;return a.radius=function(b){return arguments.length?(h=wa(b),a):h},a.source=function(b){return arguments.length?(f=wa(b),a):f},a.target=function(b){return arguments.length?(g=wa(b),a):g},a.startAngle=function(b){return arguments.length?(i=wa(b),a):i},a.endAngle=function(b){return arguments.length?(j=wa(b),a):j},a},Sf.svg.diagonal=function(){function a(a,e){var f=b.call(this,a,e),g=c.call(this,a,e),h=(f.y+g.y)/2,i=[f,{x:f.x,y:h},{x:g.x,y:h},g];return i=i.map(d),"M"+i[0]+"C"+i[1]+" "+i[2]+" "+i[3]}var b=nc,c=oc,d=Cf;return a.source=function(c){return arguments.length?(b=wa(c),a):b},a.target=function(b){return arguments.length?(c=wa(b),a):c},a.projection=function(b){return arguments.length?(d=b,a):d},a},Sf.svg.diagonal.radial=function(){var a=Sf.svg.diagonal(),b=Cf,c=a.projection;return a.projection=function(a){return arguments.length?c(Df(b=a)):b},a},Sf.svg.symbol=function(){function a(a,d){return(vi.get(b.call(this,a,d))||Gf)(c.call(this,a,d))}var b=Ff,c=Ef;return a.type=function(c){return arguments.length?(b=wa(c),a):b},a.size=function(b){return arguments.length?(c=wa(b),a):c},a};var vi=Sf.map({circle:Gf,cross:function(a){var b=Math.sqrt(a/5)/2;return"M"+-3*b+","+-b+"H"+-b+"V"+-3*b+"H"+b+"V"+-b+"H"+3*b+"V"+b+"H"+b+"V"+3*b+"H"+-b+"V"+b+"H"+-3*b+"Z"},diamond:function(a){var b=Math.sqrt(a/(2*zi)),c=b*zi;return"M0,"+-b+"L"+c+",0 0,"+b+" "+-c+",0Z"},square:function(a){var b=Math.sqrt(a)/2;return"M"+-b+","+-b+"L"+b+","+-b+" "+b+","+b+" "+-b+","+b+"Z"},"triangle-down":function(a){var b=Math.sqrt(a/yi),c=b*yi/2;return"M0,"+c+"L"+b+","+-c+" "+-b+","+-c+"Z"},"triangle-up":function(a){var b=Math.sqrt(a/yi),c=b*yi/2;return"M0,"+-c+"L"+b+","+c+" "+-b+","+c+"Z"}});Sf.svg.symbolTypes=vi.keys();var wi,xi,yi=Math.sqrt(3),zi=Math.tan(30*zg),Ai=[],Bi=0;Ai.call=mg.call,Ai.empty=mg.empty,Ai.node=mg.node,Ai.size=mg.size,Sf.transition=function(a){return arguments.length?wi?a.transition():a:pg.transition()},Sf.transition.prototype=Ai,Ai.select=function(a){var b,c,d,e=this.id,f=[];a=w(a);for(var g=-1,h=this.length;++g<h;){f.push(b=[]);for(var i=this[g],j=-1,k=i.length;++j<k;)(d=i[j])&&(c=a.call(d,d.__data__,j,g))?("__data__"in d&&(c.__data__=d.__data__),Kf(c,j,e,d.__transition__[e]),b.push(c)):b.push(null)}return Hf(f,e)},Ai.selectAll=function(a){var b,c,d,e,f,g=this.id,h=[];a=x(a);for(var i=-1,j=this.length;++i<j;)for(var k=this[i],l=-1,m=k.length;++l<m;)if(d=k[l]){f=d.__transition__[g],c=a.call(d,d.__data__,l,i),h.push(b=[]);for(var n=-1,o=c.length;++n<o;)(e=c[n])&&Kf(e,n,g,f),b.push(e)}return Hf(h,g)},Ai.filter=function(a){var b,c,d,e=[];"function"!=typeof a&&(a=I(a));for(var f=0,g=this.length;f<g;f++){e.push(b=[]);for(var c=this[f],h=0,i=c.length;h<i;h++)(d=c[h])&&a.call(d,d.__data__,h,f)&&b.push(d)}return Hf(e,this.id)},Ai.tween=function(a,b){var c=this.id;return arguments.length<2?this.node().__transition__[c].tween.get(a):K(this,null==b?function(b){b.__transition__[c].tween.remove(a)}:function(d){d.__transition__[c].tween.set(a,b)})},Ai.attr=function(a,b){function c(){this.removeAttribute(h)}function d(){this.removeAttributeNS(h.space,h.local)}function e(a){return null==a?c:(a+="",function(){var b,c=this.getAttribute(h);return c!==a&&(b=g(c,a),function(a){this.setAttribute(h,b(a))})})}function f(a){return null==a?d:(a+="",function(){var b,c=this.getAttributeNS(h.space,h.local);return c!==a&&(b=g(c,a),function(a){this.setAttributeNS(h.space,h.local,b(a))})})}if(arguments.length<2){for(b in a)this.attr(b,a[b]);return this}var g="transform"==a?Jd:md,h=Sf.ns.qualify(a);return If(this,"attr."+a,b,h.local?f:e)},Ai.attrTween=function(a,b){function c(a,c){var d=b.call(this,a,c,this.getAttribute(e));return d&&function(a){this.setAttribute(e,d(a))}}function d(a,c){var d=b.call(this,a,c,this.getAttributeNS(e.space,e.local));return d&&function(a){this.setAttributeNS(e.space,e.local,d(a))}}var e=Sf.ns.qualify(a);return this.tween("attr."+a,e.local?d:c)},Ai.style=function(a,b,c){function d(){this.style.removeProperty(a)}function e(b){return null==b?d:(b+="",function(){var d,e=Xf.getComputedStyle(this,null).getPropertyValue(a);return e!==b&&(d=md(e,b),function(b){this.style.setProperty(a,d(b),c)})})}var f=arguments.length;if(f<3){if("string"!=typeof a){f<2&&(b="");for(c in a)this.style(c,a[c],b);return this}c=""}return If(this,"style."+a,b,e)},Ai.styleTween=function(a,b,c){function d(d,e){
var f=b.call(this,d,e,Xf.getComputedStyle(this,null).getPropertyValue(a));return f&&function(b){this.style.setProperty(a,f(b),c)}}return arguments.length<3&&(c=""),this.tween("style."+a,d)},Ai.text=function(a){return If(this,"text",a,Jf)},Ai.remove=function(){return this.each("end.transition",function(){var a;this.__transition__.count<2&&(a=this.parentNode)&&a.removeChild(this)})},Ai.ease=function(a){var b=this.id;return arguments.length<1?this.node().__transition__[b].ease:("function"!=typeof a&&(a=Sf.ease.apply(Sf,arguments)),K(this,function(c){c.__transition__[b].ease=a}))},Ai.delay=function(a){var b=this.id;return arguments.length<1?this.node().__transition__[b].delay:K(this,"function"==typeof a?function(c,d,e){c.__transition__[b].delay=+a.call(c,c.__data__,d,e)}:(a=+a,function(c){c.__transition__[b].delay=a}))},Ai.duration=function(a){var b=this.id;return arguments.length<1?this.node().__transition__[b].duration:K(this,"function"==typeof a?function(c,d,e){c.__transition__[b].duration=Math.max(1,a.call(c,c.__data__,d,e))}:(a=Math.max(1,a),function(c){c.__transition__[b].duration=a}))},Ai.each=function(a,b){var c=this.id;if(arguments.length<2){var d=xi,e=wi;wi=c,K(this,function(b,d,e){xi=b.__transition__[c],a.call(b,b.__data__,d,e)}),xi=d,wi=e}else K(this,function(d){var e=d.__transition__[c];(e.event||(e.event=Sf.dispatch("start","end"))).on(a,b)});return this},Ai.transition=function(){for(var a,b,c,d,e=this.id,f=++Bi,g=[],h=0,i=this.length;h<i;h++){g.push(a=[]);for(var b=this[h],j=0,k=b.length;j<k;j++)(c=b[j])&&(d=Object.create(c.__transition__[e]),d.delay+=d.duration,Kf(c,j,f,d)),a.push(c)}return Hf(g,f)},Sf.svg.axis=function(){function a(a){a.each(function(){var a,j=Sf.select(this),k=this.__chart__||c,l=this.__chart__=c.copy(),m=null==i?l.ticks?l.ticks.apply(l,h):l.domain():i,n=null==b?l.tickFormat?l.tickFormat.apply(l,h):xa:b,o=j.selectAll(".tick").data(m,l),p=o.enter().insert("g",".domain").attr("class","tick").style("opacity",xg),q=Sf.transition(o.exit()).style("opacity",xg).remove(),r=Sf.transition(o.order()).style("opacity",1),s=Ge(l),t=j.selectAll(".domain").data([0]),u=(t.enter().append("path").attr("class","domain"),Sf.transition(t));p.append("line"),p.append("text");var v=p.select("line"),w=r.select("line"),x=o.select("text").text(n),y=p.select("text"),z=r.select("text");switch(d){case"bottom":a=Lf,v.attr("y2",e),y.attr("y",Math.max(e,0)+g),w.attr("x2",0).attr("y2",e),z.attr("x",0).attr("y",Math.max(e,0)+g),x.attr("dy",".71em").style("text-anchor","middle"),u.attr("d","M"+s[0]+","+f+"V0H"+s[1]+"V"+f);break;case"top":a=Lf,v.attr("y2",-e),y.attr("y",-(Math.max(e,0)+g)),w.attr("x2",0).attr("y2",-e),z.attr("x",0).attr("y",-(Math.max(e,0)+g)),x.attr("dy","0em").style("text-anchor","middle"),u.attr("d","M"+s[0]+","+-f+"V0H"+s[1]+"V"+-f);break;case"left":a=Mf,v.attr("x2",-e),y.attr("x",-(Math.max(e,0)+g)),w.attr("x2",-e).attr("y2",0),z.attr("x",-(Math.max(e,0)+g)).attr("y",0),x.attr("dy",".32em").style("text-anchor","end"),u.attr("d","M"+-f+","+s[0]+"H0V"+s[1]+"H"+-f);break;case"right":a=Mf,v.attr("x2",e),y.attr("x",Math.max(e,0)+g),w.attr("x2",e).attr("y2",0),z.attr("x",Math.max(e,0)+g).attr("y",0),x.attr("dy",".32em").style("text-anchor","start"),u.attr("d","M"+f+","+s[0]+"H0V"+s[1]+"H"+f)}if(l.rangeBand){var A=l,B=A.rangeBand()/2;k=l=function(a){return A(a)+B}}else k.rangeBand?k=l:q.call(a,l);p.call(a,k),r.call(a,l)})}var b,c=Sf.scale.linear(),d=Ci,e=6,f=6,g=3,h=[10],i=null;return a.scale=function(b){return arguments.length?(c=b,a):c},a.orient=function(b){return arguments.length?(d=b in Di?b+"":Ci,a):d},a.ticks=function(){return arguments.length?(h=arguments,a):h},a.tickValues=function(b){return arguments.length?(i=b,a):i},a.tickFormat=function(c){return arguments.length?(b=c,a):b},a.tickSize=function(b){var c=arguments.length;return c?(e=+b,f=+arguments[c-1],a):e},a.innerTickSize=function(b){return arguments.length?(e=+b,a):e},a.outerTickSize=function(b){return arguments.length?(f=+b,a):f},a.tickPadding=function(b){return arguments.length?(g=+b,a):g},a.tickSubdivide=function(){return arguments.length&&a},a};var Ci="bottom",Di={top:1,right:1,bottom:1,left:1};Sf.svg.brush=function(){function a(f){f.each(function(){var f=Sf.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",e).on("touchstart.brush",e),g=f.selectAll(".background").data([0]);g.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),f.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var h=f.selectAll(".resize").data(o,xa);h.exit().remove(),h.enter().append("g").attr("class",function(a){return"resize "+a}).style("cursor",function(a){return Ei[a]}).append("rect").attr("x",function(a){return/[ew]$/.test(a)?-3:null}).attr("y",function(a){return/^[ns]/.test(a)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),h.style("display",a.empty()?"none":null);var k,l=Sf.transition(f),m=Sf.transition(g);i&&(k=Ge(i),m.attr("x",k[0]).attr("width",k[1]-k[0]),c(l)),j&&(k=Ge(j),m.attr("y",k[0]).attr("height",k[1]-k[0]),d(l)),b(l)})}function b(a){a.selectAll(".resize").attr("transform",function(a){return"translate("+k[+/e$/.test(a)]+","+l[+/^s/.test(a)]+")"})}function c(a){a.select(".extent").attr("x",k[0]),a.selectAll(".extent,.n>rect,.s>rect").attr("width",k[1]-k[0])}function d(a){a.select(".extent").attr("y",l[0]),a.selectAll(".extent,.e>rect,.w>rect").attr("height",l[1]-l[0])}function e(){function e(){32==Sf.event.keyCode&&(C||(t=null,E[0]-=k[1],E[1]-=l[1],C=2),s())}function o(){32==Sf.event.keyCode&&2==C&&(E[0]+=k[1],E[1]+=l[1],C=0,s())}function p(){var a=Sf.mouse(v),e=!1;u&&(a[0]+=u[0],a[1]+=u[1]),C||(Sf.event.altKey?(t||(t=[(k[0]+k[1])/2,(l[0]+l[1])/2]),E[0]=k[+(a[0]<t[0])],E[1]=l[+(a[1]<t[1])]):t=null),A&&q(a,i,0)&&(c(y),e=!0),B&&q(a,j,1)&&(d(y),e=!0),e&&(b(y),x({type:"brush",mode:C?"move":"resize"}))}function q(a,b,c){var d,e,h=Ge(b),i=h[0],j=h[1],o=E[c],p=c?l:k,q=p[1]-p[0];if(C&&(i-=o,j-=q+o),d=(c?n:m)?Math.max(i,Math.min(j,a[c])):a[c],C?e=(d+=o)+q:(t&&(o=Math.max(i,Math.min(j,2*t[c]-d))),o<d?(e=d,d=o):e=o),p[0]!=d||p[1]!=e)return c?g=null:f=null,p[0]=d,p[1]=e,!0}function r(){p(),y.style("pointer-events","all").selectAll(".resize").style("display",a.empty()?"none":null),Sf.select("body").style("cursor",null),F.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),D(),x({type:"brushend"})}var t,u,v=this,w=Sf.select(Sf.event.target),x=h.of(v,arguments),y=Sf.select(v),z=w.datum(),A=!/^(n|s)$/.test(z)&&i,B=!/^(e|w)$/.test(z)&&j,C=w.classed("extent"),D=R(),E=Sf.mouse(v),F=Sf.select(Xf).on("keydown.brush",e).on("keyup.brush",o);if(Sf.event.changedTouches?F.on("touchmove.brush",p).on("touchend.brush",r):F.on("mousemove.brush",p).on("mouseup.brush",r),y.interrupt().selectAll("*").interrupt(),C)E[0]=k[0]-E[0],E[1]=l[0]-E[1];else if(z){var G=+/w$/.test(z),H=+/^n/.test(z);u=[k[1-G]-E[0],l[1-H]-E[1]],E[0]=k[G],E[1]=l[H]}else Sf.event.altKey&&(t=E.slice());y.style("pointer-events","none").selectAll(".resize").style("display",null),Sf.select("body").style("cursor",w.style("cursor")),x({type:"brushstart"}),p()}var f,g,h=u(a,"brushstart","brush","brushend"),i=null,j=null,k=[0,0],l=[0,0],m=!0,n=!0,o=Fi[0];return a.event=function(a){a.each(function(){var a=h.of(this,arguments),b={x:k,y:l,i:f,j:g},c=this.__chart__||b;this.__chart__=b,wi?Sf.select(this).transition().each("start.brush",function(){f=c.i,g=c.j,k=c.x,l=c.y,a({type:"brushstart"})}).tween("brush:brush",function(){var c=nd(k,b.x),d=nd(l,b.y);return f=g=null,function(e){k=b.x=c(e),l=b.y=d(e),a({type:"brush",mode:"resize"})}}).each("end.brush",function(){f=b.i,g=b.j,a({type:"brush",mode:"resize"}),a({type:"brushend"})}):(a({type:"brushstart"}),a({type:"brush",mode:"resize"}),a({type:"brushend"}))})},a.x=function(b){return arguments.length?(i=b,o=Fi[!i<<1|!j],a):i},a.y=function(b){return arguments.length?(j=b,o=Fi[!i<<1|!j],a):j},a.clamp=function(b){return arguments.length?(i&&j?(m=!!b[0],n=!!b[1]):i?m=!!b:j&&(n=!!b),a):i&&j?[m,n]:i?m:j?n:null},a.extent=function(b){var c,d,e,h,m;return arguments.length?(i&&(c=b[0],d=b[1],j&&(c=c[0],d=d[0]),f=[c,d],i.invert&&(c=i(c),d=i(d)),d<c&&(m=c,c=d,d=m),c==k[0]&&d==k[1]||(k=[c,d])),j&&(e=b[0],h=b[1],i&&(e=e[1],h=h[1]),g=[e,h],j.invert&&(e=j(e),h=j(h)),h<e&&(m=e,e=h,h=m),e==l[0]&&h==l[1]||(l=[e,h])),a):(i&&(f?(c=f[0],d=f[1]):(c=k[0],d=k[1],i.invert&&(c=i.invert(c),d=i.invert(d)),d<c&&(m=c,c=d,d=m))),j&&(g?(e=g[0],h=g[1]):(e=l[0],h=l[1],j.invert&&(e=j.invert(e),h=j.invert(h)),h<e&&(m=e,e=h,h=m))),i&&j?[[c,e],[d,h]]:i?[c,d]:j&&[e,h])},a.clear=function(){return a.empty()||(k=[0,0],l=[0,0],f=g=null),a},a.empty=function(){return!!i&&k[0]==k[1]||!!j&&l[0]==l[1]},Sf.rebind(a,h,"on")};var Ei={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},Fi=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]],Gi=Zg.format=dh.timeFormat,Hi=Gi.utc,Ii=Hi("%Y-%m-%dT%H:%M:%S.%LZ");Gi.iso=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?Nf:Ii,Nf.parse=function(a){var b=new Date(a);return isNaN(b)?null:b},Nf.toString=Ii.toString,Zg.second=Ja(function(a){return new $g(1e3*Math.floor(a/1e3))},function(a,b){a.setTime(a.getTime()+1e3*Math.floor(b))},function(a){return a.getSeconds()}),Zg.seconds=Zg.second.range,Zg.seconds.utc=Zg.second.utc.range,Zg.minute=Ja(function(a){return new $g(6e4*Math.floor(a/6e4))},function(a,b){a.setTime(a.getTime()+6e4*Math.floor(b))},function(a){return a.getMinutes()}),Zg.minutes=Zg.minute.range,Zg.minutes.utc=Zg.minute.utc.range,Zg.hour=Ja(function(a){var b=a.getTimezoneOffset()/60;return new $g(36e5*(Math.floor(a/36e5-b)+b))},function(a,b){a.setTime(a.getTime()+36e5*Math.floor(b))},function(a){return a.getHours()}),Zg.hours=Zg.hour.range,Zg.hours.utc=Zg.hour.utc.range,Zg.month=Ja(function(a){return a=Zg.day(a),a.setDate(1),a},function(a,b){a.setMonth(a.getMonth()+b)},function(a){return a.getMonth()}),Zg.months=Zg.month.range,Zg.months.utc=Zg.month.utc.range;var Ji=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6],Ki=[[Zg.second,1],[Zg.second,5],[Zg.second,15],[Zg.second,30],[Zg.minute,1],[Zg.minute,5],[Zg.minute,15],[Zg.minute,30],[Zg.hour,1],[Zg.hour,3],[Zg.hour,6],[Zg.hour,12],[Zg.day,1],[Zg.day,2],[Zg.week,1],[Zg.month,1],[Zg.month,3],[Zg.year,1]],Li=Gi.multi([[".%L",function(a){return a.getMilliseconds()}],[":%S",function(a){return a.getSeconds()}],["%I:%M",function(a){return a.getMinutes()}],["%I %p",function(a){return a.getHours()}],["%a %d",function(a){return a.getDay()&&1!=a.getDate()}],["%b %d",function(a){return 1!=a.getDate()}],["%B",function(a){return a.getMonth()}],["%Y",xb]]),Mi={range:function(a,b,c){return Sf.range(Math.ceil(a/c)*c,+b,c).map(Pf)},floor:xa,ceil:xa};Ki.year=Zg.year,Zg.scale=function(){return Of(Sf.scale.linear(),Ki,Li)};var Ni=Ki.map(function(a){return[a[0].utc,a[1]]}),Oi=Hi.multi([[".%L",function(a){return a.getUTCMilliseconds()}],[":%S",function(a){return a.getUTCSeconds()}],["%I:%M",function(a){return a.getUTCMinutes()}],["%I %p",function(a){return a.getUTCHours()}],["%a %d",function(a){return a.getUTCDay()&&1!=a.getUTCDate()}],["%b %d",function(a){return 1!=a.getUTCDate()}],["%B",function(a){return a.getUTCMonth()}],["%Y",xb]]);return Ni.year=Zg.year.utc,Zg.scale.utc=function(){return Of(Sf.scale.linear(),Ni,Oi)},Sf.text=ya(function(a){return a.responseText}),Sf.json=function(a,b){return za(a,"application/json",Qf,b)},Sf.html=function(a,b){return za(a,"text/html",Rf,b)},Sf.xml=ya(function(a){return a.responseXML}),Sf}()},{}],257:[function(b,c,d){(function(d,e){(function(){"use strict";function f(a){return"function"==typeof a||"object"==typeof a&&null!==a}function g(a){return"function"==typeof a}function h(a){return"object"==typeof a&&null!==a}function i(a){U=a}function j(a){Y=a}function k(){var a=d.nextTick,b=d.versions.node.match(/^(?:(\d+)\.)?(?:(\d+)\.)?(\*|\d+)$/);return Array.isArray(b)&&"0"===b[1]&&"10"===b[2]&&(a=setImmediate),function(){a(p)}}function l(){return function(){T(p)}}function m(){var a=0,b=new _(p),c=document.createTextNode("");return b.observe(c,{characterData:!0}),function(){c.data=a=++a%2}}function n(){var a=new MessageChannel;return a.port1.onmessage=p,function(){a.port2.postMessage(0)}}function o(){return function(){setTimeout(p,1)}}function p(){for(var a=0;a<X;a+=2){(0,ca[a])(ca[a+1]),ca[a]=void 0,ca[a+1]=void 0}X=0}function q(){try{var a=b,c=a("vertx");return T=c.runOnLoop||c.runOnContext,l()}catch(a){return o()}}function r(){}function s(){return new TypeError("You cannot resolve a promise with itself")}function t(){return new TypeError("A promises callback cannot return that same promise.")}function u(a){try{return a.then}catch(a){return ga.error=a,ga}}function v(a,b,c,d){try{a.call(b,c,d)}catch(a){return a}}function w(a,b,c){Y(function(a){var d=!1,e=v(c,b,function(c){d||(d=!0,b!==c?z(a,c):B(a,c))},function(b){d||(d=!0,C(a,b))},"Settle: "+(a._label||" unknown promise"));!d&&e&&(d=!0,C(a,e))},a)}function x(a,b){b._state===ea?B(a,b._result):b._state===fa?C(a,b._result):D(b,void 0,function(b){z(a,b)},function(b){C(a,b)})}function y(a,b){if(b.constructor===a.constructor)x(a,b);else{var c=u(b);c===ga?C(a,ga.error):void 0===c?B(a,b):g(c)?w(a,b,c):B(a,b)}}function z(a,b){a===b?C(a,s()):f(b)?y(a,b):B(a,b)}function A(a){a._onerror&&a._onerror(a._result),E(a)}function B(a,b){a._state===da&&(a._result=b,a._state=ea,0!==a._subscribers.length&&Y(E,a))}function C(a,b){a._state===da&&(a._state=fa,a._result=b,Y(A,a))}function D(a,b,c,d){var e=a._subscribers,f=e.length;a._onerror=null,e[f]=b,e[f+ea]=c,e[f+fa]=d,0===f&&a._state&&Y(E,a)}function E(a){var b=a._subscribers,c=a._state;if(0!==b.length){for(var d,e,f=a._result,g=0;g<b.length;g+=3)d=b[g],e=b[g+c],d?H(c,d,e,f):e(f);a._subscribers.length=0}}function F(){this.error=null}function G(a,b){try{return a(b)}catch(a){return ha.error=a,ha}}function H(a,b,c,d){var e,f,h,i,j=g(c);if(j){if(e=G(c,d),e===ha?(i=!0,f=e.error,e=null):h=!0,b===e)return void C(b,t())}else e=d,h=!0;b._state!==da||(j&&h?z(b,e):i?C(b,f):a===ea?B(b,e):a===fa&&C(b,e))}function I(a,b){try{b(function(b){z(a,b)},function(b){C(a,b)})}catch(b){C(a,b)}}function J(a,b){var c=this;c._instanceConstructor=a,c.promise=new a(r),c._validateInput(b)?(c._input=b,c.length=b.length,c._remaining=b.length,c._init(),0===c.length?B(c.promise,c._result):(c.length=c.length||0,c._enumerate(),0===c._remaining&&B(c.promise,c._result))):C(c.promise,c._validationError())}function K(a){return new ia(this,a).promise}function L(a){function b(a){z(e,a)}function c(a){C(e,a)}var d=this,e=new d(r);if(!W(a))return C(e,new TypeError("You must pass an array to race.")),e;for(var f=a.length,g=0;e._state===da&&g<f;g++)D(d.resolve(a[g]),void 0,b,c);return e}function M(a){var b=this;if(a&&"object"==typeof a&&a.constructor===b)return a;var c=new b(r);return z(c,a),c}function N(a){var b=this,c=new b(r);return C(c,a),c}function O(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function P(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function Q(a){this._id=na++,this._state=void 0,this._result=void 0,this._subscribers=[],r!==a&&(g(a)||O(),this instanceof Q||P(),I(this,a))}function R(){var a;if(void 0!==e)a=e;else if("undefined"!=typeof self)a=self;else try{a=Function("return this")()}catch(a){throw new Error("polyfill failed because global object is unavailable in this environment")}var b=a.Promise;b&&"[object Promise]"===Object.prototype.toString.call(b.resolve())&&!b.cast||(a.Promise=oa)}var S;S=Array.isArray?Array.isArray:function(a){return"[object Array]"===Object.prototype.toString.call(a)};var T,U,V,W=S,X=0,Y=function(a,b){ca[X]=a,ca[X+1]=b,2===(X+=2)&&(U?U(p):V())},Z="undefined"!=typeof window?window:void 0,$=Z||{},_=$.MutationObserver||$.WebKitMutationObserver,aa=void 0!==d&&"[object process]"==={}.toString.call(d),ba="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,ca=new Array(1e3);V=aa?k():_?m():ba?n():void 0===Z&&"function"==typeof b?q():o();var da=void 0,ea=1,fa=2,ga=new F,ha=new F;J.prototype._validateInput=function(a){return W(a)},J.prototype._validationError=function(){return new Error("Array Methods must be provided an Array")},J.prototype._init=function(){this._result=new Array(this.length)};var ia=J;J.prototype._enumerate=function(){for(var a=this,b=a.length,c=a.promise,d=a._input,e=0;c._state===da&&e<b;e++)a._eachEntry(d[e],e)},J.prototype._eachEntry=function(a,b){var c=this,d=c._instanceConstructor;h(a)?a.constructor===d&&a._state!==da?(a._onerror=null,c._settledAt(a._state,b,a._result)):c._willSettleAt(d.resolve(a),b):(c._remaining--,c._result[b]=a)},J.prototype._settledAt=function(a,b,c){var d=this,e=d.promise;e._state===da&&(d._remaining--,a===fa?C(e,c):d._result[b]=c),0===d._remaining&&B(e,d._result)},J.prototype._willSettleAt=function(a,b){var c=this;D(a,void 0,function(a){c._settledAt(ea,b,a)},function(a){c._settledAt(fa,b,a)})};var ja=K,ka=L,la=M,ma=N,na=0,oa=Q;Q.all=ja,Q.race=ka,Q.resolve=la,Q.reject=ma,Q._setScheduler=i,Q._setAsap=j,Q._asap=Y,Q.prototype={constructor:Q,then:function(a,b){var c=this,d=c._state;if(d===ea&&!a||d===fa&&!b)return this;var e=new this.constructor(r),f=c._result;if(d){var g=arguments[d-1];Y(function(){H(d,e,g,f)})}else D(c,e,a,b);return e},catch:function(a){return this.then(null,a)}};var pa=R,qa={Promise:oa,polyfill:pa};"function"==typeof a&&a.amd?a(function(){return qa}):void 0!==c&&c.exports?c.exports=qa:void 0!==this&&(this.ES6Promise=qa),pa()}).call(this)}).call(this,b("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:291}],258:[function(a,b,c){function d(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function e(a){return"function"==typeof a}function f(a){return"number"==typeof a}function g(a){return"object"==typeof a&&null!==a}function h(a){return void 0===a}b.exports=d,d.EventEmitter=d,d.prototype._events=void 0,d.prototype._maxListeners=void 0,d.defaultMaxListeners=10,d.prototype.setMaxListeners=function(a){if(!f(a)||a<0||isNaN(a))throw TypeError("n must be a positive number");return this._maxListeners=a,this},d.prototype.emit=function(a){var b,c,d,f,i,j;if(this._events||(this._events={}),"error"===a&&(!this._events.error||g(this._events.error)&&!this._events.error.length)){if((b=arguments[1])instanceof Error)throw b;throw TypeError('Uncaught, unspecified "error" event.')}if(c=this._events[a],h(c))return!1;if(e(c))switch(arguments.length){case 1:c.call(this);break;case 2:c.call(this,arguments[1]);break;case 3:c.call(this,arguments[1],arguments[2]);break;default:for(d=arguments.length,f=new Array(d-1),i=1;i<d;i++)f[i-1]=arguments[i];c.apply(this,f)}else if(g(c)){for(d=arguments.length,f=new Array(d-1),i=1;i<d;i++)f[i-1]=arguments[i];for(j=c.slice(),d=j.length,i=0;i<d;i++)j[i].apply(this,f)}return!0},d.prototype.addListener=function(a,b){var c;if(!e(b))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",a,e(b.listener)?b.listener:b),this._events[a]?g(this._events[a])?this._events[a].push(b):this._events[a]=[this._events[a],b]:this._events[a]=b,g(this._events[a])&&!this._events[a].warned){var c;c=h(this._maxListeners)?d.defaultMaxListeners:this._maxListeners,c&&c>0&&this._events[a].length>c&&(this._events[a].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[a].length),"function"==typeof console.trace&&console.trace())}return this},d.prototype.on=d.prototype.addListener,d.prototype.once=function(a,b){function c(){this.removeListener(a,c),d||(d=!0,b.apply(this,arguments))}if(!e(b))throw TypeError("listener must be a function");var d=!1;return c.listener=b,this.on(a,c),this},d.prototype.removeListener=function(a,b){var c,d,f,h;if(!e(b))throw TypeError("listener must be a function");if(!this._events||!this._events[a])return this;if(c=this._events[a],f=c.length,d=-1,c===b||e(c.listener)&&c.listener===b)delete this._events[a],this._events.removeListener&&this.emit("removeListener",a,b);else if(g(c)){for(h=f;h-- >0;)if(c[h]===b||c[h].listener&&c[h].listener===b){d=h;break}if(d<0)return this;1===c.length?(c.length=0,delete this._events[a]):c.splice(d,1),this._events.removeListener&&this.emit("removeListener",a,b)}return this},d.prototype.removeAllListeners=function(a){var b,c;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[a]&&delete this._events[a],this;if(0===arguments.length){for(b in this._events)"removeListener"!==b&&this.removeAllListeners(b);return this.removeAllListeners("removeListener"),this._events={},this}if(c=this._events[a],e(c))this.removeListener(a,c);else for(;c.length;)this.removeListener(a,c[c.length-1]);return delete this._events[a],this},d.prototype.listeners=function(a){return this._events&&this._events[a]?e(this._events[a])?[this._events[a]]:this._events[a].slice():[]},d.listenerCount=function(a,b){return a._events&&a._events[b]?e(a._events[b])?1:a._events[b].length:0}},{}],259:[function(a,b,c){var d=b.exports,e=(a("events").EventEmitter,a("./lib/request")),f=a("url");d.request=function(a,b){"string"==typeof a&&(a=f.parse(a)),a||(a={}),a.host||a.port||(a.port=parseInt(window.location.port,10)),!a.host&&a.hostname&&(a.host=a.hostname),a.protocol||(a.scheme?a.protocol=a.scheme+":":a.protocol=window.location.protocol),a.host||(a.host=window.location.hostname||window.location.host),/:/.test(a.host)&&(a.port||(a.port=a.host.split(":")[1]),a.host=a.host.split(":")[0]),a.port||(a.port="https:"==a.protocol?443:80);var c=new e(new g,a);return b&&c.on("response",b),c},d.get=function(a,b){a.method="GET";var c=d.request(a,b);return c.end(),c},d.Agent=function(){},d.Agent.defaultMaxSockets=4;var g=function(){if("undefined"==typeof window)throw new Error("no window object present");if(window.XMLHttpRequest)return window.XMLHttpRequest;if(window.ActiveXObject){for(var a=["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.3.0","Microsoft.XMLHTTP"],b=0;b<a.length;b++)try{var c=new window.ActiveXObject(a[b]);return function(){if(c){var d=c;return c=null,d}return new window.ActiveXObject(a[b])}}catch(a){}throw new Error("ajax not supported in this browser")}throw new Error("ajax not supported in this browser")}();d.STATUS_CODES={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",300:"Multiple Choices",301:"Moved Permanently",302:"Moved Temporarily",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Time-out",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Large",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",418:"I'm a teapot",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Unordered Collection",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Time-out",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",509:"Bandwidth Limit Exceeded",510:"Not Extended",511:"Network Authentication Required"}},{"./lib/request":260,events:258,url:311}],260:[function(a,b,c){var d=a("stream"),e=a("./response"),f=a("Base64"),g=a("inherits"),h=b.exports=function(a,b){var c=this;c.writable=!0,c.xhr=a,c.body=[],c.uri=(b.protocol||"http:")+"//"+b.host+(b.port?":"+b.port:"")+(b.path||"/"),void 0===b.withCredentials&&(b.withCredentials=!0);try{a.withCredentials=b.withCredentials}catch(a){}if(b.responseType)try{a.responseType=b.responseType}catch(a){}if(a.open(b.method||"GET",c.uri,!0),a.onerror=function(a){c.emit("error",new Error("Network error"))},c._headers={},b.headers)for(var d=i(b.headers),g=0;g<d.length;g++){var h=d[g];if(c.isSafeRequestHeader(h)){var j=b.headers[h];c.setHeader(h,j)}}b.auth&&this.setHeader("Authorization","Basic "+f.btoa(b.auth));var k=new e;k.on("close",function(){c.emit("close")}),k.on("ready",function(){c.emit("response",k)}),k.on("error",function(a){c.emit("error",a)}),a.onreadystatechange=function(){a.__aborted||k.handle(a)}};g(h,d),h.prototype.setHeader=function(a,b){this._headers[a.toLowerCase()]=b},h.prototype.getHeader=function(a){return this._headers[a.toLowerCase()]},h.prototype.removeHeader=function(a){delete this._headers[a.toLowerCase()]},h.prototype.write=function(a){this.body.push(a)},h.prototype.destroy=function(a){this.xhr.__aborted=!0,this.xhr.abort(),this.emit("close")},h.prototype.end=function(a){void 0!==a&&this.body.push(a);for(var b=i(this._headers),c=0;c<b.length;c++){var d=b[c],e=this._headers[d];if(j(e))for(var f=0;f<e.length;f++)this.xhr.setRequestHeader(d,e[f]);else this.xhr.setRequestHeader(d,e)}if(0===this.body.length)this.xhr.send("");else if("string"==typeof this.body[0])this.xhr.send(this.body.join(""));else if(j(this.body[0])){for(var g=[],c=0;c<this.body.length;c++)g.push.apply(g,this.body[c]);this.xhr.send(g)}else if(/Array/.test(Object.prototype.toString.call(this.body[0]))){for(var h=0,c=0;c<this.body.length;c++)h+=this.body[c].length;for(var g=new this.body[0].constructor(h),k=0,c=0;c<this.body.length;c++)for(var m=this.body[c],f=0;f<m.length;f++)g[k++]=m[f];this.xhr.send(g)}else if(l(this.body[0]))this.xhr.send(this.body[0]);else{for(var g="",c=0;c<this.body.length;c++)g+=this.body[c].toString();this.xhr.send(g)}},h.unsafeHeaders=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","content-transfer-encoding","date","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","user-agent","via"],h.prototype.isSafeRequestHeader=function(a){return!!a&&-1===k(h.unsafeHeaders,a.toLowerCase())};var i=Object.keys||function(a){var b=[];for(var c in a)b.push(c);return b},j=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},k=function(a,b){if(a.indexOf)return a.indexOf(b);for(var c=0;c<a.length;c++)if(a[c]===b)return c;return-1},l=function(a){return"undefined"!=typeof Blob&&a instanceof Blob||("undefined"!=typeof ArrayBuffer&&a instanceof ArrayBuffer||("undefined"!=typeof FormData&&a instanceof FormData||void 0))}},{"./response":261,Base64:232,inherits:278,stream:295}],261:[function(a,b,c){function d(a){for(var b=a.getAllResponseHeaders().split(/\r?\n/),c={},d=0;d<b.length;d++){var e=b[d];if(""!==e){var f=e.match(/^([^:]+):\s*(.*)/);if(f){var g=f[1].toLowerCase(),h=f[2];void 0!==c[g]?i(c[g])?c[g].push(h):c[g]=[c[g],h]:c[g]=h}else c[e]=!0}}return c}var e=a("stream"),f=a("util"),g=b.exports=function(a){this.offset=0,this.readable=!0};f.inherits(g,e);var h={streaming:!0,status2:!0};g.prototype.getResponse=function(a){var b=String(a.responseType).toLowerCase();return"blob"===b?a.responseBlob||a.response:"arraybuffer"===b?a.response:a.responseText},g.prototype.getHeader=function(a){return this.headers[a.toLowerCase()]},g.prototype.handle=function(a){if(2===a.readyState&&h.status2){try{this.statusCode=a.status,this.headers=d(a)}catch(a){h.status2=!1}h.status2&&this.emit("ready")}else if(h.streaming&&3===a.readyState){try{this.statusCode||(this.statusCode=a.status,this.headers=d(a),this.emit("ready"))}catch(a){}try{this._emitData(a)}catch(a){h.streaming=!1}}else 4===a.readyState&&(this.statusCode||(this.statusCode=a.status,this.emit("ready")),this._emitData(a),a.error?this.emit("error",this.getResponse(a)):this.emit("end"),this.emit("close"))},g.prototype._emitData=function(a){var b=this.getResponse(a);if(b.toString().match(/ArrayBuffer/))return this.emit("data",new Uint8Array(b,this.offset)),void(this.offset=b.byteLength);b.length>this.offset&&(this.emit("data",b.slice(this.offset)),this.offset=b.length)};var i=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)}},{stream:295,util:313}],262:[function(a,b,c){c.read=function(a,b,c,d,e){var f,g,h=8*e-d-1,i=(1<<h)-1,j=i>>1,k=-7,l=c?e-1:0,m=c?-1:1,n=a[b+l];for(l+=m,f=n&(1<<-k)-1,n>>=-k,k+=h;k>0;f=256*f+a[b+l],l+=m,k-=8);for(g=f&(1<<-k)-1,f>>=-k,k+=d;k>0;g=256*g+a[b+l],l+=m,k-=8);if(0===f)f=1-j;else{if(f===i)return g?NaN:1/0*(n?-1:1);g+=Math.pow(2,d),f-=j}return(n?-1:1)*g*Math.pow(2,f-d)},c.write=function(a,b,c,d,e,f){var g,h,i,j=8*f-e-1,k=(1<<j)-1,l=k>>1,m=23===e?Math.pow(2,-24)-Math.pow(2,-77):0,n=d?0:f-1,o=d?1:-1,p=b<0||0===b&&1/b<0?1:0;for(b=Math.abs(b),isNaN(b)||b===1/0?(h=isNaN(b)?1:0,g=k):(g=Math.floor(Math.log(b)/Math.LN2),b*(i=Math.pow(2,-g))<1&&(g--,i*=2),b+=g+l>=1?m/i:m*Math.pow(2,1-l),b*i>=2&&(g++,i/=2),g+l>=k?(h=0,g=k):g+l>=1?(h=(b*i-1)*Math.pow(2,e),g+=l):(h=b*Math.pow(2,l-1)*Math.pow(2,e),g=0));e>=8;a[c+n]=255&h,n+=o,h/=256,e-=8);for(g=g<<e|h,j+=e;j>0;a[c+n]=255&g,n+=o,g/=256,j-=8);a[c+n-o]|=128*p}},{}],263:[function(a,b,c){(function(){c.ACCEPT_HEADER={xml:"application/xml",json:"application/json",tsv:"text/tab-separated-values",tab:"text/tab-separated-values",csv:"text/comma-separated-values",fasta:"text/x-fasta",gff3:"text/x-gff3",bed:"text/x-bed",objects:"application/json;type=objects",jsonobjects:"application/json;type=objects",jsontable:"application/json;type=table",jsonrows:"application/json;type=rows",jsoncount:"application/json;type=count",jsonp:"application/javascript",jsonpobjects:"application/javascript;type=objects",jsonptable:"application/javascript;type=table",jsonprows:"application/javascript;type=rows",jsonpcount:"application/javascript;type=count"}}).call(this)},{}],264:[function(a,b,c){(function(){var b,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s;e=a("url"),d=a("JSONStream"),m=a("http"),b=a("./constants").ACCEPT_HEADER,h=a("./version").VERSION,s=r=a("./util"),k=s.error,j=s.defer,n=s.merge,s.invoke,g="node-http/imjs-"+h,f="application/x-www-form-urlencoded",c.supports=function(){return!0},q=function(a,b,c){return function(a){var e,f;return null==a.pipe?c(new Error("response is not a stream")):(a.on("error",c),null!=a.statusCode&&200!==a.statusCode?(e=d.parse("error"),e.pause(),a.pipe(e),c([a.statusCode,e])):(f=d.parse("results.*"),f.pause(),a.pipe(f),b(f)))}},l=function(a,b,c,d){var e,f;return e=a.type,f=a.url,"Could not parse response to "+e+" "+f+': "'+b+'" ('+d+": "+c+")"},i=function(a,b,c){return function(d){var e;return e="",d.on("data",function(a){return e+=a}),d.on("error",c),d.on("end",function(){var f,g,h,i,j,k;if(null!=(null!=d?d.headers:void 0)&&(f=d.headers["content-type"]),"application/json"!==f&&!/json/.test(a.dataType)&&!/json/.test(a.data.format))return(i=e.match(/\[ERROR\] (\d+)([\s\S]*)/))?c(new Error(i[2])):(200<=(k=d.statusCode)&&k<400?b:c)(e);if(""===e&&200===d.statusCode)return b();try{return j=JSON.parse(e),(h=j.error)?c(new Error(h)):b(j)}catch(b){return g=b,c(d.statusCode>=400?new Error(d.statusCode):new Error(l(a,e,g,d.statusCode)))}})}},c.iterReq=function(a,b,c){return function(d,e,f,g,h){var i,j,l,m,o;return null==e&&(e={}),null==f&&(f=function(){}),null==g&&(g=function(){}),null==h&&(h=function(){}),r.isFunction(e)&&(o=[{},e,f,g],e=o[0],f=o[1],g=o[2],h=o[3]),m=n({format:c},e,{query:d.toXML()}),i=function(a){return a.on("data",f),a.on("error",g),
a.on("end",h),setTimeout(function(){if(null!=a.resume)return a.resume()},3),a},l=function(a){var b,c;return c=a[0],b=a[1],b.on("data",g),b.on("error",g),b.on("end",h),null!=b.resume&&b.resume(),k(c)},j=this.makeRequest(a,b,m,null,!0),j.then(i,l),j}},p=function(a,b,c){var d;return d=setTimeout(function(){return b("Request timed out.")},a),c.then(function(){return cancelTimeout(d)})},o=function(a){var c,d,h,i,j,k,l,m;if(!a.url)throw new Error("No url provided in "+JSON.stringify(a));if("string"==typeof a.data){if(h=a.data,"GET"===(k=a.type)||"DELETE"===k)throw new Error("Invalid request. "+a.type+" requests must not have bodies")}else h=r.querystring(a.data);if(d=e.parse(a.url,!0),d.withCredentials=!1,d.method=a.type||"GET",null!=a.port&&(d.port=a.port),d.headers={"User-Agent":g,Accept:b[a.dataType]},("GET"===(l=d.method)||"DELETE"===l)&&(null!=h?h.length:void 0)?(i=/\?/.test(d.path)?"&":"?",d.path+=i+h,h=null):(d.headers["Content-Type"]=(a.contentType||f)+"; charset=UTF-8",d.headers["Content-Length"]=h.length),null!=a.headers){m=a.headers;for(c in m)j=m[c],d.headers[c]=j}return null!=a.auth&&(d.auth=a.auth),[d,h]},c.doReq=function(a,b){var c,d,e,f,g,h,k,l,n,r,s;r=j(),f=r.promise,k=r.resolve,g=r.reject,f.then(null,a.error);try{s=o(a),n=s[0],e=s[1],d=(b?q:i)(a,k,g),h=m.request(n,d),h.on("error",function(b){return g(new Error("Error: "+n.method+" "+a.url+": "+b))}),null!=e&&h.write(e),h.end(),l=a.timeout,l>0&&p(l,g,f)}catch(a){c=a,g(c)}return f}}).call(this)},{"./constants":263,"./util":275,"./version":276,JSONStream:233,http:259,url:311}],265:[function(a,b,c){(function(){var b,d,e,f,g,h,i,j,k,l,m,n,o,p,q={}.hasOwnProperty,r=[].indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(b in this&&this[b]===a)return b;return-1},s=function(a,b){return function(){return a.apply(b,arguments)}};k=a("./util"),n=c,o=k.uniqBy,i=k.difference,h=k.defer,p=k.withCB,m=k.id,l=k.get,j=k.fold,g=k.concatMap,f=6e4,b=function(){function a(a){var b,c;for(b in a)q.call(a,b)&&(c=a[b],this[b]=c)}var b;return a.prototype.getStats=function(a){return null!=a?this.stats[a]:this.stats},b=g(l("matches")),a.prototype.getMatches=function(a){var c;return"MATCH"===a?this.matches[a]:null!=(c=b(this.matches[a]))?c:[]},a.prototype.getMatchIds=function(a){return null!=a?this.getMatches(a).map(l("id")):this.allMatchIds()},a.prototype.goodMatchIds=function(){return this.getMatchIds("MATCH")},a.prototype.allMatchIds=function(){return j(function(a){return function(b,c){return b.concat(a.getMatchIds(c))}}(this))(this.goodMatchIds(),["DUPLICATE","WILDCARD","TYPE_CONVERTED","OTHER"])},a}(),e=function(){function a(a){var b,c;for(b in a)q.call(a,b)&&(c=a[b],this[b]=c)}var b,c,d,e;return e=o(m),b=g(m),c=function(a){var c,d;return b(function(){var b,e;b=a.identifiers,e=[];for(c in b)d=b[c],e.push(d);return e}())},d=function(a,b){return null==b||r.call(c(a),b)>=0},a.prototype.getStats=function(a){switch(a){case"objects":return this.getObjectStats();case"identifiers":return this.getIdentifierStats();default:return{objects:this.getObjectStats(),identifiers:this.getIdentifierStats()}}},a.prototype.getIdentifierStats=function(){var a,c,d,f,g,h;return h=function(a){var c,d;return e(b(function(){var b,e,f;for(f=[],b=0,e=a.length;b<e;b++)d=a[b],f.push(function(){var a;a=[];for(c in null!=d?d.identifiers:void 0)a.push(c);return a}());return f}()))},f=h(this.getMatches("MATCH")),c=h(this.getMatches()),g=f.length,a=c.length,d=i(c,f).length,{matches:g,all:a,issues:d}},a.prototype.getObjectStats=function(){var a,b,d,e;return e=this.goodMatchIds().length,a=this.allMatchIds().length,b=function(){var a;a=[];for(m in this)q.call(this,m)&&(d=this[m],r.call(c(d),"MATCH")<0&&a.push(m));return a}.call(this).length,{matches:e,all:a,issues:b}},a.prototype.getMatches=function(a){var b,c;c=[];for(m in this)q.call(this,m)&&(b=this[m],d(b,a)&&c.push(b));return c},a.prototype.getMatchIds=function(a){var b,c;c=[];for(m in this)q.call(this,m)&&(b=this[m],d(b,a)&&c.push(m));return c},a.prototype.goodMatchIds=function(){return this.getMatchIds("MATCH")},a.prototype.allMatchIds=function(){return this.getMatchIds()},a}(),d=function(){function a(a,b){this.uid=a,this.service=b,this.del=s(this.del,this),this.fetchResults=s(this.fetchResults,this),this.fetchErrorMessage=s(this.fetchErrorMessage,this),this.fetchStatus=s(this.fetchStatus,this)}return a.prototype.fetchStatus=function(a){return p(a,this.service.get("ids/"+this.uid+"/status").then(l("status")))},a.prototype.fetchErrorMessage=function(a){return p(a,this.service.get("ids/"+this.uid+"/status").then(l("message")))},a.prototype.fetchResults=function(a){var c,d;return c=this.service.get("ids/"+this.uid+"/result").then(l("results")),d=this.service.fetchVersion(),d.then(function(a){return c.then(function(c){return a>=16?new b(c):new e(c)})})},a.prototype.del=function(a){return p(a,this.service.makeRequest("DELETE","ids/"+this.uid))},a.prototype.decay=50,a.prototype.poll=function(a,b,c){var d,e,g,i,j,k,l;return l=h(),g=l.promise,j=l.resolve,i=l.reject,g.then(a,b),e=null!=c?c:function(){},k=this.fetchStatus(),k.then(null,i),d=this.decay,this.decay=Math.min(f,1.25*d),k.then(function(a){return function(b){switch(e(b),b){case"SUCCESS":return a.fetchResults().then(j,i);case"ERROR":return a.fetchErrorMessage().then(i,i);default:return setTimeout(function(){return a.poll(j,i,e)},d)}}}(this)),g},a}(),d.prototype.wait=d.prototype.poll,d.create=function(a){return function(b){return new d(b,a)}},n.IDResolutionJob=d,n.CategoryResults=b,n.IdResults=e}).call(this)},{"./util":275}],266:[function(a,b,c){(function(){var b,d,e,f,g,h,i,j,k,l,m,n,o=function(a,b){return function(){return a.apply(b,arguments)}},p={}.hasOwnProperty,q=[].indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(b in this&&this[b]===a)return b;return-1};m=a("./util"),i=c,l=m.merge,n=m.withCB,g=m.get,j=m.invoke,m.REQUIRES_VERSION,m.set,f=m.dejoin,e="lists/shares",b="lists/invitations",k=function(a){return"__folder__"===a.substr(0,a.indexOf(":"))},h=function(a){return a.substr(a.indexOf(":")+1)},d=function(){function a(a,b){var c,d;this.service=b,this._updateTags=o(this._updateTags,this),this.hasTag=o(this.hasTag,this);for(c in a)p.call(a,c)&&(d=a[c],this[c]=d);this.dateCreated=null!=this.dateCreated?new Date(this.dateCreated):null,this.folders=this.tags.filter(k).map(h)}var c;return a.prototype.hasTag=function(a){return q.call(this.tags,a)>=0},a.prototype.query=function(a){return null==a&&(a=["*"]),this.service.query({select:a,from:this.type,where:[[this.type,"IN",this.name]]})},a.prototype.del=function(a){return this.service.makeRequest("DELETE","lists",{name:this.name},a)},c=function(a){return a.tags},a.prototype._updateTags=function(a,b){if(null==a)return this.tags=b.slice(),this.folders=this.tags.filter(k).map(h)},a.prototype.fetchTags=function(a){return n(this._updateTags,a,this.service.makeRequest("GET","list/tags",{name:this.name}).then(c))},a.prototype.addTags=function(a,b){var d;return d={name:this.name,tags:a},n(this._updateTags,b,this.service.makeRequest("POST","list/tags",d).then(c))},a.prototype.removeTags=function(a,b){var d;return d={name:this.name,tags:a},n(this._updateTags,b,this.service.makeRequest("DELETE","list/tags",d).then(c))},a.prototype.contents=function(a){return n(a,this.query().then(f).then(j("records")))},a.prototype.rename=function(a,b){var c;return c=this.service.post("lists/rename",{oldname:this.name,newname:a}).then(g("listName")).then(function(a){return function(b){return a.name=b}}(this)).then(this.service.fetchList),n(b,c)},a.prototype.copy=function(a,b){var c,d,e,f,h,i,k;return null==a&&(a={}),null==b&&(b=function(){}),1===arguments.length&&m.isFunction(a)&&(h=[{},a],a=h[0],b=h[1]),"string"==typeof a&&(a={name:a}),d=c=null!=(i=a.name)?i:this.name+"_copy",f=this.tags.concat(null!=(k=a.tags)?k:[]),e=this.query(["id"]),n(b,this.service.fetchLists().then(j("map",g("name"))).then(function(a){return function(b){var g;for(g=1;q.call(b,d)>=0;)d=c+"-"+g++;return e.then(j("saveAsList",{name:d,tags:f,description:a.description}))}}(this)))},a.prototype.enrichment=function(a,b){return this.service.enrichment(l({list:this.name},a),b)},a.prototype.shareWithUser=function(a,b){return n(b,this.service.post(e,{list:this.name,with:a}))},a.prototype.inviteUserToShare=function(a,c,d){return null==c&&(c=!0),null==d&&(d=function(){}),n(d,this.service.post(b,{list:this.name,to:a,notify:!!c}))},a}(),i.List=d}).call(this)},{"./util":275}],267:[function(a,b,c){(function(){var b,d,e,f,g,h,i,j,k=function(a,b){return function(){return a.apply(b,arguments)}},l=[].indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(b in this&&this[b]===a)return b;return-1};f=a("./table").Table,e=a("./path").PathInfo,j=a("./util"),j.flatten,g=j.find,j.error,i=j.omap,h=c,b=new f({name:"Object",tags:[],displayName:"Object",attributes:{},references:{},collections:{}}),d=function(){function a(a){var c,d;this.name=a.name,c=a.classes,this.findCommonType=k(this.findCommonType,this),this.findSharedAncestor=k(this.findSharedAncestor,this),this.getAncestorsOf=k(this.getAncestorsOf,this),this.getSubclassesOf=k(this.getSubclassesOf,this),this.getPathInfo=k(this.getPathInfo,this),d=i(function(a){return function(b,c){return[b,new f(c,a)]}}(this)),this.classes=d(c),this.classes["java.lang.Object"]=b}return a.prototype.getPathInfo=function(a,b){return e.parse(this,a,b)},a.prototype.getSubclassesOf=function(a){var b,c,d,e,f,g;if(null==(c=a&&a.name?a:this.classes[a]))throw new Error(a+" is not a table");d=[c.name],f=this.classes;for(e in f)b=f[e],g=c.name,l.call(b.parents(),g)>=0&&(d=d.concat(this.getSubclassesOf(b)));return d},a.prototype.getAncestorsOf=function(a){var b,c;if(null==(b=a&&a.name?a:this.classes[a]))throw new Error(a+" is not a table");return c=b.parents(),c.filter(function(a){return function(b){return a.classes[b]}}(this)).reduce(function(a){return function(b,c){return b.concat(a.getAncestorsOf(c))}}(this),c)},a.prototype.findSharedAncestor=function(a,b){var c,d;return null===b||null===a?null:a===b?a:(c=this.getAncestorsOf(a),l.call(c,b)>=0?b:(d=this.getAncestorsOf(b),l.call(d,a)>=0?a:g(c,function(a){return l.call(d,a)>=0})))},a.prototype.findCommonType=function(a){return null==a&&(a=[]),a.reduce(this.findSharedAncestor)},a}(),d.prototype.makePath=d.prototype.getPathInfo,d.prototype.findCommonTypeOfMultipleClasses=d.prototype.findCommonType,d.load=function(a){var b;try{return new d(a)}catch(a){throw b=a,new Error("Error loading model: "+b)}},d.INTEGRAL_TYPES=["int","Integer","long","Long"],d.FRACTIONAL_TYPES=["double","Double","float","Float"],d.NUMERIC_TYPES=d.INTEGRAL_TYPES.concat(d.FRACTIONAL_TYPES),d.BOOLEAN_TYPES=["boolean","Boolean"],h.Model=d}).call(this)},{"./path":268,"./table":273,"./util":275}],268:[function(a,b,c){(function(){var b,d,e,f,g,h,i,j,k,l,m,n,o,p,q=function(a,b){return function(){return a.apply(b,arguments)}},r=[].slice,s=[].indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(b in this&&this[b]===a)return b;return-1};k=c,o=a("./util"),p=o.withCB,g=o.concatMap,j=o.get,f=o.any,m=o.set,h=o.copy,n=o.success,i=o.error,b={},d={},l=function(a,b,c){var d,e,f;return(null!=a?a.name:void 0)+"|"+(null!=a&&null!=(f=a.service)?f.root:void 0)+"|"+b+":"+function(){var a;a=[];for(d in c)e=c[d],a.push(d+"="+e);return a}()},e=function(){function a(a){var b,c;this.root=a.root,this.model=a.model,this.descriptors=a.descriptors,this.subclasses=a.subclasses,this.displayName=a.displayName,this.ident=a.ident,this.allDescriptors=q(this.allDescriptors,this),this.getChildNodes=q(this.getChildNodes,this),this.getDisplayName=q(this.getDisplayName,this),this.isa=q(this.isa,this),this.append=q(this.append,this),this.getParent=q(this.getParent,this),this.getEndClass=q(this.getEndClass,this),this.containsCollection=q(this.containsCollection,this),this.isCollection=q(this.isCollection,this),this.isReverseReference=q(this.isReverseReference,this),this.isReference=q(this.isReference,this),this.isClass=q(this.isClass,this),this.isAttribute=q(this.isAttribute,this),this.isRoot=q(this.isRoot,this),c=this.descriptors,this.mid=2<=c.length?r.call(c,0,b=c.length-1):(b=0,[]),this.end=c[b++],null==this.ident&&(this.ident=l(this.model,this,this.subclasses))}return a.prototype.isRoot=function(){return 0===this.descriptors.length},a.prototype.isAttribute=function(){return null!=this.end&&!this.isReference()},a.prototype.isClass=function(){return this.isRoot()||this.isReference()},a.prototype.isReference=function(){var a;return null!=(null!=(a=this.end)?a.referencedType:void 0)},a.prototype.isReverseReference=function(){var a,b,c,d,e;return!!(this.isReference()&&this.mid.length>0)&&(e=this.end,d=e.reverseReference,c=e.referencedType,b=this.getParent(),a=b.getParent(),null!=c&&a.isa(c)&&b.end.name===d)},a.prototype.isCollection=function(){var a,b;return null!=(a=null!=(b=this.end)?b.isCollection:void 0)&&a},a.prototype.containsCollection=function(){return f(this.descriptors,function(a){return a.isCollection})},a.prototype.getEndClass=function(){var a;return this.model.classes[this.subclasses[this.toString()]||(null!=(a=this.end)?a.referencedType:void 0)]||this.root},a.prototype.getParent=function(){var b;if(this.isRoot())throw new Error("Root paths do not have parents");return b={root:this.root,model:this.model,descriptors:this.mid.slice(),subclasses:this.subclasses},new a(b)},a.prototype.append=function(b){var c,d;if(this.isAttribute())throw new Error(this+" is an attribute.");if(null==(d="string"==typeof b?this.getType().fields[b]:b))throw new Error(b+" is not a field of "+this.getType());return c={root:this.root,model:this.model,descriptors:this.descriptors.concat([d]),subclasses:this.subclasses},new a(c)},a.prototype.isa=function(a){var b,c;return null!=a&&(this.isAttribute()?this.getType()===a:(b=a.name?a.name:""+a,c=this.getType(),b===c.name||s.call(this.model.getAncestorsOf(c),b)>=0))},a.prototype.getDisplayName=function(a){var c,d,e,f;return(d=this.displayName)?n(d):(null==this.namePromise&&(this.namePromise=(c=b[this.ident])?n(c):this.isRoot()&&this.root.displayName?n(this.root.displayName):null==this.model.service?i("No service"):(f="model"+g(function(a){return"/"+a.name})(this.allDescriptors()),e=m({format:"json"})(h(this.subclasses)),this.model.service.get(f,e).then(j("display")).then(function(a){return function(c){var d;return null!=b[d=a.ident]?b[d]:b[d]=c}}(this)))),p(a,this.namePromise))},a.prototype.getChildNodes=function(){var a,b,c,d,e;d=(null!=(c=this.getEndClass())?c.fields:void 0)||{},e=[];for(b in d)a=d[b],e.push(this.append(a));return e},a.prototype.allDescriptors=function(){return[this.root].concat(this.descriptors)},a.prototype.toString=function(){return this.allDescriptors().map(j("name")).join(".")},a.prototype.equals=function(a){return this===a||this.ident&&(null!=a?a.ident:void 0)===this.ident},a.prototype.getType=function(){var a,b;return(null!=(a=this.end)&&null!=(b=a.type)?b.replace(/java\.lang\./,""):void 0)||this.getEndClass()},a}(),e.prototype.toPathString=e.prototype.toString,e.parse=function(a,b,c){var f,g,h,i,j,k,m,n,o;return null==c&&(c={}),j=l(a,b,c),(f=d[j])?f:(n=(b+"").split("."),o=g=a.classes[n.shift()],k=o.name,h=function(){var d,e,f,h;for(h=[],d=0,e=n.length;d<e;d++){if(m=n[d],!(i=(null!=g?g.fields[m]:void 0)||(null!=(f=g=a.classes[c[k]])?f.fields[m]:void 0)))throw new Error("Could not find "+m+" in "+g+" when parsing "+b);k+="."+m,g=a.classes[i.type||i.referencedType],h.push(i)}return h}(),d[j]=new e({root:o,model:a,descriptors:h,subclasses:c,ident:j}))},e.flushCache=function(){return d={},b={}},k.PathInfo=e}).call(this)},{"./util":275}],269:[function(a,b,c){(function(){var c;c=a("es6-promise").Promise,b.exports=c}).call(this)},{"es6-promise":257}],270:[function(a,b,c){(function(){var b,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$=[].indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(b in this&&this[b]===a)return b;return-1},_=function(a,b){return function(){return a.apply(b,arguments)}},aa=[].slice,ba={}.hasOwnProperty;e=a("backbone-events-standalone"),B=c,B.xml=a("./xml"),R=a("./util"),h=R.REQUIRES_VERSION,S=R.withCB,E=R.merge,u=R.filter,J=R.partition,v=R.fold,p=R.concatMap,z=R.id,w=R.get,R.invoke,O=R.querystring,x=function(a){var b;if(!(b=null!=(null!=a?a.toLowerCase:void 0)?g.OP_DICT[a.toLowerCase()]:null))throw new Error("Illegal constraint operator: "+a);return b},b=["path","op","code"],j=b.concat(["value","extraValue"]),i=["rowByRow","eachRow","recordByRecord","eachRecord","records","rows","table","tableRows","values"],f=function(a){return R.compose(a.fetchList,w("listName"))},d=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],r=function(a){return null==a&&(a=""),a.substr(a.indexOf("."))},o=function(a){return null!=a?"<value>"+R.escape(a)+"</value>":"<nullValue/>"},l=function(a,b){var c,d;return function(){var e;e=[];for(c in a)d=a[c],$.call(b,c)>=0&&e.push(c+'="'+R.escape(d)+'" ');return e}().join("")},I=function(a){return"<constraint "+l(a,b)+"/>"},P=function(a){return"<constraint "+l(a,["path","type"])+"/>"},L=function(a){return"<constraint "+l(a,j)+"/>"},G=function(a){return"<constraint "+l(a,b)+">"+p(o)(a.values)+"</constraint>"},A=function(a){return"<constraint "+l(a,b)+'ids="'+a.ids.join(",")+'"/>'},m=function(a){var b;return null!=a.values?G(a):null!=a.ids?A(a):null==a.op?P(a):(b=a.op,$.call(g.NULL_OPS,b)>=0?I(a):L(a))},y=function(a){return a.replace(/^[^\.]+\./,"")},q=function(a){var b,c,d,e,f,g,h,i,j,k,l;return g=a.path,j=a.type,f=a.op,k=a.value,l=a.values,d=a.extraValue,e=a.ids,b=a.code,c=a.editable,i=a.switched,h=a.switchable,e=null!=e?e.slice():void 0,l=null!=l?l.slice():void 0,H({path:g,type:j,op:f,value:k,values:l,extraValue:d,ids:e,code:b,editable:c,switched:i,switchable:h})},n=function(a){var b;return b=q(a),b.path=y(b.path),b},H=function(a){var b;for(b in a)null==a[b]&&delete a[b];return a},s=function(a,b){return"Did not remove a single constraint. original = "+a+", reduced = "+b},D=function(a,b){var c,d,e,f,h,i,j;if(c={path:a},null===b)c.op="IS NULL";else if(R.isArray(b))c.op="ONE OF",c.values=b;else if("string"==(i=typeof b)||"number"===i||"boolean"===i)j="function"==typeof b.toUpperCase?b.toUpperCase():void 0,$.call(g.NULL_OPS,j)>=0?c.op=b:(c.op="=",c.value=b);else if(e=function(){var a;a=[];for(d in b)h=b[d],a.push(d);return a}(),$.call(e,"isa")>=0)R.isArray(b.isa)?(c.op=d,c.values=b.isa):c.type=b.isa;else{$.call(e,"extraValue")>=0&&(c.extraValue=b.extraValue);for(d in b)f=b[d],"extraValue"!==d&&(c.op=d,R.isArray(f)?c.values=f:c.value=f)}return c},C=function(a){var b,c,d,e;return a=a.slice(),c={path:a.shift()},1===a.length?(b=a[0],e="function"==typeof b.toUpperCase?b.toUpperCase():void 0,$.call(g.NULL_OPS,e)>=0?c.op=b:c.type=b):a.length>=2&&(c.op=a[0],d=a[1],R.isArray(d)?c.values=d:c.value=d,3===a.length&&(c.extraValue=a[2])),c},N=function(a){var b;return function(){var c,d,e;for(e=[],c=0,d=a.length;c<d;c++)b=a[c],e.push(b.path+" "+b.direction);return e}().join(" ")},M=function(a){var b,c,d,e,f,g,h;if(null==a)return[];for(c=a.split(/\s+/),d=function(){var a,b,d;for(d=[],e=a=0,b=c.length/2;0<=b?a<b:a>b;e=0<=b?++a:--a)d.push(2*e);return d}(),h=[],f=0,g=d.length;f<g;f++)b=d[f],h.push([c[b],c[b+1]]);return h},K=function(){var a,b;if(b=this.sortOrder,this.sortOrder=function(){var c,d,e;for(e=[],c=0,d=b.length;c<d;c++)a=b[c],this.isRelevant(a.path)&&e.push(a);return e}.call(this),b.length!==this.sortOrder.length)return this.trigger("change:sortorder change:orderby",this.sortOrder.slice())},g=function(){function a(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s;for(i=null!=c?c:{},d=i.model,f=i.summaryFields,this.addConstraint=_(this.addConstraint,this),this.expandStar=_(this.expandStar,this),this.adjustPath=_(this.adjustPath,this),this.select=_(this.select,this),null==a&&(a={}),this.constraints=[],this.views=[],this.joins={},this.displayNames=R.copy(null!=(j=null!=(l=a.displayNames)?l:a.aliases)?j:{}),m=["name","title","comment","description","type"],g=0,h=m.length;g<h;g++)e=m[g],null!=a[e]&&(this[e]=a[e]);this.service=null!=b?b:{},this.model=null!=(n=null!=d?d:a.model)?n:{},this.summaryFields=null!=(o=null!=f?f:a.summaryFields)?o:{},this.root=null!=(p=a.root)?p:a.from,this.maxRows=null!=(q=null!=(r=a.size)?r:a.limit)?q:a.maxRows,this.start=null!=(s=null!=(k=a.start)?k:a.offset)?s:0,this.select(a.views||a.view||a.select||[]),this.addConstraints(a.constraints||a.where||[]),this.addJoins(a.joins||a.join||[]),this.orderBy(a.sortOrder||a.orderBy||[]),null!=a.constraintLogic&&(this.constraintLogic=a.constraintLogic),this.on("change:views",K,this)}var b,c,e,g,i,j,k,o,t;return a.JOIN_STYLES=["INNER","OUTER"],a.BIO_FORMATS=["gff3","fasta","bed"],a.NULL_OPS=["IS NULL","IS NOT NULL"],a.ATTRIBUTE_VALUE_OPS=["=","!=",">",">=","<","<=","CONTAINS","LIKE","NOT LIKE"],a.MULTIVALUE_OPS=["ONE OF","NONE OF"],a.RANGE_OPS=["OVERLAPS","DOES NOT OVERLAP","OUTSIDE","WITHIN","CONTAINS","DOES NOT CONTAIN"],a.TERNARY_OPS=["LOOKUP"],a.LOOP_OPS=["=","!="],a.LIST_OPS=["IN","NOT IN"],a.OP_DICT={"=":"=","==":"==",eq:"=",eqq:"==","!=":"!=",ne:"!=",">":">",gt:">",">=":">=",ge:">=","<":"<",lt:"<","<=":"<=",le:"<=",contains:"CONTAINS",CONTAINS:"CONTAINS","does not contain":"DOES NOT CONTAIN","DOES NOT CONTAIN":"DOES NOT CONTAIN",like:"LIKE",LIKE:"LIKE","not like":"NOT LIKE","NOT LIKE":"NOT LIKE",lookup:"LOOKUP","IS NULL":"IS NULL","is null":"IS NULL","IS NOT NULL":"IS NOT NULL","is not null":"IS NOT NULL","ONE OF":"ONE OF","one of":"ONE OF","NONE OF":"NONE OF","none of":"NONE OF",in:"IN","not in":"NOT IN",IN:"IN","NOT IN":"NOT IN",WITHIN:"WITHIN",within:"WITHIN",OVERLAPS:"OVERLAPS",overlaps:"OVERLAPS","DOES NOT OVERLAP":"DOES NOT OVERLAP","does not overlap":"DOES NOT OVERLAP",OUTSIDE:"OUTSIDE",outside:"OUTSIDE",ISA:"ISA",isa:"ISA"},i=["name","view","sortOrder","constraintLogic","title","description","comment"],c=["path","type","op","code","value","ids"],k=function(a,b){var c,d,e,f;for(f=[],d=0,e=b.length;d<e;d++)c=b[d],a.hasAttribute(c)&&f.push([c,a.getAttribute(c)]);return f},e=function(a,b){var c,d,e,f,g;for(f=a.getElementsByTagName(b),g=[],d=0,e=f.length;d<e;d++)c=f[d],g.push(c);return g},t=function(a){return function(b){return b.getAttribute(a)}},a.fromXML=function(a){var b,d,f,g,h,j,l;if(d=B.xml.parse(a),!(j=e(d,"query")[0]||e(d,"template")[0]))throw new Error("no query in xml");return g=t("path"),l=t("style"),h=R.pairsToObj(k(j,i)),h.view=h.view.split(/\s+/),h.sortOrder=M(h.sortOrder),h.joins=function(){var a,b,c,d;for(c=e(j,"join"),d=[],a=0,b=c.length;a<b;a++)f=c[a],"OUTER"===l(f)&&d.push(g(f));return d}(),h.constraints=function(){var a,d,f,g;for(f=e(j,"constraint"),g=[],a=0,d=f.length;a<d;a++)b=f[a],g.push(function(a){var b,d,f,g,h;return b=R.pairsToObj(k(a,c)),null!=b.ids&&(b.ids=function(){var a,c,d,e;for(d=b.ids.split(","),e=[],a=0,c=d.length;a<c;a++)h=d[a],e.push(parseInt(h,10));return e}()),g=e(a,"value"),g.length&&(b.values=function(){var a,b,c;for(c=[],a=0,b=g.length;a<b;a++)f=g[a],c.push(function(){var a,b,c,e;for(c=f.childNodes,e=[],a=0,b=c.length;a<b;a++)d=c[a],e.push(d.data);return e}().join(""));return c}()),b}(b));return g}(),h},a.prototype.constraints=[],a.prototype.views=[],a.prototype.joins={},a.prototype.constraintLogic="",a.prototype.sortOrder="",a.prototype.name=null,a.prototype.title=null,a.prototype.comment=null,a.prototype.description=null,a.prototype.removeFromSelect=function(a){var b,c,d,e;return null==a&&(a=[]),a=R.stringList(a),b=R.compose(this.expandStar,this.adjustPath),a=R.flatten(function(){var c,e,f;for(f=[],c=0,e=a.length;c<e;c++)d=a[c],f.push(b(d));return f}()),this.sortOrder=function(){var b,d,e,f,g;for(e=this.sortOrder,g=[],b=0,d=e.length;b<d;b++)c=e[b],f=c.path,$.call(a,f)>=0||g.push(c);return g}.call(this),this.views=function(){var b,c,d,f;for(d=this.views,f=[],b=0,c=d.length;b<c;b++)e=d[b],$.call(a,e)>=0||f.push(e);return f}.call(this),this.trigger("remove:view",a),this.trigger("change:views",this.views),this.trigger("change",this.views)},a.prototype.removeConstraint=function(a,b){var c,d,e,f;if(null==b&&(b=!1),e=this.constraints,d="string"==typeof a?function(b){return b.code===a}:function(b){var c,d;return b.path===a.path&&b.op===a.op&&b.value===a.value&&b.extraValue===a.extraValue&&a.type===b.type&&(null!=(c=b.values)?c.join("%%"):void 0)===(null!=(d=a.values)?d.join("%%"):void 0)},f=function(){var a,b,f;for(f=[],a=0,b=e.length;a<b;a++)c=e[a],d(c)||f.push(c);return f}(),f.length!==e.length-1)throw new Error(s(e,f));if(this.constraints=f,!b)return this.trigger("change:constraints"),this.trigger("change"),this.trigger("removed:constraint",R.find(e,d))},a.prototype.addToSelect=function(a,b){var c,d,e,f,g,h,i,j;if(null==a&&(a=[]),null==b&&(b={}),a=R.stringList(a),d=R.compose(this.expandStar,this.adjustPath),f=R.flatten(function(){var b,c,e;for(e=[],b=0,c=a.length;b<c;b++)g=a[b],e.push(d(g));return e}()),c=function(){var a,b,c;for(c=[],a=0,b=f.length;a<b;a++)e=f[a],$.call(this.views,e)>=0&&c.push(e);return c}.call(this),c.length)throw new Error(c+" already in the select list");if(c=function(){var a,b,c;for(c=[],a=0,b=f.length;a<b;a++)e=f[a],function(){var a,b,c;for(c=[],a=0,b=f.length;a<b;a++)(h=f[a])===e&&c.push(h);return c}().length>1&&c.push(e);return c}(),c.length)throw new Error(c+" specified multiple times as arguments to addToSelect");return(i=this.views).push.apply(i,f),b.silent?b.events=(null!=(j=b.events)?j:[]).concat(["change","add:view","change:views"]):(this.trigger("add:view change:views",f),this.trigger("change")),this},a.prototype.select=function(a,b){var c,d;d=this.views.slice();try{this.views=[],this.addToSelect(a,b)}catch(a){c=a,this.views=d,R.error(c)}return this},a.prototype.adjustPath=function(a){return a=a&&a.name?a.name:""+a,null!=this.root?a.match("^"+this.root)||(a=this.root+"."+a):this.root=a.split(".")[0],a},a.prototype.getPossiblePaths=function(a,b,c){var d,e,f,g,h;return null==a&&(a=3),null==b&&(b=!0),null==c&&(c=null),g="string"==typeof c?function(a){return a[c]()}:c,d=function(a){return function(c,e){var f,g,h,i,j,k;return j=a.getPathInfo(c),!b&&j.isReverseReference()?[]:j.isAttribute()?[j]:(f=j.getType(),k=p(function(a){return d(c+"."+a.name,e-1)}),i=f&&e>0?k(function(){var a,b;a=f.fields,b=[];for(h in a)g=a[h],b.push(g);return b}()):[],[j].concat(i))}}(this),e=a+"-"+b,null==this._possiblePaths&&(this._possiblePaths={}),f=(null!=(h=this._possiblePaths)[e]?h[e]:h[e]=d(this.root,a)).slice(),null!=g?f.filter(g):f},a.prototype.getPathInfo=function(a){var b,c,d;return b=this.adjustPath(a),c=null!=(d=this.model)&&"function"==typeof d.getPathInfo?d.getPathInfo(b,this.getSubclasses()):void 0,c&&b in this.displayNames&&(c.displayName=this.displayNames[b]),c},a.prototype.makePath=a.prototype.getPathInfo,o=function(a){return[a.path,a.type]},j=R.compose(R.pairsToObj,R.map(o),u(w("type"))),a.prototype.getSubclasses=function(){return j(this.constraints)},a.prototype.getType=function(a){return this.getPathInfo(a).getType()},a.prototype.getViewNodes=function(){var a,b;return b=function(a){return function(b){return a.getPathInfo(b).getParent()}}(this),R.uniqBy(String,function(){var c,d,e,f;for(e=this.views,f=[],c=0,d=e.length;c<d;c++)a=e[c],f.push(b(a));return f}.call(this))},a.prototype.isInView=function(a){var b,c,d;if(!(b=this.getPathInfo(a)))throw new Error("Invalid path: "+a);return b.isAttribute()?(d=b.toString(),$.call(this.views,d)>=0):(c=b.toString(),R.any(this.getViewNodes(),function(a){return a.toString()===c}))},a.prototype.isConstrained=function(a,b){var c,d;if(null==b&&(b=!1),!(c=this.getPathInfo(a)))throw new Error("Invalid path: "+a);return d=function(a){return null!=a.op&&a.path===c.toString()},!c.isAttribute()&&b&&(d=function(a){return function(b){return null!=b.op&&(b.path===c.toString()||c.equals(a.getPathInfo(b.path).getParent()))}}(this)),R.any(this.constraints,d)},a.prototype.canHaveMultipleValues=function(a){return this.getPathInfo(a).containsCollection()},a.prototype.getQueryNodes=function(){var a,b,c,d;return d=this.getViewNodes(),b=function(){var b,d,e,f;for(e=this.constraints,f=[],b=0,d=e.length;b<d;b++)a=e[b],null==a.type&&(c=this.getPathInfo(a.path),c.isAttribute()?f.push(c.getParent()):f.push(c));return f}.call(this),R.uniqBy(String,d.concat(b))},a.prototype.isInQuery=function(a){var b,c,d,e,f,g;if(c=this.getPathInfo(a)){for(d=c.toPathString(),g=this.views.concat(function(){var a,c,d,e;for(d=this.constraints,e=[],a=0,c=d.length;a<c;a++)b=d[a],null==b.type&&e.push(b.path);return e}.call(this)),e=0,f=g.length;e<f;e++)if(a=g[e],0===a.indexOf(d))return!0;return!1}return!0},a.prototype.isRelevant=function(a){var b,c,d;return c=this.getPathInfo(a),c.isAttribute()&&(c=c.getParent()),d=c.toString(),b=this.getViewNodes(),R.any(b,function(a){return a.toPathString()===d})},a.prototype.expandStar=function(a){var b,c,d,e,f,g,h,i;if(/\*$/.test(a))if(h=a.substr(0,a.lastIndexOf(".")),d=function(a){return h+a},c=this.getType(h),/\.\*$/.test(a)){if(c&&this.summaryFields[c.name])return e=R.compose(d,r),function(){var a,b,d,g;for(d=this.summaryFields[c.name],g=[],a=0,b=d.length;a<b;a++)f=d[a],this.hasView(f)||g.push(e(f));return g}.call(this)}else if(/\.\*\*$/.test(a))return i=this.expandStar(h+".*"),b=function(){var a;a=[];for(g in c.attributes)a.push(d("."+g));return a}(),R.uniqBy(z,i.concat(b));return a},a.prototype.isOuterJoin=function(a){return"OUTER"===this.joins[this.adjustPath(a)]},a.prototype.hasView=function(a){var b;return this.views&&(b=this.adjustPath(a),$.call(this.views,b)>=0)},a.prototype.count=function(a){if(this.service.count)return this.service.count(this,a);throw new Error("This query has no service with count functionality attached.")},a.prototype.appendToList=function(a,b){var c,d,e,g,h;return(null!=a?a.name:void 0)?(c=a.name,h=function(b,c){if(null==b)return a.size=c.size}):(c=String(a),h=null),g=this.makeListQuery(),e={listName:c,query:g.toXML()},d=f(this.service),S(h,b,this.service.post("query/append/tolist",e).then(d))},a.prototype.selectPreservingImpliedConstraints=function(a){var b,c,d,e,f;for(null==a&&(a=[]),c=this.clone(),c.select(a),f=this.getViewNodes(),d=0,e=f.length;d<e;d++)b=f[d],this.isOuterJoined(b)||c.isInView(b||c.isConstrained(b))||null==b.getEndClass().fields.id||c.addConstraint([b.append("id"),"IS NOT NULL"]);return c},a.prototype.makeListQuery=function(){var a,b;return a=this.views.slice(),1===a.length&&(null!=(b=a[0])?b.match(/\.id$/):void 0)||(a=["id"]),this.selectPreservingImpliedConstraints(a)},a.prototype.saveAsList=function(a,b){var c,d;return d=this.makeListQuery(),c=R.copy(a),c.listName=c.listName||c.name,c.query=d.toXML(),a.tags&&(c.tags=a.tags.join(";")),S(b,this.service.post("query/tolist",c).then(f(this.service)))},a.prototype.summarise=function(a,b,c){return this.filterSummary(a,"",b,c)},a.prototype.summarize=function(){var a;return a=1<=arguments.length?aa.call(arguments,0):[],this.summarise.apply(this,a)},g=function(a){var b,c,d,e,f,g,h;for(b=null!=(null!=(g=a.results[0])?g.max:void 0),h=a.results,e=0,f=h.length;e<f;e++)c=h[e],c.count=parseInt(c.count,10);return d={uniqueValues:a.uniqueValues,filteredCount:a.filteredCount},b&&(d=E(d,a.results[0])),a.stats=d,a},a.prototype.filterSummary=function(a,b,c,d){var e,f,h;return null==d&&(d=function(){}),R.isFunction(c)&&(h=[c,null],d=h[0],c=h[1]),a=this.adjustPath(a),f=this.clone(),$.call(f.views,a)<0&&f.views.push(a),e={query:f.toXML(),summaryPath:a,format:"jsonrows"},c&&(e.size=c),b&&(e.filterTerm=b),S(d,this.service.post("query/results",e).then(g))},a.prototype.clone=function(b){var c,d,e,f;if(c=new a(this,this.service),null==c._callbacks&&(c._callbacks={}),b){f=this._callbacks;for(d in f)ba.call(f,d)&&(e=f[d],c._callbacks[d]=e);c.off("change:views",K,this)}return c},a.prototype.next=function(){var a;return a=this.clone(),this.maxRows&&(a.start=this.start+this.maxRows),a},a.prototype.previous=function(){var a;return a=this.clone(),this.maxRows?a.start=this.start-this.maxRows:a.start=0,a},a.prototype.getSortDirection=function(a){var b,c;if(b=this.adjustPath(a),
!this.isInQuery(b)&&!this.isRelevant(b))throw new Error(a+" is not in the query");return c=R.find(this.sortOrder,function(a){var c;return c=a.path,b===c}),null!=c?c.direction:void 0},a.prototype.isOuterJoined=function(a){var b,c;a=this.adjustPath(a),c=this.joins;for(b in c)if("OUTER"===c[b]&&0===a.indexOf(b))return!0;return!1},a.prototype.getOuterJoin=function(a){var b,c;return a=this.adjustPath(a),b=function(){var a;a=[];for(c in this.joins)a.push(c);return a}.call(this).sort(function(a,b){return b.length-a.length}),R.find(b,function(b){return function(c){return"OUTER"===b.joins[c]&&0===a.indexOf(c)}}(this))},a.prototype._parse_sort_order=function(a){var b,c,d,e,f,g;if(null==a)throw new Error("No input");if("string"==typeof a)e={path:a,direction:"ASC"};else if(R.isArray(a))d=a[0],b=a[1],e={path:d,direction:b};else if(null==a.path){for(c in a)f=a[c],g=[c,f],d=g[0],b=g[1];e={path:d,direction:b}}else d=a.path,b=a.direction,e={path:d,direction:b};return e.path=this.adjustPath(e.path),null==e.direction&&(e.direction="ASC"),e.direction=e.direction.toUpperCase(),e},a.prototype.addOrSetSortOrder=function(a){var b,c;return a=this._parse_sort_order(a),b=this.getSortDirection(a.path),null==b?this.addSortOrder(a):b!==a.direction&&(c=R.find(this.sortOrder,function(b){return b.path===a.path}),c.direction=a.direction,this.trigger("change:sortorder",this.sortOrder),this.trigger("change")),this},a.prototype.addSortOrder=function(a,b){var c;if(c=(null!=b?b:{}).silent,this.sortOrder.push(this._parse_sort_order(a)),!c)return this.trigger("add:sortorder",a),this.trigger("change:sortorder",this.sortOrder),this.trigger("change")},a.prototype.orderBy=function(a,b){var c,d,e,f,g,h,i,j;for(null==b&&(b={}),f=this.sortOrder.slice(),this.sortOrder=[],h=0,i=a.length;h<i;h++)e=a[h],this.addSortOrder(this._parse_sort_order(e),{silent:!0});return c=function(){var a,b,c,e,f;for(c=this.sortOrder,f=[],a=0,b=c.length;a<b;a++)e=c[a],g=e.path,d=e.direction,f.push({path:g,direction:d});return f}.call(this),this.trigger("set:sortorder",c),N(f)!==this.getSorting()&&(b.silent?b.events=(null!=(j=b.events)?j:[]).concat(["change","change:sortorder"]):(this.trigger("change:sortorder",c),this.trigger("change"))),this},a.prototype.addJoins=function(a){var b,c,d,e,f,g,h;if(R.isArray(a)){for(g=[],e=0,f=a.length;e<f;e++)b=a[e],g.push(this.addJoin(b));return g}h=[];for(c in a)d=a[c],h.push(this.addJoin({path:c,style:d}));return h},a.prototype.addJoin=function(a){return"string"==typeof a&&(a={path:a,style:"OUTER"}),this.setJoinStyle(a.path,a.style)},a.prototype.setJoinStyle=function(b,c){if(null==c&&(c="OUTER"),b=this.adjustPath(b),c=c.toUpperCase(),$.call(a.JOIN_STYLES,c)<0)throw new Error("Invalid join style: "+c);return this.joins[b]!==c&&(this.joins[b]=c,this.trigger("change:joins",{path:b,style:c}),this.trigger("change")),this},a.prototype.addConstraints=function(a,b){var c,d,e,f,g,h,i;if(null==b&&(b="and"),this.__silent__=!0,e=this.constraintLogic,R.isArray(a))for(h=0,i=a.length;h<i;h++)c=a[h],this.addConstraint(c,b);else{g=function(a){return function(c,d){return a.addConstraint(D(c,d),b)}}(this);for(f in a)d=a[f],g(f,d)}return this.__silent__=!1,this.trigger("add:constraint"),this.trigger("change:constraints"),e!==this.constraintLogic&&this.trigger("change:logic",this.constraintLogic),this.trigger("change")},a.prototype.addConstraint=function(a,b){var c,e,f,g,h,i,j;if(null==b&&(b="and"),"and"!==b&&"or"!==b)throw new Error("Unknown logical conjunction: "+b);return a=R.isArray(a)?C(a):q(a),"OFF"===a.switched?this:(a.path=this.adjustPath(a.path),null==a.type&&(a.op=x(a.op)),this.constraints.push(a),f="or"===b||(null!=(j=this.constraintLogic)?j.length:void 0)>0,g=this.constraints.length,i=this.constraintLogic,f&&(h=2===g?d[0]+" "+b+" "+d[1]:(e=this.constraintLogic,e||(e=function(){var a,b,e;for(e=[],c=a=0,b=g-2;0<=b?a<=b:a>=b;c=0<=b?++a:--a)e.push(d[c]);return e}().join(" and ")),"("+e+") "+b+" "+d[g-1]),this.constraintLogic=h),this.__silent__||(this.trigger("add:constraint",a),this.trigger("change:constraints"),i!==this.constraintLogic&&this.trigger("change:logic",this.constraintLogic),this.trigger("change")),this)},a.prototype.getSorting=function(){return N(this.sortOrder)},a.prototype.getConstraintXML=function(){var a,b;return b=function(){var b,c,d,e;for(d=this.constraints,e=[],b=0,c=d.length;b<c;b++)a=d[b],(null==a.type||this.isInQuery(a.path))&&e.push(a);return e}.call(this),b.length?p(m)(p(z)(J(function(a){return null!=a.type})(b))):""},a.prototype.getJoinXML=function(){var a,b,c;return c=function(){var c,d;c=this.joins,d=[];for(a in c)b=c[a],this.isInQuery(a)&&"OUTER"===b&&d.push('<join path="'+a+'" style="OUTER"/>');return d}.call(this),c.join("")},a.prototype.toXML=function(){var a,b,c;return a={model:this.model.name,view:this.views.join(" "),sortOrder:this.getSorting(),constraintLogic:this.constraintLogic},null!=this.name&&(a.name=this.name),"<query "+function(){var d;d=[];for(b in a)(c=a[b])&&d.push(b+'="'+c+'"');return d}().join(" ")+" >"+this.getJoinXML()+this.getConstraintXML()+"</query>"},a.prototype.toJSON=function(){var a,b,c,d,e;return H({name:this.name,title:this.title,comment:this.comment,description:this.description,constraintLogic:this.constraintLogic,from:this.root,select:function(){var a,b,c,d;for(c=this.views,d=[],a=0,b=c.length;a<b;a++)e=c[a],d.push(y(e));return d}.call(this),orderBy:function(){var a,d,e,f,g;for(e=this.sortOrder,g=[],a=0,d=e.length;a<d;a++)f=e[a],c=f.path,b=f.direction,g.push({path:y(c),direction:b});return g}.call(this),joins:function(){var a,b;a=this.joins,b=[];for(c in a)"OUTER"===(d=a[c])&&b.push(y(c));return b}.call(this),where:function(){var b,c,d,e;for(d=this.constraints,e=[],b=0,c=d.length;b<c;b++)a=d[b],e.push(n(a));return e}.call(this)})},a.prototype.fetchCode=function(a,b){var c;return c={query:this.toXML(),lang:a},S(b,this.service.post("query/code",c).then(this.service.VERIFIER).then(w("code")))},a.prototype.setName=function(a){this.name=a},a.prototype.save=function(a,b){return h(this.service,16,function(c){return function(){var d,e;return R.isFunction(a)&&(e=[null,a],a=e[0],b=e[1]),null!=a&&c.setName(a),d={type:"PUT",path:"user/queries",data:c.toXML(),contentType:"application/xml",dataType:"json"},S(b,c.service.authorise(d)).then(function(a){return c.service.doReq(a)}).then(function(a){return a.queries})}}(this))},a.prototype.store=function(a,b){return h(this.service,16,function(c){return function(){var d,e,f,g;return R.isFunction(a)&&(g=[null,a],a=g[0],b=g[1]),null!=a&&c.setName(a),f=function(a,b){if(null==a)return c.setName(b)},d=R.compose(w(c.name),w("queries")),e={type:"POST",path:"user/queries",data:c.toXML(),contentType:"application/xml",dataType:"json"},S(b,f,c.service.authorise(e)).then(function(a){return c.service.doReq(a)}).then(d)}}(this))},a.prototype.saveAsTemplate=function(a,b){return h(this.service,16,function(c){return function(){var d,e;if(R.isFunction(a)&&(e=[null,a],a=e[0],b=e[1]),null!=a&&c.setName(a),!c.name)throw new Error("Templates must have a name");return d={type:"POST",path:"templates",data:"<template "+l(c,["name","title","comment"])+">"+c.toXML()+"</template>",contentType:"application/xml",dataType:"json"},S(b,c.service.authorise(d).then(function(a){return c.service.doReq(a)}))}}(this))},a.prototype.getCodeURI=function(a){var b,c;return b={query:this.toXML(),lang:a,format:"text"},null!=(null!=(c=this.service)?c.token:void 0)&&(b.token=this.service.token),this.service.root+"query/code?"+O(b)},a.prototype.getExportURI=function(b,c){var d,e;return null==b&&(b="tab"),null==c&&(c={}),$.call(a.BIO_FORMATS,b)>=0?this["get"+b.toUpperCase()+"URI"](c):(d=E(c,{query:this.toXML(),format:b}),null!=(null!=(e=this.service)?e.token:void 0)&&(d.token=this.service.token),this.service.root+"query/results?"+O(d))},a.prototype.needsAuthentication=function(){return R.any(this.constraints,function(a){var b;return"NOT IN"===(b=a.op)||"IN"===b})},a.prototype.fetchQID=function(a){return S(a,this.service.post("queries",{query:this.toXML()}).then(w("id")))},b=function(a){return a.append("primaryIdentifier").toString()},a.prototype.__bio_req=function(a,c){var d,e;return e=this.makeListQuery(),d=function(b){return R.any(a,function(a){return b.isa(a)})},e.views=R.take(c)(function(){var a,e,f,g;for(f=this.getViewNodes(),g=[],a=0,e=f.length;a<e;a++)c=f[a],d(c)&&g.push(b(c));return g}.call(this)),{query:e.toXML(),format:"text"}},a.prototype._fasta_req=function(){return this.__bio_req(["SequenceFeature","Protein"],1)},a.prototype._gff3_req=function(){return this.__bio_req(["SequenceFeature"])},a.prototype._bed_req=a.prototype._gff3_req,a}(),Q=v(function(a,b){return a.concat(b)}),g.prototype.toString=g.prototype.toXML,g.ATTRIBUTE_OPS=Q([g.ATTRIBUTE_VALUE_OPS,g.MULTIVALUE_OPS,g.NULL_OPS]),g.REFERENCE_OPS=Q([g.TERNARY_OPS,g.LOOP_OPS,g.LIST_OPS]),k=function(a,b){return function(c,d){var e,f,g,h,i;return null==c&&(c={}),null==d&&(d=function(){}),R.isFunction(c)&&(i=[{},c],c=i[0],d=i[1]),e=function(a){return function(b){var c;return c=a.getPathInfo(b),c.isAttribute()?c:c.append("id")}}(this),null!=(null!=c?c.view:void 0)&&(c.view=function(){var a,b,d,e;for(d=c.view,e=[],a=0,b=d.length;a<b;a++)h=d[a],e.push(this.getPathInfo(h).toString());return e}.call(this)),f=null!=c.export?this.selectPreservingImpliedConstraints(c.export.map(e)):this,g=E(f[a](),c),b.call(f,g,d)}},Z=g.BIO_FORMATS,T=function(a){var b,c,d;return c="_"+a+"_req",b="get"+a.toUpperCase(),d=b+"URI",g.prototype[b]=k(c,function(b,c){return S(c,this.service.post("query/results/"+a,b))}),g.prototype[d]=k(c,function(b,c){return null!=this.service.token&&(b.token=this.service.token),this.service.root+"query/results/"+a+"?"+O(b)})};for(V=0,X=Z.length;V<X;V++)t=Z[V],T(t);for(U=function(a){return function(){var b,c,d,e;if(c=arguments[0],b=2<=arguments.length?aa.call(arguments,1):[],this.service[a])return null==c?c={}:R.isFunction(c)&&(c={},b=function(){var a,b,c;for(c=[],a=0,b=arguments.length;a<b;a++)d=arguments[a],c.push(d);return c}.apply(this,arguments)),c=H(E({start:this.start,size:this.maxRows},c)),(e=this.service)[a].apply(e,[this,c].concat(aa.call(b)));throw new Error("Service does not provide '"+a+"'.")}},W=0,Y=i.length;W<Y;W++)F=i[W],g.prototype[F]=U(F);e.mixin(g.prototype),g.prototype.emit=g.prototype.trigger,g.prototype.bind=g.prototype.on,B.Query=g}).call(this)},{"./util":275,"./xml":277,"backbone-events-standalone":235}],271:[function(a,b,c){(function(){var b,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa=function(a,b){return function(){return a.apply(b,arguments)}},pa={}.hasOwnProperty,qa=[].slice;for(x=a("./promise"),s=a("./model").Model,A=a("./query").Query,p=a("./lists").List,N=a("./user").User,k=a("./id-resolution-job").IDResolutionJob,fa=a("./version"),ea=a("./util"),Y=a("./http"),da=ea.querystring,ga=ea.withCB,$=ea.map,_=ea.merge,W=ea.get,ba=ea.set,Z=ea.invoke,ca=ea.success,V=ea.error,D=ea.REQUIRES_VERSION,U=ea.dejoin,O={},d={},B={},q={},H={},R={},g="http://",P="version",K="templates",C="version/release",e="classkeys",m="lists",r="model",G="summaryfields",y="query/results",z="search",S="widgets",h="list/enrichment",T="listswithobject",n={union:"lists/union",intersection:"lists/intersect",difference:"lists/diff"},E="lists/subtract",Q="user/whoami",J=y+"/tablerows",w="user/preferences",v="path/values",M="user/tokens",l="ids",u={},ma=[P,C,e,S,r,G,z,v],ia=0,ka=ma.length;ia<ka;ia++)aa=ma[ia],u[aa]=!0;for(b={},na=[Q,w,n,E,T,h,K,M],ja=0,la=na.length;ja<la;ja++)aa=na[ja],b[aa]=!0;t=function(a,c){return!u[a]&&(!!b[a]||(null==c||!c.needsAuthentication||c.needsAuthentication()))},i=/^https?:\/\//i,j=/service\/?$/i,F="/service/",f=function(a){var b;return(null!=(b=console.error)?b:console.log)(a)},ha=function(a,b,c,d,e){var f,g,h,i,j;return h=this.root,i=this.useCache,g=null!=this[a]?this[a]:this[a]=i&&(j=b[h])?ca(j):(f={type:"GET",dataType:"json",data:{format:"json"}},this.doReq(_(f,{url:this.root+c})).then(function(a){return b[h]=a[d]})),ga(e,g)},X=function(a){return function(b){return new x(function(c,d){var e;return(e=ea.find(b,function(b){return b.name===a}))?c(e):d('List "'+a+'" not found among: '+b.map(W("name")))})}},o=function(a,b){return null==b&&(b="listName"),ea.compose(a.fetchList,W(b))},L=function(a){var b,c,d,e,f,g;for(null==a&&(a=[]),e=ea.isArray(a)?a:[a],g=[],c=0,d=e.length;c<d;c++)b=e[c],g.push(null!=(f=b.name)?f:b);return g},I=function(){function a(a){var b;if(this.root=a.root,this.token=a.token,this.errorHandler=a.errorHandler,this.DEBUG=a.DEBUG,this.help=a.help,b=a.noCache,this.headers=a.headers,this.connectAs=oa(this.connectAs,this),this.createList=oa(this.createList,this),this.resolveIds=oa(this.resolveIds,this),this.templateQuery=oa(this.templateQuery,this),this.savedQuery=oa(this.savedQuery,this),this.query=oa(this.query,this),this.fetchRelease=oa(this.fetchRelease,this),this.fetchClassKeys=oa(this.fetchClassKeys,this),this.fetchVersion=oa(this.fetchVersion,this),this.fetchSummaryFields=oa(this.fetchSummaryFields,this),this.fetchModel=oa(this.fetchModel,this),this.fetchWidgetMap=oa(this.fetchWidgetMap,this),this.fetchWidgets=oa(this.fetchWidgets,this),this.complement=oa(this.complement,this),this.fetchListsContaining=oa(this.fetchListsContaining,this),this.fetchList=oa(this.fetchList,this),this.findLists=oa(this.findLists,this),this.fetchLists=oa(this.fetchLists,this),this.fetchTemplates=oa(this.fetchTemplates,this),this.tableRows=oa(this.tableRows,this),this.values=oa(this.values,this),this.rows=oa(this.rows,this),this.records=oa(this.records,this),this.table=oa(this.table,this),this.pathValues=oa(this.pathValues,this),this.fetchUser=oa(this.fetchUser,this),this.whoami=oa(this.whoami,this),this.findById=oa(this.findById,this),this.count=oa(this.count,this),this.enrichment=oa(this.enrichment,this),null==this.root)throw new Error("No service root provided. This is required");i.test(this.root)||(this.root=g+this.root),j.test(this.root)||(this.root=this.root+F),this.root=this.root.replace(/ice$/,"ice/"),null==this.headers&&(this.headers=null),null==this.errorHandler&&(this.errorHandler=f),null==this.help&&(this.help="no.help.available@dev.null"),this.useCache=!b,this.getFormat=function(a){return function(a){return null==a&&(a="json"),a}}()}var b,c,u,x,I,M;return a.prototype.doReq=function(){return arguments[0]=this.attachCustomHeaders(arguments[0]),Y.doReq.apply(this,arguments)},a.prototype.post=function(a,b){return this.makeRequest("POST",a,b)},a.prototype.get=function(a,b){return this.makeRequest("GET",a,b)},a.prototype.makeRequest=function(a,b,c,d,e){var f,g,h,i,j,k,l;return null==a&&(a="GET"),null==b&&(b=""),null==c&&(c={}),null==d&&(d=function(){}),null==e&&(e=!1),ea.isArray(d)&&(j=d,d=j[0],g=j[1]),ea.isArray(c)&&(c=ea.pairsToObj(c)),null==g&&(g=this.errorHandler),c=ea.copy(c),f=this.getFormat(c.format),Y.supports(a)||(k=[a,Y.getMethod(a)],c.method=k[0],a=k[1]),h={data:c,dataType:f,success:d,error:g,path:b,type:a},null!=c.auth&&(h.auth=c.auth,delete h.data.auth),null!=c.headers&&(h.headers=ea.copy(c.headers),delete h.data.headers),(i=null!=(l=c.timeout)?l:this.timeout)&&(h.timeout=i,delete c.timeout),this.authorise(h).then(function(a){return function(b){return a.doReq(b,e)}}(this))},a.prototype.authorise=function(a){return this.fetchVersion().then(function(b){return function(c){var d,e,f;return d=ea.copy(a),null==d.headers&&(d.headers={}),d.url=b.root+d.path,e=[],c<14&&("string"==typeof d.data?e.push(["format",d.dataType]):d.data.format=d.dataType),null!=b.token&&t(a.path,null!=(f=d.data)?f.query:void 0)&&(c>=14?d.headers.Authorization="Token "+b.token:"string"==typeof d.data?e.push(["token",b.token]):d.data.token=b.token),e.length&&(d.url+="?"+da(e)),d}}(this))},a.prototype.attachCustomHeaders=function(a){var b;return null!=this.headers?(b=ea.copy(a),b.headers=ea.merge(b.headers,this.headers),b):a},a.prototype.enrichment=function(a,b){return D(this,8,function(c){return function(){var d;return d=_({maxp:.05,correction:"Holm-Bonferroni"},a),ga(b,c.get(h,d).then(W("results")))}}(this))},a.prototype.search=function(a,b){return null==a&&(a={}),null==b&&(b=function(){}),D(this,9,function(c){return function(){var d,e,f,g;if(ea.isFunction(a)&&(g=[a,{}],b=g[0],a=g[1]),"string"==typeof a)e={q:a};else{e={q:a.q,start:a.start,size:a.size};for(d in a)pa.call(a,d)&&(f=a[d],"q"!==d&&"start"!==d&&"size"!==d&&(e["facet_"+d]=f))}return ga(b,c.post(z,e))}}(this))},a.prototype.makePath=function(a,b,c){return null==b&&(b={}),null==c&&(c=function(){}),ga(c,this.fetchModel().then(function(c){return c.makePath(a,b)}))},a.prototype.count=function(a,b){var c,d;return null==b&&(b=function(){}),c=a?null!=a.toPathString?(aa=a.isClass()?a.append("id"):a,this.pathValues(aa,"count")):null!=a.toXML?(d={query:a,format:"jsoncount"},this.post(y,d).then(W("count"))):"string"==typeof a?this.fetchModel().then(function(b){return function(c){try{return b.count(c.makePath(a))}catch(c){return c,b.query({select:[a]}).then(b.count)}}}(this)):this.query(a).then(this.count):V("Not enough arguments"),ga(b,c)},a.prototype.findById=function(a,b,c,d){var e,f;return null==c&&(c=["**"]),null==d&&(d=function(){}),ea.isFunction(c)&&(f=[["**"],c],c=f[0],d=f[1]),e=this.query({from:a,select:c,where:{id:b}}).then(U).then(Z("records")).then(W(0)),ga(d,e)},a.prototype.lookup=function(a,b,c,d){var e,f;return ea.isFunction(c)&&(f=[null,c],c=f[0],d=f[1]),e=this.query({from:a,select:["**"],where:[[a,"LOOKUP",b,c]]}).then(U).then(Z("records")),ga(d,e)},a.prototype.find=function(a,b,c,d){var e;return ea.isFunction(c)&&(e=[null,c],c=e[0],d=e[1]),ga(d,this.lookup(a,b,c).then(function(a){return null==a||0===a.length?V("Nothing found"):a.length>1?V("Multiple items found: "+a.slice(0,3)+"..."):ca(a[0])}))},a.prototype.whoami=function(a){return D(this,9,function(b){return function(){return ga(a,b.get(Q).then(W("user")).then(function(a){return new N(b,a)}))}}(this))},a.prototype.fetchUser=function(){var a;return a=1<=arguments.length?qa.call(arguments,0):[],this.whoami.apply(this,a)},I=function(a,b){return{format:a,path:String(b),typeConstraints:JSON.stringify(b.subclasses)}},a.prototype.pathValues=function(a,b,c){return null==b&&(b={}),D(this,6,function(d){return function(){var e,f,g,h,i;return"string"==typeof b&&(h=b,b={}),ea.isFunction(b)&&(i=[c,b],b=i[0],c=i[1]),"count"!==h&&(h="results"),f="count"===h?"jsoncount":"json",g=function(){var c;try{return this.fetchModel().then(Z("makePath",a,null!=(c=a.subclasses)?c:b)).then(function(a){return I(f,a)}).then(function(a){return function(b){return a.post(v,b)}}(this)).then(W(h))}catch(a){return e=a,V(e)}}.call(d),ga(c,g)}}(this))},a.prototype.doPagedRequest=function(a,b,c,d,e){var f,g;return null==c&&(c={}),null==e&&(e=function(){}),null!=a.toXML?(ea.isFunction(c)&&(g=[c,{}],e=g[0],c=g[1]),f=_(c,{query:a,format:d}),ga(e,this.post(b,f).then(W("results")))):this.query(a).then(function(a){return function(f){return a.doPagedRequest(f,b,c,d,e)}}(this))},a.prototype.table=function(a,b,c){return this.doPagedRequest(a,y,b,"jsontable",c)},a.prototype.records=function(a,b,c){return this.doPagedRequest(a,y,b,"jsonobjects",c)},a.prototype.rows=function(a,b,c){return this.doPagedRequest(a,y,b,"json",c)},a.prototype.values=function(a,b,c){var d,e;return ea.isFunction(b)&&(e=[b,c],c=e[0],b=e[1]),d=null==a?V("No query term supplied"):null!=a.descriptors||"string"==typeof a?this.pathValues(a,b).then($(W("value"))):null!=a.toXML?1!==a.views.length?V("Expected one column, got "+a.views.length):this.rows(a,b).then($(W(0))):this.query(a).then(function(a){return function(c){return a.values(c,b)}}(this)),ga(c,d)},a.prototype.tableRows=function(a,b,c){return this.doPagedRequest(a,J,b,"json",c)},a.prototype.fetchTemplates=function(a){return ga(a,this.get(K).then(W("templates")))},a.prototype.fetchLists=function(a){return this.findLists("",a)},a.prototype.findLists=function(a,b){return null==a&&(a=""),null==b&&(b=function(){}),this.fetchVersion().then(function(c){return function(d){var e;return ga(b,a&&d<13?V("Finding lists by name on the server requires version 13. This is only "+d):(e=function(a){var b,d,e,f;for(f=[],d=0,e=a.length;d<e;d++)b=a[d],f.push(new p(b,c));return f},c.get(m,{name:a}).then(W("lists")).then(e)))}}(this))},a.prototype.fetchList=function(a,b){return this.fetchVersion().then(function(c){return function(d){return ga(b,d<13?c.findLists().then(X(a)):c.findLists(a).then(W(0)))}}(this))},a.prototype.fetchListsContaining=function(a,b){var c;return c=function(a){return function(b){var c,d,e,f;for(f=[],d=0,e=b.length;d<e;d++)c=b[d],f.push(new p(c,a));return f}}(this),ga(b,this.get(T,a).then(W("lists")).then(c))},a.prototype.combineLists=function(a,b,c){var d,e,f,g,h,i;return i=_({lists:[],tags:[]},b),f=i.name,e=i.lists,h=i.tags,d=i.description,g={name:f,description:d},null==g.description&&(g.description=a+" of "+e.join(", ")),g.tags=h.join(";"),g.lists=e.join(";"),ga(c,this.get(n[a],g).then(o(this)))},a.prototype.merge=function(){return this.combineLists.apply(this,["union"].concat(qa.call(arguments)))},a.prototype.intersect=function(){return this.combineLists.apply(this,["intersection"].concat(qa.call(arguments)))},a.prototype.diff=function(){return this.combineLists.apply(this,["difference"].concat(qa.call(arguments)))},a.prototype.complement=function(a,b){var c,d,e,f,g,h,i,j,k;return null==a&&(a={}),null==b&&(b=function(){}),f=a.from,e=a.exclude,h=a.name,d=a.description,k=a.tags,c=function(){return"Relative complement of "+g.join(" and ")+" in "+i.join(" and ")},i=L(f),g=L(e),null==h&&(h=c()),null==d&&(d=c()),null==k&&(k=[]),j={name:h,description:d,tags:k,lists:g,references:i},ga(b,this.post(E,j).then(o(this)))},a.prototype.fetchWidgets=function(a){return D(this,8,function(b){return function(){return ha.call(b,"widgets",R,S,"widgets",a)}}(this))},M=ea.omap(function(a){return[a.name,a]}),a.prototype.fetchWidgetMap=function(a){return D(this,8,function(b){return function(){return ga(a,null!=b.__wmap__?b.__wmap__:b.__wmap__=b.fetchWidgets().then(M))}}(this))},a.prototype.fetchModel=function(a){var b;return b=ha.call(this,"model",q,r,"model").then(s.load).then(ba({service:this})),ga(a,b)},a.prototype.fetchSummaryFields=function(a){return ha.call(this,"summaryFields",H,G,"classes",a)},a.prototype.fetchVersion=function(a){return ha.call(this,"version",O,P,"version",a)},a.prototype.fetchClassKeys=function(a){return ha.call(this,"classkeys",d,e,"classes",a)},a.prototype.fetchRelease=function(a){return ha.call(this,"release",B,C,"version",a)},a.prototype.query=function(a,b){var c;return c=function(b){return function(c){var d,e;return d=c[0],e=c[1],new A(a,b,{model:d,summaryFields:e})}}(this),ga(b,ea.parallel(this.fetchModel(),this.fetchSummaryFields()).then(c))},x=function(a,b){return function(c){return c?a.query(c):V("No query found called "+b)}},c=function(a){return a?"string"==typeof a?ca():V("Name must be a string"):V("Name not provided")},a.prototype.savedQuery=function(a,b){return D(this,16,function(d){return function(){return c(a).then(function(){return ga(b,d.get("user/queries",{filter:a}).then(function(b){return b.queries[a]}).then(x(d,a)))})}}(this))},a.prototype.templateQuery=function(a,b){return c(a).then(function(c){return function(){return ga(b,c.fetchTemplates().then(W(a)).then(ba("type","TEMPLATE")).then(x(c,a)))}}(this))},a.prototype.manageUserPreferences=function(a,b,c){return D(this,11,function(d){return function(){return ga(c,d.makeRequest(a,w,b).then(W("preferences")))}}(this))},a.prototype.resolveIds=function(a,b){return D(this,10,function(c){return function(){var d;return d={type:"POST",url:c.root+l,contentType:"application/json",data:JSON.stringify(a),dataType:"json"},ga(b,c.doReq(d).then(W("uid")).then(k.create(c)))}}(this))},a.prototype.resolutionJob=function(a){return k.create(this)(a)},a.prototype.createList=function(a,b,c){var d,e;return null==a&&(a={}),null==b&&(b=""),null==c&&(c=function(){}),d=function(b){return function(c){return _(c,{token:b.token,tags:a.tags||[]})}}(this),e={data:ea.isArray(b)?b.map(function(a){return'"'+a+'"'}).join("\n"):b,dataType:"json",url:this.root+"lists?"+da(d(a)),type:"POST",contentType:"text/plain"},ga(c,this.doReq(e).then(o(this)))},u=function(a){return a.user.temporaryToken},a.prototype.connectAs=function(b){return a.connect(_(this,{token:b,noCache:!this.useCache}))},a.prototype.register=function(a,b,c){return D(this,9,function(d){return function(){return ga(c,d.post("users",{name:a,password:b}).then(u).then(d.connectAs))}}(this))},b=300,a.prototype.getDeregistrationToken=function(a,c){return null==a&&(a=b),D(this,16,function(b){return function(){var d;return d=null!=b.token?b.post("user/deregistration",{validity:a}).then(W("token")):V("Not registered"),ga(c,d)}}(this))},a.prototype.deregister=function(a,b){return D(this,16,function(c){return function(){return ga(b,c.makeRequest("DELETE","user",{deregistrationToken:a,format:"xml"}))}}(this))},a.prototype.login=function(a,b,c){return D(this,9,function(d){return function(){var e;return e=a+":"+b,ga(c,d.logout().then(function(a){return a.get("user/token",{auth:e})})).then(W("token")).then(d.connectAs)}}(this))},a.prototype.logout=function(a){return ga(a,ca(this.connectAs()))},a}(),I.prototype.rowByRow=function(){var a,b,c;return c=arguments[0],a=2<=arguments.length?qa.call(arguments,1):[],b=Y.iterReq("POST",y,"json"),null!=c.toXML?b.apply(this,arguments):this.query(c).then(function(b){return function(c){return b.rowByRow.apply(b,[c].concat(qa.call(a)))}}(this))},I.prototype.eachRow=I.prototype.rowByRow,I.prototype.recordByRecord=function(){var a,b,c;return c=arguments[0],a=2<=arguments.length?qa.call(arguments,1):[],b=Y.iterReq("POST",y,"jsonobjects"),null!=c.toXML?b.apply(this,arguments):this.query(c).then(function(b){return function(c){return b.recordByRecord.apply(b,[c].concat(qa.call(a)))}}(this))},I.prototype.eachRecord=I.prototype.recordByRecord,I.prototype.union=I.prototype.merge,I.prototype.difference=I.prototype.diff,I.prototype.symmetricDifference=I.prototype.diff,I.prototype.relativeComplement=I.prototype.complement,I.prototype.subtract=I.prototype.complement,I.flushCaches=function(){return q={},O={},B={},d={},H={},R={}},I.connect=function(a){if(null==(null!=a?a.root:void 0))throw new Error("Invalid options provided: "+JSON.stringify(a));return new I(a)},c.Service=I,c.Model=s,c.Query=A,c.utils=ea,c.VERSION=fa.VERSION,c.imjs=fa}).call(this)},{"./http":264,"./id-resolution-job":265,"./lists":266,"./model":267,"./promise":269,"./query":270,"./user":274,"./util":275,"./version":276}],272:[function(a,b,c){(function(a){(function(){c.DOMParser=null!=a.DOMParser?a.DOMParser:function(){function a(){throw new Error("DOMParser is not available")}return a}()}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],273:[function(a,b,c){(function(){var b,d,e,f=function(a,b){return function(){return a.apply(b,arguments)}};d=function(a,b){var c,d,e;e=[];for(c in a)d=a[c],e.push(b[c]=d);return e},b=a("./promise"),e=["attributes","references","collections"],c.Table=function(){function a(a,b){var c,g,h,i,j,k,l;for(this.model=b,this.getDisplayName=f(this.getDisplayName,this),this.name=a.name,this.tags=a.tags,this.displayName=a.displayName,this.attributes=a.attributes,this.references=a.references,this.collections=a.collections,this.fields={},this.__parents__=null!=(k=a.extends)?k:[],i=0,j=e.length;i<j;i++){if(g=e[i],null==this[g])throw new Error("Bad model data: missing "+g);d(this[g],this.fields)}l=this.collections;for(h in l)c=l[h],c.isCollection=!0}return a.prototype.toString=function(){var a,b;return"[Table name="+this.name+", fields=["+function(){var c,d;c=this.fields,d=[];for(a in c)b=c[a],d.push(a);return d}.call(this)+"]]"},a.prototype.parents=function(){var a;return(null!=(a=this.__parents__)?a:[]).slice()},a.prototype.getDisplayName=function(){return new b(function(a){return function(b,c){return null!=a.model?b(a.model.makePath(a.name).getDisplayName()):c(new Error("model not set - cannot make path"))}}(this))},a}()}).call(this)},{"./promise":269}],274:[function(a,b,c){(function(){var b,d,e,f,g,h,i,j=function(a,b){return function(){return a.apply(b,arguments)}};i=a("./util"),h=i.withCB,f=i.get,g=i.isFunction,b=i.any,e=i.error,d=function(a,b,c,d){return a.service.manageUserPreferences(c,b,d).then(function(b){return a.preferences=b})},c.User=function(){function a(a,b){this.service=a,this.username=b.username,this.preferences=b.preferences,this.refresh=j(this.refresh,this),this.clearPreferences=j(this.clearPreferences,this),this.clearPreference=j(this.clearPreference,this),this.setPreferences=j(this.setPreferences,this),this.setPreference=j(this.setPreference,this),this.hasPreferences=null!=this.preferences,null==this.preferences&&(this.preferences={})}return a.prototype.setPreference=function(a,b,c){var d,f;if(g(b)&&(f=[null,b],b=f[0],c=f[1]),"string"==typeof a)d={},d[a]=b;else{if(null!=b)return h(c,e("Incorrect arguments to setPreference"));d=a}return this.setPreferences(d,c)},a.prototype.setPreferences=function(a,b){return d(this,a,"POST",b)},a.prototype.clearPreference=function(a,b){return d(this,{key:a},"DELETE",b)},a.prototype.clearPreferences=function(a){return d(this,{},"DELETE",a)},a.prototype.refresh=function(a){return d(this,{},"GET",a)},a.prototype.createToken=function(a,c,d){var e,i;return null==a&&(a="day"),null==d&&b([a,c],g)&&(g(a)?(e=[null,null,a],a=e[0],c=e[1],d=e[2]):g(c)&&(i=[null,c],c=i[0],d=i[1])),h(d,this.service.post("user/tokens",{type:a,message:c}).then(f("token")))},a.prototype.fetchCurrentTokens=function(a){return h(a,this.service.get("user/tokens").then(f("tokens")))},a.prototype.revokeAllTokens=function(a){return h(a,this.service.makeRequest("DELETE","user/tokens"))},a.prototype.revokeToken=function(a,b){return h(b,this.service.makeRequest("DELETE","user/tokens/"+a))},a}()}).call(this)},{"./util":275}],275:[function(a,b,c){(function(){var b,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w=[].slice,x=[].indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(b in this&&this[b]===a)return b;return-1},y={}.hasOwnProperty;b=a("./promise"),s=c,s.defer=function(){var a;return a={},a.promise=new b(function(b,c){return a.resolve=b,a.reject=c}),a},g=function(a){return encodeURIComponent(String(a))},r=function(a){var b;return function(){var c,d,e;for(e=[],c=0,d=a.length;c<d;c++)b=a[c],e.push(b.map(g).join("="));return e}().join("&")},s.querystring=function(a){var b,c,d,e,f,g;if(!a)return"";if(o(a))d=a.slice();else{d=[];for(b in a)g=a[b],o(g)?(e=function(){var a,c,d;for(d=[],a=0,c=g.length;a<c;a++)f=g[a],d.push([b,f]);return d}(),d=d.concat(e)):d.push([b,g])}return r(function(){var a,b,e;for(e=[],a=0,b=d.length;a<b;a++)c=d[a],null!=c[1]&&e.push(c);return e}())},s.curry=f=function(){var a,b;return b=arguments[0],a=2<=arguments.length?w.call(arguments,1):[],function(){var c;return c=1<=arguments.length?w.call(arguments,0):[],b.apply(null,a.concat(c))}},s.error=i=function(a){return new b(function(b,c){return c(new Error(a))})},s.success=t=function(a){return new b(function(b,c){return b(a)})},s.parallel=function(){var a;return a=1<=arguments.length?w.call(arguments,0):[],1===a.length&&!a[0].then&&a[0].length?b.all(a[0]):b.all(a)},s.withCB=function(){var a,b,c,d,e,g,h,i;for(b=2<=arguments.length?w.call(arguments,0,g=arguments.length-1):(g=0,[]),e=arguments[g++],h=0,i=b.length;h<i;h++)null!=(a=b[h])&&(d=f(a,null),c=a,e.then(d,c));return e},s.fold=k=function(a){return function(b,c){var d,e,f;if(1===arguments.length&&(c=(null!=b?b.slice():void 0)||b,b=(null!=c?c.shift():void 0)||{}),null==c)throw new Error("xs is null");if(null!=c.reduce)return c.reduce(a,b);e=b;for(d in c)f=c[d],e=null!=e?a(e,d,f):{k:f};return e}},s.take=function(a){return function(b){return null!=a?b.slice(0,+(a-1)+1||9e9):b.slice()}},s.filter=function(a){return function(b){var c,d,e,f;for(f=[],d=0,e=b.length;d<e;d++)c=b[d],a(c)&&f.push(c);return f}},s.uniqBy=function(a,b){
var c,d,e,g,h,i;if(1===arguments.length)return f(s.uniqBy,a);if(d=[],e=[],null==b)return e;for(h=0,i=b.length;h<i;h++)g=b[h],c=a(g),x.call(d,c)<0&&(d.push(c),e.push(g));return e},s.find=function(a,b){var c,d,e;if(1===arguments.length)return b=a,function(a){return s.find(a,b)};for(d=0,e=a.length;d<e;d++)if(c=a[d],b(c))return c;return null},o=null!=(v=Array.isArray)?v:function(a){return null!=(null!=a?a.splice:void 0)&&null!=(null!=a?a.push:void 0)&&null!=(null!=a?a.pop:void 0)&&null!=(null!=a?a.slice:void 0)},s.isArray=o,s.isFunction="function"!=typeof/./?function(a){return"function"==typeof a}:function(a){return null!=a&&null!=a.call&&null!=a.apply&&"[object Function]"===a.toString()},h={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&apos;"},s.escape=function(a){var b,c,d,e,f,g;if(null==a)return"";for(e=String(a).replace(/[&<>"']/g,function(a){return h[a]}),d=[],c=f=0,g=e.length;0<=g?f<=g:f>=g;c=0<=g?++f:--f)b=e.charCodeAt(c),b>256?d.push("&#"+b+";"):d.push(e.charAt(c));return d.join("")},s.omap=function(a){var b;return b=k(function(b,c,d){var e,f,g;return g=a(c,d),e=g[0],f=g[1],o(f)&&(f=f.slice()),b[e]=f,b}),function(a){return b({},a)}},s.copy=s.omap(function(a,b){return[a,b]}),s.partition=function(a){return function(b){return k(function(b,c){var d,e;return e=b[0],d=b[1],a(c)?[e.concat([c]),d]:[e,d.concat([c])]})([[],[]],b)}},s.merge=function(a,b){return extend(extend({},a),b)},s.extend=function(a,b){var c,d,e;e=[];for(c in b)d=b[c],e.push(a[c]=d);return e},s.id=l=function(a){return a},s.concatMap=function(a){return function(b){var c,d,e,f,g;for(d=void 0,f=0,g=b.length;f<g;f++)e=b[f],c=a(e),d=void 0===d?c:"number"==typeof d?d+c:null!=d.concat?d.concat(c):p(d,c);return d}},s.map=function(a){return m("map",a)},e=k(function(a,b){return function(){var c;return c=1<=arguments.length?w.call(arguments,0):[],a(b.apply(null,c))}}),s.compose=function(){var a;return a=1<=arguments.length?w.call(arguments,0):[],e(a)},s.flatMap=s.concatMap,s.difference=function(a,b){var c,d,e,f;for(f=[],d=0,e=a.length;d<e;d++)c=a[d],x.call(b,c)<0&&f.push(c);return f},s.stringList=function(a){return"string"==typeof a?[a]:a},s.flatten=j=function(){var a,b,c,d,e,f,g,h,i;for(c=1<=arguments.length?w.call(arguments,0):[],a=[],e=0,g=c.length;e<g;e++)if(b=c[e],o(b))for(i=j.apply(null,b),f=0,h=i.length;f<h;f++)d=i[f],a.push(d);else a.push(b);return a},s.sum=s.concatMap(l),s.merge=p=function(){var a,b,c,d,e,f,g;for(d=1<=arguments.length?w.call(arguments,0):[],b={},f=0,g=d.length;f<g;f++){c=d[f];for(a in c)y.call(c,a)&&(e=c[a],b[a]=e)}return b},s.any=function(a,b){var c,d,e;for(null==b&&(b=l),d=0,e=a.length;d<e;d++)if(c=a[d],b(c))return!0;return!1},s.invoke=m=function(){var a,b;return b=arguments[0],a=2<=arguments.length?w.call(arguments,1):[],n(b,a)},s.invokeWith=n=function(a,b,c){return null==b&&(b=[]),null==c&&(c=null),function(d){if(null==d)throw new Error('Cannot call method "'+a+'" of null');if(d[a])return d[a].apply(c||d,b);throw new Error('Cannot call undefined method "'+a+" of "+d)}},s.get=function(a){return function(b){return b[a]}},s.set=function(a,b){return function(c){var d,e;if(2===arguments.length)c[a]=b;else for(d in a)y.call(a,d)&&(e=a[d],c[d]=e);return c}},d=function(a,b){return"This service requires a service at version "+a+" or above. This one is at "+b},s.REQUIRES_VERSION=function(a,b,c){return a.fetchVersion().then(function(a){return a>=b?c():i(d(b,a))})},s.dejoin=function(a){var b,c,d,e,f;for(f=a.views,d=0,e=f.length;d<e;d++)c=f[d],b=c.split("."),b.length>2&&a.addJoin(b.slice(1,-1).join("."));return a},u=k(function(a,b){return a.then(b)}),s.sequence=function(){var a;return a=1<=arguments.length?w.call(arguments,0):[],u(t(),a)},q=k(function(a,b){var c,d;if(c=b[0],d=b[1],null!=a[c])throw new Error("Duplicate key: "+c);return a[c]=d,a}),s.pairsToObj=function(a){return q({},a)}}).call(this)},{"./promise":269}],276:[function(a,b,c){(function(){c.VERSION="3.16.0"}).call(this)},{}],277:[function(a,b,c){(function(){var b,d;b=a("xmldom").DOMParser,d=function(a){return a=a.replace(/^\s*/g,""),a=a.replace(/\s$/g,""),0===a.length?a:">"!==a[a.length-1]?a+">":a},c.parse=function(a){var c,e;if("string"!=typeof a)throw new Error("Expected a string - got "+a);if(!(a=d(a)))throw new Error("Expected content - got empty string");if(!(c=function(){try{return e=new b,e.parseFromString(a,"text/xml")}catch(a){}}())||!c.documentElement||c.getElementsByTagName("parsererror").length)throw new Error("Invalid XML: "+a);return c}}).call(this)},{xmldom:272}],278:[function(a,b,c){"function"==typeof Object.create?b.exports=function(a,b){a.super_=b,a.prototype=Object.create(b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}})}:b.exports=function(a,b){a.super_=b;var c=function(){};c.prototype=b.prototype,a.prototype=new c,a.prototype.constructor=a}},{}],279:[function(a,b,c){function d(a){return!!a.constructor&&"function"==typeof a.constructor.isBuffer&&a.constructor.isBuffer(a)}function e(a){return"function"==typeof a.readFloatLE&&"function"==typeof a.slice&&d(a.slice(0,0))}b.exports=function(a){return null!=a&&(d(a)||e(a)||!!a._isBuffer)}},{}],280:[function(a,b,c){var d={}.toString;b.exports=Array.isArray||function(a){return"[object Array]"==d.call(a)}},{}],281:[function(a,b,c){var d=a("jquery");!function(a,b){function c(b,c){var e,f,g,h=b.nodeName.toLowerCase();return"area"===h?(e=b.parentNode,f=e.name,!(!b.href||!f||"map"!==e.nodeName.toLowerCase())&&(!!(g=a("img[usemap=#"+f+"]")[0])&&d(g))):(/input|select|textarea|button|object/.test(h)?!b.disabled:"a"===h?b.href||c:c)&&d(b)}function d(b){return a.expr.filters.visible(b)&&!a(b).parents().addBack().filter(function(){return"hidden"===a.css(this,"visibility")}).length}var e=0,f=/^ui-id-\d+$/;a.ui=a.ui||{},a.extend(a.ui,{version:"1.10.4",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),a.fn.extend({focus:function(b){return function(c,d){return"number"==typeof c?this.each(function(){var b=this;setTimeout(function(){a(b).focus(),d&&d.call(b)},c)}):b.apply(this,arguments)}}(a.fn.focus),scrollParent:function(){var b;return b=a.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(a.css(this,"position"))&&/(auto|scroll)/.test(a.css(this,"overflow")+a.css(this,"overflow-y")+a.css(this,"overflow-x"))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(a.css(this,"overflow")+a.css(this,"overflow-y")+a.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!b.length?a(document):b},zIndex:function(c){if(c!==b)return this.css("zIndex",c);if(this.length)for(var d,e,f=a(this[0]);f.length&&f[0]!==document;){if(("absolute"===(d=f.css("position"))||"relative"===d||"fixed"===d)&&(e=parseInt(f.css("zIndex"),10),!isNaN(e)&&0!==e))return e;f=f.parent()}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++e)})},removeUniqueId:function(){return this.each(function(){f.test(this.id)&&a(this).removeAttr("id")})}}),a.extend(a.expr[":"],{data:a.expr.createPseudo?a.expr.createPseudo(function(b){return function(c){return!!a.data(c,b)}}):function(b,c,d){return!!a.data(b,d[3])},focusable:function(b){return c(b,!isNaN(a.attr(b,"tabindex")))},tabbable:function(b){var d=a.attr(b,"tabindex"),e=isNaN(d);return(e||d>=0)&&c(b,!e)}}),a("<a>").outerWidth(1).jquery||a.each(["Width","Height"],function(c,d){function e(b,c,d,e){return a.each(f,function(){c-=parseFloat(a.css(b,"padding"+this))||0,d&&(c-=parseFloat(a.css(b,"border"+this+"Width"))||0),e&&(c-=parseFloat(a.css(b,"margin"+this))||0)}),c}var f="Width"===d?["Left","Right"]:["Top","Bottom"],g=d.toLowerCase(),h={innerWidth:a.fn.innerWidth,innerHeight:a.fn.innerHeight,outerWidth:a.fn.outerWidth,outerHeight:a.fn.outerHeight};a.fn["inner"+d]=function(c){return c===b?h["inner"+d].call(this):this.each(function(){a(this).css(g,e(this,c)+"px")})},a.fn["outer"+d]=function(b,c){return"number"!=typeof b?h["outer"+d].call(this,b):this.each(function(){a(this).css(g,e(this,b,!0,c)+"px")})}}),a.fn.addBack||(a.fn.addBack=function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}),a("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(a.fn.removeData=function(b){return function(c){return arguments.length?b.call(this,a.camelCase(c)):b.call(this)}}(a.fn.removeData)),a.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),a.support.selectstart="onselectstart"in document.createElement("div"),a.fn.extend({disableSelection:function(){return this.bind((a.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(a){a.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),a.extend(a.ui,{plugin:{add:function(b,c,d){var e,f=a.ui[b].prototype;for(e in d)f.plugins[e]=f.plugins[e]||[],f.plugins[e].push([c,d[e]])},call:function(a,b,c){var d,e=a.plugins[b];if(e&&a.element[0].parentNode&&11!==a.element[0].parentNode.nodeType)for(d=0;d<e.length;d++)a.options[e[d][0]]&&e[d][1].apply(a.element,c)}},hasScroll:function(b,c){if("hidden"===a(b).css("overflow"))return!1;var d=c&&"left"===c?"scrollLeft":"scrollTop",e=!1;return b[d]>0||(b[d]=1,e=b[d]>0,b[d]=0,e)}})}(d)},{jquery:288}],282:[function(a,b,c){var d=a("jquery");a("./core"),a("./mouse"),a("./widget"),function(a,b){a.widget("ui.draggable",a.ui.mouse,{version:"1.10.4",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"!==this.options.helper||/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative"),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._mouseInit()},_destroy:function(){this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._mouseDestroy()},_mouseCapture:function(b){var c=this.options;return!(this.helper||c.disabled||a(b.target).closest(".ui-resizable-handle").length>0)&&(this.handle=this._getHandle(b),!!this.handle&&(a(!0===c.iframeFix?"iframe":c.iframeFix).each(function(){a("<div class='ui-draggable-iframeFix' style='background: #fff;'></div>").css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1e3}).css(a(this).offset()).appendTo("body")}),!0))},_mouseStart:function(b){var c=this.options;return this.helper=this._createHelper(b),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),a.ui.ddmanager&&(a.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(),this.offsetParent=this.helper.offsetParent(),this.offsetParentCssPosition=this.offsetParent.css("position"),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},this.offset.scroll=!1,a.extend(this.offset,{click:{left:b.pageX-this.offset.left,top:b.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(b),this.originalPageX=b.pageX,this.originalPageY=b.pageY,c.cursorAt&&this._adjustOffsetFromHelper(c.cursorAt),this._setContainment(),!1===this._trigger("start",b)?(this._clear(),!1):(this._cacheHelperProportions(),a.ui.ddmanager&&!c.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,b),this._mouseDrag(b,!0),a.ui.ddmanager&&a.ui.ddmanager.dragStart(this,b),!0)},_mouseDrag:function(b,c){if("fixed"===this.offsetParentCssPosition&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(b),this.positionAbs=this._convertPositionTo("absolute"),!c){var d=this._uiHash();if(!1===this._trigger("drag",b,d))return this._mouseUp({}),!1;this.position=d.position}return this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),a.ui.ddmanager&&a.ui.ddmanager.drag(this,b),!1},_mouseStop:function(b){var c=this,d=!1;return a.ui.ddmanager&&!this.options.dropBehaviour&&(d=a.ui.ddmanager.drop(this,b)),this.dropped&&(d=this.dropped,this.dropped=!1),!("original"===this.options.helper&&!a.contains(this.element[0].ownerDocument,this.element[0]))&&("invalid"===this.options.revert&&!d||"valid"===this.options.revert&&d||!0===this.options.revert||a.isFunction(this.options.revert)&&this.options.revert.call(this.element,d)?a(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){!1!==c._trigger("stop",b)&&c._clear()}):!1!==this._trigger("stop",b)&&this._clear(),!1)},_mouseUp:function(b){return a("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)}),a.ui.ddmanager&&a.ui.ddmanager.dragStop(this,b),a.ui.mouse.prototype._mouseUp.call(this,b)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(b){return!this.options.handle||!!a(b.target).closest(this.element.find(this.options.handle)).length},_createHelper:function(b){var c=this.options,d=a.isFunction(c.helper)?a(c.helper.apply(this.element[0],[b])):"clone"===c.helper?this.element.clone().removeAttr("id"):this.element;return d.parents("body").length||d.appendTo("parent"===c.appendTo?this.element[0].parentNode:c.appendTo),d[0]===this.element[0]||/(fixed|absolute)/.test(d.css("position"))||d.css("position","absolute"),d},_adjustOffsetFromHelper:function(b){"string"==typeof b&&(b=b.split(" ")),a.isArray(b)&&(b={left:+b[0],top:+b[1]||0}),"left"in b&&(this.offset.click.left=b.left+this.margins.left),"right"in b&&(this.offset.click.left=this.helperProportions.width-b.right+this.margins.left),"top"in b&&(this.offset.click.top=b.top+this.margins.top),"bottom"in b&&(this.offset.click.top=this.helperProportions.height-b.bottom+this.margins.top)},_getParentOffset:function(){var b=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&a.contains(this.scrollParent[0],this.offsetParent[0])&&(b.left+=this.scrollParent.scrollLeft(),b.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&a.ui.ie)&&(b={top:0,left:0}),{top:b.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:b.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var a=this.element.position();return{top:a.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:a.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var b,c,d,e=this.options;return e.containment?"window"===e.containment?void(this.containment=[a(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,a(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,a(window).scrollLeft()+a(window).width()-this.helperProportions.width-this.margins.left,a(window).scrollTop()+(a(window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):"document"===e.containment?void(this.containment=[0,0,a(document).width()-this.helperProportions.width-this.margins.left,(a(document).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):e.containment.constructor===Array?void(this.containment=e.containment):("parent"===e.containment&&(e.containment=this.helper[0].parentNode),c=a(e.containment),void((d=c[0])&&(b="hidden"!==c.css("overflow"),this.containment=[(parseInt(c.css("borderLeftWidth"),10)||0)+(parseInt(c.css("paddingLeft"),10)||0),(parseInt(c.css("borderTopWidth"),10)||0)+(parseInt(c.css("paddingTop"),10)||0),(b?Math.max(d.scrollWidth,d.offsetWidth):d.offsetWidth)-(parseInt(c.css("borderRightWidth"),10)||0)-(parseInt(c.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(b?Math.max(d.scrollHeight,d.offsetHeight):d.offsetHeight)-(parseInt(c.css("borderBottomWidth"),10)||0)-(parseInt(c.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relative_container=c))):void(this.containment=null)},_convertPositionTo:function(b,c){c||(c=this.position);var d="absolute"===b?1:-1,e="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&a.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent;return this.offset.scroll||(this.offset.scroll={top:e.scrollTop(),left:e.scrollLeft()}),{top:c.top+this.offset.relative.top*d+this.offset.parent.top*d-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():this.offset.scroll.top)*d,left:c.left+this.offset.relative.left*d+this.offset.parent.left*d-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():this.offset.scroll.left)*d}},_generatePosition:function(b){var c,d,e,f,g=this.options,h="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&a.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,i=b.pageX,j=b.pageY;return this.offset.scroll||(this.offset.scroll={top:h.scrollTop(),left:h.scrollLeft()}),this.originalPosition&&(this.containment&&(this.relative_container?(d=this.relative_container.offset(),c=[this.containment[0]+d.left,this.containment[1]+d.top,this.containment[2]+d.left,this.containment[3]+d.top]):c=this.containment,b.pageX-this.offset.click.left<c[0]&&(i=c[0]+this.offset.click.left),b.pageY-this.offset.click.top<c[1]&&(j=c[1]+this.offset.click.top),b.pageX-this.offset.click.left>c[2]&&(i=c[2]+this.offset.click.left),b.pageY-this.offset.click.top>c[3]&&(j=c[3]+this.offset.click.top)),g.grid&&(e=g.grid[1]?this.originalPageY+Math.round((j-this.originalPageY)/g.grid[1])*g.grid[1]:this.originalPageY,j=c?e-this.offset.click.top>=c[1]||e-this.offset.click.top>c[3]?e:e-this.offset.click.top>=c[1]?e-g.grid[1]:e+g.grid[1]:e,f=g.grid[0]?this.originalPageX+Math.round((i-this.originalPageX)/g.grid[0])*g.grid[0]:this.originalPageX,i=c?f-this.offset.click.left>=c[0]||f-this.offset.click.left>c[2]?f:f-this.offset.click.left>=c[0]?f-g.grid[0]:f+g.grid[0]:f)),{top:j-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():this.offset.scroll.top),left:i-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1},_trigger:function(b,c,d){return d=d||this._uiHash(),a.ui.plugin.call(this,b,[c,d]),"drag"===b&&(this.positionAbs=this._convertPositionTo("absolute")),a.Widget.prototype._trigger.call(this,b,c,d)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),a.ui.plugin.add("draggable","connectToSortable",{start:function(b,c){var d=a(this).data("ui-draggable"),e=d.options,f=a.extend({},c,{item:d.element});d.sortables=[],a(e.connectToSortable).each(function(){var c=a.data(this,"ui-sortable");c&&!c.options.disabled&&(d.sortables.push({instance:c,shouldRevert:c.options.revert}),c.refreshPositions(),c._trigger("activate",b,f))})},stop:function(b,c){var d=a(this).data("ui-draggable"),e=a.extend({},c,{item:d.element});a.each(d.sortables,function(){this.instance.isOver?(this.instance.isOver=0,d.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=this.shouldRevert),this.instance._mouseStop(b),this.instance.options.helper=this.instance.options._helper,"original"===d.options.helper&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",b,e))})},drag:function(b,c){var d=a(this).data("ui-draggable"),e=this;a.each(d.sortables,function(){var f=!1,g=this;this.instance.positionAbs=d.positionAbs,this.instance.helperProportions=d.helperProportions,this.instance.offset.click=d.offset.click,this.instance._intersectsWith(this.instance.containerCache)&&(f=!0,a.each(d.sortables,function(){return this.instance.positionAbs=d.positionAbs,this.instance.helperProportions=d.helperProportions,this.instance.offset.click=d.offset.click,this!==g&&this.instance._intersectsWith(this.instance.containerCache)&&a.contains(g.instance.element[0],this.instance.element[0])&&(f=!1),f})),f?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=a(e).clone().removeAttr("id").appendTo(this.instance.element).data("ui-sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return c.helper[0]},b.target=this.instance.currentItem[0],this.instance._mouseCapture(b,!0),this.instance._mouseStart(b,!0,!0),this.instance.offset.click.top=d.offset.click.top,this.instance.offset.click.left=d.offset.click.left,this.instance.offset.parent.left-=d.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=d.offset.parent.top-this.instance.offset.parent.top,d._trigger("toSortable",b),d.dropped=this.instance.element,d.currentItem=d.element,this.instance.fromOutside=d),this.instance.currentItem&&this.instance._mouseDrag(b)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",b,this.instance._uiHash(this.instance)),this.instance._mouseStop(b,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),d._trigger("fromSortable",b),d.dropped=!1)})}}),a.ui.plugin.add("draggable","cursor",{start:function(){var b=a("body"),c=a(this).data("ui-draggable").options;b.css("cursor")&&(c._cursor=b.css("cursor")),b.css("cursor",c.cursor)},stop:function(){var b=a(this).data("ui-draggable").options;b._cursor&&a("body").css("cursor",b._cursor)}}),a.ui.plugin.add("draggable","opacity",{start:function(b,c){var d=a(c.helper),e=a(this).data("ui-draggable").options;d.css("opacity")&&(e._opacity=d.css("opacity")),d.css("opacity",e.opacity)},stop:function(b,c){var d=a(this).data("ui-draggable").options;d._opacity&&a(c.helper).css("opacity",d._opacity)}}),a.ui.plugin.add("draggable","scroll",{start:function(){var b=a(this).data("ui-draggable");b.scrollParent[0]!==document&&"HTML"!==b.scrollParent[0].tagName&&(b.overflowOffset=b.scrollParent.offset())},drag:function(b){var c=a(this).data("ui-draggable"),d=c.options,e=!1;c.scrollParent[0]!==document&&"HTML"!==c.scrollParent[0].tagName?(d.axis&&"x"===d.axis||(c.overflowOffset.top+c.scrollParent[0].offsetHeight-b.pageY<d.scrollSensitivity?c.scrollParent[0].scrollTop=e=c.scrollParent[0].scrollTop+d.scrollSpeed:b.pageY-c.overflowOffset.top<d.scrollSensitivity&&(c.scrollParent[0].scrollTop=e=c.scrollParent[0].scrollTop-d.scrollSpeed)),d.axis&&"y"===d.axis||(c.overflowOffset.left+c.scrollParent[0].offsetWidth-b.pageX<d.scrollSensitivity?c.scrollParent[0].scrollLeft=e=c.scrollParent[0].scrollLeft+d.scrollSpeed:b.pageX-c.overflowOffset.left<d.scrollSensitivity&&(c.scrollParent[0].scrollLeft=e=c.scrollParent[0].scrollLeft-d.scrollSpeed))):(d.axis&&"x"===d.axis||(b.pageY-a(document).scrollTop()<d.scrollSensitivity?e=a(document).scrollTop(a(document).scrollTop()-d.scrollSpeed):a(window).height()-(b.pageY-a(document).scrollTop())<d.scrollSensitivity&&(e=a(document).scrollTop(a(document).scrollTop()+d.scrollSpeed))),d.axis&&"y"===d.axis||(b.pageX-a(document).scrollLeft()<d.scrollSensitivity?e=a(document).scrollLeft(a(document).scrollLeft()-d.scrollSpeed):a(window).width()-(b.pageX-a(document).scrollLeft())<d.scrollSensitivity&&(e=a(document).scrollLeft(a(document).scrollLeft()+d.scrollSpeed)))),!1!==e&&a.ui.ddmanager&&!d.dropBehaviour&&a.ui.ddmanager.prepareOffsets(c,b)}}),a.ui.plugin.add("draggable","snap",{start:function(){var b=a(this).data("ui-draggable"),c=b.options;b.snapElements=[],a(c.snap.constructor!==String?c.snap.items||":data(ui-draggable)":c.snap).each(function(){var c=a(this),d=c.offset();this!==b.element[0]&&b.snapElements.push({item:this,width:c.outerWidth(),height:c.outerHeight(),top:d.top,left:d.left})})},drag:function(b,c){var d,e,f,g,h,i,j,k,l,m,n=a(this).data("ui-draggable"),o=n.options,p=o.snapTolerance,q=c.offset.left,r=q+n.helperProportions.width,s=c.offset.top,t=s+n.helperProportions.height;for(l=n.snapElements.length-1;l>=0;l--)h=n.snapElements[l].left,i=h+n.snapElements[l].width,j=n.snapElements[l].top,k=j+n.snapElements[l].height,r<h-p||q>i+p||t<j-p||s>k+p||!a.contains(n.snapElements[l].item.ownerDocument,n.snapElements[l].item)?(n.snapElements[l].snapping&&n.options.snap.release&&n.options.snap.release.call(n.element,b,a.extend(n._uiHash(),{snapItem:n.snapElements[l].item})),n.snapElements[l].snapping=!1):("inner"!==o.snapMode&&(d=Math.abs(j-t)<=p,e=Math.abs(k-s)<=p,f=Math.abs(h-r)<=p,g=Math.abs(i-q)<=p,d&&(c.position.top=n._convertPositionTo("relative",{top:j-n.helperProportions.height,left:0}).top-n.margins.top),e&&(c.position.top=n._convertPositionTo("relative",{top:k,left:0}).top-n.margins.top),f&&(c.position.left=n._convertPositionTo("relative",{top:0,left:h-n.helperProportions.width}).left-n.margins.left),g&&(c.position.left=n._convertPositionTo("relative",{top:0,left:i}).left-n.margins.left)),m=d||e||f||g,"outer"!==o.snapMode&&(d=Math.abs(j-s)<=p,e=Math.abs(k-t)<=p,f=Math.abs(h-q)<=p,g=Math.abs(i-r)<=p,d&&(c.position.top=n._convertPositionTo("relative",{top:j,left:0}).top-n.margins.top),e&&(c.position.top=n._convertPositionTo("relative",{top:k-n.helperProportions.height,left:0}).top-n.margins.top),f&&(c.position.left=n._convertPositionTo("relative",{top:0,left:h}).left-n.margins.left),g&&(c.position.left=n._convertPositionTo("relative",{top:0,left:i-n.helperProportions.width}).left-n.margins.left)),!n.snapElements[l].snapping&&(d||e||f||g||m)&&n.options.snap.snap&&n.options.snap.snap.call(n.element,b,a.extend(n._uiHash(),{snapItem:n.snapElements[l].item})),n.snapElements[l].snapping=d||e||f||g||m)}}),a.ui.plugin.add("draggable","stack",{start:function(){var b,c=this.data("ui-draggable").options,d=a.makeArray(a(c.stack)).sort(function(b,c){return(parseInt(a(b).css("zIndex"),10)||0)-(parseInt(a(c).css("zIndex"),10)||0)});d.length&&(b=parseInt(a(d[0]).css("zIndex"),10)||0,a(d).each(function(c){a(this).css("zIndex",b+c)}),this.css("zIndex",b+d.length))}}),a.ui.plugin.add("draggable","zIndex",{start:function(b,c){var d=a(c.helper),e=a(this).data("ui-draggable").options;d.css("zIndex")&&(e._zIndex=d.css("zIndex")),d.css("zIndex",e.zIndex)},stop:function(b,c){var d=a(this).data("ui-draggable").options;d._zIndex&&a(c.helper).css("zIndex",d._zIndex)}})}(d)},{"./core":281,"./mouse":284,"./widget":287,jquery:288}],283:[function(a,b,c){var d=a("jquery");a("./core"),a("./widget"),a("./mouse"),a("./draggable"),function(a,b){function c(a,b,c){return a>b&&a<b+c}a.widget("ui.droppable",{version:"1.10.4",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var b,c=this.options,d=c.accept;this.isover=!1,this.isout=!0,this.accept=a.isFunction(d)?d:function(a){return a.is(d)},this.proportions=function(){if(!arguments.length)return b||(b={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight});b=arguments[0]},a.ui.ddmanager.droppables[c.scope]=a.ui.ddmanager.droppables[c.scope]||[],a.ui.ddmanager.droppables[c.scope].push(this),c.addClasses&&this.element.addClass("ui-droppable")},_destroy:function(){for(var b=0,c=a.ui.ddmanager.droppables[this.options.scope];b<c.length;b++)c[b]===this&&c.splice(b,1);this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(b,c){"accept"===b&&(this.accept=a.isFunction(c)?c:function(a){return a.is(c)}),a.Widget.prototype._setOption.apply(this,arguments)},_activate:function(b){var c=a.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),c&&this._trigger("activate",b,this.ui(c))},_deactivate:function(b){var c=a.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),c&&this._trigger("deactivate",b,this.ui(c))},_over:function(b){var c=a.ui.ddmanager.current;c&&(c.currentItem||c.element)[0]!==this.element[0]&&this.accept.call(this.element[0],c.currentItem||c.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",b,this.ui(c)))},_out:function(b){var c=a.ui.ddmanager.current;c&&(c.currentItem||c.element)[0]!==this.element[0]&&this.accept.call(this.element[0],c.currentItem||c.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",b,this.ui(c)))},_drop:function(b,c){var d=c||a.ui.ddmanager.current,e=!1;return!(!d||(d.currentItem||d.element)[0]===this.element[0])&&(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var b=a.data(this,"ui-droppable");if(b.options.greedy&&!b.options.disabled&&b.options.scope===d.options.scope&&b.accept.call(b.element[0],d.currentItem||d.element)&&a.ui.intersect(d,a.extend(b,{offset:b.element.offset()}),b.options.tolerance))return e=!0,!1}),!e&&(!!this.accept.call(this.element[0],d.currentItem||d.element)&&(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",b,this.ui(d)),this.element)))},ui:function(a){return{draggable:a.currentItem||a.element,helper:a.helper,position:a.position,offset:a.positionAbs}}}),a.ui.intersect=function(a,b,d){if(!b.offset)return!1;var e,f,g=(a.positionAbs||a.position.absolute).left,h=(a.positionAbs||a.position.absolute).top,i=g+a.helperProportions.width,j=h+a.helperProportions.height,k=b.offset.left,l=b.offset.top,m=k+b.proportions().width,n=l+b.proportions().height;switch(d){case"fit":return k<=g&&i<=m&&l<=h&&j<=n;case"intersect":return k<g+a.helperProportions.width/2&&i-a.helperProportions.width/2<m&&l<h+a.helperProportions.height/2&&j-a.helperProportions.height/2<n;case"pointer":return e=(a.positionAbs||a.position.absolute).left+(a.clickOffset||a.offset.click).left,f=(a.positionAbs||a.position.absolute).top+(a.clickOffset||a.offset.click).top,c(f,l,b.proportions().height)&&c(e,k,b.proportions().width);case"touch":return(h>=l&&h<=n||j>=l&&j<=n||h<l&&j>n)&&(g>=k&&g<=m||i>=k&&i<=m||g<k&&i>m);default:return!1}},a.ui.ddmanager={current:null,droppables:{default:[]},prepareOffsets:function(b,c){var d,e,f=a.ui.ddmanager.droppables[b.options.scope]||[],g=c?c.type:null,h=(b.currentItem||b.element).find(":data(ui-droppable)").addBack()
;a:for(d=0;d<f.length;d++)if(!(f[d].options.disabled||b&&!f[d].accept.call(f[d].element[0],b.currentItem||b.element))){for(e=0;e<h.length;e++)if(h[e]===f[d].element[0]){f[d].proportions().height=0;continue a}f[d].visible="none"!==f[d].element.css("display"),f[d].visible&&("mousedown"===g&&f[d]._activate.call(f[d],c),f[d].offset=f[d].element.offset(),f[d].proportions({width:f[d].element[0].offsetWidth,height:f[d].element[0].offsetHeight}))}},drop:function(b,c){var d=!1;return a.each((a.ui.ddmanager.droppables[b.options.scope]||[]).slice(),function(){this.options&&(!this.options.disabled&&this.visible&&a.ui.intersect(b,this,this.options.tolerance)&&(d=this._drop.call(this,c)||d),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],b.currentItem||b.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,c)))}),d},dragStart:function(b,c){b.element.parentsUntil("body").bind("scroll.droppable",function(){b.options.refreshPositions||a.ui.ddmanager.prepareOffsets(b,c)})},drag:function(b,c){b.options.refreshPositions&&a.ui.ddmanager.prepareOffsets(b,c),a.each(a.ui.ddmanager.droppables[b.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var d,e,f,g=a.ui.intersect(b,this,this.options.tolerance),h=!g&&this.isover?"isout":g&&!this.isover?"isover":null;h&&(this.options.greedy&&(e=this.options.scope,f=this.element.parents(":data(ui-droppable)").filter(function(){return a.data(this,"ui-droppable").options.scope===e}),f.length&&(d=a.data(f[0],"ui-droppable"),d.greedyChild="isover"===h)),d&&"isover"===h&&(d.isover=!1,d.isout=!0,d._out.call(d,c)),this[h]=!0,this["isout"===h?"isover":"isout"]=!1,this["isover"===h?"_over":"_out"].call(this,c),d&&"isout"===h&&(d.isout=!1,d.isover=!0,d._over.call(d,c)))}})},dragStop:function(b,c){b.element.parentsUntil("body").unbind("scroll.droppable"),b.options.refreshPositions||a.ui.ddmanager.prepareOffsets(b,c)}}}(d)},{"./core":281,"./draggable":282,"./mouse":284,"./widget":287,jquery:288}],284:[function(a,b,c){var d=a("jquery");a("./widget"),function(a,b){var c=!1;a(document).mouseup(function(){c=!1}),a.widget("ui.mouse",{version:"1.10.4",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var b=this;this.element.bind("mousedown."+this.widgetName,function(a){return b._mouseDown(a)}).bind("click."+this.widgetName,function(c){if(!0===a.data(c.target,b.widgetName+".preventClickEvent"))return a.removeData(c.target,b.widgetName+".preventClickEvent"),c.stopImmediatePropagation(),!1}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&a(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(b){if(!c){this._mouseStarted&&this._mouseUp(b),this._mouseDownEvent=b;var d=this,e=1===b.which,f=!("string"!=typeof this.options.cancel||!b.target.nodeName)&&a(b.target).closest(this.options.cancel).length;return!(e&&!f&&this._mouseCapture(b))||(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){d.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(b)&&this._mouseDelayMet(b)&&(this._mouseStarted=!1!==this._mouseStart(b),!this._mouseStarted)?(b.preventDefault(),!0):(!0===a.data(b.target,this.widgetName+".preventClickEvent")&&a.removeData(b.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(a){return d._mouseMove(a)},this._mouseUpDelegate=function(a){return d._mouseUp(a)},a(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),b.preventDefault(),c=!0,!0))}},_mouseMove:function(b){return a.ui.ie&&(!document.documentMode||document.documentMode<9)&&!b.button?this._mouseUp(b):this._mouseStarted?(this._mouseDrag(b),b.preventDefault()):(this._mouseDistanceMet(b)&&this._mouseDelayMet(b)&&(this._mouseStarted=!1!==this._mouseStart(this._mouseDownEvent,b),this._mouseStarted?this._mouseDrag(b):this._mouseUp(b)),!this._mouseStarted)},_mouseUp:function(b){return a(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,b.target===this._mouseDownEvent.target&&a.data(b.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(b)),!1},_mouseDistanceMet:function(a){return Math.max(Math.abs(this._mouseDownEvent.pageX-a.pageX),Math.abs(this._mouseDownEvent.pageY-a.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})}(d)},{"./widget":287,jquery:288}],285:[function(a,b,c){var d=a("jquery");a("./core"),a("./mouse"),a("./widget"),function(a,b){var c=5;a.widget("ui.slider",a.ui.mouse,{version:"1.10.4",widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},_create:function(){this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget ui-widget-content ui-corner-all"),this._refresh(),this._setOption("disabled",this.options.disabled),this._animateOff=!1},_refresh:function(){this._createRange(),this._createHandles(),this._setupEvents(),this._refreshValue()},_createHandles:function(){var b,c,d=this.options,e=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),f=[];for(c=d.values&&d.values.length||1,e.length>c&&(e.slice(c).remove(),e=e.slice(0,c)),b=e.length;b<c;b++)f.push("<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>");this.handles=e.add(a(f.join("")).appendTo(this.element)),this.handle=this.handles.eq(0),this.handles.each(function(b){a(this).data("ui-slider-handle-index",b)})},_createRange:function(){var b=this.options,c="";b.range?(!0===b.range&&(b.values?b.values.length&&2!==b.values.length?b.values=[b.values[0],b.values[0]]:a.isArray(b.values)&&(b.values=b.values.slice(0)):b.values=[this._valueMin(),this._valueMin()]),this.range&&this.range.length?this.range.removeClass("ui-slider-range-min ui-slider-range-max").css({left:"",bottom:""}):(this.range=a("<div></div>").appendTo(this.element),c="ui-slider-range ui-widget-header ui-corner-all"),this.range.addClass(c+("min"===b.range||"max"===b.range?" ui-slider-range-"+b.range:""))):(this.range&&this.range.remove(),this.range=null)},_setupEvents:function(){var a=this.handles.add(this.range).filter("a");this._off(a),this._on(a,this._handleEvents),this._hoverable(a),this._focusable(a)},_destroy:function(){this.handles.remove(),this.range&&this.range.remove(),this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-widget ui-widget-content ui-corner-all"),this._mouseDestroy()},_mouseCapture:function(b){var c,d,e,f,g,h,i,j=this,k=this.options;return!k.disabled&&(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),c={x:b.pageX,y:b.pageY},d=this._normValueFromMouse(c),e=this._valueMax()-this._valueMin()+1,this.handles.each(function(b){var c=Math.abs(d-j.values(b));(e>c||e===c&&(b===j._lastChangedValue||j.values(b)===k.min))&&(e=c,f=a(this),g=b)}),!1!==this._start(b,g)&&(this._mouseSliding=!0,this._handleIndex=g,f.addClass("ui-state-active").focus(),h=f.offset(),i=!a(b.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=i?{left:0,top:0}:{left:b.pageX-h.left-f.width()/2,top:b.pageY-h.top-f.height()/2-(parseInt(f.css("borderTopWidth"),10)||0)-(parseInt(f.css("borderBottomWidth"),10)||0)+(parseInt(f.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(b,g,d),this._animateOff=!0,!0))},_mouseStart:function(){return!0},_mouseDrag:function(a){var b={x:a.pageX,y:a.pageY},c=this._normValueFromMouse(b);return this._slide(a,this._handleIndex,c),!1},_mouseStop:function(a){return this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(a,this._handleIndex),this._change(a,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(a){var b,c,d,e,f;return"horizontal"===this.orientation?(b=this.elementSize.width,c=a.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(b=this.elementSize.height,c=a.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),d=c/b,d>1&&(d=1),d<0&&(d=0),"vertical"===this.orientation&&(d=1-d),e=this._valueMax()-this._valueMin(),f=this._valueMin()+d*e,this._trimAlignValue(f)},_start:function(a,b){var c={handle:this.handles[b],value:this.value()};return this.options.values&&this.options.values.length&&(c.value=this.values(b),c.values=this.values()),this._trigger("start",a,c)},_slide:function(a,b,c){var d,e,f;this.options.values&&this.options.values.length?(d=this.values(b?0:1),2===this.options.values.length&&!0===this.options.range&&(0===b&&c>d||1===b&&c<d)&&(c=d),c!==this.values(b)&&(e=this.values(),e[b]=c,f=this._trigger("slide",a,{handle:this.handles[b],value:c,values:e}),d=this.values(b?0:1),!1!==f&&this.values(b,c))):c!==this.value()&&!1!==(f=this._trigger("slide",a,{handle:this.handles[b],value:c}))&&this.value(c)},_stop:function(a,b){var c={handle:this.handles[b],value:this.value()};this.options.values&&this.options.values.length&&(c.value=this.values(b),c.values=this.values()),this._trigger("stop",a,c)},_change:function(a,b){if(!this._keySliding&&!this._mouseSliding){var c={handle:this.handles[b],value:this.value()};this.options.values&&this.options.values.length&&(c.value=this.values(b),c.values=this.values()),this._lastChangedValue=b,this._trigger("change",a,c)}},value:function(a){return arguments.length?(this.options.value=this._trimAlignValue(a),this._refreshValue(),void this._change(null,0)):this._value()},values:function(b,c){var d,e,f;if(arguments.length>1)return this.options.values[b]=this._trimAlignValue(c),this._refreshValue(),void this._change(null,b);if(!arguments.length)return this._values();if(!a.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(b):this.value();for(d=this.options.values,e=arguments[0],f=0;f<d.length;f+=1)d[f]=this._trimAlignValue(e[f]),this._change(null,f);this._refreshValue()},_setOption:function(b,c){var d,e=0;switch("range"===b&&!0===this.options.range&&("min"===c?(this.options.value=this._values(0),this.options.values=null):"max"===c&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),a.isArray(this.options.values)&&(e=this.options.values.length),a.Widget.prototype._setOption.apply(this,arguments),b){case"orientation":this._detectOrientation(),this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation),this._refreshValue();break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),d=0;d<e;d+=1)this._change(null,d);this._animateOff=!1;break;case"min":case"max":this._animateOff=!0,this._refreshValue(),this._animateOff=!1;break;case"range":this._animateOff=!0,this._refresh(),this._animateOff=!1}},_value:function(){var a=this.options.value;return a=this._trimAlignValue(a)},_values:function(a){var b,c,d;if(arguments.length)return b=this.options.values[a],b=this._trimAlignValue(b);if(this.options.values&&this.options.values.length){for(c=this.options.values.slice(),d=0;d<c.length;d+=1)c[d]=this._trimAlignValue(c[d]);return c}return[]},_trimAlignValue:function(a){if(a<=this._valueMin())return this._valueMin();if(a>=this._valueMax())return this._valueMax();var b=this.options.step>0?this.options.step:1,c=(a-this._valueMin())%b,d=a-c;return 2*Math.abs(c)>=b&&(d+=c>0?b:-b),parseFloat(d.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var b,c,d,e,f,g=this.options.range,h=this.options,i=this,j=!this._animateOff&&h.animate,k={};this.options.values&&this.options.values.length?this.handles.each(function(d){c=(i.values(d)-i._valueMin())/(i._valueMax()-i._valueMin())*100,k["horizontal"===i.orientation?"left":"bottom"]=c+"%",a(this).stop(1,1)[j?"animate":"css"](k,h.animate),!0===i.options.range&&("horizontal"===i.orientation?(0===d&&i.range.stop(1,1)[j?"animate":"css"]({left:c+"%"},h.animate),1===d&&i.range[j?"animate":"css"]({width:c-b+"%"},{queue:!1,duration:h.animate})):(0===d&&i.range.stop(1,1)[j?"animate":"css"]({bottom:c+"%"},h.animate),1===d&&i.range[j?"animate":"css"]({height:c-b+"%"},{queue:!1,duration:h.animate}))),b=c}):(d=this.value(),e=this._valueMin(),f=this._valueMax(),c=f!==e?(d-e)/(f-e)*100:0,k["horizontal"===this.orientation?"left":"bottom"]=c+"%",this.handle.stop(1,1)[j?"animate":"css"](k,h.animate),"min"===g&&"horizontal"===this.orientation&&this.range.stop(1,1)[j?"animate":"css"]({width:c+"%"},h.animate),"max"===g&&"horizontal"===this.orientation&&this.range[j?"animate":"css"]({width:100-c+"%"},{queue:!1,duration:h.animate}),"min"===g&&"vertical"===this.orientation&&this.range.stop(1,1)[j?"animate":"css"]({height:c+"%"},h.animate),"max"===g&&"vertical"===this.orientation&&this.range[j?"animate":"css"]({height:100-c+"%"},{queue:!1,duration:h.animate}))},_handleEvents:{keydown:function(b){var d,e,f,g=a(b.target).data("ui-slider-handle-index");switch(b.keyCode){case a.ui.keyCode.HOME:case a.ui.keyCode.END:case a.ui.keyCode.PAGE_UP:case a.ui.keyCode.PAGE_DOWN:case a.ui.keyCode.UP:case a.ui.keyCode.RIGHT:case a.ui.keyCode.DOWN:case a.ui.keyCode.LEFT:if(b.preventDefault(),!this._keySliding&&(this._keySliding=!0,a(b.target).addClass("ui-state-active"),!1===this._start(b,g)))return}switch(f=this.options.step,d=e=this.options.values&&this.options.values.length?this.values(g):this.value(),b.keyCode){case a.ui.keyCode.HOME:e=this._valueMin();break;case a.ui.keyCode.END:e=this._valueMax();break;case a.ui.keyCode.PAGE_UP:e=this._trimAlignValue(d+(this._valueMax()-this._valueMin())/c);break;case a.ui.keyCode.PAGE_DOWN:e=this._trimAlignValue(d-(this._valueMax()-this._valueMin())/c);break;case a.ui.keyCode.UP:case a.ui.keyCode.RIGHT:if(d===this._valueMax())return;e=this._trimAlignValue(d+f);break;case a.ui.keyCode.DOWN:case a.ui.keyCode.LEFT:if(d===this._valueMin())return;e=this._trimAlignValue(d-f)}this._slide(b,g,e)},click:function(a){a.preventDefault()},keyup:function(b){var c=a(b.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(b,c),this._change(b,c),a(b.target).removeClass("ui-state-active"))}}})}(d)},{"./core":281,"./mouse":284,"./widget":287,jquery:288}],286:[function(a,b,c){var d=a("jquery");a("./core"),a("./mouse"),a("./widget"),function(a,b){function c(a,b,c){return a>b&&a<b+c}function d(a){return/left|right/.test(a.css("float"))||/inline|table-cell/.test(a.css("display"))}a.widget("ui.sortable",a.ui.mouse,{version:"1.10.4",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_create:function(){var a=this.options;this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.floating=!!this.items.length&&("x"===a.axis||d(this.items[0].item)),this.offset=this.element.offset(),this._mouseInit(),this.ready=!0},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled"),this._mouseDestroy();for(var a=this.items.length-1;a>=0;a--)this.items[a].item.removeData(this.widgetName+"-item");return this},_setOption:function(b,c){"disabled"===b?(this.options[b]=c,this.widget().toggleClass("ui-sortable-disabled",!!c)):a.Widget.prototype._setOption.apply(this,arguments)},_mouseCapture:function(b,c){var d=null,e=!1,f=this;return!this.reverting&&(!this.options.disabled&&"static"!==this.options.type&&(this._refreshItems(b),a(b.target).parents().each(function(){if(a.data(this,f.widgetName+"-item")===f)return d=a(this),!1}),a.data(b.target,f.widgetName+"-item")===f&&(d=a(b.target)),!!d&&(!(this.options.handle&&!c&&(a(this.options.handle,d).find("*").addBack().each(function(){this===b.target&&(e=!0)}),!e))&&(this.currentItem=d,this._removeCurrentsFromItems(),!0))))},_mouseStart:function(b,c,d){var e,f,g=this.options;if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(b),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},a.extend(this.offset,{click:{left:b.pageX-this.offset.left,top:b.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(b),this.originalPageX=b.pageX,this.originalPageY=b.pageY,g.cursorAt&&this._adjustOffsetFromHelper(g.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),g.containment&&this._setContainment(),g.cursor&&"auto"!==g.cursor&&(f=this.document.find("body"),this.storedCursor=f.css("cursor"),f.css("cursor",g.cursor),this.storedStylesheet=a("<style>*{ cursor: "+g.cursor+" !important; }</style>").appendTo(f)),g.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",g.opacity)),g.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",g.zIndex)),this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",b,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!d)for(e=this.containers.length-1;e>=0;e--)this.containers[e]._trigger("activate",b,this._uiHash(this));return a.ui.ddmanager&&(a.ui.ddmanager.current=this),a.ui.ddmanager&&!g.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,b),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(b),!0},_mouseDrag:function(b){var c,d,e,f,g=this.options,h=!1;for(this.position=this._generatePosition(b),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-b.pageY<g.scrollSensitivity?this.scrollParent[0].scrollTop=h=this.scrollParent[0].scrollTop+g.scrollSpeed:b.pageY-this.overflowOffset.top<g.scrollSensitivity&&(this.scrollParent[0].scrollTop=h=this.scrollParent[0].scrollTop-g.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-b.pageX<g.scrollSensitivity?this.scrollParent[0].scrollLeft=h=this.scrollParent[0].scrollLeft+g.scrollSpeed:b.pageX-this.overflowOffset.left<g.scrollSensitivity&&(this.scrollParent[0].scrollLeft=h=this.scrollParent[0].scrollLeft-g.scrollSpeed)):(b.pageY-a(document).scrollTop()<g.scrollSensitivity?h=a(document).scrollTop(a(document).scrollTop()-g.scrollSpeed):a(window).height()-(b.pageY-a(document).scrollTop())<g.scrollSensitivity&&(h=a(document).scrollTop(a(document).scrollTop()+g.scrollSpeed)),b.pageX-a(document).scrollLeft()<g.scrollSensitivity?h=a(document).scrollLeft(a(document).scrollLeft()-g.scrollSpeed):a(window).width()-(b.pageX-a(document).scrollLeft())<g.scrollSensitivity&&(h=a(document).scrollLeft(a(document).scrollLeft()+g.scrollSpeed))),!1!==h&&a.ui.ddmanager&&!g.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,b)),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),c=this.items.length-1;c>=0;c--)if(d=this.items[c],e=d.item[0],(f=this._intersectsWithPointer(d))&&d.instance===this.currentContainer&&!(e===this.currentItem[0]||this.placeholder[1===f?"next":"prev"]()[0]===e||a.contains(this.placeholder[0],e)||"semi-dynamic"===this.options.type&&a.contains(this.element[0],e))){if(this.direction=1===f?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(d))break;this._rearrange(b,d),this._trigger("change",b,this._uiHash());break}return this._contactContainers(b),a.ui.ddmanager&&a.ui.ddmanager.drag(this,b),this._trigger("sort",b,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(b,c){if(b){if(a.ui.ddmanager&&!this.options.dropBehaviour&&a.ui.ddmanager.drop(this,b),this.options.revert){var d=this,e=this.placeholder.offset(),f=this.options.axis,g={};f&&"x"!==f||(g.left=e.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollLeft)),f&&"y"!==f||(g.top=e.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,a(this.helper).animate(g,parseInt(this.options.revert,10)||500,function(){d._clear(b)})}else this._clear(b,c);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null}),"original"===this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var b=this.containers.length-1;b>=0;b--)this.containers[b]._trigger("deactivate",null,this._uiHash(this)),this.containers[b].containerCache.over&&(this.containers[b]._trigger("out",null,this._uiHash(this)),this.containers[b].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),a.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?a(this.domPosition.prev).after(this.currentItem):a(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(b){var c=this._getItemsAsjQuery(b&&b.connected),d=[];return b=b||{},a(c).each(function(){var c=(a(b.item||this).attr(b.attribute||"id")||"").match(b.expression||/(.+)[\-=_](.+)/);c&&d.push((b.key||c[1]+"[]")+"="+(b.key&&b.expression?c[1]:c[2]))}),!d.length&&b.key&&d.push(b.key+"="),d.join("&")},toArray:function(b){var c=this._getItemsAsjQuery(b&&b.connected),d=[];return b=b||{},c.each(function(){d.push(a(b.item||this).attr(b.attribute||"id")||"")}),d},_intersectsWith:function(a){var b=this.positionAbs.left,c=b+this.helperProportions.width,d=this.positionAbs.top,e=d+this.helperProportions.height,f=a.left,g=f+a.width,h=a.top,i=h+a.height,j=this.offset.click.top,k=this.offset.click.left,l="x"===this.options.axis||d+j>h&&d+j<i,m="y"===this.options.axis||b+k>f&&b+k<g,n=l&&m;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>a[this.floating?"width":"height"]?n:f<b+this.helperProportions.width/2&&c-this.helperProportions.width/2<g&&h<d+this.helperProportions.height/2&&e-this.helperProportions.height/2<i},_intersectsWithPointer:function(a){var b="x"===this.options.axis||c(this.positionAbs.top+this.offset.click.top,a.top,a.height),d="y"===this.options.axis||c(this.positionAbs.left+this.offset.click.left,a.left,a.width),e=b&&d,f=this._getDragVerticalDirection(),g=this._getDragHorizontalDirection();return!!e&&(this.floating?g&&"right"===g||"down"===f?2:1:f&&("down"===f?2:1))},_intersectsWithSides:function(a){var b=c(this.positionAbs.top+this.offset.click.top,a.top+a.height/2,a.height),d=c(this.positionAbs.left+this.offset.click.left,a.left+a.width/2,a.width),e=this._getDragVerticalDirection(),f=this._getDragHorizontalDirection();return this.floating&&f?"right"===f&&d||"left"===f&&!d:e&&("down"===e&&b||"up"===e&&!b)},_getDragVerticalDirection:function(){var a=this.positionAbs.top-this.lastPositionAbs.top;return 0!==a&&(a>0?"down":"up")},_getDragHorizontalDirection:function(){var a=this.positionAbs.left-this.lastPositionAbs.left;return 0!==a&&(a>0?"right":"left")},refresh:function(a){return this._refreshItems(a),this.refreshPositions(),this},_connectWith:function(){var a=this.options;return a.connectWith.constructor===String?[a.connectWith]:a.connectWith},_getItemsAsjQuery:function(b){function c(){h.push(this)}var d,e,f,g,h=[],i=[],j=this._connectWith();if(j&&b)for(d=j.length-1;d>=0;d--)for(f=a(j[d]),e=f.length-1;e>=0;e--)(g=a.data(f[e],this.widgetFullName))&&g!==this&&!g.options.disabled&&i.push([a.isFunction(g.options.items)?g.options.items.call(g.element):a(g.options.items,g.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),g]);for(i.push([a.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):a(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),d=i.length-1;d>=0;d--)i[d][0].each(c);return a(h)},_removeCurrentsFromItems:function(){var b=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=a.grep(this.items,function(a){for(var c=0;c<b.length;c++)if(b[c]===a.item[0])return!1;return!0})},_refreshItems:function(b){this.items=[],this.containers=[this];var c,d,e,f,g,h,i,j,k=this.items,l=[[a.isFunction(this.options.items)?this.options.items.call(this.element[0],b,{item:this.currentItem}):a(this.options.items,this.element),this]],m=this._connectWith();if(m&&this.ready)for(c=m.length-1;c>=0;c--)for(e=a(m[c]),d=e.length-1;d>=0;d--)(f=a.data(e[d],this.widgetFullName))&&f!==this&&!f.options.disabled&&(l.push([a.isFunction(f.options.items)?f.options.items.call(f.element[0],b,{item:this.currentItem}):a(f.options.items,f.element),f]),this.containers.push(f));for(c=l.length-1;c>=0;c--)for(g=l[c][1],h=l[c][0],d=0,j=h.length;d<j;d++)i=a(h[d]),i.data(this.widgetName+"-item",g),k.push({item:i,instance:g,width:0,height:0,left:0,top:0})},refreshPositions:function(b){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());var c,d,e,f;for(c=this.items.length-1;c>=0;c--)d=this.items[c],d.instance!==this.currentContainer&&this.currentContainer&&d.item[0]!==this.currentItem[0]||(e=this.options.toleranceElement?a(this.options.toleranceElement,d.item):d.item,b||(d.width=e.outerWidth(),d.height=e.outerHeight()),f=e.offset(),d.left=f.left,d.top=f.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(c=this.containers.length-1;c>=0;c--)f=this.containers[c].element.offset(),this.containers[c].containerCache.left=f.left,this.containers[c].containerCache.top=f.top,this.containers[c].containerCache.width=this.containers[c].element.outerWidth(),this.containers[c].containerCache.height=this.containers[c].element.outerHeight();return this},_createPlaceholder:function(b){b=b||this;var c,d=b.options;d.placeholder&&d.placeholder.constructor!==String||(c=d.placeholder,d.placeholder={element:function(){var d=b.currentItem[0].nodeName.toLowerCase(),e=a("<"+d+">",b.document[0]).addClass(c||b.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper");return"tr"===d?b.currentItem.children().each(function(){a("<td>&#160;</td>",b.document[0]).attr("colspan",a(this).attr("colspan")||1).appendTo(e)}):"img"===d&&e.attr("src",b.currentItem.attr("src")),c||e.css("visibility","hidden"),e},update:function(a,e){c&&!d.forcePlaceholderSize||(e.height()||e.height(b.currentItem.innerHeight()-parseInt(b.currentItem.css("paddingTop")||0,10)-parseInt(b.currentItem.css("paddingBottom")||0,10)),e.width()||e.width(b.currentItem.innerWidth()-parseInt(b.currentItem.css("paddingLeft")||0,10)-parseInt(b.currentItem.css("paddingRight")||0,10)))}}),b.placeholder=a(d.placeholder.element.call(b.element,b.currentItem)),b.currentItem.after(b.placeholder),d.placeholder.update(b,b.placeholder)},_contactContainers:function(b){var e,f,g,h,i,j,k,l,m,n,o=null,p=null;for(e=this.containers.length-1;e>=0;e--)if(!a.contains(this.currentItem[0],this.containers[e].element[0]))if(this._intersectsWith(this.containers[e].containerCache)){if(o&&a.contains(this.containers[e].element[0],o.element[0]))continue;o=this.containers[e],p=e}else this.containers[e].containerCache.over&&(this.containers[e]._trigger("out",b,this._uiHash(this)),this.containers[e].containerCache.over=0);if(o)if(1===this.containers.length)this.containers[p].containerCache.over||(this.containers[p]._trigger("over",b,this._uiHash(this)),this.containers[p].containerCache.over=1);else{for(g=1e4,h=null,n=o.floating||d(this.currentItem),i=n?"left":"top",j=n?"width":"height",k=this.positionAbs[i]+this.offset.click[i],f=this.items.length-1;f>=0;f--)a.contains(this.containers[p].element[0],this.items[f].item[0])&&this.items[f].item[0]!==this.currentItem[0]&&(n&&!c(this.positionAbs.top+this.offset.click.top,this.items[f].top,this.items[f].height)||(l=this.items[f].item.offset()[i],m=!1,Math.abs(l-k)>Math.abs(l+this.items[f][j]-k)&&(m=!0,l+=this.items[f][j]),Math.abs(l-k)<g&&(g=Math.abs(l-k),h=this.items[f],this.direction=m?"up":"down")));if(!h&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[p])return;h?this._rearrange(b,h,null,!0):this._rearrange(b,null,this.containers[p].element,!0),this._trigger("change",b,this._uiHash()),this.containers[p]._trigger("change",b,this._uiHash(this)),this.currentContainer=this.containers[p],this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[p]._trigger("over",b,this._uiHash(this)),this.containers[p].containerCache.over=1}},_createHelper:function(b){var c=this.options,d=a.isFunction(c.helper)?a(c.helper.apply(this.element[0],[b,this.currentItem])):"clone"===c.helper?this.currentItem.clone():this.currentItem;return d.parents("body").length||a("parent"!==c.appendTo?c.appendTo:this.currentItem[0].parentNode)[0].appendChild(d[0]),d[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),d[0].style.width&&!c.forceHelperSize||d.width(this.currentItem.width()),d[0].style.height&&!c.forceHelperSize||d.height(this.currentItem.height()),d},_adjustOffsetFromHelper:function(b){"string"==typeof b&&(b=b.split(" ")),a.isArray(b)&&(b={left:+b[0],top:+b[1]||0}),"left"in b&&(this.offset.click.left=b.left+this.margins.left),"right"in b&&(this.offset.click.left=this.helperProportions.width-b.right+this.margins.left),"top"in b&&(this.offset.click.top=b.top+this.margins.top),"bottom"in b&&(this.offset.click.top=this.helperProportions.height-b.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var b=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&a.contains(this.scrollParent[0],this.offsetParent[0])&&(b.left+=this.scrollParent.scrollLeft(),b.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&a.ui.ie)&&(b={top:0,left:0}),{
top:b.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:b.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var a=this.currentItem.position();return{top:a.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:a.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var b,c,d,e=this.options;"parent"===e.containment&&(e.containment=this.helper[0].parentNode),"document"!==e.containment&&"window"!==e.containment||(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,a("document"===e.containment?document:window).width()-this.helperProportions.width-this.margins.left,(a("document"===e.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(e.containment)||(b=a(e.containment)[0],c=a(e.containment).offset(),d="hidden"!==a(b).css("overflow"),this.containment=[c.left+(parseInt(a(b).css("borderLeftWidth"),10)||0)+(parseInt(a(b).css("paddingLeft"),10)||0)-this.margins.left,c.top+(parseInt(a(b).css("borderTopWidth"),10)||0)+(parseInt(a(b).css("paddingTop"),10)||0)-this.margins.top,c.left+(d?Math.max(b.scrollWidth,b.offsetWidth):b.offsetWidth)-(parseInt(a(b).css("borderLeftWidth"),10)||0)-(parseInt(a(b).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,c.top+(d?Math.max(b.scrollHeight,b.offsetHeight):b.offsetHeight)-(parseInt(a(b).css("borderTopWidth"),10)||0)-(parseInt(a(b).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(b,c){c||(c=this.position);var d="absolute"===b?1:-1,e="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&a.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,f=/(html|body)/i.test(e[0].tagName);return{top:c.top+this.offset.relative.top*d+this.offset.parent.top*d-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():f?0:e.scrollTop())*d,left:c.left+this.offset.relative.left*d+this.offset.parent.left*d-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():f?0:e.scrollLeft())*d}},_generatePosition:function(b){var c,d,e=this.options,f=b.pageX,g=b.pageY,h="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&a.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,i=/(html|body)/i.test(h[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==document&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(b.pageX-this.offset.click.left<this.containment[0]&&(f=this.containment[0]+this.offset.click.left),b.pageY-this.offset.click.top<this.containment[1]&&(g=this.containment[1]+this.offset.click.top),b.pageX-this.offset.click.left>this.containment[2]&&(f=this.containment[2]+this.offset.click.left),b.pageY-this.offset.click.top>this.containment[3]&&(g=this.containment[3]+this.offset.click.top)),e.grid&&(c=this.originalPageY+Math.round((g-this.originalPageY)/e.grid[1])*e.grid[1],g=this.containment?c-this.offset.click.top>=this.containment[1]&&c-this.offset.click.top<=this.containment[3]?c:c-this.offset.click.top>=this.containment[1]?c-e.grid[1]:c+e.grid[1]:c,d=this.originalPageX+Math.round((f-this.originalPageX)/e.grid[0])*e.grid[0],f=this.containment?d-this.offset.click.left>=this.containment[0]&&d-this.offset.click.left<=this.containment[2]?d:d-this.offset.click.left>=this.containment[0]?d-e.grid[0]:d+e.grid[0]:d)),{top:g-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():i?0:h.scrollTop()),left:f-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():i?0:h.scrollLeft())}},_rearrange:function(a,b,c,d){c?c[0].appendChild(this.placeholder[0]):b.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?b.item[0]:b.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var e=this.counter;this._delay(function(){e===this.counter&&this.refreshPositions(!d)})},_clear:function(a,b){function c(a,b,c){return function(d){c._trigger(a,d,b._uiHash(b))}}this.reverting=!1;var d,e=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(d in this._storedCSS)"auto"!==this._storedCSS[d]&&"static"!==this._storedCSS[d]||(this._storedCSS[d]="");this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();for(this.fromOutside&&!b&&e.push(function(a){this._trigger("receive",a,this._uiHash(this.fromOutside))}),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||b||e.push(function(a){this._trigger("update",a,this._uiHash())}),this!==this.currentContainer&&(b||(e.push(function(a){this._trigger("remove",a,this._uiHash())}),e.push(function(a){return function(b){a._trigger("receive",b,this._uiHash(this))}}.call(this,this.currentContainer)),e.push(function(a){return function(b){a._trigger("update",b,this._uiHash(this))}}.call(this,this.currentContainer)))),d=this.containers.length-1;d>=0;d--)b||e.push(c("deactivate",this,this.containers[d])),this.containers[d].containerCache.over&&(e.push(c("out",this,this.containers[d])),this.containers[d].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,this.cancelHelperRemoval){if(!b){for(this._trigger("beforeStop",a,this._uiHash()),d=0;d<e.length;d++)e[d].call(this,a);this._trigger("stop",a,this._uiHash())}return this.fromOutside=!1,!1}if(b||this._trigger("beforeStop",a,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null,!b){for(d=0;d<e.length;d++)e[d].call(this,a);this._trigger("stop",a,this._uiHash())}return this.fromOutside=!1,!0},_trigger:function(){!1===a.Widget.prototype._trigger.apply(this,arguments)&&this.cancel()},_uiHash:function(b){var c=b||this;return{helper:c.helper,placeholder:c.placeholder||a([]),position:c.position,originalPosition:c.originalPosition,offset:c.positionAbs,item:c.currentItem,sender:b?b.element:null}}})}(d)},{"./core":281,"./mouse":284,"./widget":287,jquery:288}],287:[function(a,b,c){var d=a("jquery");!function(a,b){var c=0,d=Array.prototype.slice,e=a.cleanData;a.cleanData=function(b){for(var c,d=0;null!=(c=b[d]);d++)try{a(c).triggerHandler("remove")}catch(a){}e(b)},a.widget=function(b,c,d){var e,f,g,h,i={},j=b.split(".")[0];b=b.split(".")[1],e=j+"-"+b,d||(d=c,c=a.Widget),a.expr[":"][e.toLowerCase()]=function(b){return!!a.data(b,e)},a[j]=a[j]||{},f=a[j][b],g=a[j][b]=function(a,b){if(!this._createWidget)return new g(a,b);arguments.length&&this._createWidget(a,b)},a.extend(g,f,{version:d.version,_proto:a.extend({},d),_childConstructors:[]}),h=new c,h.options=a.widget.extend({},h.options),a.each(d,function(b,d){if(!a.isFunction(d))return void(i[b]=d);i[b]=function(){var a=function(){return c.prototype[b].apply(this,arguments)},e=function(a){return c.prototype[b].apply(this,a)};return function(){var b,c=this._super,f=this._superApply;return this._super=a,this._superApply=e,b=d.apply(this,arguments),this._super=c,this._superApply=f,b}}()}),g.prototype=a.widget.extend(h,{widgetEventPrefix:f?h.widgetEventPrefix||b:b},i,{constructor:g,namespace:j,widgetName:b,widgetFullName:e}),f?(a.each(f._childConstructors,function(b,c){var d=c.prototype;a.widget(d.namespace+"."+d.widgetName,g,c._proto)}),delete f._childConstructors):c._childConstructors.push(g),a.widget.bridge(b,g)},a.widget.extend=function(c){for(var e,f,g=d.call(arguments,1),h=0,i=g.length;h<i;h++)for(e in g[h])f=g[h][e],g[h].hasOwnProperty(e)&&f!==b&&(a.isPlainObject(f)?c[e]=a.isPlainObject(c[e])?a.widget.extend({},c[e],f):a.widget.extend({},f):c[e]=f);return c},a.widget.bridge=function(c,e){var f=e.prototype.widgetFullName||c;a.fn[c]=function(g){var h="string"==typeof g,i=d.call(arguments,1),j=this;return g=!h&&i.length?a.widget.extend.apply(null,[g].concat(i)):g,h?this.each(function(){var d,e=a.data(this,f);return e?a.isFunction(e[g])&&"_"!==g.charAt(0)?(d=e[g].apply(e,i),d!==e&&d!==b?(j=d&&d.jquery?j.pushStack(d.get()):d,!1):void 0):a.error("no such method '"+g+"' for "+c+" widget instance"):a.error("cannot call methods on "+c+" prior to initialization; attempted to call method '"+g+"'")}):this.each(function(){var b=a.data(this,f);b?b.option(g||{})._init():a.data(this,f,new e(g,this))}),j}},a.Widget=function(){},a.Widget._childConstructors=[],a.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(b,d){d=a(d||this.defaultElement||this)[0],this.element=a(d),this.uuid=c++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=a.widget.extend({},this.options,this._getCreateOptions(),b),this.bindings=a(),this.hoverable=a(),this.focusable=a(),d!==this&&(a.data(d,this.widgetFullName,this),this._on(!0,this.element,{remove:function(a){a.target===d&&this.destroy()}}),this.document=a(d.style?d.ownerDocument:d.document||d),this.window=a(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:a.noop,_getCreateEventData:a.noop,_create:a.noop,_init:a.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(a.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:a.noop,widget:function(){return this.element},option:function(c,d){var e,f,g,h=c;if(0===arguments.length)return a.widget.extend({},this.options);if("string"==typeof c)if(h={},e=c.split("."),c=e.shift(),e.length){for(f=h[c]=a.widget.extend({},this.options[c]),g=0;g<e.length-1;g++)f[e[g]]=f[e[g]]||{},f=f[e[g]];if(c=e.pop(),1===arguments.length)return f[c]===b?null:f[c];f[c]=d}else{if(1===arguments.length)return this.options[c]===b?null:this.options[c];h[c]=d}return this._setOptions(h),this},_setOptions:function(a){var b;for(b in a)this._setOption(b,a[b]);return this},_setOption:function(a,b){return this.options[a]=b,"disabled"===a&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!b).attr("aria-disabled",b),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(b,c,d){var e,f=this;"boolean"!=typeof b&&(d=c,c=b,b=!1),d?(c=e=a(c),this.bindings=this.bindings.add(c)):(d=c,c=this.element,e=this.widget()),a.each(d,function(d,g){function h(){if(b||!0!==f.options.disabled&&!a(this).hasClass("ui-state-disabled"))return("string"==typeof g?f[g]:g).apply(f,arguments)}"string"!=typeof g&&(h.guid=g.guid=g.guid||h.guid||a.guid++);var i=d.match(/^(\w+)\s*(.*)$/),j=i[1]+f.eventNamespace,k=i[2];k?e.delegate(k,j,h):c.bind(j,h)})},_off:function(a,b){b=(b||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,a.unbind(b).undelegate(b)},_delay:function(a,b){function c(){return("string"==typeof a?d[a]:a).apply(d,arguments)}var d=this;return setTimeout(c,b||0)},_hoverable:function(b){this.hoverable=this.hoverable.add(b),this._on(b,{mouseenter:function(b){a(b.currentTarget).addClass("ui-state-hover")},mouseleave:function(b){a(b.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(b){this.focusable=this.focusable.add(b),this._on(b,{focusin:function(b){a(b.currentTarget).addClass("ui-state-focus")},focusout:function(b){a(b.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(b,c,d){var e,f,g=this.options[b];if(d=d||{},c=a.Event(c),c.type=(b===this.widgetEventPrefix?b:this.widgetEventPrefix+b).toLowerCase(),c.target=this.element[0],f=c.originalEvent)for(e in f)e in c||(c[e]=f[e]);return this.element.trigger(c,d),!(a.isFunction(g)&&!1===g.apply(this.element[0],[c].concat(d))||c.isDefaultPrevented())}},a.each({show:"fadeIn",hide:"fadeOut"},function(b,c){a.Widget.prototype["_"+b]=function(d,e,f){"string"==typeof e&&(e={effect:e});var g,h=e?!0===e||"number"==typeof e?c:e.effect||c:b;e=e||{},"number"==typeof e&&(e={duration:e}),g=!a.isEmptyObject(e),e.complete=f,e.delay&&d.delay(e.delay),g&&a.effects&&a.effects.effect[h]?d[b](e):h!==b&&d[h]?d[h](e.duration,e.easing,f):d.queue(function(c){a(this)[b](),f&&f.call(d[0]),c()})}})}(d)},{jquery:288}],288:[function(b,c,d){!function(a,b){"object"==typeof c&&"object"==typeof c.exports?c.exports=a.document?b(a,!0):function(a){if(!a.document)throw new Error("jQuery requires a window with a document");return b(a)}:b(a)}("undefined"!=typeof window?window:this,function(b,c){function d(a){var b=!!a&&"length"in a&&a.length,c=ga.type(a);return"function"!==c&&!ga.isWindow(a)&&("array"===c||0===b||"number"==typeof b&&b>0&&b-1 in a)}function e(a,b,c){if(ga.isFunction(b))return ga.grep(a,function(a,d){return!!b.call(a,d,a)!==c});if(b.nodeType)return ga.grep(a,function(a){return a===b!==c});if("string"==typeof b){if(qa.test(b))return ga.filter(b,a,c);b=ga.filter(b,a)}return ga.grep(a,function(a){return aa.call(b,a)>-1!==c})}function f(a,b){for(;(a=a[b])&&1!==a.nodeType;);return a}function g(a){var b={};return ga.each(a.match(va)||[],function(a,c){b[c]=!0}),b}function h(){Y.removeEventListener("DOMContentLoaded",h),b.removeEventListener("load",h),ga.ready()}function i(){this.expando=ga.expando+i.uid++}function j(a,b,c){var d;if(void 0===c&&1===a.nodeType)if(d="data-"+b.replace(Ca,"-$&").toLowerCase(),"string"==typeof(c=a.getAttribute(d))){try{c="true"===c||"false"!==c&&("null"===c?null:+c+""===c?+c:Ba.test(c)?ga.parseJSON(c):c)}catch(a){}Aa.set(a,b,c)}else c=void 0;return c}function k(a,b,c,d){var e,f=1,g=20,h=d?function(){return d.cur()}:function(){return ga.css(a,b,"")},i=h(),j=c&&c[3]||(ga.cssNumber[b]?"":"px"),k=(ga.cssNumber[b]||"px"!==j&&+i)&&Ea.exec(ga.css(a,b));if(k&&k[3]!==j){j=j||k[3],c=c||[],k=+i||1;do{f=f||".5",k/=f,ga.style(a,b,k+j)}while(f!==(f=h()/i)&&1!==f&&--g)}return c&&(k=+k||+i||0,e=c[1]?k+(c[1]+1)*c[2]:+c[2],d&&(d.unit=j,d.start=k,d.end=e)),e}function l(a,b){var c=void 0!==a.getElementsByTagName?a.getElementsByTagName(b||"*"):void 0!==a.querySelectorAll?a.querySelectorAll(b||"*"):[];return void 0===b||b&&ga.nodeName(a,b)?ga.merge([a],c):c}function m(a,b){for(var c=0,d=a.length;c<d;c++)za.set(a[c],"globalEval",!b||za.get(b[c],"globalEval"))}function n(a,b,c,d,e){for(var f,g,h,i,j,k,n=b.createDocumentFragment(),o=[],p=0,q=a.length;p<q;p++)if((f=a[p])||0===f)if("object"===ga.type(f))ga.merge(o,f.nodeType?[f]:f);else if(La.test(f)){for(g=g||n.appendChild(b.createElement("div")),h=(Ia.exec(f)||["",""])[1].toLowerCase(),i=Ka[h]||Ka._default,g.innerHTML=i[1]+ga.htmlPrefilter(f)+i[2],k=i[0];k--;)g=g.lastChild;ga.merge(o,g.childNodes),g=n.firstChild,g.textContent=""}else o.push(b.createTextNode(f));for(n.textContent="",p=0;f=o[p++];)if(d&&ga.inArray(f,d)>-1)e&&e.push(f);else if(j=ga.contains(f.ownerDocument,f),g=l(n.appendChild(f),"script"),j&&m(g),c)for(k=0;f=g[k++];)Ja.test(f.type||"")&&c.push(f);return n}function o(){return!0}function p(){return!1}function q(){try{return Y.activeElement}catch(a){}}function r(a,b,c,d,e,f){var g,h;if("object"==typeof b){"string"!=typeof c&&(d=d||c,c=void 0);for(h in b)r(a,h,c,d,b[h],f);return a}if(null==d&&null==e?(e=c,d=c=void 0):null==e&&("string"==typeof c?(e=d,d=void 0):(e=d,d=c,c=void 0)),!1===e)e=p;else if(!e)return a;return 1===f&&(g=e,e=function(a){return ga().off(a),g.apply(this,arguments)},e.guid=g.guid||(g.guid=ga.guid++)),a.each(function(){ga.event.add(this,b,e,d,c)})}function s(a,b){return ga.nodeName(a,"table")&&ga.nodeName(11!==b.nodeType?b:b.firstChild,"tr")?a.getElementsByTagName("tbody")[0]||a.appendChild(a.ownerDocument.createElement("tbody")):a}function t(a){return a.type=(null!==a.getAttribute("type"))+"/"+a.type,a}function u(a){var b=Sa.exec(a.type);return b?a.type=b[1]:a.removeAttribute("type"),a}function v(a,b){var c,d,e,f,g,h,i,j;if(1===b.nodeType){if(za.hasData(a)&&(f=za.access(a),g=za.set(b,f),j=f.events)){delete g.handle,g.events={};for(e in j)for(c=0,d=j[e].length;c<d;c++)ga.event.add(b,e,j[e][c])}Aa.hasData(a)&&(h=Aa.access(a),i=ga.extend({},h),Aa.set(b,i))}}function w(a,b){var c=b.nodeName.toLowerCase();"input"===c&&Ha.test(a.type)?b.checked=a.checked:"input"!==c&&"textarea"!==c||(b.defaultValue=a.defaultValue)}function x(a,b,c,d){b=$.apply([],b);var e,f,g,h,i,j,k=0,m=a.length,o=m-1,p=b[0],q=ga.isFunction(p);if(q||m>1&&"string"==typeof p&&!ea.checkClone&&Ra.test(p))return a.each(function(e){var f=a.eq(e);q&&(b[0]=p.call(this,e,f.html())),x(f,b,c,d)});if(m&&(e=n(b,a[0].ownerDocument,!1,a,d),f=e.firstChild,1===e.childNodes.length&&(e=f),f||d)){for(g=ga.map(l(e,"script"),t),h=g.length;k<m;k++)i=e,k!==o&&(i=ga.clone(i,!0,!0),h&&ga.merge(g,l(i,"script"))),c.call(a[k],i,k);if(h)for(j=g[g.length-1].ownerDocument,ga.map(g,u),k=0;k<h;k++)i=g[k],Ja.test(i.type||"")&&!za.access(i,"globalEval")&&ga.contains(j,i)&&(i.src?ga._evalUrl&&ga._evalUrl(i.src):ga.globalEval(i.textContent.replace(Ta,"")))}return a}function y(a,b,c){for(var d,e=b?ga.filter(b,a):a,f=0;null!=(d=e[f]);f++)c||1!==d.nodeType||ga.cleanData(l(d)),d.parentNode&&(c&&ga.contains(d.ownerDocument,d)&&m(l(d,"script")),d.parentNode.removeChild(d));return a}function z(a,b){var c=ga(b.createElement(a)).appendTo(b.body),d=ga.css(c[0],"display");return c.detach(),d}function A(a){var b=Y,c=Va[a];return c||(c=z(a,b),"none"!==c&&c||(Ua=(Ua||ga("<iframe frameborder='0' width='0' height='0'/>")).appendTo(b.documentElement),b=Ua[0].contentDocument,b.write(),b.close(),c=z(a,b),Ua.detach()),Va[a]=c),c}function B(a,b,c){var d,e,f,g,h=a.style;return c=c||Ya(a),g=c?c.getPropertyValue(b)||c[b]:void 0,""!==g&&void 0!==g||ga.contains(a.ownerDocument,a)||(g=ga.style(a,b)),c&&!ea.pixelMarginRight()&&Xa.test(g)&&Wa.test(b)&&(d=h.width,e=h.minWidth,f=h.maxWidth,h.minWidth=h.maxWidth=h.width=g,g=c.width,h.width=d,h.minWidth=e,h.maxWidth=f),void 0!==g?g+"":g}function C(a,b){return{get:function(){return a()?void delete this.get:(this.get=b).apply(this,arguments)}}}function D(a){if(a in db)return a;for(var b=a[0].toUpperCase()+a.slice(1),c=cb.length;c--;)if((a=cb[c]+b)in db)return a}function E(a,b,c){var d=Ea.exec(b);return d?Math.max(0,d[2]-(c||0))+(d[3]||"px"):b}function F(a,b,c,d,e){for(var f=c===(d?"border":"content")?4:"width"===b?1:0,g=0;f<4;f+=2)"margin"===c&&(g+=ga.css(a,c+Fa[f],!0,e)),d?("content"===c&&(g-=ga.css(a,"padding"+Fa[f],!0,e)),"margin"!==c&&(g-=ga.css(a,"border"+Fa[f]+"Width",!0,e))):(g+=ga.css(a,"padding"+Fa[f],!0,e),"padding"!==c&&(g+=ga.css(a,"border"+Fa[f]+"Width",!0,e)));return g}function G(a,b,c){var d=!0,e="width"===b?a.offsetWidth:a.offsetHeight,f=Ya(a),g="border-box"===ga.css(a,"boxSizing",!1,f);if(e<=0||null==e){if(e=B(a,b,f),(e<0||null==e)&&(e=a.style[b]),Xa.test(e))return e;d=g&&(ea.boxSizingReliable()||e===a.style[b]),e=parseFloat(e)||0}return e+F(a,b,c||(g?"border":"content"),d,f)+"px"}function H(a,b){for(var c,d,e,f=[],g=0,h=a.length;g<h;g++)d=a[g],d.style&&(f[g]=za.get(d,"olddisplay"),c=d.style.display,b?(f[g]||"none"!==c||(d.style.display=""),""===d.style.display&&Ga(d)&&(f[g]=za.access(d,"olddisplay",A(d.nodeName)))):(e=Ga(d),"none"===c&&e||za.set(d,"olddisplay",e?c:ga.css(d,"display"))));for(g=0;g<h;g++)d=a[g],d.style&&(b&&"none"!==d.style.display&&""!==d.style.display||(d.style.display=b?f[g]||"":"none"));return a}function I(a,b,c,d,e){return new I.prototype.init(a,b,c,d,e)}function J(){return b.setTimeout(function(){eb=void 0}),eb=ga.now()}function K(a,b){var c,d=0,e={height:a};for(b=b?1:0;d<4;d+=2-b)c=Fa[d],e["margin"+c]=e["padding"+c]=a;return b&&(e.opacity=e.width=a),e}function L(a,b,c){for(var d,e=(O.tweeners[b]||[]).concat(O.tweeners["*"]),f=0,g=e.length;f<g;f++)if(d=e[f].call(c,b,a))return d}function M(a,b,c){var d,e,f,g,h,i,j,k=this,l={},m=a.style,n=a.nodeType&&Ga(a),o=za.get(a,"fxshow");c.queue||(h=ga._queueHooks(a,"fx"),null==h.unqueued&&(h.unqueued=0,i=h.empty.fire,h.empty.fire=function(){h.unqueued||i()}),h.unqueued++,k.always(function(){k.always(function(){h.unqueued--,ga.queue(a,"fx").length||h.empty.fire()})})),1===a.nodeType&&("height"in b||"width"in b)&&(c.overflow=[m.overflow,m.overflowX,m.overflowY],j=ga.css(a,"display"),"inline"===("none"===j?za.get(a,"olddisplay")||A(a.nodeName):j)&&"none"===ga.css(a,"float")&&(m.display="inline-block")),c.overflow&&(m.overflow="hidden",k.always(function(){m.overflow=c.overflow[0],m.overflowX=c.overflow[1],m.overflowY=c.overflow[2]}));for(d in b)if(e=b[d],gb.exec(e)){if(delete b[d],f=f||"toggle"===e,e===(n?"hide":"show")){if("show"!==e||!o||void 0===o[d])continue;n=!0}l[d]=o&&o[d]||ga.style(a,d)}else j=void 0;if(ga.isEmptyObject(l))"inline"===("none"===j?A(a.nodeName):j)&&(m.display=j);else{o?"hidden"in o&&(n=o.hidden):o=za.access(a,"fxshow",{}),f&&(o.hidden=!n),n?ga(a).show():k.done(function(){ga(a).hide()}),k.done(function(){var b;za.remove(a,"fxshow");for(b in l)ga.style(a,b,l[b])});for(d in l)g=L(n?o[d]:0,d,k),d in o||(o[d]=g.start,n&&(g.end=g.start,g.start="width"===d||"height"===d?1:0))}}function N(a,b){var c,d,e,f,g;for(c in a)if(d=ga.camelCase(c),e=b[d],f=a[c],ga.isArray(f)&&(e=f[1],f=a[c]=f[0]),c!==d&&(a[d]=f,delete a[c]),(g=ga.cssHooks[d])&&"expand"in g){f=g.expand(f),delete a[d];for(c in f)c in a||(a[c]=f[c],b[c]=e)}else b[d]=e}function O(a,b,c){var d,e,f=0,g=O.prefilters.length,h=ga.Deferred().always(function(){delete i.elem}),i=function(){if(e)return!1;for(var b=eb||J(),c=Math.max(0,j.startTime+j.duration-b),d=c/j.duration||0,f=1-d,g=0,i=j.tweens.length;g<i;g++)j.tweens[g].run(f);return h.notifyWith(a,[j,f,c]),f<1&&i?c:(h.resolveWith(a,[j]),!1)},j=h.promise({elem:a,props:ga.extend({},b),opts:ga.extend(!0,{specialEasing:{},easing:ga.easing._default},c),originalProperties:b,originalOptions:c,startTime:eb||J(),duration:c.duration,tweens:[],createTween:function(b,c){var d=ga.Tween(a,j.opts,b,c,j.opts.specialEasing[b]||j.opts.easing);return j.tweens.push(d),d},stop:function(b){var c=0,d=b?j.tweens.length:0;if(e)return this;for(e=!0;c<d;c++)j.tweens[c].run(1);return b?(h.notifyWith(a,[j,1,0]),h.resolveWith(a,[j,b])):h.rejectWith(a,[j,b]),this}}),k=j.props;for(N(k,j.opts.specialEasing);f<g;f++)if(d=O.prefilters[f].call(j,a,k,j.opts))return ga.isFunction(d.stop)&&(ga._queueHooks(j.elem,j.opts.queue).stop=ga.proxy(d.stop,d)),d;return ga.map(k,L,j),ga.isFunction(j.opts.start)&&j.opts.start.call(a,j),ga.fx.timer(ga.extend(i,{elem:a,anim:j,queue:j.opts.queue})),j.progress(j.opts.progress).done(j.opts.done,j.opts.complete).fail(j.opts.fail).always(j.opts.always)}function P(a){return a.getAttribute&&a.getAttribute("class")||""}function Q(a){return function(b,c){"string"!=typeof b&&(c=b,b="*");var d,e=0,f=b.toLowerCase().match(va)||[];if(ga.isFunction(c))for(;d=f[e++];)"+"===d[0]?(d=d.slice(1)||"*",(a[d]=a[d]||[]).unshift(c)):(a[d]=a[d]||[]).push(c)}}function R(a,b,c,d){function e(h){var i;return f[h]=!0,ga.each(a[h]||[],function(a,h){var j=h(b,c,d);return"string"!=typeof j||g||f[j]?g?!(i=j):void 0:(b.dataTypes.unshift(j),e(j),!1)}),i}var f={},g=a===Ab;return e(b.dataTypes[0])||!f["*"]&&e("*")}function S(a,b){var c,d,e=ga.ajaxSettings.flatOptions||{};for(c in b)void 0!==b[c]&&((e[c]?a:d||(d={}))[c]=b[c]);return d&&ga.extend(!0,a,d),a}function T(a,b,c){for(var d,e,f,g,h=a.contents,i=a.dataTypes;"*"===i[0];)i.shift(),void 0===d&&(d=a.mimeType||b.getResponseHeader("Content-Type"));if(d)for(e in h)if(h[e]&&h[e].test(d)){i.unshift(e);break}if(i[0]in c)f=i[0];else{for(e in c){if(!i[0]||a.converters[e+" "+i[0]]){f=e;break}g||(g=e)}f=f||g}if(f)return f!==i[0]&&i.unshift(f),c[f]}function U(a,b,c,d){var e,f,g,h,i,j={},k=a.dataTypes.slice();if(k[1])for(g in a.converters)j[g.toLowerCase()]=a.converters[g];for(f=k.shift();f;)if(a.responseFields[f]&&(c[a.responseFields[f]]=b),!i&&d&&a.dataFilter&&(b=a.dataFilter(b,a.dataType)),i=f,f=k.shift())if("*"===f)f=i;else if("*"!==i&&i!==f){if(!(g=j[i+" "+f]||j["* "+f]))for(e in j)if(h=e.split(" "),h[1]===f&&(g=j[i+" "+h[0]]||j["* "+h[0]])){!0===g?g=j[e]:!0!==j[e]&&(f=h[0],k.unshift(h[1]));break}if(!0!==g)if(g&&a.throws)b=g(b);else try{b=g(b)}catch(a){return{state:"parsererror",error:g?a:"No conversion from "+i+" to "+f}}}return{state:"success",data:b}}function V(a,b,c,d){var e;if(ga.isArray(b))ga.each(b,function(b,e){c||Eb.test(a)?d(a,e):V(a+"["+("object"==typeof e&&null!=e?b:"")+"]",e,c,d)});else if(c||"object"!==ga.type(b))d(a,b);else for(e in b)V(a+"["+e+"]",b[e],c,d)}function W(a){return ga.isWindow(a)?a:9===a.nodeType&&a.defaultView}var X=[],Y=b.document,Z=X.slice,$=X.concat,_=X.push,aa=X.indexOf,ba={},ca=ba.toString,da=ba.hasOwnProperty,ea={},fa="2.2.4",ga=function(a,b){return new ga.fn.init(a,b)},ha=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,ia=/^-ms-/,ja=/-([\da-z])/gi,ka=function(a,b){return b.toUpperCase()};ga.fn=ga.prototype={jquery:fa,constructor:ga,selector:"",length:0,toArray:function(){return Z.call(this)},get:function(a){return null!=a?a<0?this[a+this.length]:this[a]:Z.call(this)},pushStack:function(a){var b=ga.merge(this.constructor(),a);return b.prevObject=this,b.context=this.context,b},each:function(a){return ga.each(this,a)},map:function(a){return this.pushStack(ga.map(this,function(b,c){return a.call(b,c,b)}))},slice:function(){return this.pushStack(Z.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(a){var b=this.length,c=+a+(a<0?b:0);return this.pushStack(c>=0&&c<b?[this[c]]:[])},end:function(){return this.prevObject||this.constructor()},push:_,sort:X.sort,splice:X.splice},ga.extend=ga.fn.extend=function(){var a,b,c,d,e,f,g=arguments[0]||{},h=1,i=arguments.length,j=!1;for("boolean"==typeof g&&(j=g,g=arguments[h]||{},h++),"object"==typeof g||ga.isFunction(g)||(g={}),h===i&&(g=this,h--);h<i;h++)if(null!=(a=arguments[h]))for(b in a)c=g[b],d=a[b],g!==d&&(j&&d&&(ga.isPlainObject(d)||(e=ga.isArray(d)))?(e?(e=!1,f=c&&ga.isArray(c)?c:[]):f=c&&ga.isPlainObject(c)?c:{},g[b]=ga.extend(j,f,d)):void 0!==d&&(g[b]=d));return g},ga.extend({expando:"jQuery"+(fa+Math.random()).replace(/\D/g,""),isReady:!0,error:function(a){throw new Error(a)},noop:function(){},isFunction:function(a){return"function"===ga.type(a)},isArray:Array.isArray,isWindow:function(a){return null!=a&&a===a.window},isNumeric:function(a){var b=a&&a.toString();return!ga.isArray(a)&&b-parseFloat(b)+1>=0},isPlainObject:function(a){var b;if("object"!==ga.type(a)||a.nodeType||ga.isWindow(a))return!1;if(a.constructor&&!da.call(a,"constructor")&&!da.call(a.constructor.prototype||{},"isPrototypeOf"))return!1;for(b in a);return void 0===b||da.call(a,b)},isEmptyObject:function(a){var b;for(b in a)return!1;return!0},type:function(a){return null==a?a+"":"object"==typeof a||"function"==typeof a?ba[ca.call(a)]||"object":typeof a},globalEval:function(a){var b,c=eval;(a=ga.trim(a))&&(1===a.indexOf("use strict")?(b=Y.createElement("script"),b.text=a,Y.head.appendChild(b).parentNode.removeChild(b)):c(a))},camelCase:function(a){return a.replace(ia,"ms-").replace(ja,ka)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toLowerCase()===b.toLowerCase()},each:function(a,b){var c,e=0;if(d(a))for(c=a.length;e<c&&!1!==b.call(a[e],e,a[e]);e++);else for(e in a)if(!1===b.call(a[e],e,a[e]))break;return a},trim:function(a){return null==a?"":(a+"").replace(ha,"")},makeArray:function(a,b){var c=b||[];return null!=a&&(d(Object(a))?ga.merge(c,"string"==typeof a?[a]:a):_.call(c,a)),c},inArray:function(a,b,c){return null==b?-1:aa.call(b,a,c)},merge:function(a,b){for(var c=+b.length,d=0,e=a.length;d<c;d++)a[e++]=b[d];return a.length=e,a},grep:function(a,b,c){for(var d=[],e=0,f=a.length,g=!c;e<f;e++)!b(a[e],e)!==g&&d.push(a[e]);return d},map:function(a,b,c){var e,f,g=0,h=[];if(d(a))for(e=a.length;g<e;g++)null!=(f=b(a[g],g,c))&&h.push(f);else for(g in a)null!=(f=b(a[g],g,c))&&h.push(f);return $.apply([],h)},guid:1,proxy:function(a,b){var c,d,e;if("string"==typeof b&&(c=a[b],b=a,a=c),ga.isFunction(a))return d=Z.call(arguments,2),e=function(){return a.apply(b||this,d.concat(Z.call(arguments)))},e.guid=a.guid=a.guid||ga.guid++,e},now:Date.now,support:ea}),"function"==typeof Symbol&&(ga.fn[Symbol.iterator]=X[Symbol.iterator]),ga.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(a,b){ba["[object "+b+"]"]=b.toLowerCase()});var la=function(a){function b(a,b,c,d){var e,f,g,h,i,j,l,n,o=b&&b.ownerDocument,p=b?b.nodeType:9;if(c=c||[],"string"!=typeof a||!a||1!==p&&9!==p&&11!==p)return c;if(!d&&((b?b.ownerDocument||b:O)!==G&&F(b),b=b||G,I)){if(11!==p&&(j=ra.exec(a)))if(e=j[1]){if(9===p){if(!(g=b.getElementById(e)))return c;if(g.id===e)return c.push(g),c}else if(o&&(g=o.getElementById(e))&&M(b,g)&&g.id===e)return c.push(g),c}else{if(j[2])return $.apply(c,b.getElementsByTagName(a)),c;if((e=j[3])&&v.getElementsByClassName&&b.getElementsByClassName)return $.apply(c,b.getElementsByClassName(e)),c}if(v.qsa&&!T[a+" "]&&(!J||!J.test(a))){if(1!==p)o=b,n=a;else if("object"!==b.nodeName.toLowerCase()){for((h=b.getAttribute("id"))?h=h.replace(ta,"\\$&"):b.setAttribute("id",h=N),l=z(a),f=l.length,i=ma.test(h)?"#"+h:"[id='"+h+"']";f--;)l[f]=i+" "+m(l[f]);n=l.join(","),o=sa.test(a)&&k(b.parentNode)||b}if(n)try{return $.apply(c,o.querySelectorAll(n)),c}catch(a){}finally{h===N&&b.removeAttribute("id")}}}return B(a.replace(ha,"$1"),b,c,d)}function c(){function a(c,d){return b.push(c+" ")>w.cacheLength&&delete a[b.shift()],a[c+" "]=d}var b=[];return a}function d(a){return a[N]=!0,a}function e(a){var b=G.createElement("div");try{return!!a(b)}catch(a){return!1}finally{b.parentNode&&b.parentNode.removeChild(b),b=null}}function f(a,b){for(var c=a.split("|"),d=c.length;d--;)w.attrHandle[c[d]]=b}function g(a,b){var c=b&&a,d=c&&1===a.nodeType&&1===b.nodeType&&(~b.sourceIndex||V)-(~a.sourceIndex||V);if(d)return d;if(c)for(;c=c.nextSibling;)if(c===b)return-1;return a?1:-1}function h(a){return function(b){return"input"===b.nodeName.toLowerCase()&&b.type===a}}function i(a){return function(b){var c=b.nodeName.toLowerCase();return("input"===c||"button"===c)&&b.type===a}}function j(a){return d(function(b){return b=+b,d(function(c,d){for(var e,f=a([],c.length,b),g=f.length;g--;)c[e=f[g]]&&(c[e]=!(d[e]=c[e]))})})}function k(a){return a&&void 0!==a.getElementsByTagName&&a}function l(){}function m(a){for(var b=0,c=a.length,d="";b<c;b++)d+=a[b].value;return d}function n(a,b,c){var d=b.dir,e=c&&"parentNode"===d,f=Q++;return b.first?function(b,c,f){for(;b=b[d];)if(1===b.nodeType||e)return a(b,c,f)}:function(b,c,g){var h,i,j,k=[P,f];if(g){for(;b=b[d];)if((1===b.nodeType||e)&&a(b,c,g))return!0}else for(;b=b[d];)if(1===b.nodeType||e){if(j=b[N]||(b[N]={}),i=j[b.uniqueID]||(j[b.uniqueID]={}),(h=i[d])&&h[0]===P&&h[1]===f)return k[2]=h[2];if(i[d]=k,k[2]=a(b,c,g))return!0}}}function o(a){return a.length>1?function(b,c,d){for(var e=a.length;e--;)if(!a[e](b,c,d))return!1;return!0}:a[0]}
function p(a,c,d){for(var e=0,f=c.length;e<f;e++)b(a,c[e],d);return d}function q(a,b,c,d,e){for(var f,g=[],h=0,i=a.length,j=null!=b;h<i;h++)(f=a[h])&&(c&&!c(f,d,e)||(g.push(f),j&&b.push(h)));return g}function r(a,b,c,e,f,g){return e&&!e[N]&&(e=r(e)),f&&!f[N]&&(f=r(f,g)),d(function(d,g,h,i){var j,k,l,m=[],n=[],o=g.length,r=d||p(b||"*",h.nodeType?[h]:h,[]),s=!a||!d&&b?r:q(r,m,a,h,i),t=c?f||(d?a:o||e)?[]:g:s;if(c&&c(s,t,h,i),e)for(j=q(t,n),e(j,[],h,i),k=j.length;k--;)(l=j[k])&&(t[n[k]]=!(s[n[k]]=l));if(d){if(f||a){if(f){for(j=[],k=t.length;k--;)(l=t[k])&&j.push(s[k]=l);f(null,t=[],j,i)}for(k=t.length;k--;)(l=t[k])&&(j=f?aa(d,l):m[k])>-1&&(d[j]=!(g[j]=l))}}else t=q(t===g?t.splice(o,t.length):t),f?f(null,g,t,i):$.apply(g,t)})}function s(a){for(var b,c,d,e=a.length,f=w.relative[a[0].type],g=f||w.relative[" "],h=f?1:0,i=n(function(a){return a===b},g,!0),j=n(function(a){return aa(b,a)>-1},g,!0),k=[function(a,c,d){var e=!f&&(d||c!==C)||((b=c).nodeType?i(a,c,d):j(a,c,d));return b=null,e}];h<e;h++)if(c=w.relative[a[h].type])k=[n(o(k),c)];else{if(c=w.filter[a[h].type].apply(null,a[h].matches),c[N]){for(d=++h;d<e&&!w.relative[a[d].type];d++);return r(h>1&&o(k),h>1&&m(a.slice(0,h-1).concat({value:" "===a[h-2].type?"*":""})).replace(ha,"$1"),c,h<d&&s(a.slice(h,d)),d<e&&s(a=a.slice(d)),d<e&&m(a))}k.push(c)}return o(k)}function t(a,c){var e=c.length>0,f=a.length>0,g=function(d,g,h,i,j){var k,l,m,n=0,o="0",p=d&&[],r=[],s=C,t=d||f&&w.find.TAG("*",j),u=P+=null==s?1:Math.random()||.1,v=t.length;for(j&&(C=g===G||g||j);o!==v&&null!=(k=t[o]);o++){if(f&&k){for(l=0,g||k.ownerDocument===G||(F(k),h=!I);m=a[l++];)if(m(k,g||G,h)){i.push(k);break}j&&(P=u)}e&&((k=!m&&k)&&n--,d&&p.push(k))}if(n+=o,e&&o!==n){for(l=0;m=c[l++];)m(p,r,g,h);if(d){if(n>0)for(;o--;)p[o]||r[o]||(r[o]=Y.call(i));r=q(r)}$.apply(i,r),j&&!d&&r.length>0&&n+c.length>1&&b.uniqueSort(i)}return j&&(P=u,C=s),p};return e?d(g):g}var u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N="sizzle"+1*new Date,O=a.document,P=0,Q=0,R=c(),S=c(),T=c(),U=function(a,b){return a===b&&(E=!0),0},V=1<<31,W={}.hasOwnProperty,X=[],Y=X.pop,Z=X.push,$=X.push,_=X.slice,aa=function(a,b){for(var c=0,d=a.length;c<d;c++)if(a[c]===b)return c;return-1},ba="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",ca="[\\x20\\t\\r\\n\\f]",da="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",ea="\\["+ca+"*("+da+")(?:"+ca+"*([*^$|!~]?=)"+ca+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+da+"))|)"+ca+"*\\]",fa=":("+da+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+ea+")*)|.*)\\)|)",ga=new RegExp(ca+"+","g"),ha=new RegExp("^"+ca+"+|((?:^|[^\\\\])(?:\\\\.)*)"+ca+"+$","g"),ia=new RegExp("^"+ca+"*,"+ca+"*"),ja=new RegExp("^"+ca+"*([>+~]|"+ca+")"+ca+"*"),ka=new RegExp("="+ca+"*([^\\]'\"]*?)"+ca+"*\\]","g"),la=new RegExp(fa),ma=new RegExp("^"+da+"$"),na={ID:new RegExp("^#("+da+")"),CLASS:new RegExp("^\\.("+da+")"),TAG:new RegExp("^("+da+"|[*])"),ATTR:new RegExp("^"+ea),PSEUDO:new RegExp("^"+fa),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+ca+"*(even|odd|(([+-]|)(\\d*)n|)"+ca+"*(?:([+-]|)"+ca+"*(\\d+)|))"+ca+"*\\)|)","i"),bool:new RegExp("^(?:"+ba+")$","i"),needsContext:new RegExp("^"+ca+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+ca+"*((?:-\\d)?\\d*)"+ca+"*\\)|)(?=[^-]|$)","i")},oa=/^(?:input|select|textarea|button)$/i,pa=/^h\d$/i,qa=/^[^{]+\{\s*\[native \w/,ra=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,sa=/[+~]/,ta=/'|\\/g,ua=new RegExp("\\\\([\\da-f]{1,6}"+ca+"?|("+ca+")|.)","ig"),va=function(a,b,c){var d="0x"+b-65536;return d!==d||c?b:d<0?String.fromCharCode(d+65536):String.fromCharCode(d>>10|55296,1023&d|56320)},wa=function(){F()};try{$.apply(X=_.call(O.childNodes),O.childNodes),X[O.childNodes.length].nodeType}catch(a){$={apply:X.length?function(a,b){Z.apply(a,_.call(b))}:function(a,b){for(var c=a.length,d=0;a[c++]=b[d++];);a.length=c-1}}}v=b.support={},y=b.isXML=function(a){var b=a&&(a.ownerDocument||a).documentElement;return!!b&&"HTML"!==b.nodeName},F=b.setDocument=function(a){var b,c,d=a?a.ownerDocument||a:O;return d!==G&&9===d.nodeType&&d.documentElement?(G=d,H=G.documentElement,I=!y(G),(c=G.defaultView)&&c.top!==c&&(c.addEventListener?c.addEventListener("unload",wa,!1):c.attachEvent&&c.attachEvent("onunload",wa)),v.attributes=e(function(a){return a.className="i",!a.getAttribute("className")}),v.getElementsByTagName=e(function(a){return a.appendChild(G.createComment("")),!a.getElementsByTagName("*").length}),v.getElementsByClassName=qa.test(G.getElementsByClassName),v.getById=e(function(a){return H.appendChild(a).id=N,!G.getElementsByName||!G.getElementsByName(N).length}),v.getById?(w.find.ID=function(a,b){if(void 0!==b.getElementById&&I){var c=b.getElementById(a);return c?[c]:[]}},w.filter.ID=function(a){var b=a.replace(ua,va);return function(a){return a.getAttribute("id")===b}}):(delete w.find.ID,w.filter.ID=function(a){var b=a.replace(ua,va);return function(a){var c=void 0!==a.getAttributeNode&&a.getAttributeNode("id");return c&&c.value===b}}),w.find.TAG=v.getElementsByTagName?function(a,b){return void 0!==b.getElementsByTagName?b.getElementsByTagName(a):v.qsa?b.querySelectorAll(a):void 0}:function(a,b){var c,d=[],e=0,f=b.getElementsByTagName(a);if("*"===a){for(;c=f[e++];)1===c.nodeType&&d.push(c);return d}return f},w.find.CLASS=v.getElementsByClassName&&function(a,b){if(void 0!==b.getElementsByClassName&&I)return b.getElementsByClassName(a)},K=[],J=[],(v.qsa=qa.test(G.querySelectorAll))&&(e(function(a){H.appendChild(a).innerHTML="<a id='"+N+"'></a><select id='"+N+"-\r\\' msallowcapture=''><option selected=''></option></select>",a.querySelectorAll("[msallowcapture^='']").length&&J.push("[*^$]="+ca+"*(?:''|\"\")"),a.querySelectorAll("[selected]").length||J.push("\\["+ca+"*(?:value|"+ba+")"),a.querySelectorAll("[id~="+N+"-]").length||J.push("~="),a.querySelectorAll(":checked").length||J.push(":checked"),a.querySelectorAll("a#"+N+"+*").length||J.push(".#.+[+~]")}),e(function(a){var b=G.createElement("input");b.setAttribute("type","hidden"),a.appendChild(b).setAttribute("name","D"),a.querySelectorAll("[name=d]").length&&J.push("name"+ca+"*[*^$|!~]?="),a.querySelectorAll(":enabled").length||J.push(":enabled",":disabled"),a.querySelectorAll("*,:x"),J.push(",.*:")})),(v.matchesSelector=qa.test(L=H.matches||H.webkitMatchesSelector||H.mozMatchesSelector||H.oMatchesSelector||H.msMatchesSelector))&&e(function(a){v.disconnectedMatch=L.call(a,"div"),L.call(a,"[s!='']:x"),K.push("!=",fa)}),J=J.length&&new RegExp(J.join("|")),K=K.length&&new RegExp(K.join("|")),b=qa.test(H.compareDocumentPosition),M=b||qa.test(H.contains)?function(a,b){var c=9===a.nodeType?a.documentElement:a,d=b&&b.parentNode;return a===d||!(!d||1!==d.nodeType||!(c.contains?c.contains(d):a.compareDocumentPosition&&16&a.compareDocumentPosition(d)))}:function(a,b){if(b)for(;b=b.parentNode;)if(b===a)return!0;return!1},U=b?function(a,b){if(a===b)return E=!0,0;var c=!a.compareDocumentPosition-!b.compareDocumentPosition;return c||(c=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1,1&c||!v.sortDetached&&b.compareDocumentPosition(a)===c?a===G||a.ownerDocument===O&&M(O,a)?-1:b===G||b.ownerDocument===O&&M(O,b)?1:D?aa(D,a)-aa(D,b):0:4&c?-1:1)}:function(a,b){if(a===b)return E=!0,0;var c,d=0,e=a.parentNode,f=b.parentNode,h=[a],i=[b];if(!e||!f)return a===G?-1:b===G?1:e?-1:f?1:D?aa(D,a)-aa(D,b):0;if(e===f)return g(a,b);for(c=a;c=c.parentNode;)h.unshift(c);for(c=b;c=c.parentNode;)i.unshift(c);for(;h[d]===i[d];)d++;return d?g(h[d],i[d]):h[d]===O?-1:i[d]===O?1:0},G):G},b.matches=function(a,c){return b(a,null,null,c)},b.matchesSelector=function(a,c){if((a.ownerDocument||a)!==G&&F(a),c=c.replace(ka,"='$1']"),v.matchesSelector&&I&&!T[c+" "]&&(!K||!K.test(c))&&(!J||!J.test(c)))try{var d=L.call(a,c);if(d||v.disconnectedMatch||a.document&&11!==a.document.nodeType)return d}catch(a){}return b(c,G,null,[a]).length>0},b.contains=function(a,b){return(a.ownerDocument||a)!==G&&F(a),M(a,b)},b.attr=function(a,b){(a.ownerDocument||a)!==G&&F(a);var c=w.attrHandle[b.toLowerCase()],d=c&&W.call(w.attrHandle,b.toLowerCase())?c(a,b,!I):void 0;return void 0!==d?d:v.attributes||!I?a.getAttribute(b):(d=a.getAttributeNode(b))&&d.specified?d.value:null},b.error=function(a){throw new Error("Syntax error, unrecognized expression: "+a)},b.uniqueSort=function(a){var b,c=[],d=0,e=0;if(E=!v.detectDuplicates,D=!v.sortStable&&a.slice(0),a.sort(U),E){for(;b=a[e++];)b===a[e]&&(d=c.push(e));for(;d--;)a.splice(c[d],1)}return D=null,a},x=b.getText=function(a){var b,c="",d=0,e=a.nodeType;if(e){if(1===e||9===e||11===e){if("string"==typeof a.textContent)return a.textContent;for(a=a.firstChild;a;a=a.nextSibling)c+=x(a)}else if(3===e||4===e)return a.nodeValue}else for(;b=a[d++];)c+=x(b);return c},w=b.selectors={cacheLength:50,createPseudo:d,match:na,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(a){return a[1]=a[1].replace(ua,va),a[3]=(a[3]||a[4]||a[5]||"").replace(ua,va),"~="===a[2]&&(a[3]=" "+a[3]+" "),a.slice(0,4)},CHILD:function(a){return a[1]=a[1].toLowerCase(),"nth"===a[1].slice(0,3)?(a[3]||b.error(a[0]),a[4]=+(a[4]?a[5]+(a[6]||1):2*("even"===a[3]||"odd"===a[3])),a[5]=+(a[7]+a[8]||"odd"===a[3])):a[3]&&b.error(a[0]),a},PSEUDO:function(a){var b,c=!a[6]&&a[2];return na.CHILD.test(a[0])?null:(a[3]?a[2]=a[4]||a[5]||"":c&&la.test(c)&&(b=z(c,!0))&&(b=c.indexOf(")",c.length-b)-c.length)&&(a[0]=a[0].slice(0,b),a[2]=c.slice(0,b)),a.slice(0,3))}},filter:{TAG:function(a){var b=a.replace(ua,va).toLowerCase();return"*"===a?function(){return!0}:function(a){return a.nodeName&&a.nodeName.toLowerCase()===b}},CLASS:function(a){var b=R[a+" "];return b||(b=new RegExp("(^|"+ca+")"+a+"("+ca+"|$)"))&&R(a,function(a){return b.test("string"==typeof a.className&&a.className||void 0!==a.getAttribute&&a.getAttribute("class")||"")})},ATTR:function(a,c,d){return function(e){var f=b.attr(e,a);return null==f?"!="===c:!c||(f+="","="===c?f===d:"!="===c?f!==d:"^="===c?d&&0===f.indexOf(d):"*="===c?d&&f.indexOf(d)>-1:"$="===c?d&&f.slice(-d.length)===d:"~="===c?(" "+f.replace(ga," ")+" ").indexOf(d)>-1:"|="===c&&(f===d||f.slice(0,d.length+1)===d+"-"))}},CHILD:function(a,b,c,d,e){var f="nth"!==a.slice(0,3),g="last"!==a.slice(-4),h="of-type"===b;return 1===d&&0===e?function(a){return!!a.parentNode}:function(b,c,i){var j,k,l,m,n,o,p=f!==g?"nextSibling":"previousSibling",q=b.parentNode,r=h&&b.nodeName.toLowerCase(),s=!i&&!h,t=!1;if(q){if(f){for(;p;){for(m=b;m=m[p];)if(h?m.nodeName.toLowerCase()===r:1===m.nodeType)return!1;o=p="only"===a&&!o&&"nextSibling"}return!0}if(o=[g?q.firstChild:q.lastChild],g&&s){for(m=q,l=m[N]||(m[N]={}),k=l[m.uniqueID]||(l[m.uniqueID]={}),j=k[a]||[],n=j[0]===P&&j[1],t=n&&j[2],m=n&&q.childNodes[n];m=++n&&m&&m[p]||(t=n=0)||o.pop();)if(1===m.nodeType&&++t&&m===b){k[a]=[P,n,t];break}}else if(s&&(m=b,l=m[N]||(m[N]={}),k=l[m.uniqueID]||(l[m.uniqueID]={}),j=k[a]||[],n=j[0]===P&&j[1],t=n),!1===t)for(;(m=++n&&m&&m[p]||(t=n=0)||o.pop())&&((h?m.nodeName.toLowerCase()!==r:1!==m.nodeType)||!++t||(s&&(l=m[N]||(m[N]={}),k=l[m.uniqueID]||(l[m.uniqueID]={}),k[a]=[P,t]),m!==b)););return(t-=e)===d||t%d==0&&t/d>=0}}},PSEUDO:function(a,c){var e,f=w.pseudos[a]||w.setFilters[a.toLowerCase()]||b.error("unsupported pseudo: "+a);return f[N]?f(c):f.length>1?(e=[a,a,"",c],w.setFilters.hasOwnProperty(a.toLowerCase())?d(function(a,b){for(var d,e=f(a,c),g=e.length;g--;)d=aa(a,e[g]),a[d]=!(b[d]=e[g])}):function(a){return f(a,0,e)}):f}},pseudos:{not:d(function(a){var b=[],c=[],e=A(a.replace(ha,"$1"));return e[N]?d(function(a,b,c,d){for(var f,g=e(a,null,d,[]),h=a.length;h--;)(f=g[h])&&(a[h]=!(b[h]=f))}):function(a,d,f){return b[0]=a,e(b,null,f,c),b[0]=null,!c.pop()}}),has:d(function(a){return function(c){return b(a,c).length>0}}),contains:d(function(a){return a=a.replace(ua,va),function(b){return(b.textContent||b.innerText||x(b)).indexOf(a)>-1}}),lang:d(function(a){return ma.test(a||"")||b.error("unsupported lang: "+a),a=a.replace(ua,va).toLowerCase(),function(b){var c;do{if(c=I?b.lang:b.getAttribute("xml:lang")||b.getAttribute("lang"))return(c=c.toLowerCase())===a||0===c.indexOf(a+"-")}while((b=b.parentNode)&&1===b.nodeType);return!1}}),target:function(b){var c=a.location&&a.location.hash;return c&&c.slice(1)===b.id},root:function(a){return a===H},focus:function(a){return a===G.activeElement&&(!G.hasFocus||G.hasFocus())&&!!(a.type||a.href||~a.tabIndex)},enabled:function(a){return!1===a.disabled},disabled:function(a){return!0===a.disabled},checked:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&!!a.checked||"option"===b&&!!a.selected},selected:function(a){return a.parentNode&&a.parentNode.selectedIndex,!0===a.selected},empty:function(a){for(a=a.firstChild;a;a=a.nextSibling)if(a.nodeType<6)return!1;return!0},parent:function(a){return!w.pseudos.empty(a)},header:function(a){return pa.test(a.nodeName)},input:function(a){return oa.test(a.nodeName)},button:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&"button"===a.type||"button"===b},text:function(a){var b;return"input"===a.nodeName.toLowerCase()&&"text"===a.type&&(null==(b=a.getAttribute("type"))||"text"===b.toLowerCase())},first:j(function(){return[0]}),last:j(function(a,b){return[b-1]}),eq:j(function(a,b,c){return[c<0?c+b:c]}),even:j(function(a,b){for(var c=0;c<b;c+=2)a.push(c);return a}),odd:j(function(a,b){for(var c=1;c<b;c+=2)a.push(c);return a}),lt:j(function(a,b,c){for(var d=c<0?c+b:c;--d>=0;)a.push(d);return a}),gt:j(function(a,b,c){for(var d=c<0?c+b:c;++d<b;)a.push(d);return a})}},w.pseudos.nth=w.pseudos.eq;for(u in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})w.pseudos[u]=h(u);for(u in{submit:!0,reset:!0})w.pseudos[u]=i(u);return l.prototype=w.filters=w.pseudos,w.setFilters=new l,z=b.tokenize=function(a,c){var d,e,f,g,h,i,j,k=S[a+" "];if(k)return c?0:k.slice(0);for(h=a,i=[],j=w.preFilter;h;){d&&!(e=ia.exec(h))||(e&&(h=h.slice(e[0].length)||h),i.push(f=[])),d=!1,(e=ja.exec(h))&&(d=e.shift(),f.push({value:d,type:e[0].replace(ha," ")}),h=h.slice(d.length));for(g in w.filter)!(e=na[g].exec(h))||j[g]&&!(e=j[g](e))||(d=e.shift(),f.push({value:d,type:g,matches:e}),h=h.slice(d.length));if(!d)break}return c?h.length:h?b.error(a):S(a,i).slice(0)},A=b.compile=function(a,b){var c,d=[],e=[],f=T[a+" "];if(!f){for(b||(b=z(a)),c=b.length;c--;)f=s(b[c]),f[N]?d.push(f):e.push(f);f=T(a,t(e,d)),f.selector=a}return f},B=b.select=function(a,b,c,d){var e,f,g,h,i,j="function"==typeof a&&a,l=!d&&z(a=j.selector||a);if(c=c||[],1===l.length){if(f=l[0]=l[0].slice(0),f.length>2&&"ID"===(g=f[0]).type&&v.getById&&9===b.nodeType&&I&&w.relative[f[1].type]){if(!(b=(w.find.ID(g.matches[0].replace(ua,va),b)||[])[0]))return c;j&&(b=b.parentNode),a=a.slice(f.shift().value.length)}for(e=na.needsContext.test(a)?0:f.length;e--&&(g=f[e],!w.relative[h=g.type]);)if((i=w.find[h])&&(d=i(g.matches[0].replace(ua,va),sa.test(f[0].type)&&k(b.parentNode)||b))){if(f.splice(e,1),!(a=d.length&&m(f)))return $.apply(c,d),c;break}}return(j||A(a,l))(d,b,!I,c,!b||sa.test(a)&&k(b.parentNode)||b),c},v.sortStable=N.split("").sort(U).join("")===N,v.detectDuplicates=!!E,F(),v.sortDetached=e(function(a){return 1&a.compareDocumentPosition(G.createElement("div"))}),e(function(a){return a.innerHTML="<a href='#'></a>","#"===a.firstChild.getAttribute("href")})||f("type|href|height|width",function(a,b,c){if(!c)return a.getAttribute(b,"type"===b.toLowerCase()?1:2)}),v.attributes&&e(function(a){return a.innerHTML="<input/>",a.firstChild.setAttribute("value",""),""===a.firstChild.getAttribute("value")})||f("value",function(a,b,c){if(!c&&"input"===a.nodeName.toLowerCase())return a.defaultValue}),e(function(a){return null==a.getAttribute("disabled")})||f(ba,function(a,b,c){var d;if(!c)return!0===a[b]?b.toLowerCase():(d=a.getAttributeNode(b))&&d.specified?d.value:null}),b}(b);ga.find=la,ga.expr=la.selectors,ga.expr[":"]=ga.expr.pseudos,ga.uniqueSort=ga.unique=la.uniqueSort,ga.text=la.getText,ga.isXMLDoc=la.isXML,ga.contains=la.contains;var ma=function(a,b,c){for(var d=[],e=void 0!==c;(a=a[b])&&9!==a.nodeType;)if(1===a.nodeType){if(e&&ga(a).is(c))break;d.push(a)}return d},na=function(a,b){for(var c=[];a;a=a.nextSibling)1===a.nodeType&&a!==b&&c.push(a);return c},oa=ga.expr.match.needsContext,pa=/^<([\w-]+)\s*\/?>(?:<\/\1>|)$/,qa=/^.[^:#\[\.,]*$/;ga.filter=function(a,b,c){var d=b[0];return c&&(a=":not("+a+")"),1===b.length&&1===d.nodeType?ga.find.matchesSelector(d,a)?[d]:[]:ga.find.matches(a,ga.grep(b,function(a){return 1===a.nodeType}))},ga.fn.extend({find:function(a){var b,c=this.length,d=[],e=this;if("string"!=typeof a)return this.pushStack(ga(a).filter(function(){for(b=0;b<c;b++)if(ga.contains(e[b],this))return!0}));for(b=0;b<c;b++)ga.find(a,e[b],d);return d=this.pushStack(c>1?ga.unique(d):d),d.selector=this.selector?this.selector+" "+a:a,d},filter:function(a){return this.pushStack(e(this,a||[],!1))},not:function(a){return this.pushStack(e(this,a||[],!0))},is:function(a){return!!e(this,"string"==typeof a&&oa.test(a)?ga(a):a||[],!1).length}});var ra,sa=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/;(ga.fn.init=function(a,b,c){var d,e;if(!a)return this;if(c=c||ra,"string"==typeof a){if(!(d="<"===a[0]&&">"===a[a.length-1]&&a.length>=3?[null,a,null]:sa.exec(a))||!d[1]&&b)return!b||b.jquery?(b||c).find(a):this.constructor(b).find(a);if(d[1]){if(b=b instanceof ga?b[0]:b,ga.merge(this,ga.parseHTML(d[1],b&&b.nodeType?b.ownerDocument||b:Y,!0)),pa.test(d[1])&&ga.isPlainObject(b))for(d in b)ga.isFunction(this[d])?this[d](b[d]):this.attr(d,b[d]);return this}return e=Y.getElementById(d[2]),e&&e.parentNode&&(this.length=1,this[0]=e),this.context=Y,this.selector=a,this}return a.nodeType?(this.context=this[0]=a,this.length=1,this):ga.isFunction(a)?void 0!==c.ready?c.ready(a):a(ga):(void 0!==a.selector&&(this.selector=a.selector,this.context=a.context),ga.makeArray(a,this))}).prototype=ga.fn,ra=ga(Y);var ta=/^(?:parents|prev(?:Until|All))/,ua={children:!0,contents:!0,next:!0,prev:!0};ga.fn.extend({has:function(a){var b=ga(a,this),c=b.length;return this.filter(function(){for(var a=0;a<c;a++)if(ga.contains(this,b[a]))return!0})},closest:function(a,b){for(var c,d=0,e=this.length,f=[],g=oa.test(a)||"string"!=typeof a?ga(a,b||this.context):0;d<e;d++)for(c=this[d];c&&c!==b;c=c.parentNode)if(c.nodeType<11&&(g?g.index(c)>-1:1===c.nodeType&&ga.find.matchesSelector(c,a))){f.push(c);break}return this.pushStack(f.length>1?ga.uniqueSort(f):f)},index:function(a){return a?"string"==typeof a?aa.call(ga(a),this[0]):aa.call(this,a.jquery?a[0]:a):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(a,b){return this.pushStack(ga.uniqueSort(ga.merge(this.get(),ga(a,b))))},addBack:function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}}),ga.each({parent:function(a){var b=a.parentNode;return b&&11!==b.nodeType?b:null},parents:function(a){return ma(a,"parentNode")},parentsUntil:function(a,b,c){return ma(a,"parentNode",c)},next:function(a){return f(a,"nextSibling")},prev:function(a){return f(a,"previousSibling")},nextAll:function(a){return ma(a,"nextSibling")},prevAll:function(a){return ma(a,"previousSibling")},nextUntil:function(a,b,c){return ma(a,"nextSibling",c)},prevUntil:function(a,b,c){return ma(a,"previousSibling",c)},siblings:function(a){return na((a.parentNode||{}).firstChild,a)},children:function(a){return na(a.firstChild)},contents:function(a){return a.contentDocument||ga.merge([],a.childNodes)}},function(a,b){ga.fn[a]=function(c,d){var e=ga.map(this,b,c);return"Until"!==a.slice(-5)&&(d=c),d&&"string"==typeof d&&(e=ga.filter(d,e)),this.length>1&&(ua[a]||ga.uniqueSort(e),ta.test(a)&&e.reverse()),this.pushStack(e)}});var va=/\S+/g;ga.Callbacks=function(a){a="string"==typeof a?g(a):ga.extend({},a);var b,c,d,e,f=[],h=[],i=-1,j=function(){for(e=a.once,d=b=!0;h.length;i=-1)for(c=h.shift();++i<f.length;)!1===f[i].apply(c[0],c[1])&&a.stopOnFalse&&(i=f.length,c=!1);a.memory||(c=!1),b=!1,e&&(f=c?[]:"")},k={add:function(){return f&&(c&&!b&&(i=f.length-1,h.push(c)),function b(c){ga.each(c,function(c,d){ga.isFunction(d)?a.unique&&k.has(d)||f.push(d):d&&d.length&&"string"!==ga.type(d)&&b(d)})}(arguments),c&&!b&&j()),this},remove:function(){return ga.each(arguments,function(a,b){for(var c;(c=ga.inArray(b,f,c))>-1;)f.splice(c,1),c<=i&&i--}),this},has:function(a){return a?ga.inArray(a,f)>-1:f.length>0},empty:function(){return f&&(f=[]),this},disable:function(){return e=h=[],f=c="",this},disabled:function(){return!f},lock:function(){return e=h=[],c||(f=c=""),this},locked:function(){return!!e},fireWith:function(a,c){return e||(c=c||[],c=[a,c.slice?c.slice():c],h.push(c),b||j()),this},fire:function(){return k.fireWith(this,arguments),this},fired:function(){return!!d}};return k},ga.extend({Deferred:function(a){var b=[["resolve","done",ga.Callbacks("once memory"),"resolved"],["reject","fail",ga.Callbacks("once memory"),"rejected"],["notify","progress",ga.Callbacks("memory")]],c="pending",d={state:function(){return c},always:function(){return e.done(arguments).fail(arguments),this},then:function(){var a=arguments;return ga.Deferred(function(c){ga.each(b,function(b,f){var g=ga.isFunction(a[b])&&a[b];e[f[1]](function(){var a=g&&g.apply(this,arguments);a&&ga.isFunction(a.promise)?a.promise().progress(c.notify).done(c.resolve).fail(c.reject):c[f[0]+"With"](this===d?c.promise():this,g?[a]:arguments)})}),a=null}).promise()},promise:function(a){return null!=a?ga.extend(a,d):d}},e={};return d.pipe=d.then,ga.each(b,function(a,f){var g=f[2],h=f[3];d[f[1]]=g.add,h&&g.add(function(){c=h},b[1^a][2].disable,b[2][2].lock),e[f[0]]=function(){return e[f[0]+"With"](this===e?d:this,arguments),this},e[f[0]+"With"]=g.fireWith}),d.promise(e),a&&a.call(e,e),e},when:function(a){var b,c,d,e=0,f=Z.call(arguments),g=f.length,h=1!==g||a&&ga.isFunction(a.promise)?g:0,i=1===h?a:ga.Deferred(),j=function(a,c,d){return function(e){c[a]=this,d[a]=arguments.length>1?Z.call(arguments):e,d===b?i.notifyWith(c,d):--h||i.resolveWith(c,d)}};if(g>1)for(b=new Array(g),c=new Array(g),d=new Array(g);e<g;e++)f[e]&&ga.isFunction(f[e].promise)?f[e].promise().progress(j(e,c,b)).done(j(e,d,f)).fail(i.reject):--h;return h||i.resolveWith(d,f),i.promise()}});var wa;ga.fn.ready=function(a){return ga.ready.promise().done(a),this},ga.extend({isReady:!1,readyWait:1,holdReady:function(a){a?ga.readyWait++:ga.ready(!0)},ready:function(a){(!0===a?--ga.readyWait:ga.isReady)||(ga.isReady=!0,!0!==a&&--ga.readyWait>0||(wa.resolveWith(Y,[ga]),ga.fn.triggerHandler&&(ga(Y).triggerHandler("ready"),ga(Y).off("ready"))))}}),ga.ready.promise=function(a){return wa||(wa=ga.Deferred(),"complete"===Y.readyState||"loading"!==Y.readyState&&!Y.documentElement.doScroll?b.setTimeout(ga.ready):(Y.addEventListener("DOMContentLoaded",h),b.addEventListener("load",h))),wa.promise(a)},ga.ready.promise();var xa=function(a,b,c,d,e,f,g){var h=0,i=a.length,j=null==c;if("object"===ga.type(c)){e=!0;for(h in c)xa(a,b,h,c[h],!0,f,g)}else if(void 0!==d&&(e=!0,ga.isFunction(d)||(g=!0),j&&(g?(b.call(a,d),b=null):(j=b,b=function(a,b,c){return j.call(ga(a),c)})),b))for(;h<i;h++)b(a[h],c,g?d:d.call(a[h],h,b(a[h],c)));return e?a:j?b.call(a):i?b(a[0],c):f},ya=function(a){return 1===a.nodeType||9===a.nodeType||!+a.nodeType};i.uid=1,i.prototype={register:function(a,b){var c=b||{};return a.nodeType?a[this.expando]=c:Object.defineProperty(a,this.expando,{value:c,writable:!0,configurable:!0}),a[this.expando]},cache:function(a){if(!ya(a))return{};var b=a[this.expando];return b||(b={},ya(a)&&(a.nodeType?a[this.expando]=b:Object.defineProperty(a,this.expando,{value:b,configurable:!0}))),b},set:function(a,b,c){var d,e=this.cache(a);if("string"==typeof b)e[b]=c;else for(d in b)e[d]=b[d];return e},get:function(a,b){return void 0===b?this.cache(a):a[this.expando]&&a[this.expando][b]},access:function(a,b,c){var d;return void 0===b||b&&"string"==typeof b&&void 0===c?(d=this.get(a,b),void 0!==d?d:this.get(a,ga.camelCase(b))):(this.set(a,b,c),void 0!==c?c:b)},remove:function(a,b){var c,d,e,f=a[this.expando];if(void 0!==f){if(void 0===b)this.register(a);else{ga.isArray(b)?d=b.concat(b.map(ga.camelCase)):(e=ga.camelCase(b),b in f?d=[b,e]:(d=e,d=d in f?[d]:d.match(va)||[])),c=d.length;for(;c--;)delete f[d[c]]}(void 0===b||ga.isEmptyObject(f))&&(a.nodeType?a[this.expando]=void 0:delete a[this.expando])}},hasData:function(a){var b=a[this.expando];return void 0!==b&&!ga.isEmptyObject(b)}};var za=new i,Aa=new i,Ba=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Ca=/[A-Z]/g;ga.extend({hasData:function(a){return Aa.hasData(a)||za.hasData(a)},data:function(a,b,c){return Aa.access(a,b,c)},removeData:function(a,b){Aa.remove(a,b)},_data:function(a,b,c){return za.access(a,b,c)},_removeData:function(a,b){za.remove(a,b)}}),ga.fn.extend({data:function(a,b){var c,d,e,f=this[0],g=f&&f.attributes;if(void 0===a){if(this.length&&(e=Aa.get(f),1===f.nodeType&&!za.get(f,"hasDataAttrs"))){for(c=g.length;c--;)g[c]&&(d=g[c].name,0===d.indexOf("data-")&&(d=ga.camelCase(d.slice(5)),j(f,d,e[d])));za.set(f,"hasDataAttrs",!0)}return e}return"object"==typeof a?this.each(function(){Aa.set(this,a)}):xa(this,function(b){var c,d;if(f&&void 0===b){if(void 0!==(c=Aa.get(f,a)||Aa.get(f,a.replace(Ca,"-$&").toLowerCase())))return c;if(d=ga.camelCase(a),void 0!==(c=Aa.get(f,d)))return c;if(void 0!==(c=j(f,d,void 0)))return c}else d=ga.camelCase(a),this.each(function(){var c=Aa.get(this,d);Aa.set(this,d,b),a.indexOf("-")>-1&&void 0!==c&&Aa.set(this,a,b)})},null,b,arguments.length>1,null,!0)},removeData:function(a){return this.each(function(){Aa.remove(this,a)})}}),ga.extend({queue:function(a,b,c){var d;if(a)return b=(b||"fx")+"queue",d=za.get(a,b),c&&(!d||ga.isArray(c)?d=za.access(a,b,ga.makeArray(c)):d.push(c)),d||[]},dequeue:function(a,b){b=b||"fx";var c=ga.queue(a,b),d=c.length,e=c.shift(),f=ga._queueHooks(a,b),g=function(){ga.dequeue(a,b)};"inprogress"===e&&(e=c.shift(),d--),e&&("fx"===b&&c.unshift("inprogress"),delete f.stop,e.call(a,g,f)),!d&&f&&f.empty.fire()},_queueHooks:function(a,b){var c=b+"queueHooks";return za.get(a,c)||za.access(a,c,{empty:ga.Callbacks("once memory").add(function(){za.remove(a,[b+"queue",c])})})}}),ga.fn.extend({queue:function(a,b){var c=2;return"string"!=typeof a&&(b=a,a="fx",c--),arguments.length<c?ga.queue(this[0],a):void 0===b?this:this.each(function(){var c=ga.queue(this,a,b);ga._queueHooks(this,a),"fx"===a&&"inprogress"!==c[0]&&ga.dequeue(this,a)})},dequeue:function(a){return this.each(function(){ga.dequeue(this,a)})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,b){var c,d=1,e=ga.Deferred(),f=this,g=this.length,h=function(){--d||e.resolveWith(f,[f])};for("string"!=typeof a&&(b=a,a=void 0),a=a||"fx";g--;)(c=za.get(f[g],a+"queueHooks"))&&c.empty&&(d++,c.empty.add(h));return h(),e.promise(b)}});var Da=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,Ea=new RegExp("^(?:([+-])=|)("+Da+")([a-z%]*)$","i"),Fa=["Top","Right","Bottom","Left"],Ga=function(a,b){return a=b||a,"none"===ga.css(a,"display")||!ga.contains(a.ownerDocument,a)},Ha=/^(?:checkbox|radio)$/i,Ia=/<([\w:-]+)/,Ja=/^$|\/(?:java|ecma)script/i,Ka={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};Ka.optgroup=Ka.option,Ka.tbody=Ka.tfoot=Ka.colgroup=Ka.caption=Ka.thead,Ka.th=Ka.td;var La=/<|&#?\w+;/;!function(){var a=Y.createDocumentFragment(),b=a.appendChild(Y.createElement("div")),c=Y.createElement("input");c.setAttribute("type","radio"),c.setAttribute("checked","checked"),c.setAttribute("name","t"),b.appendChild(c),ea.checkClone=b.cloneNode(!0).cloneNode(!0).lastChild.checked,b.innerHTML="<textarea>x</textarea>",ea.noCloneChecked=!!b.cloneNode(!0).lastChild.defaultValue}();var Ma=/^key/,Na=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,Oa=/^([^.]*)(?:\.(.+)|)/;ga.event={global:{},add:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q=za.get(a);if(q)for(c.handler&&(f=c,c=f.handler,e=f.selector),c.guid||(c.guid=ga.guid++),(i=q.events)||(i=q.events={}),(g=q.handle)||(g=q.handle=function(b){return void 0!==ga&&ga.event.triggered!==b.type?ga.event.dispatch.apply(a,arguments):void 0}),b=(b||"").match(va)||[""],j=b.length;j--;)h=Oa.exec(b[j])||[],n=p=h[1],o=(h[2]||"").split(".").sort(),n&&(l=ga.event.special[n]||{},n=(e?l.delegateType:l.bindType)||n,l=ga.event.special[n]||{},k=ga.extend({type:n,origType:p,data:d,handler:c,guid:c.guid,selector:e,needsContext:e&&ga.expr.match.needsContext.test(e),namespace:o.join(".")},f),(m=i[n])||(m=i[n]=[],m.delegateCount=0,l.setup&&!1!==l.setup.call(a,d,o,g)||a.addEventListener&&a.addEventListener(n,g)),l.add&&(l.add.call(a,k),k.handler.guid||(k.handler.guid=c.guid)),e?m.splice(m.delegateCount++,0,k):m.push(k),ga.event.global[n]=!0)},remove:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q=za.hasData(a)&&za.get(a);if(q&&(i=q.events)){for(b=(b||"").match(va)||[""],j=b.length;j--;)if(h=Oa.exec(b[j])||[],n=p=h[1],o=(h[2]||"").split(".").sort(),n){for(l=ga.event.special[n]||{},n=(d?l.delegateType:l.bindType)||n,m=i[n]||[],h=h[2]&&new RegExp("(^|\\.)"+o.join("\\.(?:.*\\.|)")+"(\\.|$)"),g=f=m.length;f--;)k=m[f],!e&&p!==k.origType||c&&c.guid!==k.guid||h&&!h.test(k.namespace)||d&&d!==k.selector&&("**"!==d||!k.selector)||(m.splice(f,1),k.selector&&m.delegateCount--,l.remove&&l.remove.call(a,k));g&&!m.length&&(l.teardown&&!1!==l.teardown.call(a,o,q.handle)||ga.removeEvent(a,n,q.handle),delete i[n])}else for(n in i)ga.event.remove(a,n+b[j],c,d,!0);ga.isEmptyObject(i)&&za.remove(a,"handle events")}},dispatch:function(a){a=ga.event.fix(a);var b,c,d,e,f,g=[],h=Z.call(arguments),i=(za.get(this,"events")||{})[a.type]||[],j=ga.event.special[a.type]||{};if(h[0]=a,a.delegateTarget=this,!j.preDispatch||!1!==j.preDispatch.call(this,a)){for(g=ga.event.handlers.call(this,a,i),b=0;(e=g[b++])&&!a.isPropagationStopped();)for(a.currentTarget=e.elem,c=0;(f=e.handlers[c++])&&!a.isImmediatePropagationStopped();)a.rnamespace&&!a.rnamespace.test(f.namespace)||(a.handleObj=f,a.data=f.data,void 0!==(d=((ga.event.special[f.origType]||{}).handle||f.handler).apply(e.elem,h))&&!1===(a.result=d)&&(a.preventDefault(),a.stopPropagation()));return j.postDispatch&&j.postDispatch.call(this,a),a.result}},handlers:function(a,b){var c,d,e,f,g=[],h=b.delegateCount,i=a.target;if(h&&i.nodeType&&("click"!==a.type||isNaN(a.button)||a.button<1))for(;i!==this;i=i.parentNode||this)if(1===i.nodeType&&(!0!==i.disabled||"click"!==a.type)){for(d=[],c=0;c<h;c++)f=b[c],e=f.selector+" ",void 0===d[e]&&(d[e]=f.needsContext?ga(e,this).index(i)>-1:ga.find(e,this,null,[i]).length),d[e]&&d.push(f);d.length&&g.push({elem:i,handlers:d})}return h<b.length&&g.push({elem:this,handlers:b.slice(h)}),g},props:"altKey bubbles cancelable ctrlKey currentTarget detail eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(a,b){return null==a.which&&(a.which=null!=b.charCode?b.charCode:b.keyCode),a}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(a,b){var c,d,e,f=b.button;return null==a.pageX&&null!=b.clientX&&(c=a.target.ownerDocument||Y,d=c.documentElement,e=c.body,a.pageX=b.clientX+(d&&d.scrollLeft||e&&e.scrollLeft||0)-(d&&d.clientLeft||e&&e.clientLeft||0),a.pageY=b.clientY+(d&&d.scrollTop||e&&e.scrollTop||0)-(d&&d.clientTop||e&&e.clientTop||0)),a.which||void 0===f||(a.which=1&f?1:2&f?3:4&f?2:0),a}},fix:function(a){if(a[ga.expando])return a;var b,c,d,e=a.type,f=a,g=this.fixHooks[e];for(g||(this.fixHooks[e]=g=Na.test(e)?this.mouseHooks:Ma.test(e)?this.keyHooks:{}),d=g.props?this.props.concat(g.props):this.props,a=new ga.Event(f),b=d.length;b--;)c=d[b],a[c]=f[c];return a.target||(a.target=Y),3===a.target.nodeType&&(a.target=a.target.parentNode),g.filter?g.filter(a,f):a},special:{
load:{noBubble:!0},focus:{trigger:function(){if(this!==q()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===q()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if("checkbox"===this.type&&this.click&&ga.nodeName(this,"input"))return this.click(),!1},_default:function(a){return ga.nodeName(a.target,"a")}},beforeunload:{postDispatch:function(a){void 0!==a.result&&a.originalEvent&&(a.originalEvent.returnValue=a.result)}}}},ga.removeEvent=function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c)},ga.Event=function(a,b){if(!(this instanceof ga.Event))return new ga.Event(a,b);a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||void 0===a.defaultPrevented&&!1===a.returnValue?o:p):this.type=a,b&&ga.extend(this,b),this.timeStamp=a&&a.timeStamp||ga.now(),this[ga.expando]=!0},ga.Event.prototype={constructor:ga.Event,isDefaultPrevented:p,isPropagationStopped:p,isImmediatePropagationStopped:p,isSimulated:!1,preventDefault:function(){var a=this.originalEvent;this.isDefaultPrevented=o,a&&!this.isSimulated&&a.preventDefault()},stopPropagation:function(){var a=this.originalEvent;this.isPropagationStopped=o,a&&!this.isSimulated&&a.stopPropagation()},stopImmediatePropagation:function(){var a=this.originalEvent;this.isImmediatePropagationStopped=o,a&&!this.isSimulated&&a.stopImmediatePropagation(),this.stopPropagation()}},ga.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(a,b){ga.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c,d=this,e=a.relatedTarget,f=a.handleObj;return e&&(e===d||ga.contains(d,e))||(a.type=f.origType,c=f.handler.apply(this,arguments),a.type=b),c}}}),ga.fn.extend({on:function(a,b,c,d){return r(this,a,b,c,d)},one:function(a,b,c,d){return r(this,a,b,c,d,1)},off:function(a,b,c){var d,e;if(a&&a.preventDefault&&a.handleObj)return d=a.handleObj,ga(a.delegateTarget).off(d.namespace?d.origType+"."+d.namespace:d.origType,d.selector,d.handler),this;if("object"==typeof a){for(e in a)this.off(e,b,a[e]);return this}return!1!==b&&"function"!=typeof b||(c=b,b=void 0),!1===c&&(c=p),this.each(function(){ga.event.remove(this,a,c,b)})}});var Pa=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:-]+)[^>]*)\/>/gi,Qa=/<script|<style|<link/i,Ra=/checked\s*(?:[^=]|=\s*.checked.)/i,Sa=/^true\/(.*)/,Ta=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;ga.extend({htmlPrefilter:function(a){return a.replace(Pa,"<$1></$2>")},clone:function(a,b,c){var d,e,f,g,h=a.cloneNode(!0),i=ga.contains(a.ownerDocument,a);if(!(ea.noCloneChecked||1!==a.nodeType&&11!==a.nodeType||ga.isXMLDoc(a)))for(g=l(h),f=l(a),d=0,e=f.length;d<e;d++)w(f[d],g[d]);if(b)if(c)for(f=f||l(a),g=g||l(h),d=0,e=f.length;d<e;d++)v(f[d],g[d]);else v(a,h);return g=l(h,"script"),g.length>0&&m(g,!i&&l(a,"script")),h},cleanData:function(a){for(var b,c,d,e=ga.event.special,f=0;void 0!==(c=a[f]);f++)if(ya(c)){if(b=c[za.expando]){if(b.events)for(d in b.events)e[d]?ga.event.remove(c,d):ga.removeEvent(c,d,b.handle);c[za.expando]=void 0}c[Aa.expando]&&(c[Aa.expando]=void 0)}}}),ga.fn.extend({domManip:x,detach:function(a){return y(this,a,!0)},remove:function(a){return y(this,a)},text:function(a){return xa(this,function(a){return void 0===a?ga.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=a)})},null,a,arguments.length)},append:function(){return x(this,arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){s(this,a).appendChild(a)}})},prepend:function(){return x(this,arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=s(this,a);b.insertBefore(a,b.firstChild)}})},before:function(){return x(this,arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this)})},after:function(){return x(this,arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this.nextSibling)})},empty:function(){for(var a,b=0;null!=(a=this[b]);b++)1===a.nodeType&&(ga.cleanData(l(a,!1)),a.textContent="");return this},clone:function(a,b){return a=null!=a&&a,b=null==b?a:b,this.map(function(){return ga.clone(this,a,b)})},html:function(a){return xa(this,function(a){var b=this[0]||{},c=0,d=this.length;if(void 0===a&&1===b.nodeType)return b.innerHTML;if("string"==typeof a&&!Qa.test(a)&&!Ka[(Ia.exec(a)||["",""])[1].toLowerCase()]){a=ga.htmlPrefilter(a);try{for(;c<d;c++)b=this[c]||{},1===b.nodeType&&(ga.cleanData(l(b,!1)),b.innerHTML=a);b=0}catch(a){}}b&&this.empty().append(a)},null,a,arguments.length)},replaceWith:function(){var a=[];return x(this,arguments,function(b){var c=this.parentNode;ga.inArray(this,a)<0&&(ga.cleanData(l(this)),c&&c.replaceChild(b,this))},a)}}),ga.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){ga.fn[a]=function(a){for(var c,d=[],e=ga(a),f=e.length-1,g=0;g<=f;g++)c=g===f?this:this.clone(!0),ga(e[g])[b](c),_.apply(d,c.get());return this.pushStack(d)}});var Ua,Va={HTML:"block",BODY:"block"},Wa=/^margin/,Xa=new RegExp("^("+Da+")(?!px)[a-z%]+$","i"),Ya=function(a){var c=a.ownerDocument.defaultView;return c&&c.opener||(c=b),c.getComputedStyle(a)},Za=function(a,b,c,d){var e,f,g={};for(f in b)g[f]=a.style[f],a.style[f]=b[f];e=c.apply(a,d||[]);for(f in b)a.style[f]=g[f];return e},$a=Y.documentElement;!function(){function a(){h.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%",h.innerHTML="",$a.appendChild(g);var a=b.getComputedStyle(h);c="1%"!==a.top,f="2px"===a.marginLeft,d="4px"===a.width,h.style.marginRight="50%",e="4px"===a.marginRight,$a.removeChild(g)}var c,d,e,f,g=Y.createElement("div"),h=Y.createElement("div");h.style&&(h.style.backgroundClip="content-box",h.cloneNode(!0).style.backgroundClip="",ea.clearCloneStyle="content-box"===h.style.backgroundClip,g.style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute",g.appendChild(h),ga.extend(ea,{pixelPosition:function(){return a(),c},boxSizingReliable:function(){return null==d&&a(),d},pixelMarginRight:function(){return null==d&&a(),e},reliableMarginLeft:function(){return null==d&&a(),f},reliableMarginRight:function(){var a,c=h.appendChild(Y.createElement("div"));return c.style.cssText=h.style.cssText="-webkit-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",c.style.marginRight=c.style.width="0",h.style.width="1px",$a.appendChild(g),a=!parseFloat(b.getComputedStyle(c).marginRight),$a.removeChild(g),h.removeChild(c),a}}))}();var _a=/^(none|table(?!-c[ea]).+)/,ab={position:"absolute",visibility:"hidden",display:"block"},bb={letterSpacing:"0",fontWeight:"400"},cb=["Webkit","O","Moz","ms"],db=Y.createElement("div").style;ga.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=B(a,"opacity");return""===c?"1":c}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:"cssFloat"},style:function(a,b,c,d){if(a&&3!==a.nodeType&&8!==a.nodeType&&a.style){var e,f,g,h=ga.camelCase(b),i=a.style;if(b=ga.cssProps[h]||(ga.cssProps[h]=D(h)||h),g=ga.cssHooks[b]||ga.cssHooks[h],void 0===c)return g&&"get"in g&&void 0!==(e=g.get(a,!1,d))?e:i[b];f=typeof c,"string"===f&&(e=Ea.exec(c))&&e[1]&&(c=k(a,b,e),f="number"),null!=c&&c===c&&("number"===f&&(c+=e&&e[3]||(ga.cssNumber[h]?"":"px")),ea.clearCloneStyle||""!==c||0!==b.indexOf("background")||(i[b]="inherit"),g&&"set"in g&&void 0===(c=g.set(a,c,d))||(i[b]=c))}},css:function(a,b,c,d){var e,f,g,h=ga.camelCase(b);return b=ga.cssProps[h]||(ga.cssProps[h]=D(h)||h),g=ga.cssHooks[b]||ga.cssHooks[h],g&&"get"in g&&(e=g.get(a,!0,c)),void 0===e&&(e=B(a,b,d)),"normal"===e&&b in bb&&(e=bb[b]),""===c||c?(f=parseFloat(e),!0===c||isFinite(f)?f||0:e):e}}),ga.each(["height","width"],function(a,b){ga.cssHooks[b]={get:function(a,c,d){if(c)return _a.test(ga.css(a,"display"))&&0===a.offsetWidth?Za(a,ab,function(){return G(a,b,d)}):G(a,b,d)},set:function(a,c,d){var e,f=d&&Ya(a),g=d&&F(a,b,d,"border-box"===ga.css(a,"boxSizing",!1,f),f);return g&&(e=Ea.exec(c))&&"px"!==(e[3]||"px")&&(a.style[b]=c,c=ga.css(a,b)),E(a,c,g)}}}),ga.cssHooks.marginLeft=C(ea.reliableMarginLeft,function(a,b){if(b)return(parseFloat(B(a,"marginLeft"))||a.getBoundingClientRect().left-Za(a,{marginLeft:0},function(){return a.getBoundingClientRect().left}))+"px"}),ga.cssHooks.marginRight=C(ea.reliableMarginRight,function(a,b){if(b)return Za(a,{display:"inline-block"},B,[a,"marginRight"])}),ga.each({margin:"",padding:"",border:"Width"},function(a,b){ga.cssHooks[a+b]={expand:function(c){for(var d=0,e={},f="string"==typeof c?c.split(" "):[c];d<4;d++)e[a+Fa[d]+b]=f[d]||f[d-2]||f[0];return e}},Wa.test(a)||(ga.cssHooks[a+b].set=E)}),ga.fn.extend({css:function(a,b){return xa(this,function(a,b,c){var d,e,f={},g=0;if(ga.isArray(b)){for(d=Ya(a),e=b.length;g<e;g++)f[b[g]]=ga.css(a,b[g],!1,d);return f}return void 0!==c?ga.style(a,b,c):ga.css(a,b)},a,b,arguments.length>1)},show:function(){return H(this,!0)},hide:function(){return H(this)},toggle:function(a){return"boolean"==typeof a?a?this.show():this.hide():this.each(function(){Ga(this)?ga(this).show():ga(this).hide()})}}),ga.Tween=I,I.prototype={constructor:I,init:function(a,b,c,d,e,f){this.elem=a,this.prop=c,this.easing=e||ga.easing._default,this.options=b,this.start=this.now=this.cur(),this.end=d,this.unit=f||(ga.cssNumber[c]?"":"px")},cur:function(){var a=I.propHooks[this.prop];return a&&a.get?a.get(this):I.propHooks._default.get(this)},run:function(a){var b,c=I.propHooks[this.prop];return this.options.duration?this.pos=b=ga.easing[this.easing](a,this.options.duration*a,0,1,this.options.duration):this.pos=b=a,this.now=(this.end-this.start)*b+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),c&&c.set?c.set(this):I.propHooks._default.set(this),this}},I.prototype.init.prototype=I.prototype,I.propHooks={_default:{get:function(a){var b;return 1!==a.elem.nodeType||null!=a.elem[a.prop]&&null==a.elem.style[a.prop]?a.elem[a.prop]:(b=ga.css(a.elem,a.prop,""),b&&"auto"!==b?b:0)},set:function(a){ga.fx.step[a.prop]?ga.fx.step[a.prop](a):1!==a.elem.nodeType||null==a.elem.style[ga.cssProps[a.prop]]&&!ga.cssHooks[a.prop]?a.elem[a.prop]=a.now:ga.style(a.elem,a.prop,a.now+a.unit)}}},I.propHooks.scrollTop=I.propHooks.scrollLeft={set:function(a){a.elem.nodeType&&a.elem.parentNode&&(a.elem[a.prop]=a.now)}},ga.easing={linear:function(a){return a},swing:function(a){return.5-Math.cos(a*Math.PI)/2},_default:"swing"},ga.fx=I.prototype.init,ga.fx.step={};var eb,fb,gb=/^(?:toggle|show|hide)$/,hb=/queueHooks$/;ga.Animation=ga.extend(O,{tweeners:{"*":[function(a,b){var c=this.createTween(a,b);return k(c.elem,a,Ea.exec(b),c),c}]},tweener:function(a,b){ga.isFunction(a)?(b=a,a=["*"]):a=a.match(va);for(var c,d=0,e=a.length;d<e;d++)c=a[d],O.tweeners[c]=O.tweeners[c]||[],O.tweeners[c].unshift(b)},prefilters:[M],prefilter:function(a,b){b?O.prefilters.unshift(a):O.prefilters.push(a)}}),ga.speed=function(a,b,c){var d=a&&"object"==typeof a?ga.extend({},a):{complete:c||!c&&b||ga.isFunction(a)&&a,duration:a,easing:c&&b||b&&!ga.isFunction(b)&&b};return d.duration=ga.fx.off?0:"number"==typeof d.duration?d.duration:d.duration in ga.fx.speeds?ga.fx.speeds[d.duration]:ga.fx.speeds._default,null!=d.queue&&!0!==d.queue||(d.queue="fx"),d.old=d.complete,d.complete=function(){ga.isFunction(d.old)&&d.old.call(this),d.queue&&ga.dequeue(this,d.queue)},d},ga.fn.extend({fadeTo:function(a,b,c,d){return this.filter(Ga).css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){var e=ga.isEmptyObject(a),f=ga.speed(b,c,d),g=function(){var b=O(this,ga.extend({},a),f);(e||za.get(this,"finish"))&&b.stop(!0)};return g.finish=g,e||!1===f.queue?this.each(g):this.queue(f.queue,g)},stop:function(a,b,c){var d=function(a){var b=a.stop;delete a.stop,b(c)};return"string"!=typeof a&&(c=b,b=a,a=void 0),b&&!1!==a&&this.queue(a||"fx",[]),this.each(function(){var b=!0,e=null!=a&&a+"queueHooks",f=ga.timers,g=za.get(this);if(e)g[e]&&g[e].stop&&d(g[e]);else for(e in g)g[e]&&g[e].stop&&hb.test(e)&&d(g[e]);for(e=f.length;e--;)f[e].elem!==this||null!=a&&f[e].queue!==a||(f[e].anim.stop(c),b=!1,f.splice(e,1));!b&&c||ga.dequeue(this,a)})},finish:function(a){return!1!==a&&(a=a||"fx"),this.each(function(){var b,c=za.get(this),d=c[a+"queue"],e=c[a+"queueHooks"],f=ga.timers,g=d?d.length:0;for(c.finish=!0,ga.queue(this,a,[]),e&&e.stop&&e.stop.call(this,!0),b=f.length;b--;)f[b].elem===this&&f[b].queue===a&&(f[b].anim.stop(!0),f.splice(b,1));for(b=0;b<g;b++)d[b]&&d[b].finish&&d[b].finish.call(this);delete c.finish})}}),ga.each(["toggle","show","hide"],function(a,b){var c=ga.fn[b];ga.fn[b]=function(a,d,e){return null==a||"boolean"==typeof a?c.apply(this,arguments):this.animate(K(b,!0),a,d,e)}}),ga.each({slideDown:K("show"),slideUp:K("hide"),slideToggle:K("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){ga.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}}),ga.timers=[],ga.fx.tick=function(){var a,b=0,c=ga.timers;for(eb=ga.now();b<c.length;b++)(a=c[b])()||c[b]!==a||c.splice(b--,1);c.length||ga.fx.stop(),eb=void 0},ga.fx.timer=function(a){ga.timers.push(a),a()?ga.fx.start():ga.timers.pop()},ga.fx.interval=13,ga.fx.start=function(){fb||(fb=b.setInterval(ga.fx.tick,ga.fx.interval))},ga.fx.stop=function(){b.clearInterval(fb),fb=null},ga.fx.speeds={slow:600,fast:200,_default:400},ga.fn.delay=function(a,c){return a=ga.fx?ga.fx.speeds[a]||a:a,c=c||"fx",this.queue(c,function(c,d){var e=b.setTimeout(c,a);d.stop=function(){b.clearTimeout(e)}})},function(){var a=Y.createElement("input"),b=Y.createElement("select"),c=b.appendChild(Y.createElement("option"));a.type="checkbox",ea.checkOn=""!==a.value,ea.optSelected=c.selected,b.disabled=!0,ea.optDisabled=!c.disabled,a=Y.createElement("input"),a.value="t",a.type="radio",ea.radioValue="t"===a.value}();var ib,jb=ga.expr.attrHandle;ga.fn.extend({attr:function(a,b){return xa(this,ga.attr,a,b,arguments.length>1)},removeAttr:function(a){return this.each(function(){ga.removeAttr(this,a)})}}),ga.extend({attr:function(a,b,c){var d,e,f=a.nodeType;if(3!==f&&8!==f&&2!==f)return void 0===a.getAttribute?ga.prop(a,b,c):(1===f&&ga.isXMLDoc(a)||(b=b.toLowerCase(),e=ga.attrHooks[b]||(ga.expr.match.bool.test(b)?ib:void 0)),void 0!==c?null===c?void ga.removeAttr(a,b):e&&"set"in e&&void 0!==(d=e.set(a,c,b))?d:(a.setAttribute(b,c+""),c):e&&"get"in e&&null!==(d=e.get(a,b))?d:(d=ga.find.attr(a,b),null==d?void 0:d))},attrHooks:{type:{set:function(a,b){if(!ea.radioValue&&"radio"===b&&ga.nodeName(a,"input")){var c=a.value;return a.setAttribute("type",b),c&&(a.value=c),b}}}},removeAttr:function(a,b){var c,d,e=0,f=b&&b.match(va);if(f&&1===a.nodeType)for(;c=f[e++];)d=ga.propFix[c]||c,ga.expr.match.bool.test(c)&&(a[d]=!1),a.removeAttribute(c)}}),ib={set:function(a,b,c){return!1===b?ga.removeAttr(a,c):a.setAttribute(c,c),c}},ga.each(ga.expr.match.bool.source.match(/\w+/g),function(a,b){var c=jb[b]||ga.find.attr;jb[b]=function(a,b,d){var e,f;return d||(f=jb[b],jb[b]=e,e=null!=c(a,b,d)?b.toLowerCase():null,jb[b]=f),e}});var kb=/^(?:input|select|textarea|button)$/i,lb=/^(?:a|area)$/i;ga.fn.extend({prop:function(a,b){return xa(this,ga.prop,a,b,arguments.length>1)},removeProp:function(a){return this.each(function(){delete this[ga.propFix[a]||a]})}}),ga.extend({prop:function(a,b,c){var d,e,f=a.nodeType;if(3!==f&&8!==f&&2!==f)return 1===f&&ga.isXMLDoc(a)||(b=ga.propFix[b]||b,e=ga.propHooks[b]),void 0!==c?e&&"set"in e&&void 0!==(d=e.set(a,c,b))?d:a[b]=c:e&&"get"in e&&null!==(d=e.get(a,b))?d:a[b]},propHooks:{tabIndex:{get:function(a){var b=ga.find.attr(a,"tabindex");return b?parseInt(b,10):kb.test(a.nodeName)||lb.test(a.nodeName)&&a.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),ea.optSelected||(ga.propHooks.selected={get:function(a){var b=a.parentNode;return b&&b.parentNode&&b.parentNode.selectedIndex,null},set:function(a){var b=a.parentNode;b&&(b.selectedIndex,b.parentNode&&b.parentNode.selectedIndex)}}),ga.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){ga.propFix[this.toLowerCase()]=this});var mb=/[\t\r\n\f]/g;ga.fn.extend({addClass:function(a){var b,c,d,e,f,g,h,i=0;if(ga.isFunction(a))return this.each(function(b){ga(this).addClass(a.call(this,b,P(this)))});if("string"==typeof a&&a)for(b=a.match(va)||[];c=this[i++];)if(e=P(c),d=1===c.nodeType&&(" "+e+" ").replace(mb," ")){for(g=0;f=b[g++];)d.indexOf(" "+f+" ")<0&&(d+=f+" ");h=ga.trim(d),e!==h&&c.setAttribute("class",h)}return this},removeClass:function(a){var b,c,d,e,f,g,h,i=0;if(ga.isFunction(a))return this.each(function(b){ga(this).removeClass(a.call(this,b,P(this)))});if(!arguments.length)return this.attr("class","");if("string"==typeof a&&a)for(b=a.match(va)||[];c=this[i++];)if(e=P(c),d=1===c.nodeType&&(" "+e+" ").replace(mb," ")){for(g=0;f=b[g++];)for(;d.indexOf(" "+f+" ")>-1;)d=d.replace(" "+f+" "," ");h=ga.trim(d),e!==h&&c.setAttribute("class",h)}return this},toggleClass:function(a,b){var c=typeof a;return"boolean"==typeof b&&"string"===c?b?this.addClass(a):this.removeClass(a):ga.isFunction(a)?this.each(function(c){ga(this).toggleClass(a.call(this,c,P(this),b),b)}):this.each(function(){var b,d,e,f;if("string"===c)for(d=0,e=ga(this),f=a.match(va)||[];b=f[d++];)e.hasClass(b)?e.removeClass(b):e.addClass(b);else void 0!==a&&"boolean"!==c||(b=P(this),b&&za.set(this,"__className__",b),this.setAttribute&&this.setAttribute("class",b||!1===a?"":za.get(this,"__className__")||""))})},hasClass:function(a){var b,c,d=0;for(b=" "+a+" ";c=this[d++];)if(1===c.nodeType&&(" "+P(c)+" ").replace(mb," ").indexOf(b)>-1)return!0;return!1}});var nb=/\r/g,ob=/[\x20\t\r\n\f]+/g;ga.fn.extend({val:function(a){var b,c,d,e=this[0];{if(arguments.length)return d=ga.isFunction(a),this.each(function(c){var e;1===this.nodeType&&(e=d?a.call(this,c,ga(this).val()):a,null==e?e="":"number"==typeof e?e+="":ga.isArray(e)&&(e=ga.map(e,function(a){return null==a?"":a+""})),(b=ga.valHooks[this.type]||ga.valHooks[this.nodeName.toLowerCase()])&&"set"in b&&void 0!==b.set(this,e,"value")||(this.value=e))});if(e)return(b=ga.valHooks[e.type]||ga.valHooks[e.nodeName.toLowerCase()])&&"get"in b&&void 0!==(c=b.get(e,"value"))?c:(c=e.value,"string"==typeof c?c.replace(nb,""):null==c?"":c)}}}),ga.extend({valHooks:{option:{get:function(a){var b=ga.find.attr(a,"value");return null!=b?b:ga.trim(ga.text(a)).replace(ob," ")}},select:{get:function(a){for(var b,c,d=a.options,e=a.selectedIndex,f="select-one"===a.type||e<0,g=f?null:[],h=f?e+1:d.length,i=e<0?h:f?e:0;i<h;i++)if(c=d[i],(c.selected||i===e)&&(ea.optDisabled?!c.disabled:null===c.getAttribute("disabled"))&&(!c.parentNode.disabled||!ga.nodeName(c.parentNode,"optgroup"))){if(b=ga(c).val(),f)return b;g.push(b)}return g},set:function(a,b){for(var c,d,e=a.options,f=ga.makeArray(b),g=e.length;g--;)d=e[g],(d.selected=ga.inArray(ga.valHooks.option.get(d),f)>-1)&&(c=!0);return c||(a.selectedIndex=-1),f}}}}),ga.each(["radio","checkbox"],function(){ga.valHooks[this]={set:function(a,b){if(ga.isArray(b))return a.checked=ga.inArray(ga(a).val(),b)>-1}},ea.checkOn||(ga.valHooks[this].get=function(a){return null===a.getAttribute("value")?"on":a.value})});var pb=/^(?:focusinfocus|focusoutblur)$/;ga.extend(ga.event,{trigger:function(a,c,d,e){var f,g,h,i,j,k,l,m=[d||Y],n=da.call(a,"type")?a.type:a,o=da.call(a,"namespace")?a.namespace.split("."):[];if(g=h=d=d||Y,3!==d.nodeType&&8!==d.nodeType&&!pb.test(n+ga.event.triggered)&&(n.indexOf(".")>-1&&(o=n.split("."),n=o.shift(),o.sort()),j=n.indexOf(":")<0&&"on"+n,a=a[ga.expando]?a:new ga.Event(n,"object"==typeof a&&a),a.isTrigger=e?2:3,a.namespace=o.join("."),a.rnamespace=a.namespace?new RegExp("(^|\\.)"+o.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,a.result=void 0,a.target||(a.target=d),c=null==c?[a]:ga.makeArray(c,[a]),l=ga.event.special[n]||{},e||!l.trigger||!1!==l.trigger.apply(d,c))){if(!e&&!l.noBubble&&!ga.isWindow(d)){for(i=l.delegateType||n,pb.test(i+n)||(g=g.parentNode);g;g=g.parentNode)m.push(g),h=g;h===(d.ownerDocument||Y)&&m.push(h.defaultView||h.parentWindow||b)}for(f=0;(g=m[f++])&&!a.isPropagationStopped();)a.type=f>1?i:l.bindType||n,k=(za.get(g,"events")||{})[a.type]&&za.get(g,"handle"),k&&k.apply(g,c),(k=j&&g[j])&&k.apply&&ya(g)&&(a.result=k.apply(g,c),!1===a.result&&a.preventDefault());return a.type=n,e||a.isDefaultPrevented()||l._default&&!1!==l._default.apply(m.pop(),c)||!ya(d)||j&&ga.isFunction(d[n])&&!ga.isWindow(d)&&(h=d[j],h&&(d[j]=null),ga.event.triggered=n,d[n](),ga.event.triggered=void 0,h&&(d[j]=h)),a.result}},simulate:function(a,b,c){var d=ga.extend(new ga.Event,c,{type:a,isSimulated:!0});ga.event.trigger(d,null,b)}}),ga.fn.extend({trigger:function(a,b){return this.each(function(){ga.event.trigger(a,b,this)})},triggerHandler:function(a,b){var c=this[0];if(c)return ga.event.trigger(a,b,c,!0)}}),ga.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(a,b){ga.fn[b]=function(a,c){return arguments.length>0?this.on(b,null,a,c):this.trigger(b)}}),ga.fn.extend({hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)}}),ea.focusin="onfocusin"in b,ea.focusin||ga.each({focus:"focusin",blur:"focusout"},function(a,b){var c=function(a){ga.event.simulate(b,a.target,ga.event.fix(a))};ga.event.special[b]={setup:function(){var d=this.ownerDocument||this,e=za.access(d,b);e||d.addEventListener(a,c,!0),za.access(d,b,(e||0)+1)},teardown:function(){var d=this.ownerDocument||this,e=za.access(d,b)-1;e?za.access(d,b,e):(d.removeEventListener(a,c,!0),za.remove(d,b))}}});var qb=b.location,rb=ga.now(),sb=/\?/;ga.parseJSON=function(a){return JSON.parse(a+"")},ga.parseXML=function(a){var c;if(!a||"string"!=typeof a)return null;try{c=(new b.DOMParser).parseFromString(a,"text/xml")}catch(a){c=void 0}return c&&!c.getElementsByTagName("parsererror").length||ga.error("Invalid XML: "+a),c};var tb=/#.*$/,ub=/([?&])_=[^&]*/,vb=/^(.*?):[ \t]*([^\r\n]*)$/gm,wb=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,xb=/^(?:GET|HEAD)$/,yb=/^\/\//,zb={},Ab={},Bb="*/".concat("*"),Cb=Y.createElement("a");Cb.href=qb.href,ga.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:qb.href,type:"GET",isLocal:wb.test(qb.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Bb,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":ga.parseJSON,"text xml":ga.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(a,b){return b?S(S(a,ga.ajaxSettings),b):S(ga.ajaxSettings,a)},ajaxPrefilter:Q(zb),ajaxTransport:Q(Ab),ajax:function(a,c){function d(a,c,d,h){var j,l,s,t,v,x=c;2!==u&&(u=2,i&&b.clearTimeout(i),e=void 0,g=h||"",w.readyState=a>0?4:0,j=a>=200&&a<300||304===a,d&&(t=T(m,w,d)),t=U(m,t,w,j),j?(m.ifModified&&(v=w.getResponseHeader("Last-Modified"),v&&(ga.lastModified[f]=v),(v=w.getResponseHeader("etag"))&&(ga.etag[f]=v)),204===a||"HEAD"===m.type?x="nocontent":304===a?x="notmodified":(x=t.state,l=t.data,s=t.error,j=!s)):(s=x,!a&&x||(x="error",a<0&&(a=0))),w.status=a,w.statusText=(c||x)+"",j?p.resolveWith(n,[l,x,w]):p.rejectWith(n,[w,x,s]),w.statusCode(r),r=void 0,k&&o.trigger(j?"ajaxSuccess":"ajaxError",[w,m,j?l:s]),q.fireWith(n,[w,x]),k&&(o.trigger("ajaxComplete",[w,m]),--ga.active||ga.event.trigger("ajaxStop")))}"object"==typeof a&&(c=a,a=void 0),c=c||{};var e,f,g,h,i,j,k,l,m=ga.ajaxSetup({},c),n=m.context||m,o=m.context&&(n.nodeType||n.jquery)?ga(n):ga.event,p=ga.Deferred(),q=ga.Callbacks("once memory"),r=m.statusCode||{},s={},t={},u=0,v="canceled",w={readyState:0,getResponseHeader:function(a){var b;if(2===u){if(!h)for(h={};b=vb.exec(g);)h[b[1].toLowerCase()]=b[2];b=h[a.toLowerCase()]}return null==b?null:b},getAllResponseHeaders:function(){return 2===u?g:null},setRequestHeader:function(a,b){var c=a.toLowerCase();return u||(a=t[c]=t[c]||a,s[a]=b),this},overrideMimeType:function(a){return u||(m.mimeType=a),this},statusCode:function(a){var b;if(a)if(u<2)for(b in a)r[b]=[r[b],a[b]];else w.always(a[w.status]);return this},abort:function(a){var b=a||v;return e&&e.abort(b),d(0,b),this}};if(p.promise(w).complete=q.add,w.success=w.done,w.error=w.fail,m.url=((a||m.url||qb.href)+"").replace(tb,"").replace(yb,qb.protocol+"//"),m.type=c.method||c.type||m.method||m.type,m.dataTypes=ga.trim(m.dataType||"*").toLowerCase().match(va)||[""],null==m.crossDomain){j=Y.createElement("a");try{j.href=m.url,j.href=j.href,m.crossDomain=Cb.protocol+"//"+Cb.host!=j.protocol+"//"+j.host}catch(a){m.crossDomain=!0}}if(m.data&&m.processData&&"string"!=typeof m.data&&(m.data=ga.param(m.data,m.traditional)),R(zb,m,c,w),2===u)return w;k=ga.event&&m.global,k&&0==ga.active++&&ga.event.trigger("ajaxStart"),m.type=m.type.toUpperCase(),m.hasContent=!xb.test(m.type),f=m.url,m.hasContent||(m.data&&(f=m.url+=(sb.test(f)?"&":"?")+m.data,delete m.data),!1===m.cache&&(m.url=ub.test(f)?f.replace(ub,"$1_="+rb++):f+(sb.test(f)?"&":"?")+"_="+rb++)),m.ifModified&&(ga.lastModified[f]&&w.setRequestHeader("If-Modified-Since",ga.lastModified[f]),ga.etag[f]&&w.setRequestHeader("If-None-Match",ga.etag[f])),(m.data&&m.hasContent&&!1!==m.contentType||c.contentType)&&w.setRequestHeader("Content-Type",m.contentType),w.setRequestHeader("Accept",m.dataTypes[0]&&m.accepts[m.dataTypes[0]]?m.accepts[m.dataTypes[0]]+("*"!==m.dataTypes[0]?", "+Bb+"; q=0.01":""):m.accepts["*"]);for(l in m.headers)w.setRequestHeader(l,m.headers[l]);if(m.beforeSend&&(!1===m.beforeSend.call(n,w,m)||2===u))return w.abort();v="abort";for(l in{success:1,error:1,complete:1})w[l](m[l]);if(e=R(Ab,m,c,w)){if(w.readyState=1,k&&o.trigger("ajaxSend",[w,m]),2===u)return w;m.async&&m.timeout>0&&(i=b.setTimeout(function(){w.abort("timeout")},m.timeout));try{u=1,e.send(s,d)}catch(a){if(!(u<2))throw a;d(-1,a)}}else d(-1,"No Transport");return w},getJSON:function(a,b,c){return ga.get(a,b,c,"json")},getScript:function(a,b){return ga.get(a,void 0,b,"script")}}),ga.each(["get","post"],function(a,b){ga[b]=function(a,c,d,e){return ga.isFunction(c)&&(e=e||d,d=c,c=void 0),ga.ajax(ga.extend({url:a,type:b,dataType:e,data:c,success:d},ga.isPlainObject(a)&&a))}}),ga._evalUrl=function(a){return ga.ajax({url:a,type:"GET",dataType:"script",async:!1,global:!1,throws:!0})},ga.fn.extend({wrapAll:function(a){var b;return ga.isFunction(a)?this.each(function(b){ga(this).wrapAll(a.call(this,b))}):(this[0]&&(b=ga(a,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){for(var a=this;a.firstElementChild;)a=a.firstElementChild;return a}).append(this)),this)},wrapInner:function(a){return ga.isFunction(a)?this.each(function(b){ga(this).wrapInner(a.call(this,b))}):this.each(function(){var b=ga(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=ga.isFunction(a);return this.each(function(c){ga(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(){return this.parent().each(function(){ga.nodeName(this,"body")||ga(this).replaceWith(this.childNodes)}).end()}}),ga.expr.filters.hidden=function(a){return!ga.expr.filters.visible(a)},ga.expr.filters.visible=function(a){return a.offsetWidth>0||a.offsetHeight>0||a.getClientRects().length>0};var Db=/%20/g,Eb=/\[\]$/,Fb=/\r?\n/g,Gb=/^(?:submit|button|image|reset|file)$/i,Hb=/^(?:input|select|textarea|keygen)/i;ga.param=function(a,b){var c,d=[],e=function(a,b){b=ga.isFunction(b)?b():null==b?"":b,d[d.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};if(void 0===b&&(b=ga.ajaxSettings&&ga.ajaxSettings.traditional),ga.isArray(a)||a.jquery&&!ga.isPlainObject(a))ga.each(a,function(){e(this.name,this.value)});else for(c in a)V(c,a[c],b,e);return d.join("&").replace(Db,"+")},ga.fn.extend({serialize:function(){return ga.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var a=ga.prop(this,"elements");return a?ga.makeArray(a):this}).filter(function(){var a=this.type;return this.name&&!ga(this).is(":disabled")&&Hb.test(this.nodeName)&&!Gb.test(a)&&(this.checked||!Ha.test(a))}).map(function(a,b){var c=ga(this).val();return null==c?null:ga.isArray(c)?ga.map(c,function(a){return{name:b.name,value:a.replace(Fb,"\r\n")}}):{name:b.name,value:c.replace(Fb,"\r\n")}}).get()}}),ga.ajaxSettings.xhr=function(){try{return new b.XMLHttpRequest}catch(a){}};var Ib={0:200,1223:204},Jb=ga.ajaxSettings.xhr();ea.cors=!!Jb&&"withCredentials"in Jb,ea.ajax=Jb=!!Jb,ga.ajaxTransport(function(a){var c,d;if(ea.cors||Jb&&!a.crossDomain)return{send:function(e,f){var g,h=a.xhr();if(h.open(a.type,a.url,a.async,a.username,a.password),a.xhrFields)for(g in a.xhrFields)h[g]=a.xhrFields[g];a.mimeType&&h.overrideMimeType&&h.overrideMimeType(a.mimeType),a.crossDomain||e["X-Requested-With"]||(e["X-Requested-With"]="XMLHttpRequest");for(g in e)h.setRequestHeader(g,e[g]);c=function(a){return function(){c&&(c=d=h.onload=h.onerror=h.onabort=h.onreadystatechange=null,"abort"===a?h.abort():"error"===a?"number"!=typeof h.status?f(0,"error"):f(h.status,h.statusText):f(Ib[h.status]||h.status,h.statusText,"text"!==(h.responseType||"text")||"string"!=typeof h.responseText?{binary:h.response}:{text:h.responseText},h.getAllResponseHeaders()))}},h.onload=c(),d=h.onerror=c("error"),void 0!==h.onabort?h.onabort=d:h.onreadystatechange=function(){4===h.readyState&&b.setTimeout(function(){c&&d()})},c=c("abort");try{h.send(a.hasContent&&a.data||null)}catch(a){if(c)throw a}},abort:function(){c&&c()}}}),ga.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(a){return ga.globalEval(a),a}}}),ga.ajaxPrefilter("script",function(a){void 0===a.cache&&(a.cache=!1),a.crossDomain&&(a.type="GET")}),ga.ajaxTransport("script",function(a){if(a.crossDomain){var b,c;return{send:function(d,e){b=ga("<script>").prop({charset:a.scriptCharset,src:a.url}).on("load error",c=function(a){b.remove(),c=null,a&&e("error"===a.type?404:200,a.type)}),Y.head.appendChild(b[0])},abort:function(){c&&c()}}}});var Kb=[],Lb=/(=)\?(?=&|$)|\?\?/;ga.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var a=Kb.pop()||ga.expando+"_"+rb++;return this[a]=!0,a}}),ga.ajaxPrefilter("json jsonp",function(a,c,d){var e,f,g,h=!1!==a.jsonp&&(Lb.test(a.url)?"url":"string"==typeof a.data&&0===(a.contentType||"").indexOf("application/x-www-form-urlencoded")&&Lb.test(a.data)&&"data");if(h||"jsonp"===a.dataTypes[0])return e=a.jsonpCallback=ga.isFunction(a.jsonpCallback)?a.jsonpCallback():a.jsonpCallback,h?a[h]=a[h].replace(Lb,"$1"+e):!1!==a.jsonp&&(a.url+=(sb.test(a.url)?"&":"?")+a.jsonp+"="+e),a.converters["script json"]=function(){return g||ga.error(e+" was not called"),g[0]},a.dataTypes[0]="json",f=b[e],b[e]=function(){g=arguments},d.always(function(){void 0===f?ga(b).removeProp(e):b[e]=f,a[e]&&(a.jsonpCallback=c.jsonpCallback,Kb.push(e)),g&&ga.isFunction(f)&&f(g[0]),g=f=void 0}),"script"}),ga.parseHTML=function(a,b,c){if(!a||"string"!=typeof a)return null;"boolean"==typeof b&&(c=b,b=!1),b=b||Y;var d=pa.exec(a),e=!c&&[];return d?[b.createElement(d[1])]:(d=n([a],b,e),e&&e.length&&ga(e).remove(),ga.merge([],d.childNodes))};var Mb=ga.fn.load;ga.fn.load=function(a,b,c){if("string"!=typeof a&&Mb)return Mb.apply(this,arguments);var d,e,f,g=this,h=a.indexOf(" ");return h>-1&&(d=ga.trim(a.slice(h)),a=a.slice(0,h)),
ga.isFunction(b)?(c=b,b=void 0):b&&"object"==typeof b&&(e="POST"),g.length>0&&ga.ajax({url:a,type:e||"GET",dataType:"html",data:b}).done(function(a){f=arguments,g.html(d?ga("<div>").append(ga.parseHTML(a)).find(d):a)}).always(c&&function(a,b){g.each(function(){c.apply(this,f||[a.responseText,b,a])})}),this},ga.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(a,b){ga.fn[b]=function(a){return this.on(b,a)}}),ga.expr.filters.animated=function(a){return ga.grep(ga.timers,function(b){return a===b.elem}).length},ga.offset={setOffset:function(a,b,c){var d,e,f,g,h,i,j,k=ga.css(a,"position"),l=ga(a),m={};"static"===k&&(a.style.position="relative"),h=l.offset(),f=ga.css(a,"top"),i=ga.css(a,"left"),j=("absolute"===k||"fixed"===k)&&(f+i).indexOf("auto")>-1,j?(d=l.position(),g=d.top,e=d.left):(g=parseFloat(f)||0,e=parseFloat(i)||0),ga.isFunction(b)&&(b=b.call(a,c,ga.extend({},h))),null!=b.top&&(m.top=b.top-h.top+g),null!=b.left&&(m.left=b.left-h.left+e),"using"in b?b.using.call(a,m):l.css(m)}},ga.fn.extend({offset:function(a){if(arguments.length)return void 0===a?this:this.each(function(b){ga.offset.setOffset(this,a,b)});var b,c,d=this[0],e={top:0,left:0},f=d&&d.ownerDocument;if(f)return b=f.documentElement,ga.contains(b,d)?(e=d.getBoundingClientRect(),c=W(f),{top:e.top+c.pageYOffset-b.clientTop,left:e.left+c.pageXOffset-b.clientLeft}):e},position:function(){if(this[0]){var a,b,c=this[0],d={top:0,left:0};return"fixed"===ga.css(c,"position")?b=c.getBoundingClientRect():(a=this.offsetParent(),b=this.offset(),ga.nodeName(a[0],"html")||(d=a.offset()),d.top+=ga.css(a[0],"borderTopWidth",!0),d.left+=ga.css(a[0],"borderLeftWidth",!0)),{top:b.top-d.top-ga.css(c,"marginTop",!0),left:b.left-d.left-ga.css(c,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var a=this.offsetParent;a&&"static"===ga.css(a,"position");)a=a.offsetParent;return a||$a})}}),ga.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(a,b){var c="pageYOffset"===b;ga.fn[a]=function(d){return xa(this,function(a,d,e){var f=W(a);if(void 0===e)return f?f[b]:a[d];f?f.scrollTo(c?f.pageXOffset:e,c?e:f.pageYOffset):a[d]=e},a,d,arguments.length)}}),ga.each(["top","left"],function(a,b){ga.cssHooks[b]=C(ea.pixelPosition,function(a,c){if(c)return c=B(a,b),Xa.test(c)?ga(a).position()[b]+"px":c})}),ga.each({Height:"height",Width:"width"},function(a,b){ga.each({padding:"inner"+a,content:b,"":"outer"+a},function(c,d){ga.fn[d]=function(d,e){var f=arguments.length&&(c||"boolean"!=typeof d),g=c||(!0===d||!0===e?"margin":"border");return xa(this,function(b,c,d){var e;return ga.isWindow(b)?b.document.documentElement["client"+a]:9===b.nodeType?(e=b.documentElement,Math.max(b.body["scroll"+a],e["scroll"+a],b.body["offset"+a],e["offset"+a],e["client"+a])):void 0===d?ga.css(b,c,g):ga.style(b,c,d,g)},b,f?d:void 0,f,null)}})}),ga.fn.extend({bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return 1===arguments.length?this.off(a,"**"):this.off(b,a||"**",c)},size:function(){return this.length}}),ga.fn.andSelf=ga.fn.addBack,"function"==typeof a&&a.amd&&a("jquery",[],function(){return ga});var Nb=b.jQuery,Ob=b.$;return ga.noConflict=function(a){return b.$===ga&&(b.$=Ob),a&&b.jQuery===ga&&(b.jQuery=Nb),ga},c||(b.jQuery=b.$=ga),ga})},{}],289:[function(a,b,c){(function(a){function c(a){for(var b=Object.keys(e),c=0,d=b.length;c<d;c++){var f=b[c];if(e[f]===a)return f}return a&&"0x"+a.toString(16)}function d(){this.tState=q,this.value=void 0,this.string=void 0,this.unicode=void 0,this.negative=void 0,this.magnatude=void 0,this.position=void 0,this.exponent=void 0,this.negativeExponent=void 0,this.key=void 0,this.mode=void 0,this.stack=[],this.state=P,this.bytes_remaining=0,this.bytes_in_sequence=0,this.temp_buffs={2:new a(2),3:new a(3),4:new a(4)}}var e={},f=e.LEFT_BRACE=1,g=e.RIGHT_BRACE=2,h=e.LEFT_BRACKET=3,i=e.RIGHT_BRACKET=4,j=e.COLON=5,k=e.COMMA=6,l=e.TRUE=7,m=e.FALSE=8,n=e.NULL=9,o=e.STRING=10,p=e.NUMBER=11,q=e.START=17,r=e.TRUE1=33,s=e.TRUE2=34,t=e.TRUE3=35,u=e.FALSE1=49,v=e.FALSE2=50,w=e.FALSE3=51,x=e.FALSE4=52,y=e.NULL1=65,z=e.NULL3=66,A=e.NULL2=67,B=e.NUMBER1=81,C=e.NUMBER2=82,D=e.NUMBER3=83,E=e.NUMBER4=84,F=e.NUMBER5=85,G=e.NUMBER6=86,H=e.NUMBER7=87,I=e.NUMBER8=88,J=e.STRING1=97,K=e.STRING2=98,L=e.STRING3=99,M=e.STRING4=100,N=e.STRING5=101,O=e.STRING6=102,P=e.VALUE=113,Q=e.KEY=114,R=e.OBJECT=129,S=e.ARRAY=130,T=d.prototype;T.charError=function(a,b){this.onError(new Error("Unexpected "+JSON.stringify(String.fromCharCode(a[b]))+" at position "+b+" in state "+c(this.tState)))},T.onError=function(a){throw a},T.write=function(b){"string"==typeof b&&(b=new a(b));for(var c,d=0,e=b.length;d<e;d++)if(this.tState===q)c=b[d],123===c?this.onToken(f,"{"):125===c?this.onToken(g,"}"):91===c?this.onToken(h,"["):93===c?this.onToken(i,"]"):58===c?this.onToken(j,":"):44===c?this.onToken(k,","):116===c?this.tState=r:102===c?this.tState=u:110===c?this.tState=y:34===c?(this.string="",this.tState=J):45===c?(this.negative=!0,this.tState=B):48===c?(this.magnatude=0,this.tState=C):c>48&&c<64?(this.magnatude=c-48,this.tState=D):32===c||9===c||10===c||13===c||this.charError(b,d);else if(this.tState===J)if(c=b[d],this.bytes_remaining>0){for(var P=0;P<this.bytes_remaining;P++)this.temp_buffs[this.bytes_in_sequence][this.bytes_in_sequence-this.bytes_remaining+P]=b[P];this.string+=this.temp_buffs[this.bytes_in_sequence].toString(),this.bytes_in_sequence=this.bytes_remaining=0,d=d+P-1}else if(0===this.bytes_remaining&&c>=128)if(c>=194&&c<=223&&(this.bytes_in_sequence=2),c>=224&&c<=239&&(this.bytes_in_sequence=3),c>=240&&c<=244&&(this.bytes_in_sequence=4),this.bytes_in_sequence+d>b.length){for(var Q=0;Q<=b.length-1-d;Q++)this.temp_buffs[this.bytes_in_sequence][Q]=b[d+Q];this.bytes_remaining=d+this.bytes_in_sequence-b.length,d=b.length-1}else this.string+=b.slice(d,d+this.bytes_in_sequence).toString(),d=d+this.bytes_in_sequence-1;else 34===c?(this.tState=q,this.onToken(o,this.string),this.string=void 0):92===c?this.tState=K:c>=32?this.string+=String.fromCharCode(c):this.charError(b,d);else this.tState===K?(c=b[d],34===c?(this.string+='"',this.tState=J):92===c?(this.string+="\\",this.tState=J):47===c?(this.string+="/",this.tState=J):98===c?(this.string+="\b",this.tState=J):102===c?(this.string+="\f",this.tState=J):110===c?(this.string+="\n",this.tState=J):114===c?(this.string+="\r",this.tState=J):116===c?(this.string+="\t",this.tState=J):117===c?(this.unicode="",this.tState=L):this.charError(b,d)):this.tState===L||this.tState===M||this.tState===N||this.tState===O?(c=b[d],c>=48&&c<64||c>64&&c<=70||c>96&&c<=102?(this.unicode+=String.fromCharCode(c),this.tState++===O&&(this.string+=String.fromCharCode(parseInt(this.unicode,16)),this.unicode=void 0,this.tState=J)):this.charError(b,d)):this.tState===B?(c=b[d],48===c?(this.magnatude=0,this.tState=C):c>48&&c<64?(this.magnatude=c-48,this.tState=D):this.charError(b,d)):this.tState===C?(c=b[d],46===c?(this.position=.1,this.tState=E):101===c||69===c?(this.exponent=0,this.tState=G):(this.tState=q,this.onToken(p,0),this.magnatude=void 0,this.negative=void 0,d--)):this.tState===D?(c=b[d],46===c?(this.position=.1,this.tState=E):101===c||69===c?(this.exponent=0,this.tState=G):c>=48&&c<64?this.magnatude=10*this.magnatude+c-48:(this.tState=q,this.negative&&(this.magnatude=-this.magnatude,this.negative=void 0),this.onToken(p,this.magnatude),this.magnatude=void 0,d--)):this.tState===E?(c=b[d],c>=48&&c<64?(this.magnatude+=this.position*(c-48),this.position/=10,this.tState=F):this.charError(b,d)):this.tState===F?(c=b[d],c>=48&&c<64?(this.magnatude+=this.position*(c-48),this.position/=10):101===c||69===c?(this.exponent=0,this.tState=G):(this.tState=q,this.negative&&(this.magnatude=-this.magnatude,this.negative=void 0),this.onToken(p,this.negative?-this.magnatude:this.magnatude),this.magnatude=void 0,this.position=void 0,d--)):this.tState===G?(c=b[d],43===c||45===c?(45===c&&(this.negativeExponent=!0),this.tState=H):c>=48&&c<64?(this.exponent=10*this.exponent+(c-48),this.tState=I):this.charError(b,d)):this.tState===H?(c=b[d],c>=48&&c<64?(this.exponent=10*this.exponent+(c-48),this.tState=I):this.charError(b,d)):this.tState===I?(c=b[d],c>=48&&c<64?this.exponent=10*this.exponent+(c-48):(this.negativeExponent&&(this.exponent=-this.exponent,this.negativeExponent=void 0),this.magnatude*=Math.pow(10,this.exponent),this.exponent=void 0,this.negative&&(this.magnatude=-this.magnatude,this.negative=void 0),this.tState=q,this.onToken(p,this.magnatude),this.magnatude=void 0,d--)):this.tState===r?114===b[d]?this.tState=s:this.charError(b,d):this.tState===s?117===b[d]?this.tState=t:this.charError(b,d):this.tState===t?101===b[d]?(this.tState=q,this.onToken(l,!0)):this.charError(b,d):this.tState===u?97===b[d]?this.tState=v:this.charError(b,d):this.tState===v?108===b[d]?this.tState=w:this.charError(b,d):this.tState===w?115===b[d]?this.tState=x:this.charError(b,d):this.tState===x?101===b[d]?(this.tState=q,this.onToken(m,!1)):this.charError(b,d):this.tState===y?117===b[d]?this.tState=z:this.charError(b,d):this.tState===z?108===b[d]?this.tState=A:this.charError(b,d):this.tState===A&&(108===b[d]?(this.tState=q,this.onToken(n,null)):this.charError(b,d))},T.onToken=function(a,b){},T.parseError=function(a,b){this.onError(new Error("Unexpected "+c(a)+(b?"("+JSON.stringify(b)+")":"")+" in state "+c(this.state)))},T.onError=function(a){throw a},T.push=function(){this.stack.push({value:this.value,key:this.key,mode:this.mode})},T.pop=function(){var a=this.value,b=this.stack.pop();this.value=b.value,this.key=b.key,this.mode=b.mode,this.emit(a),this.mode||(this.state=P)},T.emit=function(a){this.mode&&(this.state=k),this.onValue(a)},T.onValue=function(a){},T.onToken=function(a,b){this.state===P?a===o||a===p||a===l||a===m||a===n?(this.value&&(this.value[this.key]=b),this.emit(b)):a===f?(this.push(),this.value?this.value=this.value[this.key]={}:this.value={},this.key=void 0,this.state=Q,this.mode=R):a===h?(this.push(),this.value?this.value=this.value[this.key]=[]:this.value=[],this.key=0,this.mode=S,this.state=P):a===g?this.mode===R?this.pop():this.parseError(a,b):a===i&&this.mode===S?this.pop():this.parseError(a,b):this.state===Q?a===o?(this.key=b,this.state=j):a===g?this.pop():this.parseError(a,b):this.state===j?a===j?this.state=P:this.parseError(a,b):this.state===k?a===k?this.mode===S?(this.key++,this.state=P):this.mode===R&&(this.state=Q):a===i&&this.mode===S||a===g&&this.mode===R?this.pop():this.parseError(a,b):this.parseError(a,b)},b.exports=d}).call(this,a("buffer").Buffer)},{buffer:254}],290:[function(b,c,d){!function(e,f){"function"==typeof b&&"object"==typeof d&&"object"==typeof c?c.exports=f():"function"==typeof a&&a.amd?a(function(){return f()}):e.pluralize=f()}(this,function(){function a(a){return a.charAt(0).toUpperCase()+a.substr(1).toLowerCase()}function b(a){return"string"==typeof a?new RegExp("^"+a+"$","i"):a}function c(b,c){return b===b.toUpperCase()?c.toUpperCase():b[0]===b[0].toUpperCase()?a(c):c.toLowerCase()}function d(a,b){return a.replace(/\$(\d{1,2})/g,function(a,c){return b[c]||""})}function e(a,b,e){if(!a.length||j.hasOwnProperty(a))return b;for(var f=e.length;f--;){var g=e[f];if(g[0].test(b))return b.replace(g[0],function(a,b,e){var f=d(g[1],arguments);return""===a?c(e[b-1],f):c(a,f)})}return b}function f(a,b,d){return function(f){var g=f.toLowerCase();return b.hasOwnProperty(g)?c(f,g):a.hasOwnProperty(g)?c(f,a[g]):e(g,f,d)}}function g(a,b,c){var d=1===b?g.singular(a):g.plural(a);return(c?b+" ":"")+d}var h=[],i=[],j={},k={},l={};return g.plural=f(l,k,h),g.singular=f(k,l,i),g.addPluralRule=function(a,c){h.push([b(a),c])},g.addSingularRule=function(a,c){i.push([b(a),c])},g.addUncountableRule=function(a){if("string"==typeof a)return void(j[a.toLowerCase()]=!0);g.addPluralRule(a,"$0"),g.addSingularRule(a,"$0")},g.addIrregularRule=function(a,b){b=b.toLowerCase(),a=a.toLowerCase(),l[a]=b,k[b]=a},[["I","we"],["me","us"],["he","they"],["she","they"],["them","them"],["myself","ourselves"],["yourself","yourselves"],["itself","themselves"],["herself","themselves"],["himself","themselves"],["themself","themselves"],["is","are"],["this","these"],["that","those"],["echo","echoes"],["dingo","dingoes"],["volcano","volcanoes"],["tornado","tornadoes"],["torpedo","torpedoes"],["genus","genera"],["viscus","viscera"],["stigma","stigmata"],["stoma","stomata"],["dogma","dogmata"],["lemma","lemmata"],["schema","schemata"],["anathema","anathemata"],["ox","oxen"],["axe","axes"],["die","dice"],["yes","yeses"],["foot","feet"],["eave","eaves"],["goose","geese"],["tooth","teeth"],["quiz","quizzes"],["human","humans"],["proof","proofs"],["carve","carves"],["valve","valves"],["thief","thieves"],["genie","genies"],["groove","grooves"],["pickaxe","pickaxes"],["whiskey","whiskies"]].forEach(function(a){return g.addIrregularRule(a[0],a[1])}),[[/s?$/i,"s"],[/([^aeiou]ese)$/i,"$1"],[/(ax|test)is$/i,"$1es"],[/(alias|[^aou]us|tlas|gas|ris)$/i,"$1es"],[/(e[mn]u)s?$/i,"$1s"],[/([^l]ias|[aeiou]las|[emjzr]as|[iu]am)$/i,"$1"],[/(alumn|syllab|octop|vir|radi|nucle|fung|cact|stimul|termin|bacill|foc|uter|loc|strat)(?:us|i)$/i,"$1i"],[/(alumn|alg|vertebr)(?:a|ae)$/i,"$1ae"],[/(seraph|cherub)(?:im)?$/i,"$1im"],[/(her|at|gr)o$/i,"$1oes"],[/(agend|addend|millenni|dat|extrem|bacteri|desiderat|strat|candelabr|errat|ov|symposi|curricul|automat|quor)(?:a|um)$/i,"$1a"],[/(apheli|hyperbat|periheli|asyndet|noumen|phenomen|criteri|organ|prolegomen|hedr|automat)(?:a|on)$/i,"$1a"],[/sis$/i,"ses"],[/(?:(kni|wi|li)fe|(ar|l|ea|eo|oa|hoo)f)$/i,"$1$2ves"],[/([^aeiouy]|qu)y$/i,"$1ies"],[/([^ch][ieo][ln])ey$/i,"$1ies"],[/(x|ch|ss|sh|zz)$/i,"$1es"],[/(matr|cod|mur|sil|vert|ind|append)(?:ix|ex)$/i,"$1ices"],[/(m|l)(?:ice|ouse)$/i,"$1ice"],[/(pe)(?:rson|ople)$/i,"$1ople"],[/(child)(?:ren)?$/i,"$1ren"],[/eaux$/i,"$0"],[/m[ae]n$/i,"men"],["thou","you"]].forEach(function(a){return g.addPluralRule(a[0],a[1])}),[[/s$/i,""],[/(ss)$/i,"$1"],[/((a)naly|(b)a|(d)iagno|(p)arenthe|(p)rogno|(s)ynop|(t)he)(?:sis|ses)$/i,"$1sis"],[/(^analy)(?:sis|ses)$/i,"$1sis"],[/(wi|kni|(?:after|half|high|low|mid|non|night|[^\w]|^)li)ves$/i,"$1fe"],[/(ar|(?:wo|[ae])l|[eo][ao])ves$/i,"$1f"],[/([^aeiouy]|qu)ies$/i,"$1y"],[/(^[pl]|zomb|^(?:neck)?t|[aeo][lt]|cut)ies$/i,"$1ie"],[/(\b(?:mon|smil))ies$/i,"$1ey"],[/(m|l)ice$/i,"$1ouse"],[/(seraph|cherub)im$/i,"$1"],[/(x|ch|ss|sh|zz|tto|go|cho|alias|[^aou]us|tlas|gas|(?:her|at|gr)o|ris)(?:es)?$/i,"$1"],[/(e[mn]u)s?$/i,"$1"],[/(movie|twelve)s$/i,"$1"],[/(cris|test|diagnos)(?:is|es)$/i,"$1is"],[/(alumn|syllab|octop|vir|radi|nucle|fung|cact|stimul|termin|bacill|foc|uter|loc|strat)(?:us|i)$/i,"$1us"],[/(agend|addend|millenni|dat|extrem|bacteri|desiderat|strat|candelabr|errat|ov|symposi|curricul|quor)a$/i,"$1um"],[/(apheli|hyperbat|periheli|asyndet|noumen|phenomen|criteri|organ|prolegomen|hedr|automat)a$/i,"$1on"],[/(alumn|alg|vertebr)ae$/i,"$1a"],[/(cod|mur|sil|vert|ind)ices$/i,"$1ex"],[/(matr|append)ices$/i,"$1ix"],[/(pe)(rson|ople)$/i,"$1rson"],[/(child)ren$/i,"$1"],[/(eau)x?$/i,"$1"],[/men$/i,"man"]].forEach(function(a){return g.addSingularRule(a[0],a[1])}),["advice","agenda","bison","bream","buffalo","carp","chassis","cod","cooperation","corps","digestion","debris","diabetes","energy","equipment","elk","excretion","expertise","flounder","gallows","garbage","graffiti","headquarters","health","herpes","highjinks","homework","information","jeans","justice","kudos","labour","machinery","mackerel","media","mews","moose","news","pike","plankton","pliers","pollution","premises","rain","rice","salmon","scissors","series","sewage","shambles","shrimp","species","staff","swine","trout","tuna","whiting","wildebeest","wildlife","you",/pox$/i,/ois$/i,/deer$/i,/fish$/i,/sheep$/i,/measles$/i,/[^aeiou]ese$/i].forEach(g.addUncountableRule),g})},{}],291:[function(a,b,c){function d(){}var e=b.exports={};e.nextTick=function(){var a="undefined"!=typeof window&&window.setImmediate,b="undefined"!=typeof window&&window.MutationObserver,c="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(a)return function(a){return window.setImmediate(a)};var d=[];if(b){var e=document.createElement("div");return new MutationObserver(function(){var a=d.slice();d.length=0,a.forEach(function(a){a()})}).observe(e,{attributes:!0}),function(a){d.length||e.setAttribute("yes","no"),d.push(a)}}return c?(window.addEventListener("message",function(a){var b=a.source;if((b===window||null===b)&&"process-tick"===a.data&&(a.stopPropagation(),d.length>0)){d.shift()()}},!0),function(a){d.push(a),window.postMessage("process-tick","*")}):function(a){setTimeout(a,0)}}(),e.title="browser",e.browser=!0,e.env={},e.argv=[],e.on=d,e.addListener=d,e.once=d,e.off=d,e.removeListener=d,e.removeAllListeners=d,e.emit=d,e.binding=function(a){throw new Error("process.binding is not supported")},e.cwd=function(){return"/"},e.chdir=function(a){throw new Error("process.chdir is not supported")}},{}],292:[function(a,b,c){"use strict";function d(a,b){return Object.prototype.hasOwnProperty.call(a,b)}b.exports=function(a,b,c,f){b=b||"&",c=c||"=";var g={};if("string"!=typeof a||0===a.length)return g;var h=/\+/g;a=a.split(b);var i=1e3;f&&"number"==typeof f.maxKeys&&(i=f.maxKeys);var j=a.length;i>0&&j>i&&(j=i);for(var k=0;k<j;++k){var l,m,n,o,p=a[k].replace(h,"%20"),q=p.indexOf(c);q>=0?(l=p.substr(0,q),m=p.substr(q+1)):(l=p,m=""),n=decodeURIComponent(l),o=decodeURIComponent(m),d(g,n)?e(g[n])?g[n].push(o):g[n]=[g[n],o]:g[n]=o}return g};var e=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)}},{}],293:[function(a,b,c){"use strict";function d(a,b){if(a.map)return a.map(b);for(var c=[],d=0;d<a.length;d++)c.push(b(a[d],d));return c}var e=function(a){switch(typeof a){case"string":return a;case"boolean":return a?"true":"false";case"number":return isFinite(a)?a:"";default:return""}};b.exports=function(a,b,c,h){return b=b||"&",c=c||"=",null===a&&(a=void 0),"object"==typeof a?d(g(a),function(g){var h=encodeURIComponent(e(g))+c;return f(a[g])?d(a[g],function(a){return h+encodeURIComponent(e(a))}).join(b):h+encodeURIComponent(e(a[g]))}).join(b):h?encodeURIComponent(e(h))+c+encodeURIComponent(e(a)):""};var f=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},g=Object.keys||function(a){var b=[];for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&b.push(c);return b}},{}],294:[function(a,b,c){"use strict";c.decode=c.parse=a("./decode"),c.encode=c.stringify=a("./encode")},{"./decode":292,"./encode":293}],295:[function(a,b,c){function d(){e.call(this)}b.exports=d;var e=a("events").EventEmitter;a("inherits")(d,e),d.Readable=a("readable-stream/readable.js"),d.Writable=a("readable-stream/writable.js"),d.Duplex=a("readable-stream/duplex.js"),d.Transform=a("readable-stream/transform.js"),d.PassThrough=a("readable-stream/passthrough.js"),d.Stream=d,d.prototype.pipe=function(a,b){function c(b){a.writable&&!1===a.write(b)&&j.pause&&j.pause()}function d(){j.readable&&j.resume&&j.resume()}function f(){k||(k=!0,a.end())}function g(){k||(k=!0,"function"==typeof a.destroy&&a.destroy())}function h(a){if(i(),0===e.listenerCount(this,"error"))throw a}function i(){j.removeListener("data",c),a.removeListener("drain",d),j.removeListener("end",f),j.removeListener("close",g),j.removeListener("error",h),a.removeListener("error",h),j.removeListener("end",i),j.removeListener("close",i),a.removeListener("close",i)}var j=this;j.on("data",c),a.on("drain",d),a._isStdio||b&&!1===b.end||(j.on("end",f),j.on("close",g));var k=!1;return j.on("error",h),a.on("error",h),j.on("end",i),j.on("close",i),a.on("close",i),a.emit("pipe",j),a}},{events:258,inherits:278,"readable-stream/duplex.js":297,"readable-stream/passthrough.js":303,"readable-stream/readable.js":304,"readable-stream/transform.js":305,"readable-stream/writable.js":306}],296:[function(a,b,c){b.exports=Array.isArray||function(a){return"[object Array]"==Object.prototype.toString.call(a)}},{}],297:[function(a,b,c){b.exports=a("./lib/_stream_duplex.js")},{"./lib/_stream_duplex.js":298}],298:[function(a,b,c){(function(c){function d(a){if(!(this instanceof d))return new d(a);i.call(this,a),j.call(this,a),a&&!1===a.readable&&(this.readable=!1),a&&!1===a.writable&&(this.writable=!1),this.allowHalfOpen=!0,a&&!1===a.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",e)}function e(){this.allowHalfOpen||this._writableState.ended||c.nextTick(this.end.bind(this))}function f(a,b){for(var c=0,d=a.length;c<d;c++)b(a[c],c)}b.exports=d;var g=Object.keys||function(a){var b=[];for(var c in a)b.push(c);return b},h=a("core-util-is");h.inherits=a("inherits");var i=a("./_stream_readable"),j=a("./_stream_writable");h.inherits(d,i),f(g(j.prototype),function(a){d.prototype[a]||(d.prototype[a]=j.prototype[a])})}).call(this,a("_process"))},{"./_stream_readable":300,"./_stream_writable":302,_process:291,"core-util-is":255,inherits:278}],299:[function(a,b,c){function d(a){if(!(this instanceof d))return new d(a);e.call(this,a)}b.exports=d;var e=a("./_stream_transform"),f=a("core-util-is");f.inherits=a("inherits"),f.inherits(d,e),d.prototype._transform=function(a,b,c){c(null,a)}},{"./_stream_transform":301,"core-util-is":255,inherits:278}],300:[function(a,b,c){(function(c){function d(b,c){var d=a("./_stream_duplex");b=b||{};var e=b.highWaterMark,f=b.objectMode?16:16384;this.highWaterMark=e||0===e?e:f,this.highWaterMark=~~this.highWaterMark,this.buffer=[],this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.objectMode=!!b.objectMode,c instanceof d&&(this.objectMode=this.objectMode||!!b.readableObjectMode),this.defaultEncoding=b.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,b.encoding&&(C||(C=a("string_decoder/").StringDecoder),this.decoder=new C(b.encoding),this.encoding=b.encoding)}function e(b){a("./_stream_duplex");if(!(this instanceof e))return new e(b);this._readableState=new d(b,this),this.readable=!0,A.call(this)}function f(a,b,c,d,e){var f=j(b,c);if(f)a.emit("error",f);else if(B.isNullOrUndefined(c))b.reading=!1,b.ended||k(a,b);else if(b.objectMode||c&&c.length>0)if(b.ended&&!e){var h=new Error("stream.push() after EOF");a.emit("error",h)}else if(b.endEmitted&&e){var h=new Error("stream.unshift() after end event");a.emit("error",h)}else!b.decoder||e||d||(c=b.decoder.write(c)),e||(b.reading=!1),b.flowing&&0===b.length&&!b.sync?(a.emit("data",c),a.read(0)):(b.length+=b.objectMode?1:c.length,e?b.buffer.unshift(c):b.buffer.push(c),b.needReadable&&l(a)),n(a,b);else e||(b.reading=!1);return g(b)}function g(a){return!a.ended&&(a.needReadable||a.length<a.highWaterMark||0===a.length)}function h(a){if(a>=E)a=E;else{a--;for(var b=1;b<32;b<<=1)a|=a>>b;a++}return a}function i(a,b){return 0===b.length&&b.ended?0:b.objectMode?0===a?0:1:isNaN(a)||B.isNull(a)?b.flowing&&b.buffer.length?b.buffer[0].length:b.length:a<=0?0:(a>b.highWaterMark&&(b.highWaterMark=h(a)),a>b.length?b.ended?b.length:(b.needReadable=!0,0):a)}function j(a,b){var c=null;return B.isBuffer(b)||B.isString(b)||B.isNullOrUndefined(b)||a.objectMode||(c=new TypeError("Invalid non-string/buffer chunk")),c}function k(a,b){if(b.decoder&&!b.ended){var c=b.decoder.end();c&&c.length&&(b.buffer.push(c),b.length+=b.objectMode?1:c.length)}b.ended=!0,l(a)}function l(a){var b=a._readableState;b.needReadable=!1,b.emittedReadable||(D("emitReadable",b.flowing),b.emittedReadable=!0,b.sync?c.nextTick(function(){m(a)}):m(a))}function m(a){D("emit readable"),a.emit("readable"),s(a)}function n(a,b){b.readingMore||(b.readingMore=!0,c.nextTick(function(){o(a,b)}))}function o(a,b){for(var c=b.length;!b.reading&&!b.flowing&&!b.ended&&b.length<b.highWaterMark&&(D("maybeReadMore read 0"),a.read(0),c!==b.length);)c=b.length;b.readingMore=!1}function p(a){return function(){var b=a._readableState;D("pipeOnDrain",b.awaitDrain),b.awaitDrain&&b.awaitDrain--,0===b.awaitDrain&&z.listenerCount(a,"data")&&(b.flowing=!0,s(a))}}function q(a,b){b.resumeScheduled||(b.resumeScheduled=!0,c.nextTick(function(){r(a,b)}))}function r(a,b){b.resumeScheduled=!1,a.emit("resume"),s(a),b.flowing&&!b.reading&&a.read(0)}function s(a){var b=a._readableState;if(D("flow",b.flowing),b.flowing)do{var c=a.read()}while(null!==c&&b.flowing)}function t(a,b){var c,d=b.buffer,e=b.length,f=!!b.decoder,g=!!b.objectMode;if(0===d.length)return null;if(0===e)c=null;else if(g)c=d.shift();else if(!a||a>=e)c=f?d.join(""):y.concat(d,e),d.length=0;else if(a<d[0].length){var h=d[0];c=h.slice(0,a),d[0]=h.slice(a)}else if(a===d[0].length)c=d.shift();else{c=f?"":new y(a);for(var i=0,j=0,k=d.length;j<k&&i<a;j++){var h=d[0],l=Math.min(a-i,h.length);f?c+=h.slice(0,l):h.copy(c,i,0,l),l<h.length?d[0]=h.slice(l):d.shift(),i+=l}}return c}function u(a){var b=a._readableState;if(b.length>0)throw new Error("endReadable called on non-empty stream");b.endEmitted||(b.ended=!0,c.nextTick(function(){b.endEmitted||0!==b.length||(b.endEmitted=!0,a.readable=!1,a.emit("end"))}))}function v(a,b){for(var c=0,d=a.length;c<d;c++)b(a[c],c)}function w(a,b){for(var c=0,d=a.length;c<d;c++)if(a[c]===b)return c;return-1}b.exports=e;var x=a("isarray"),y=a("buffer").Buffer;e.ReadableState=d;var z=a("events").EventEmitter;z.listenerCount||(z.listenerCount=function(a,b){return a.listeners(b).length});var A=a("stream"),B=a("core-util-is");B.inherits=a("inherits");var C,D=a("util");D=D&&D.debuglog?D.debuglog("stream"):function(){},B.inherits(e,A),e.prototype.push=function(a,b){var c=this._readableState;return B.isString(a)&&!c.objectMode&&(b=b||c.defaultEncoding)!==c.encoding&&(a=new y(a,b),b=""),f(this,c,a,b,!1)},e.prototype.unshift=function(a){return f(this,this._readableState,a,"",!0)},e.prototype.setEncoding=function(b){return C||(C=a("string_decoder/").StringDecoder),this._readableState.decoder=new C(b),this._readableState.encoding=b,this};var E=8388608;e.prototype.read=function(a){D("read",a);var b=this._readableState,c=a;if((!B.isNumber(a)||a>0)&&(b.emittedReadable=!1),0===a&&b.needReadable&&(b.length>=b.highWaterMark||b.ended))return D("read: emitReadable",b.length,b.ended),0===b.length&&b.ended?u(this):l(this),null;if(0===(a=i(a,b))&&b.ended)return 0===b.length&&u(this),null;var d=b.needReadable;D("need readable",d),(0===b.length||b.length-a<b.highWaterMark)&&(d=!0,D("length less than watermark",d)),(b.ended||b.reading)&&(d=!1,D("reading or ended",d)),d&&(D("do read"),b.reading=!0,b.sync=!0,0===b.length&&(b.needReadable=!0),this._read(b.highWaterMark),b.sync=!1),d&&!b.reading&&(a=i(c,b));var e;return e=a>0?t(a,b):null,B.isNull(e)&&(b.needReadable=!0,a=0),b.length-=a,0!==b.length||b.ended||(b.needReadable=!0),c!==a&&b.ended&&0===b.length&&u(this),B.isNull(e)||this.emit("data",e),e},e.prototype._read=function(a){this.emit("error",new Error("not implemented"))},e.prototype.pipe=function(a,b){function d(a){D("onunpipe"),a===l&&f()}function e(){D("onend"),a.end()}function f(){D("cleanup"),a.removeListener("close",i),a.removeListener("finish",j),a.removeListener("drain",q),a.removeListener("error",h),a.removeListener("unpipe",d),l.removeListener("end",e),l.removeListener("end",f),l.removeListener("data",g),!m.awaitDrain||a._writableState&&!a._writableState.needDrain||q()}function g(b){D("ondata"),!1===a.write(b)&&(D("false write response, pause",l._readableState.awaitDrain),l._readableState.awaitDrain++,l.pause())}function h(b){D("onerror",b),k(),a.removeListener("error",h),0===z.listenerCount(a,"error")&&a.emit("error",b)}function i(){a.removeListener("finish",j),k()}function j(){D("onfinish"),a.removeListener("close",i),k()}function k(){D("unpipe"),l.unpipe(a)}var l=this,m=this._readableState;switch(m.pipesCount){case 0:m.pipes=a;break;case 1:m.pipes=[m.pipes,a];break;default:m.pipes.push(a)}m.pipesCount+=1,D("pipe count=%d opts=%j",m.pipesCount,b);var n=(!b||!1!==b.end)&&a!==c.stdout&&a!==c.stderr,o=n?e:f;m.endEmitted?c.nextTick(o):l.once("end",o),a.on("unpipe",d);var q=p(l);return a.on("drain",q),l.on("data",g),a._events&&a._events.error?x(a._events.error)?a._events.error.unshift(h):a._events.error=[h,a._events.error]:a.on("error",h),a.once("close",i),a.once("finish",j),a.emit("pipe",l),m.flowing||(D("pipe resume"),l.resume()),a},e.prototype.unpipe=function(a){var b=this._readableState;if(0===b.pipesCount)return this;if(1===b.pipesCount)return a&&a!==b.pipes?this:(a||(a=b.pipes),b.pipes=null,b.pipesCount=0,b.flowing=!1,a&&a.emit("unpipe",this),this);if(!a){var c=b.pipes,d=b.pipesCount;b.pipes=null,b.pipesCount=0,b.flowing=!1;for(var e=0;e<d;e++)c[e].emit("unpipe",this);return this}var e=w(b.pipes,a);return-1===e?this:(b.pipes.splice(e,1),b.pipesCount-=1,1===b.pipesCount&&(b.pipes=b.pipes[0]),a.emit("unpipe",this),this)},e.prototype.on=function(a,b){var d=A.prototype.on.call(this,a,b);if("data"===a&&!1!==this._readableState.flowing&&this.resume(),"readable"===a&&this.readable){var e=this._readableState;if(!e.readableListening)if(e.readableListening=!0,e.emittedReadable=!1,e.needReadable=!0,e.reading)e.length&&l(this,e);else{var f=this;c.nextTick(function(){D("readable nexttick read 0"),f.read(0)})}}return d},e.prototype.addListener=e.prototype.on,e.prototype.resume=function(){var a=this._readableState;return a.flowing||(D("resume"),a.flowing=!0,a.reading||(D("resume read 0"),this.read(0)),q(this,a)),this},e.prototype.pause=function(){return D("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(D("pause"),this._readableState.flowing=!1,this.emit("pause")),this},e.prototype.wrap=function(a){var b=this._readableState,c=!1,d=this;a.on("end",function(){if(D("wrapped end"),b.decoder&&!b.ended){var a=b.decoder.end();a&&a.length&&d.push(a)}d.push(null)}),a.on("data",function(e){if(D("wrapped data"),b.decoder&&(e=b.decoder.write(e)),e&&(b.objectMode||e.length)){d.push(e)||(c=!0,a.pause())}});for(var e in a)B.isFunction(a[e])&&B.isUndefined(this[e])&&(this[e]=function(b){return function(){return a[b].apply(a,arguments)}}(e));return v(["error","close","destroy","pause","resume"],function(b){a.on(b,d.emit.bind(d,b))}),d._read=function(b){D("wrapped _read",b),c&&(c=!1,a.resume())},d},e._fromList=t}).call(this,a("_process"))},{"./_stream_duplex":298,_process:291,buffer:254,"core-util-is":255,events:258,inherits:278,isarray:296,stream:295,"string_decoder/":307,util:251}],301:[function(a,b,c){function d(a,b){this.afterTransform=function(a,c){return e(b,a,c)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null}function e(a,b,c){var d=a._transformState;d.transforming=!1;var e=d.writecb;if(!e)return a.emit("error",new Error("no writecb in Transform class"));d.writechunk=null,d.writecb=null,i.isNullOrUndefined(c)||a.push(c),e&&e(b);var f=a._readableState;f.reading=!1,(f.needReadable||f.length<f.highWaterMark)&&a._read(f.highWaterMark)}function f(a){if(!(this instanceof f))return new f(a);h.call(this,a),this._transformState=new d(a,this);var b=this;this._readableState.needReadable=!0,this._readableState.sync=!1,this.once("prefinish",function(){i.isFunction(this._flush)?this._flush(function(a){g(b,a)}):g(b)})}function g(a,b){if(b)return a.emit("error",b);var c=a._writableState,d=a._transformState;if(c.length)throw new Error("calling transform done when ws.length != 0");if(d.transforming)throw new Error("calling transform done when still transforming");return a.push(null)}b.exports=f;var h=a("./_stream_duplex"),i=a("core-util-is");i.inherits=a("inherits"),i.inherits(f,h),f.prototype.push=function(a,b){return this._transformState.needTransform=!1,h.prototype.push.call(this,a,b)},f.prototype._transform=function(a,b,c){throw new Error("not implemented")},f.prototype._write=function(a,b,c){var d=this._transformState;if(d.writecb=c,d.writechunk=a,d.writeencoding=b,!d.transforming){var e=this._readableState
;(d.needTransform||e.needReadable||e.length<e.highWaterMark)&&this._read(e.highWaterMark)}},f.prototype._read=function(a){var b=this._transformState;i.isNull(b.writechunk)||!b.writecb||b.transforming?b.needTransform=!0:(b.transforming=!0,this._transform(b.writechunk,b.writeencoding,b.afterTransform))}},{"./_stream_duplex":298,"core-util-is":255,inherits:278}],302:[function(a,b,c){(function(c){function d(a,b,c){this.chunk=a,this.encoding=b,this.callback=c}function e(b,c){var d=a("./_stream_duplex");b=b||{};var e=b.highWaterMark,f=b.objectMode?16:16384;this.highWaterMark=e||0===e?e:f,this.objectMode=!!b.objectMode,c instanceof d&&(this.objectMode=this.objectMode||!!b.writableObjectMode),this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var g=!1===b.decodeStrings;this.decodeStrings=!g,this.defaultEncoding=b.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(a){n(c,a)},this.writecb=null,this.writelen=0,this.buffer=[],this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1}function f(b){var c=a("./_stream_duplex");if(!(this instanceof f||this instanceof c))return new f(b);this._writableState=new e(b,this),this.writable=!0,x.call(this)}function g(a,b,d){var e=new Error("write after end");a.emit("error",e),c.nextTick(function(){d(e)})}function h(a,b,d,e){var f=!0;if(!(w.isBuffer(d)||w.isString(d)||w.isNullOrUndefined(d)||b.objectMode)){var g=new TypeError("Invalid non-string/buffer chunk");a.emit("error",g),c.nextTick(function(){e(g)}),f=!1}return f}function i(a,b,c){return!a.objectMode&&!1!==a.decodeStrings&&w.isString(b)&&(b=new v(b,c)),b}function j(a,b,c,e,f){c=i(b,c,e),w.isBuffer(c)&&(e="buffer");var g=b.objectMode?1:c.length;b.length+=g;var h=b.length<b.highWaterMark;return h||(b.needDrain=!0),b.writing||b.corked?b.buffer.push(new d(c,e,f)):k(a,b,!1,g,c,e,f),h}function k(a,b,c,d,e,f,g){b.writelen=d,b.writecb=g,b.writing=!0,b.sync=!0,c?a._writev(e,b.onwrite):a._write(e,f,b.onwrite),b.sync=!1}function l(a,b,d,e,f){d?c.nextTick(function(){b.pendingcb--,f(e)}):(b.pendingcb--,f(e)),a._writableState.errorEmitted=!0,a.emit("error",e)}function m(a){a.writing=!1,a.writecb=null,a.length-=a.writelen,a.writelen=0}function n(a,b){var d=a._writableState,e=d.sync,f=d.writecb;if(m(d),b)l(a,d,e,b,f);else{var g=r(a,d);g||d.corked||d.bufferProcessing||!d.buffer.length||q(a,d),e?c.nextTick(function(){o(a,d,g,f)}):o(a,d,g,f)}}function o(a,b,c,d){c||p(a,b),b.pendingcb--,d(),t(a,b)}function p(a,b){0===b.length&&b.needDrain&&(b.needDrain=!1,a.emit("drain"))}function q(a,b){if(b.bufferProcessing=!0,a._writev&&b.buffer.length>1){for(var c=[],d=0;d<b.buffer.length;d++)c.push(b.buffer[d].callback);b.pendingcb++,k(a,b,!0,b.length,b.buffer,"",function(a){for(var d=0;d<c.length;d++)b.pendingcb--,c[d](a)}),b.buffer=[]}else{for(var d=0;d<b.buffer.length;d++){var e=b.buffer[d],f=e.chunk,g=e.encoding,h=e.callback,i=b.objectMode?1:f.length;if(k(a,b,!1,i,f,g,h),b.writing){d++;break}}d<b.buffer.length?b.buffer=b.buffer.slice(d):b.buffer.length=0}b.bufferProcessing=!1}function r(a,b){return b.ending&&0===b.length&&!b.finished&&!b.writing}function s(a,b){b.prefinished||(b.prefinished=!0,a.emit("prefinish"))}function t(a,b){var c=r(a,b);return c&&(0===b.pendingcb?(s(a,b),b.finished=!0,a.emit("finish")):s(a,b)),c}function u(a,b,d){b.ending=!0,t(a,b),d&&(b.finished?c.nextTick(d):a.once("finish",d)),b.ended=!0}b.exports=f;var v=a("buffer").Buffer;f.WritableState=e;var w=a("core-util-is");w.inherits=a("inherits");var x=a("stream");w.inherits(f,x),f.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe. Not readable."))},f.prototype.write=function(a,b,c){var d=this._writableState,e=!1;return w.isFunction(b)&&(c=b,b=null),w.isBuffer(a)?b="buffer":b||(b=d.defaultEncoding),w.isFunction(c)||(c=function(){}),d.ended?g(this,d,c):h(this,d,a,c)&&(d.pendingcb++,e=j(this,d,a,b,c)),e},f.prototype.cork=function(){this._writableState.corked++},f.prototype.uncork=function(){var a=this._writableState;a.corked&&(a.corked--,a.writing||a.corked||a.finished||a.bufferProcessing||!a.buffer.length||q(this,a))},f.prototype._write=function(a,b,c){c(new Error("not implemented"))},f.prototype._writev=null,f.prototype.end=function(a,b,c){var d=this._writableState;w.isFunction(a)?(c=a,a=null,b=null):w.isFunction(b)&&(c=b,b=null),w.isNullOrUndefined(a)||this.write(a,b),d.corked&&(d.corked=1,this.uncork()),d.ending||d.finished||u(this,d,c)}}).call(this,a("_process"))},{"./_stream_duplex":298,_process:291,buffer:254,"core-util-is":255,inherits:278,stream:295}],303:[function(a,b,c){b.exports=a("./lib/_stream_passthrough.js")},{"./lib/_stream_passthrough.js":299}],304:[function(a,b,c){(function(d){c=b.exports=a("./lib/_stream_readable.js"),c.Stream=a("stream"),c.Readable=c,c.Writable=a("./lib/_stream_writable.js"),c.Duplex=a("./lib/_stream_duplex.js"),c.Transform=a("./lib/_stream_transform.js"),c.PassThrough=a("./lib/_stream_passthrough.js"),d.browser||"disable"!==d.env.READABLE_STREAM||(b.exports=a("stream"))}).call(this,a("_process"))},{"./lib/_stream_duplex.js":298,"./lib/_stream_passthrough.js":299,"./lib/_stream_readable.js":300,"./lib/_stream_transform.js":301,"./lib/_stream_writable.js":302,_process:291,stream:295}],305:[function(a,b,c){b.exports=a("./lib/_stream_transform.js")},{"./lib/_stream_transform.js":301}],306:[function(a,b,c){b.exports=a("./lib/_stream_writable.js")},{"./lib/_stream_writable.js":302}],307:[function(a,b,c){function d(a){if(a&&!i(a))throw new Error("Unknown encoding: "+a)}function e(a){return a.toString(this.encoding)}function f(a){this.charReceived=a.length%2,this.charLength=this.charReceived?2:0}function g(a){this.charReceived=a.length%3,this.charLength=this.charReceived?3:0}var h=a("buffer").Buffer,i=h.isEncoding||function(a){switch(a&&a.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}},j=c.StringDecoder=function(a){switch(this.encoding=(a||"utf8").toLowerCase().replace(/[-_]/,""),d(a),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=f;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=g;break;default:return void(this.write=e)}this.charBuffer=new h(6),this.charReceived=0,this.charLength=0};j.prototype.write=function(a){for(var b="";this.charLength;){var c=a.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:a.length;if(a.copy(this.charBuffer,this.charReceived,0,c),this.charReceived+=c,this.charReceived<this.charLength)return"";a=a.slice(c,a.length),b=this.charBuffer.slice(0,this.charLength).toString(this.encoding);var d=b.charCodeAt(b.length-1);if(!(d>=55296&&d<=56319)){if(this.charReceived=this.charLength=0,0===a.length)return b;break}this.charLength+=this.surrogateSize,b=""}this.detectIncompleteChar(a);var e=a.length;this.charLength&&(a.copy(this.charBuffer,0,a.length-this.charReceived,e),e-=this.charReceived),b+=a.toString(this.encoding,0,e);var e=b.length-1,d=b.charCodeAt(e);if(d>=55296&&d<=56319){var f=this.surrogateSize;return this.charLength+=f,this.charReceived+=f,this.charBuffer.copy(this.charBuffer,f,0,f),a.copy(this.charBuffer,0,0,f),b.substring(0,e)}return b},j.prototype.detectIncompleteChar=function(a){for(var b=a.length>=3?3:a.length;b>0;b--){var c=a[a.length-b];if(1==b&&c>>5==6){this.charLength=2;break}if(b<=2&&c>>4==14){this.charLength=3;break}if(b<=3&&c>>3==30){this.charLength=4;break}}this.charReceived=b},j.prototype.end=function(a){var b="";if(a&&a.length&&(b=this.write(a)),this.charReceived){var c=this.charReceived,d=this.charBuffer,e=this.encoding;b+=d.slice(0,c).toString(e)}return b}},{buffer:254}],308:[function(a,b,c){(function(d){function e(a,b,c){function e(){for(;j.length&&!l.paused;){var a=j.shift();if(null===a)return l.emit("end");l.emit("data",a)}}function g(){l.writable=!1,b.call(l),!l.readable&&l.autoDestroy&&l.destroy()}a=a||function(a){this.queue(a)},b=b||function(){this.queue(null)};var h=!1,i=!1,j=[],k=!1,l=new f;return l.readable=l.writable=!0,l.paused=!1,l.autoDestroy=!(c&&!1===c.autoDestroy),l.write=function(b){return a.call(this,b),!l.paused},l.queue=l.push=function(a){return k?l:(null===a&&(k=!0),j.push(a),e(),l)},l.on("end",function(){l.readable=!1,!l.writable&&l.autoDestroy&&d.nextTick(function(){l.destroy()})}),l.end=function(a){if(!h)return h=!0,arguments.length&&l.write(a),g(),l},l.destroy=function(){if(!i)return i=!0,h=!0,j.length=0,l.writable=l.readable=!1,l.emit("close"),l},l.pause=function(){if(!l.paused)return l.paused=!0,l},l.resume=function(){return l.paused&&(l.paused=!1,l.emit("resume")),e(),l.paused||l.emit("drain"),l},l}var f=a("stream");c=b.exports=e,e.through=e}).call(this,a("_process"))},{_process:291,stream:295}],309:[function(a,b,c){!function(a){var b=function(){"use strict";return{isMsie:function(){return!!/(msie|trident)/i.test(navigator.userAgent)&&navigator.userAgent.match(/(msie |rv:)(\d+(.\d+)?)/i)[2]},isBlankString:function(a){return!a||/^\s*$/.test(a)},escapeRegExChars:function(a){return a.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},isString:function(a){return"string"==typeof a},isNumber:function(a){return"number"==typeof a},isArray:a.isArray,isFunction:a.isFunction,isObject:a.isPlainObject,isUndefined:function(a){return void 0===a},toStr:function(a){return b.isUndefined(a)||null===a?"":a+""},bind:a.proxy,each:function(b,c){function d(a,b){return c(b,a)}a.each(b,d)},map:a.map,filter:a.grep,every:function(b,c){var d=!0;return b?(a.each(b,function(a,e){if(!(d=c.call(null,e,a,b)))return!1}),!!d):d},some:function(b,c){var d=!1;return b?(a.each(b,function(a,e){if(d=c.call(null,e,a,b))return!1}),!!d):d},mixin:a.extend,getUniqueId:function(){var a=0;return function(){return a++}}(),templatify:function(b){function c(){return String(b)}return a.isFunction(b)?b:c},defer:function(a){setTimeout(a,0)},debounce:function(a,b,c){var d,e;return function(){var f,g,h=this,i=arguments;return f=function(){d=null,c||(e=a.apply(h,i))},g=c&&!d,clearTimeout(d),d=setTimeout(f,b),g&&(e=a.apply(h,i)),e}},throttle:function(a,b){var c,d,e,f,g,h;return g=0,h=function(){g=new Date,e=null,f=a.apply(c,d)},function(){var i=new Date,j=b-(i-g);return c=this,d=arguments,j<=0?(clearTimeout(e),e=null,g=i,f=a.apply(c,d)):e||(e=setTimeout(h,j)),f}},noop:function(){}}}(),c="0.10.5",d=function(){"use strict";function a(a){return a=b.toStr(a),a?a.split(/\s+/):[]}function c(a){return a=b.toStr(a),a?a.split(/\W+/):[]}function d(a){return function(){var c=[].slice.call(arguments,0);return function(d){var e=[];return b.each(c,function(c){e=e.concat(a(b.toStr(d[c])))}),e}}}return{nonword:c,whitespace:a,obj:{nonword:d(c),whitespace:d(a)}}}(),e=function(){"use strict";function c(c){this.maxSize=b.isNumber(c)?c:100,this.reset(),this.maxSize<=0&&(this.set=this.get=a.noop)}function d(){this.head=this.tail=null}function e(a,b){this.key=a,this.val=b,this.prev=this.next=null}return b.mixin(c.prototype,{set:function(a,b){var c,d=this.list.tail;this.size>=this.maxSize&&(this.list.remove(d),delete this.hash[d.key]),(c=this.hash[a])?(c.val=b,this.list.moveToFront(c)):(c=new e(a,b),this.list.add(c),this.hash[a]=c,this.size++)},get:function(a){var b=this.hash[a];if(b)return this.list.moveToFront(b),b.val},reset:function(){this.size=0,this.hash={},this.list=new d}}),b.mixin(d.prototype,{add:function(a){this.head&&(a.next=this.head,this.head.prev=a),this.head=a,this.tail=this.tail||a},remove:function(a){a.prev?a.prev.next=a.next:this.head=a.next,a.next?a.next.prev=a.prev:this.tail=a.prev},moveToFront:function(a){this.remove(a),this.add(a)}}),c}(),f=function(){"use strict";function a(a){this.prefix=["__",a,"__"].join(""),this.ttlKey="__ttl__",this.keyMatcher=new RegExp("^"+b.escapeRegExChars(this.prefix))}function c(){return(new Date).getTime()}function d(a){return JSON.stringify(b.isUndefined(a)?null:a)}function e(a){return JSON.parse(a)}var f,g;try{f=window.localStorage,f.setItem("~~~","!"),f.removeItem("~~~")}catch(a){f=null}return g=f&&window.JSON?{_prefix:function(a){return this.prefix+a},_ttlKey:function(a){return this._prefix(a)+this.ttlKey},get:function(a){return this.isExpired(a)&&this.remove(a),e(f.getItem(this._prefix(a)))},set:function(a,e,g){return b.isNumber(g)?f.setItem(this._ttlKey(a),d(c()+g)):f.removeItem(this._ttlKey(a)),f.setItem(this._prefix(a),d(e))},remove:function(a){return f.removeItem(this._ttlKey(a)),f.removeItem(this._prefix(a)),this},clear:function(){var a,b,c=[],d=f.length;for(a=0;a<d;a++)(b=f.key(a)).match(this.keyMatcher)&&c.push(b.replace(this.keyMatcher,""));for(a=c.length;a--;)this.remove(c[a]);return this},isExpired:function(a){var d=e(f.getItem(this._ttlKey(a)));return!!(b.isNumber(d)&&c()>d)}}:{get:b.noop,set:b.noop,remove:b.noop,clear:b.noop,isExpired:b.noop},b.mixin(a.prototype,g),a}(),g=function(){"use strict";function c(b){b=b||{},this.cancelled=!1,this.lastUrl=null,this._send=b.transport?d(b.transport):a.ajax,this._get=b.rateLimiter?b.rateLimiter(this._get):this._get,this._cache=!1===b.cache?new e(0):i}function d(c){return function(d,e){function f(a){b.defer(function(){h.resolve(a)})}function g(a){b.defer(function(){h.reject(a)})}var h=a.Deferred();return c(d,e,f,g),h}}var f=0,g={},h=6,i=new e(10);return c.setMaxPendingRequests=function(a){h=a},c.resetCache=function(){i.reset()},b.mixin(c.prototype,{_get:function(a,b,c){function d(b){c&&c(null,b),k._cache.set(a,b)}function e(){c&&c(!0)}function i(){f--,delete g[a],k.onDeckRequestArgs&&(k._get.apply(k,k.onDeckRequestArgs),k.onDeckRequestArgs=null)}var j,k=this;this.cancelled||a!==this.lastUrl||((j=g[a])?j.done(d).fail(e):f<h?(f++,g[a]=this._send(a,b).done(d).fail(e).always(i)):this.onDeckRequestArgs=[].slice.call(arguments,0))},get:function(a,c,d){var e;return b.isFunction(c)&&(d=c,c={}),this.cancelled=!1,this.lastUrl=a,(e=this._cache.get(a))?b.defer(function(){d&&d(null,e)}):this._get(a,c,d),!!e},cancel:function(){this.cancelled=!0}}),c}(),h=function(){"use strict";function c(b){b=b||{},b.datumTokenizer&&b.queryTokenizer||a.error("datumTokenizer and queryTokenizer are both required"),this.datumTokenizer=b.datumTokenizer,this.queryTokenizer=b.queryTokenizer,this.reset()}function d(a){return a=b.filter(a,function(a){return!!a}),a=b.map(a,function(a){return a.toLowerCase()})}function e(){return{ids:[],children:{}}}function f(a){for(var b={},c=[],d=0,e=a.length;d<e;d++)b[a[d]]||(b[a[d]]=!0,c.push(a[d]));return c}function g(a,b){function c(a,b){return a-b}var d=0,e=0,f=[];a=a.sort(c),b=b.sort(c);for(var g=a.length,h=b.length;d<g&&e<h;)a[d]<b[e]?d++:a[d]>b[e]?e++:(f.push(a[d]),d++,e++);return f}return b.mixin(c.prototype,{bootstrap:function(a){this.datums=a.datums,this.trie=a.trie},add:function(a){var c=this;a=b.isArray(a)?a:[a],b.each(a,function(a){var f,g;f=c.datums.push(a)-1,g=d(c.datumTokenizer(a)),b.each(g,function(a){var b,d,g;for(b=c.trie,d=a.split("");g=d.shift();)b=b.children[g]||(b.children[g]=e()),b.ids.push(f)})})},get:function(a){var c,e,h=this;return c=d(this.queryTokenizer(a)),b.each(c,function(a){var b,c,d,f;if(e&&0===e.length)return!1;for(b=h.trie,c=a.split("");b&&(d=c.shift());)b=b.children[d];if(!b||0!==c.length)return e=[],!1;f=b.ids.slice(0),e=e?g(e,f):f}),e?b.map(f(e),function(a){return h.datums[a]}):[]},reset:function(){this.datums=[],this.trie=e()},serialize:function(){return{datums:this.datums,trie:this.trie}}}),c}(),i=function(){"use strict";function d(a){return a.local||null}function e(d){var e,f;return f={url:null,thumbprint:"",ttl:864e5,filter:null,ajax:{}},(e=d.prefetch||null)&&(e=b.isString(e)?{url:e}:e,e=b.mixin(f,e),e.thumbprint=c+e.thumbprint,e.ajax.type=e.ajax.type||"GET",e.ajax.dataType=e.ajax.dataType||"json",!e.url&&a.error("prefetch requires url to be set")),e}function f(c){function d(a){return function(c){return b.debounce(c,a)}}function e(a){return function(c){return b.throttle(c,a)}}var f,g;return g={url:null,cache:!0,wildcard:"%QUERY",replace:null,rateLimitBy:"debounce",rateLimitWait:300,send:null,filter:null,ajax:{}},(f=c.remote||null)&&(f=b.isString(f)?{url:f}:f,f=b.mixin(g,f),f.rateLimiter=/^throttle$/i.test(f.rateLimitBy)?e(f.rateLimitWait):d(f.rateLimitWait),f.ajax.type=f.ajax.type||"GET",f.ajax.dataType=f.ajax.dataType||"json",delete f.rateLimitBy,delete f.rateLimitWait,!f.url&&a.error("remote requires url to be set")),f}return{local:d,prefetch:e,remote:f}}();!function(c){"use strict";function e(b){b&&(b.local||b.prefetch||b.remote)||a.error("one of local, prefetch, or remote is required"),this.limit=b.limit||5,this.sorter=j(b.sorter),this.dupDetector=b.dupDetector||k,this.local=i.local(b),this.prefetch=i.prefetch(b),this.remote=i.remote(b),this.cacheKey=this.prefetch?this.prefetch.cacheKey||this.prefetch.url:null,this.index=new h({datumTokenizer:b.datumTokenizer,queryTokenizer:b.queryTokenizer}),this.storage=this.cacheKey?new f(this.cacheKey):null}function j(a){function c(b){return b.sort(a)}function d(a){return a}return b.isFunction(a)?c:d}function k(){return!1}var l,m;l=c.Bloodhound,m={data:"data",protocol:"protocol",thumbprint:"thumbprint"},c.Bloodhound=e,e.noConflict=function(){return c.Bloodhound=l,e},e.tokenizers=d,b.mixin(e.prototype,{_loadPrefetch:function(b){function c(a){f.clear(),f.add(b.filter?b.filter(a):a),f._saveToStorage(f.index.serialize(),b.thumbprint,b.ttl)}var d,e,f=this;return(d=this._readFromStorage(b.thumbprint))?(this.index.bootstrap(d),e=a.Deferred().resolve()):e=a.ajax(b.url,b.ajax).done(c),e},_getFromRemote:function(a,b){function c(a,c){b(a?[]:f.remote.filter?f.remote.filter(c):c)}var d,e,f=this;if(this.transport)return a=a||"",e=encodeURIComponent(a),d=this.remote.replace?this.remote.replace(this.remote.url,a):this.remote.url.replace(this.remote.wildcard,e),this.transport.get(d,this.remote.ajax,c)},_cancelLastRemoteRequest:function(){this.transport&&this.transport.cancel()},_saveToStorage:function(a,b,c){this.storage&&(this.storage.set(m.data,a,c),this.storage.set(m.protocol,location.protocol,c),this.storage.set(m.thumbprint,b,c))},_readFromStorage:function(a){var b,c={};return this.storage&&(c.data=this.storage.get(m.data),c.protocol=this.storage.get(m.protocol),c.thumbprint=this.storage.get(m.thumbprint)),b=c.thumbprint!==a||c.protocol!==location.protocol,c.data&&!b?c.data:null},_initialize:function(){function c(){e.add(b.isFunction(f)?f():f)}var d,e=this,f=this.local;return d=this.prefetch?this._loadPrefetch(this.prefetch):a.Deferred().resolve(),f&&d.done(c),this.transport=this.remote?new g(this.remote):null,this.initPromise=d.promise()},initialize:function(a){return!this.initPromise||a?this._initialize():this.initPromise},add:function(a){this.index.add(a)},get:function(a,c){function d(a){var d=f.slice(0);b.each(a,function(a){var c;return c=b.some(d,function(b){return e.dupDetector(a,b)}),!c&&d.push(a),d.length<e.limit}),c&&c(e.sorter(d))}var e=this,f=[],g=!1;f=this.index.get(a),f=this.sorter(f).slice(0,this.limit),f.length<this.limit?g=this._getFromRemote(a,d):this._cancelLastRemoteRequest(),g||(f.length>0||!this.transport)&&c&&c(f)},clear:function(){this.index.reset()},clearPrefetchCache:function(){this.storage&&this.storage.clear()},clearRemoteCache:function(){this.transport&&g.resetCache()},ttAdapter:function(){return b.bind(this.get,this)}})}(this);var j=function(){return{wrapper:'<span class="twitter-typeahead"></span>',dropdown:'<span class="tt-dropdown-menu"></span>',dataset:'<div class="tt-dataset-%CLASS%"></div>',suggestions:'<span class="tt-suggestions"></span>',suggestion:'<div class="tt-suggestion"></div>'}}(),k=function(){"use strict";var a={wrapper:{position:"relative",display:"inline-block"},hint:{position:"absolute",top:"0",left:"0",borderColor:"transparent",boxShadow:"none",opacity:"1"},input:{position:"relative",verticalAlign:"top",backgroundColor:"transparent"},inputWithNoHint:{position:"relative",verticalAlign:"top"},dropdown:{position:"absolute",top:"100%",left:"0",zIndex:"100",display:"none"},suggestions:{display:"block"},suggestion:{whiteSpace:"nowrap",cursor:"pointer"},suggestionChild:{whiteSpace:"normal"},ltr:{left:"0",right:"auto"},rtl:{left:"auto",right:" 0"}};return b.isMsie()&&b.mixin(a.input,{backgroundImage:"url(data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7)"}),b.isMsie()&&b.isMsie()<=7&&b.mixin(a.input,{marginTop:"-1px"}),a}(),l=function(){"use strict";function c(b){b&&b.el||a.error("EventBus initialized without el"),this.$el=a(b.el)}return b.mixin(c.prototype,{trigger:function(a){var b=[].slice.call(arguments,1);this.$el.trigger("typeahead:"+a,b)}}),c}(),m=function(){"use strict";function a(a,b,c,d){var e;if(!c)return this;for(b=b.split(i),c=d?h(c,d):c,this._callbacks=this._callbacks||{};e=b.shift();)this._callbacks[e]=this._callbacks[e]||{sync:[],async:[]},this._callbacks[e][a].push(c);return this}function b(b,c,d){return a.call(this,"async",b,c,d)}function c(b,c,d){return a.call(this,"sync",b,c,d)}function d(a){var b;if(!this._callbacks)return this;for(a=a.split(i);b=a.shift();)delete this._callbacks[b];return this}function e(a){var b,c,d,e,g;if(!this._callbacks)return this;for(a=a.split(i),d=[].slice.call(arguments,1);(b=a.shift())&&(c=this._callbacks[b]);)e=f(c.sync,this,[b].concat(d)),g=f(c.async,this,[b].concat(d)),e()&&j(g);return this}function f(a,b,c){function d(){for(var d,e=0,f=a.length;!d&&e<f;e+=1)d=!1===a[e].apply(b,c);return!d}return d}function g(){return window.setImmediate?function(a){setImmediate(function(){a()})}:function(a){setTimeout(function(){a()},0)}}function h(a,b){return a.bind?a.bind(b):function(){a.apply(b,[].slice.call(arguments,0))}}var i=/\s+/,j=g();return{onSync:c,onAsync:b,off:d,trigger:e}}(),n=function(a){"use strict";function c(a,c,d){for(var e,f=[],g=0,h=a.length;g<h;g++)f.push(b.escapeRegExChars(a[g]));return e=d?"\\b("+f.join("|")+")\\b":"("+f.join("|")+")",c?new RegExp(e):new RegExp(e,"i")}var d={node:null,pattern:null,tagName:"strong",className:null,wordsOnly:!1,caseSensitive:!1};return function(e){function f(b){var c,d,f;return(c=h.exec(b.data))&&(f=a.createElement(e.tagName),e.className&&(f.className=e.className),d=b.splitText(c.index),d.splitText(c[0].length),f.appendChild(d.cloneNode(!0)),b.parentNode.replaceChild(f,d)),!!c}function g(a,b){for(var c,d=3,e=0;e<a.childNodes.length;e++)c=a.childNodes[e],c.nodeType===d?e+=b(c)?1:0:g(c,b)}var h;e=b.mixin({},d,e),e.node&&e.pattern&&(e.pattern=b.isArray(e.pattern)?e.pattern:[e.pattern],h=c(e.pattern,e.caseSensitive,e.wordsOnly),g(e.node,f))}}(window.document),o=function(){"use strict";function c(c){var e,f,h,i,j=this;c=c||{},c.input||a.error("input is missing"),e=b.bind(this._onBlur,this),f=b.bind(this._onFocus,this),h=b.bind(this._onKeydown,this),i=b.bind(this._onInput,this),this.$hint=a(c.hint),this.$input=a(c.input).on("blur.tt",e).on("focus.tt",f).on("keydown.tt",h),0===this.$hint.length&&(this.setHint=this.getHint=this.clearHint=this.clearHintIfInvalid=b.noop),b.isMsie()?this.$input.on("keydown.tt keypress.tt cut.tt paste.tt",function(a){g[a.which||a.keyCode]||b.defer(b.bind(j._onInput,j,a))}):this.$input.on("input.tt",i),this.query=this.$input.val(),this.$overflowHelper=d(this.$input)}function d(b){return a('<pre aria-hidden="true"></pre>').css({position:"absolute",visibility:"hidden",whiteSpace:"pre",fontFamily:b.css("font-family"),fontSize:b.css("font-size"),fontStyle:b.css("font-style"),fontVariant:b.css("font-variant"),fontWeight:b.css("font-weight"),wordSpacing:b.css("word-spacing"),letterSpacing:b.css("letter-spacing"),textIndent:b.css("text-indent"),textRendering:b.css("text-rendering"),textTransform:b.css("text-transform")}).insertAfter(b)}function e(a,b){return c.normalizeQuery(a)===c.normalizeQuery(b)}function f(a){return a.altKey||a.ctrlKey||a.metaKey||a.shiftKey}var g;return g={9:"tab",27:"esc",37:"left",39:"right",13:"enter",38:"up",40:"down"},c.normalizeQuery=function(a){return(a||"").replace(/^\s*/g,"").replace(/\s{2,}/g," ")},b.mixin(c.prototype,m,{_onBlur:function(){this.resetInputValue(),this.trigger("blurred")},_onFocus:function(){this.trigger("focused")},_onKeydown:function(a){var b=g[a.which||a.keyCode];this._managePreventDefault(b,a),b&&this._shouldTrigger(b,a)&&this.trigger(b+"Keyed",a)},_onInput:function(){this._checkInputValue()},_managePreventDefault:function(a,b){var c,d,e;switch(a){case"tab":d=this.getHint(),e=this.getInputValue(),c=d&&d!==e&&!f(b);break;case"up":case"down":c=!f(b);break;default:c=!1}c&&b.preventDefault()},_shouldTrigger:function(a,b){var c;switch(a){case"tab":c=!f(b);break;default:c=!0}return c},_checkInputValue:function(){var a,b,c;a=this.getInputValue(),b=e(a,this.query),c=!!b&&this.query.length!==a.length,this.query=a,b?c&&this.trigger("whitespaceChanged",this.query):this.trigger("queryChanged",this.query)},focus:function(){this.$input.focus()},blur:function(){this.$input.blur()},getQuery:function(){return this.query},setQuery:function(a){this.query=a},getInputValue:function(){return this.$input.val()},setInputValue:function(a,b){this.$input.val(a),b?this.clearHint():this._checkInputValue()},resetInputValue:function(){this.setInputValue(this.query,!0)},getHint:function(){return this.$hint.val()},setHint:function(a){this.$hint.val(a)},clearHint:function(){this.setHint("")},clearHintIfInvalid:function(){var a,b,c,d;a=this.getInputValue(),b=this.getHint(),c=a!==b&&0===b.indexOf(a),!(d=""!==a&&c&&!this.hasOverflow())&&this.clearHint()},getLanguageDirection:function(){return(this.$input.css("direction")||"ltr").toLowerCase()},hasOverflow:function(){var a=this.$input.width()-2;return this.$overflowHelper.text(this.getInputValue()),this.$overflowHelper.width()>=a},isCursorAtEnd:function(){var a,c,d;return a=this.$input.val().length,c=this.$input[0].selectionStart,b.isNumber(c)?c===a:!document.selection||(d=document.selection.createRange(),d.moveStart("character",-a),a===d.text.length)},destroy:function(){this.$hint.off(".tt"),this.$input.off(".tt"),this.$hint=this.$input=this.$overflowHelper=null}}),c}(),p=function(){"use strict";function c(c){c=c||{},c.templates=c.templates||{},c.source||a.error("missing source"),c.name&&!f(c.name)&&a.error("invalid dataset name: "+c.name),this.query=null,this.highlight=!!c.highlight,this.name=c.name||b.getUniqueId(),this.source=c.source,this.displayFn=d(c.display||c.displayKey),this.templates=e(c.templates,this.displayFn),this.$el=a(j.dataset.replace("%CLASS%",this.name))}function d(a){function c(b){return b[a]}return a=a||"value",b.isFunction(a)?a:c}function e(a,c){function d(a){return"<p>"+c(a)+"</p>"}return{empty:a.empty&&b.templatify(a.empty),header:a.header&&b.templatify(a.header),footer:a.footer&&b.templatify(a.footer),suggestion:a.suggestion||d}}function f(a){return/^[_a-zA-Z0-9-]+$/.test(a)}var g="ttDataset",h="ttValue",i="ttDatum";return c.extractDatasetName=function(b){return a(b).data(g)},c.extractValue=function(b){return a(b).data(h)},c.extractDatum=function(b){return a(b).data(i)},b.mixin(c.prototype,m,{_render:function(c,d){function e(){return p.templates.empty({query:c,isEmpty:!0})}function f(){function e(b){var c;return c=a(j.suggestion).append(p.templates.suggestion(b)).data(g,p.name).data(h,p.displayFn(b)).data(i,b),c.children().each(function(){a(this).css(k.suggestionChild)}),c}var f,l;return f=a(j.suggestions).css(k.suggestions),l=b.map(d,e),f.append.apply(f,l),p.highlight&&n({className:"tt-highlight",node:f[0],pattern:c}),f}function l(){return p.templates.header({query:c,isEmpty:!o})}function m(){return p.templates.footer({query:c,isEmpty:!o})}if(this.$el){var o,p=this;this.$el.empty(),o=d&&d.length,!o&&this.templates.empty?this.$el.html(e()).prepend(p.templates.header?l():null).append(p.templates.footer?m():null):o&&this.$el.html(f()).prepend(p.templates.header?l():null).append(p.templates.footer?m():null),this.trigger("rendered")}},getRoot:function(){return this.$el},update:function(a){function b(b){c.canceled||a!==c.query||c._render(a,b)}var c=this;this.query=a,this.canceled=!1,this.source(a,b)},cancel:function(){this.canceled=!0},clear:function(){this.cancel(),this.$el.empty(),this.trigger("rendered")},isEmpty:function(){return this.$el.is(":empty")},destroy:function(){this.$el=null}}),c}(),q=function(){"use strict";function c(c){var e,f,g,h=this;c=c||{},c.menu||a.error("menu is required"),this.isOpen=!1,this.isEmpty=!0,this.datasets=b.map(c.datasets,d),e=b.bind(this._onSuggestionClick,this),f=b.bind(this._onSuggestionMouseEnter,this),g=b.bind(this._onSuggestionMouseLeave,this),this.$menu=a(c.menu).on("click.tt",".tt-suggestion",e).on("mouseenter.tt",".tt-suggestion",f).on("mouseleave.tt",".tt-suggestion",g),b.each(this.datasets,function(a){h.$menu.append(a.getRoot()),a.onSync("rendered",h._onRendered,h)})}function d(a){return new p(a)}return b.mixin(c.prototype,m,{_onSuggestionClick:function(b){this.trigger("suggestionClicked",a(b.currentTarget))},_onSuggestionMouseEnter:function(b){this._removeCursor(),this._setCursor(a(b.currentTarget),!0)},_onSuggestionMouseLeave:function(){this._removeCursor()},_onRendered:function(){function a(a){return a.isEmpty()}this.isEmpty=b.every(this.datasets,a),this.isEmpty?this._hide():this.isOpen&&this._show(),this.trigger("datasetRendered")},_hide:function(){this.$menu.hide()},_show:function(){this.$menu.css("display","block")},_getSuggestions:function(){return this.$menu.find(".tt-suggestion")},_getCursor:function(){return this.$menu.find(".tt-cursor").first()},_setCursor:function(a,b){a.first().addClass("tt-cursor"),!b&&this.trigger("cursorMoved")},_removeCursor:function(){this._getCursor().removeClass("tt-cursor")},_moveCursor:function(a){var b,c,d,e;if(this.isOpen){if(c=this._getCursor(),b=this._getSuggestions(),this._removeCursor(),d=b.index(c)+a,-1===(d=(d+1)%(b.length+1)-1))return void this.trigger("cursorRemoved");d<-1&&(d=b.length-1),this._setCursor(e=b.eq(d)),this._ensureVisible(e)}},_ensureVisible:function(a){var b,c,d,e;b=a.position().top,c=b+a.outerHeight(!0),d=this.$menu.scrollTop(),e=this.$menu.height()+parseInt(this.$menu.css("paddingTop"),10)+parseInt(this.$menu.css("paddingBottom"),10),b<0?this.$menu.scrollTop(d+b):e<c&&this.$menu.scrollTop(d+(c-e))},close:function(){this.isOpen&&(this.isOpen=!1,this._removeCursor(),this._hide(),this.trigger("closed"))},open:function(){this.isOpen||(this.isOpen=!0,!this.isEmpty&&this._show(),this.trigger("opened"))},setLanguageDirection:function(a){this.$menu.css("ltr"===a?k.ltr:k.rtl)},moveCursorUp:function(){this._moveCursor(-1)},moveCursorDown:function(){this._moveCursor(1)},getDatumForSuggestion:function(a){var b=null;return a.length&&(b={raw:p.extractDatum(a),value:p.extractValue(a),datasetName:p.extractDatasetName(a)}),b},getDatumForCursor:function(){return this.getDatumForSuggestion(this._getCursor().first())},getDatumForTopSuggestion:function(){return this.getDatumForSuggestion(this._getSuggestions().first())},update:function(a){function c(b){b.update(a)}b.each(this.datasets,c)},empty:function(){function a(a){a.clear()}b.each(this.datasets,a),this.isEmpty=!0},isVisible:function(){return this.isOpen&&!this.isEmpty},destroy:function(){function a(a){a.destroy()}this.$menu.off(".tt"),this.$menu=null,b.each(this.datasets,a)}}),c}(),r=function(){"use strict";function c(c){var e,f,g;c=c||{},c.input||a.error("missing input"),this.isActivated=!1,this.autoselect=!!c.autoselect,this.minLength=b.isNumber(c.minLength)?c.minLength:1,this.$node=d(c.input,c.withHint),e=this.$node.find(".tt-dropdown-menu"),f=this.$node.find(".tt-input"),g=this.$node.find(".tt-hint"),f.on("blur.tt",function(a){var c,d,g;c=document.activeElement,d=e.is(c),g=e.has(c).length>0,b.isMsie()&&(d||g)&&(a.preventDefault(),a.stopImmediatePropagation(),b.defer(function(){f.focus()}))}),e.on("mousedown.tt",function(a){a.preventDefault()}),this.eventBus=c.eventBus||new l({el:f}),this.dropdown=new q({menu:e,datasets:c.datasets
}).onSync("suggestionClicked",this._onSuggestionClicked,this).onSync("cursorMoved",this._onCursorMoved,this).onSync("cursorRemoved",this._onCursorRemoved,this).onSync("opened",this._onOpened,this).onSync("closed",this._onClosed,this).onAsync("datasetRendered",this._onDatasetRendered,this),this.input=new o({input:f,hint:g}).onSync("focused",this._onFocused,this).onSync("blurred",this._onBlurred,this).onSync("enterKeyed",this._onEnterKeyed,this).onSync("tabKeyed",this._onTabKeyed,this).onSync("escKeyed",this._onEscKeyed,this).onSync("upKeyed",this._onUpKeyed,this).onSync("downKeyed",this._onDownKeyed,this).onSync("leftKeyed",this._onLeftKeyed,this).onSync("rightKeyed",this._onRightKeyed,this).onSync("queryChanged",this._onQueryChanged,this).onSync("whitespaceChanged",this._onWhitespaceChanged,this),this._setLanguageDirection()}function d(b,c){var d,f,h,i;d=a(b),f=a(j.wrapper).css(k.wrapper),h=a(j.dropdown).css(k.dropdown),i=d.clone().css(k.hint).css(e(d)),i.val("").removeData().addClass("tt-hint").removeAttr("id name placeholder required").prop("readonly",!0).attr({autocomplete:"off",spellcheck:"false",tabindex:-1}),d.data(g,{dir:d.attr("dir"),autocomplete:d.attr("autocomplete"),spellcheck:d.attr("spellcheck"),style:d.attr("style")}),d.addClass("tt-input").attr({autocomplete:"off",spellcheck:!1}).css(c?k.input:k.inputWithNoHint);try{!d.attr("dir")&&d.attr("dir","auto")}catch(a){}return d.wrap(f).parent().prepend(c?i:null).append(h)}function e(a){return{backgroundAttachment:a.css("background-attachment"),backgroundClip:a.css("background-clip"),backgroundColor:a.css("background-color"),backgroundImage:a.css("background-image"),backgroundOrigin:a.css("background-origin"),backgroundPosition:a.css("background-position"),backgroundRepeat:a.css("background-repeat"),backgroundSize:a.css("background-size")}}function f(a){var c=a.find(".tt-input");b.each(c.data(g),function(a,d){b.isUndefined(a)?c.removeAttr(d):c.attr(d,a)}),c.detach().removeData(g).removeClass("tt-input").insertAfter(a),a.remove()}var g="ttAttrs";return b.mixin(c.prototype,{_onSuggestionClicked:function(a,b){var c;(c=this.dropdown.getDatumForSuggestion(b))&&this._select(c)},_onCursorMoved:function(){var a=this.dropdown.getDatumForCursor();this.input.setInputValue(a.value,!0),this.eventBus.trigger("cursorchanged",a.raw,a.datasetName)},_onCursorRemoved:function(){this.input.resetInputValue(),this._updateHint()},_onDatasetRendered:function(){this._updateHint()},_onOpened:function(){this._updateHint(),this.eventBus.trigger("opened")},_onClosed:function(){this.input.clearHint(),this.eventBus.trigger("closed")},_onFocused:function(){this.isActivated=!0,this.dropdown.open()},_onBlurred:function(){this.isActivated=!1,this.dropdown.empty(),this.dropdown.close()},_onEnterKeyed:function(a,b){var c,d;c=this.dropdown.getDatumForCursor(),d=this.dropdown.getDatumForTopSuggestion(),c?(this._select(c),b.preventDefault()):this.autoselect&&d&&(this._select(d),b.preventDefault())},_onTabKeyed:function(a,b){var c;(c=this.dropdown.getDatumForCursor())?(this._select(c),b.preventDefault()):this._autocomplete(!0)},_onEscKeyed:function(){this.dropdown.close(),this.input.resetInputValue()},_onUpKeyed:function(){var a=this.input.getQuery();this.dropdown.isEmpty&&a.length>=this.minLength?this.dropdown.update(a):this.dropdown.moveCursorUp(),this.dropdown.open()},_onDownKeyed:function(){var a=this.input.getQuery();this.dropdown.isEmpty&&a.length>=this.minLength?this.dropdown.update(a):this.dropdown.moveCursorDown(),this.dropdown.open()},_onLeftKeyed:function(){"rtl"===this.dir&&this._autocomplete()},_onRightKeyed:function(){"ltr"===this.dir&&this._autocomplete()},_onQueryChanged:function(a,b){this.input.clearHintIfInvalid(),b.length>=this.minLength?this.dropdown.update(b):this.dropdown.empty(),this.dropdown.open(),this._setLanguageDirection()},_onWhitespaceChanged:function(){this._updateHint(),this.dropdown.open()},_setLanguageDirection:function(){var a;this.dir!==(a=this.input.getLanguageDirection())&&(this.dir=a,this.$node.css("direction",a),this.dropdown.setLanguageDirection(a))},_updateHint:function(){var a,c,d,e,f,g;a=this.dropdown.getDatumForTopSuggestion(),a&&this.dropdown.isVisible()&&!this.input.hasOverflow()?(c=this.input.getInputValue(),d=o.normalizeQuery(c),e=b.escapeRegExChars(d),f=new RegExp("^(?:"+e+")(.+$)","i"),g=f.exec(a.value),g?this.input.setHint(c+g[1]):this.input.clearHint()):this.input.clearHint()},_autocomplete:function(a){var b,c,d,e;b=this.input.getHint(),c=this.input.getQuery(),d=a||this.input.isCursorAtEnd(),b&&c!==b&&d&&(e=this.dropdown.getDatumForTopSuggestion(),e&&this.input.setInputValue(e.value),this.eventBus.trigger("autocompleted",e.raw,e.datasetName))},_select:function(a){this.input.setQuery(a.value),this.input.setInputValue(a.value,!0),this._setLanguageDirection(),this.eventBus.trigger("selected",a.raw,a.datasetName),this.dropdown.close(),b.defer(b.bind(this.dropdown.empty,this.dropdown))},open:function(){this.dropdown.open()},close:function(){this.dropdown.close()},setVal:function(a){a=b.toStr(a),this.isActivated?this.input.setInputValue(a):(this.input.setQuery(a),this.input.setInputValue(a,!0)),this._setLanguageDirection()},getVal:function(){return this.input.getQuery()},destroy:function(){this.input.destroy(),this.dropdown.destroy(),f(this.$node),this.$node=null}}),c}();!function(){"use strict";var c,d,e;c=a.fn.typeahead,d="ttTypeahead",e={initialize:function(c,e){function f(){var f,g=a(this);b.each(e,function(a){a.highlight=!!c.highlight}),f=new r({input:g,eventBus:new l({el:g}),withHint:!!b.isUndefined(c.hint)||!!c.hint,minLength:c.minLength,autoselect:c.autoselect,datasets:e}),g.data(d,f)}return e=b.isArray(e)?e:[].slice.call(arguments,1),c=c||{},this.each(f)},open:function(){function b(){var b,c=a(this);(b=c.data(d))&&b.open()}return this.each(b)},close:function(){function b(){var b,c=a(this);(b=c.data(d))&&b.close()}return this.each(b)},val:function(b){function c(){var c,e=a(this);(c=e.data(d))&&c.setVal(b)}function e(a){var b,c;return(b=a.data(d))&&(c=b.getVal()),c}return arguments.length?this.each(c):e(this.first())},destroy:function(){function b(){var b,c=a(this);(b=c.data(d))&&(b.destroy(),c.removeData(d))}return this.each(b)}},a.fn.typeahead=function(b){var c;return e[b]&&"initialize"!==b?(c=this.filter(function(){return!!a(this).data(d)}),e[b].apply(c,[].slice.call(arguments,1))):e.initialize.apply(this,arguments)},a.fn.typeahead.noConflict=function(){return a.fn.typeahead=c,this}}()}(window.jQuery)},{}],310:[function(b,c,d){(function(b){!function(){var e="object"==typeof self&&self.self===self&&self||"object"==typeof b&&b.global===b&&b||this||{},f=e._,g=Array.prototype,h=Object.prototype,i="undefined"!=typeof Symbol?Symbol.prototype:null,j=g.push,k=g.slice,l=h.toString,m=h.hasOwnProperty,n=Array.isArray,o=Object.keys,p=Object.create,q=function(){},r=function(a){return a instanceof r?a:this instanceof r?void(this._wrapped=a):new r(a)};void 0===d||d.nodeType?e._=r:(void 0!==c&&!c.nodeType&&c.exports&&(d=c.exports=r),d._=r),r.VERSION="1.9.1";var s,t=function(a,b,c){if(void 0===b)return a;switch(null==c?3:c){case 1:return function(c){return a.call(b,c)};case 3:return function(c,d,e){return a.call(b,c,d,e)};case 4:return function(c,d,e,f){return a.call(b,c,d,e,f)}}return function(){return a.apply(b,arguments)}},u=function(a,b,c){return r.iteratee!==s?r.iteratee(a,b):null==a?r.identity:r.isFunction(a)?t(a,b,c):r.isObject(a)&&!r.isArray(a)?r.matcher(a):r.property(a)};r.iteratee=s=function(a,b){return u(a,b,1/0)};var v=function(a,b){return b=null==b?a.length-1:+b,function(){for(var c=Math.max(arguments.length-b,0),d=Array(c),e=0;e<c;e++)d[e]=arguments[e+b];switch(b){case 0:return a.call(this,d);case 1:return a.call(this,arguments[0],d);case 2:return a.call(this,arguments[0],arguments[1],d)}var f=Array(b+1);for(e=0;e<b;e++)f[e]=arguments[e];return f[b]=d,a.apply(this,f)}},w=function(a){if(!r.isObject(a))return{};if(p)return p(a);q.prototype=a;var b=new q;return q.prototype=null,b},x=function(a){return function(b){return null==b?void 0:b[a]}},y=function(a,b){return null!=a&&m.call(a,b)},z=function(a,b){for(var c=b.length,d=0;d<c;d++){if(null==a)return;a=a[b[d]]}return c?a:void 0},A=Math.pow(2,53)-1,B=x("length"),C=function(a){var b=B(a);return"number"==typeof b&&b>=0&&b<=A};r.each=r.forEach=function(a,b,c){b=t(b,c);var d,e;if(C(a))for(d=0,e=a.length;d<e;d++)b(a[d],d,a);else{var f=r.keys(a);for(d=0,e=f.length;d<e;d++)b(a[f[d]],f[d],a)}return a},r.map=r.collect=function(a,b,c){b=u(b,c);for(var d=!C(a)&&r.keys(a),e=(d||a).length,f=Array(e),g=0;g<e;g++){var h=d?d[g]:g;f[g]=b(a[h],h,a)}return f};var D=function(a){var b=function(b,c,d,e){var f=!C(b)&&r.keys(b),g=(f||b).length,h=a>0?0:g-1;for(e||(d=b[f?f[h]:h],h+=a);h>=0&&h<g;h+=a){var i=f?f[h]:h;d=c(d,b[i],i,b)}return d};return function(a,c,d,e){var f=arguments.length>=3;return b(a,t(c,e,4),d,f)}};r.reduce=r.foldl=r.inject=D(1),r.reduceRight=r.foldr=D(-1),r.find=r.detect=function(a,b,c){var d=C(a)?r.findIndex:r.findKey,e=d(a,b,c);if(void 0!==e&&-1!==e)return a[e]},r.filter=r.select=function(a,b,c){var d=[];return b=u(b,c),r.each(a,function(a,c,e){b(a,c,e)&&d.push(a)}),d},r.reject=function(a,b,c){return r.filter(a,r.negate(u(b)),c)},r.every=r.all=function(a,b,c){b=u(b,c);for(var d=!C(a)&&r.keys(a),e=(d||a).length,f=0;f<e;f++){var g=d?d[f]:f;if(!b(a[g],g,a))return!1}return!0},r.some=r.any=function(a,b,c){b=u(b,c);for(var d=!C(a)&&r.keys(a),e=(d||a).length,f=0;f<e;f++){var g=d?d[f]:f;if(b(a[g],g,a))return!0}return!1},r.contains=r.includes=r.include=function(a,b,c,d){return C(a)||(a=r.values(a)),("number"!=typeof c||d)&&(c=0),r.indexOf(a,b,c)>=0},r.invoke=v(function(a,b,c){var d,e;return r.isFunction(b)?e=b:r.isArray(b)&&(d=b.slice(0,-1),b=b[b.length-1]),r.map(a,function(a){var f=e;if(!f){if(d&&d.length&&(a=z(a,d)),null==a)return;f=a[b]}return null==f?f:f.apply(a,c)})}),r.pluck=function(a,b){return r.map(a,r.property(b))},r.where=function(a,b){return r.filter(a,r.matcher(b))},r.findWhere=function(a,b){return r.find(a,r.matcher(b))},r.max=function(a,b,c){var d,e,f=-1/0,g=-1/0;if(null==b||"number"==typeof b&&"object"!=typeof a[0]&&null!=a){a=C(a)?a:r.values(a);for(var h=0,i=a.length;h<i;h++)null!=(d=a[h])&&d>f&&(f=d)}else b=u(b,c),r.each(a,function(a,c,d){((e=b(a,c,d))>g||e===-1/0&&f===-1/0)&&(f=a,g=e)});return f},r.min=function(a,b,c){var d,e,f=1/0,g=1/0;if(null==b||"number"==typeof b&&"object"!=typeof a[0]&&null!=a){a=C(a)?a:r.values(a);for(var h=0,i=a.length;h<i;h++)null!=(d=a[h])&&d<f&&(f=d)}else b=u(b,c),r.each(a,function(a,c,d){((e=b(a,c,d))<g||e===1/0&&f===1/0)&&(f=a,g=e)});return f},r.shuffle=function(a){return r.sample(a,1/0)},r.sample=function(a,b,c){if(null==b||c)return C(a)||(a=r.values(a)),a[r.random(a.length-1)];var d=C(a)?r.clone(a):r.values(a),e=B(d);b=Math.max(Math.min(b,e),0);for(var f=e-1,g=0;g<b;g++){var h=r.random(g,f),i=d[g];d[g]=d[h],d[h]=i}return d.slice(0,b)},r.sortBy=function(a,b,c){var d=0;return b=u(b,c),r.pluck(r.map(a,function(a,c,e){return{value:a,index:d++,criteria:b(a,c,e)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;if(c!==d){if(c>d||void 0===c)return 1;if(c<d||void 0===d)return-1}return a.index-b.index}),"value")};var E=function(a,b){return function(c,d,e){var f=b?[[],[]]:{};return d=u(d,e),r.each(c,function(b,e){var g=d(b,e,c);a(f,b,g)}),f}};r.groupBy=E(function(a,b,c){y(a,c)?a[c].push(b):a[c]=[b]}),r.indexBy=E(function(a,b,c){a[c]=b}),r.countBy=E(function(a,b,c){y(a,c)?a[c]++:a[c]=1});var F=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;r.toArray=function(a){return a?r.isArray(a)?k.call(a):r.isString(a)?a.match(F):C(a)?r.map(a,r.identity):r.values(a):[]},r.size=function(a){return null==a?0:C(a)?a.length:r.keys(a).length},r.partition=E(function(a,b,c){a[c?0:1].push(b)},!0),r.first=r.head=r.take=function(a,b,c){return null==a||a.length<1?null==b?void 0:[]:null==b||c?a[0]:r.initial(a,a.length-b)},r.initial=function(a,b,c){return k.call(a,0,Math.max(0,a.length-(null==b||c?1:b)))},r.last=function(a,b,c){return null==a||a.length<1?null==b?void 0:[]:null==b||c?a[a.length-1]:r.rest(a,Math.max(0,a.length-b))},r.rest=r.tail=r.drop=function(a,b,c){return k.call(a,null==b||c?1:b)},r.compact=function(a){return r.filter(a,Boolean)};var G=function(a,b,c,d){d=d||[];for(var e=d.length,f=0,g=B(a);f<g;f++){var h=a[f];if(C(h)&&(r.isArray(h)||r.isArguments(h)))if(b)for(var i=0,j=h.length;i<j;)d[e++]=h[i++];else G(h,b,c,d),e=d.length;else c||(d[e++]=h)}return d};r.flatten=function(a,b){return G(a,b,!1)},r.without=v(function(a,b){return r.difference(a,b)}),r.uniq=r.unique=function(a,b,c,d){r.isBoolean(b)||(d=c,c=b,b=!1),null!=c&&(c=u(c,d));for(var e=[],f=[],g=0,h=B(a);g<h;g++){var i=a[g],j=c?c(i,g,a):i;b&&!c?(g&&f===j||e.push(i),f=j):c?r.contains(f,j)||(f.push(j),e.push(i)):r.contains(e,i)||e.push(i)}return e},r.union=v(function(a){return r.uniq(G(a,!0,!0))}),r.intersection=function(a){for(var b=[],c=arguments.length,d=0,e=B(a);d<e;d++){var f=a[d];if(!r.contains(b,f)){var g;for(g=1;g<c&&r.contains(arguments[g],f);g++);g===c&&b.push(f)}}return b},r.difference=v(function(a,b){return b=G(b,!0,!0),r.filter(a,function(a){return!r.contains(b,a)})}),r.unzip=function(a){for(var b=a&&r.max(a,B).length||0,c=Array(b),d=0;d<b;d++)c[d]=r.pluck(a,d);return c},r.zip=v(r.unzip),r.object=function(a,b){for(var c={},d=0,e=B(a);d<e;d++)b?c[a[d]]=b[d]:c[a[d][0]]=a[d][1];return c};var H=function(a){return function(b,c,d){c=u(c,d);for(var e=B(b),f=a>0?0:e-1;f>=0&&f<e;f+=a)if(c(b[f],f,b))return f;return-1}};r.findIndex=H(1),r.findLastIndex=H(-1),r.sortedIndex=function(a,b,c,d){c=u(c,d,1);for(var e=c(b),f=0,g=B(a);f<g;){var h=Math.floor((f+g)/2);c(a[h])<e?f=h+1:g=h}return f};var I=function(a,b,c){return function(d,e,f){var g=0,h=B(d);if("number"==typeof f)a>0?g=f>=0?f:Math.max(f+h,g):h=f>=0?Math.min(f+1,h):f+h+1;else if(c&&f&&h)return f=c(d,e),d[f]===e?f:-1;if(e!==e)return f=b(k.call(d,g,h),r.isNaN),f>=0?f+g:-1;for(f=a>0?g:h-1;f>=0&&f<h;f+=a)if(d[f]===e)return f;return-1}};r.indexOf=I(1,r.findIndex,r.sortedIndex),r.lastIndexOf=I(-1,r.findLastIndex),r.range=function(a,b,c){null==b&&(b=a||0,a=0),c||(c=b<a?-1:1);for(var d=Math.max(Math.ceil((b-a)/c),0),e=Array(d),f=0;f<d;f++,a+=c)e[f]=a;return e},r.chunk=function(a,b){if(null==b||b<1)return[];for(var c=[],d=0,e=a.length;d<e;)c.push(k.call(a,d,d+=b));return c};var J=function(a,b,c,d,e){if(!(d instanceof b))return a.apply(c,e);var f=w(a.prototype),g=a.apply(f,e);return r.isObject(g)?g:f};r.bind=v(function(a,b,c){if(!r.isFunction(a))throw new TypeError("Bind must be called on a function");var d=v(function(e){return J(a,d,b,this,c.concat(e))});return d}),r.partial=v(function(a,b){var c=r.partial.placeholder,d=function(){for(var e=0,f=b.length,g=Array(f),h=0;h<f;h++)g[h]=b[h]===c?arguments[e++]:b[h];for(;e<arguments.length;)g.push(arguments[e++]);return J(a,d,this,this,g)};return d}),r.partial.placeholder=r,r.bindAll=v(function(a,b){b=G(b,!1,!1);var c=b.length;if(c<1)throw new Error("bindAll must be passed function names");for(;c--;){var d=b[c];a[d]=r.bind(a[d],a)}}),r.memoize=function(a,b){var c=function(d){var e=c.cache,f=""+(b?b.apply(this,arguments):d);return y(e,f)||(e[f]=a.apply(this,arguments)),e[f]};return c.cache={},c},r.delay=v(function(a,b,c){return setTimeout(function(){return a.apply(null,c)},b)}),r.defer=r.partial(r.delay,r,1),r.throttle=function(a,b,c){var d,e,f,g,h=0;c||(c={});var i=function(){h=!1===c.leading?0:r.now(),d=null,g=a.apply(e,f),d||(e=f=null)},j=function(){var j=r.now();h||!1!==c.leading||(h=j);var k=b-(j-h);return e=this,f=arguments,k<=0||k>b?(d&&(clearTimeout(d),d=null),h=j,g=a.apply(e,f),d||(e=f=null)):d||!1===c.trailing||(d=setTimeout(i,k)),g};return j.cancel=function(){clearTimeout(d),h=0,d=e=f=null},j},r.debounce=function(a,b,c){var d,e,f=function(b,c){d=null,c&&(e=a.apply(b,c))},g=v(function(g){if(d&&clearTimeout(d),c){var h=!d;d=setTimeout(f,b),h&&(e=a.apply(this,g))}else d=r.delay(f,b,this,g);return e});return g.cancel=function(){clearTimeout(d),d=null},g},r.wrap=function(a,b){return r.partial(b,a)},r.negate=function(a){return function(){return!a.apply(this,arguments)}},r.compose=function(){var a=arguments,b=a.length-1;return function(){for(var c=b,d=a[b].apply(this,arguments);c--;)d=a[c].call(this,d);return d}},r.after=function(a,b){return function(){if(--a<1)return b.apply(this,arguments)}},r.before=function(a,b){var c;return function(){return--a>0&&(c=b.apply(this,arguments)),a<=1&&(b=null),c}},r.once=r.partial(r.before,2),r.restArguments=v;var K=!{toString:null}.propertyIsEnumerable("toString"),L=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],M=function(a,b){var c=L.length,d=a.constructor,e=r.isFunction(d)&&d.prototype||h,f="constructor";for(y(a,f)&&!r.contains(b,f)&&b.push(f);c--;)(f=L[c])in a&&a[f]!==e[f]&&!r.contains(b,f)&&b.push(f)};r.keys=function(a){if(!r.isObject(a))return[];if(o)return o(a);var b=[];for(var c in a)y(a,c)&&b.push(c);return K&&M(a,b),b},r.allKeys=function(a){if(!r.isObject(a))return[];var b=[];for(var c in a)b.push(c);return K&&M(a,b),b},r.values=function(a){for(var b=r.keys(a),c=b.length,d=Array(c),e=0;e<c;e++)d[e]=a[b[e]];return d},r.mapObject=function(a,b,c){b=u(b,c);for(var d=r.keys(a),e=d.length,f={},g=0;g<e;g++){var h=d[g];f[h]=b(a[h],h,a)}return f},r.pairs=function(a){for(var b=r.keys(a),c=b.length,d=Array(c),e=0;e<c;e++)d[e]=[b[e],a[b[e]]];return d},r.invert=function(a){for(var b={},c=r.keys(a),d=0,e=c.length;d<e;d++)b[a[c[d]]]=c[d];return b},r.functions=r.methods=function(a){var b=[];for(var c in a)r.isFunction(a[c])&&b.push(c);return b.sort()};var N=function(a,b){return function(c){var d=arguments.length;if(b&&(c=Object(c)),d<2||null==c)return c;for(var e=1;e<d;e++)for(var f=arguments[e],g=a(f),h=g.length,i=0;i<h;i++){var j=g[i];b&&void 0!==c[j]||(c[j]=f[j])}return c}};r.extend=N(r.allKeys),r.extendOwn=r.assign=N(r.keys),r.findKey=function(a,b,c){b=u(b,c);for(var d,e=r.keys(a),f=0,g=e.length;f<g;f++)if(d=e[f],b(a[d],d,a))return d};var O=function(a,b,c){return b in c};r.pick=v(function(a,b){var c={},d=b[0];if(null==a)return c;r.isFunction(d)?(b.length>1&&(d=t(d,b[1])),b=r.allKeys(a)):(d=O,b=G(b,!1,!1),a=Object(a));for(var e=0,f=b.length;e<f;e++){var g=b[e],h=a[g];d(h,g,a)&&(c[g]=h)}return c}),r.omit=v(function(a,b){var c,d=b[0];return r.isFunction(d)?(d=r.negate(d),b.length>1&&(c=b[1])):(b=r.map(G(b,!1,!1),String),d=function(a,c){return!r.contains(b,c)}),r.pick(a,d,c)}),r.defaults=N(r.allKeys,!0),r.create=function(a,b){var c=w(a);return b&&r.extendOwn(c,b),c},r.clone=function(a){return r.isObject(a)?r.isArray(a)?a.slice():r.extend({},a):a},r.tap=function(a,b){return b(a),a},r.isMatch=function(a,b){var c=r.keys(b),d=c.length;if(null==a)return!d;for(var e=Object(a),f=0;f<d;f++){var g=c[f];if(b[g]!==e[g]||!(g in e))return!1}return!0};var P,Q;P=function(a,b,c,d){if(a===b)return 0!==a||1/a==1/b;if(null==a||null==b)return!1;if(a!==a)return b!==b;var e=typeof a;return("function"===e||"object"===e||"object"==typeof b)&&Q(a,b,c,d)},Q=function(a,b,c,d){a instanceof r&&(a=a._wrapped),b instanceof r&&(b=b._wrapped);var e=l.call(a);if(e!==l.call(b))return!1;switch(e){case"[object RegExp]":case"[object String]":return""+a==""+b;case"[object Number]":return+a!=+a?+b!=+b:0==+a?1/+a==1/b:+a==+b;case"[object Date]":case"[object Boolean]":return+a==+b;case"[object Symbol]":return i.valueOf.call(a)===i.valueOf.call(b)}var f="[object Array]"===e;if(!f){if("object"!=typeof a||"object"!=typeof b)return!1;var g=a.constructor,h=b.constructor;if(g!==h&&!(r.isFunction(g)&&g instanceof g&&r.isFunction(h)&&h instanceof h)&&"constructor"in a&&"constructor"in b)return!1}c=c||[],d=d||[];for(var j=c.length;j--;)if(c[j]===a)return d[j]===b;if(c.push(a),d.push(b),f){if((j=a.length)!==b.length)return!1;for(;j--;)if(!P(a[j],b[j],c,d))return!1}else{var k,m=r.keys(a);if(j=m.length,r.keys(b).length!==j)return!1;for(;j--;)if(k=m[j],!y(b,k)||!P(a[k],b[k],c,d))return!1}return c.pop(),d.pop(),!0},r.isEqual=function(a,b){return P(a,b)},r.isEmpty=function(a){return null==a||(C(a)&&(r.isArray(a)||r.isString(a)||r.isArguments(a))?0===a.length:0===r.keys(a).length)},r.isElement=function(a){return!(!a||1!==a.nodeType)},r.isArray=n||function(a){return"[object Array]"===l.call(a)},r.isObject=function(a){var b=typeof a;return"function"===b||"object"===b&&!!a},r.each(["Arguments","Function","String","Number","Date","RegExp","Error","Symbol","Map","WeakMap","Set","WeakSet"],function(a){r["is"+a]=function(b){return l.call(b)==="[object "+a+"]"}}),r.isArguments(arguments)||(r.isArguments=function(a){return y(a,"callee")});var R=e.document&&e.document.childNodes;"function"!=typeof/./&&"object"!=typeof Int8Array&&"function"!=typeof R&&(r.isFunction=function(a){return"function"==typeof a||!1}),r.isFinite=function(a){return!r.isSymbol(a)&&isFinite(a)&&!isNaN(parseFloat(a))},r.isNaN=function(a){return r.isNumber(a)&&isNaN(a)},r.isBoolean=function(a){return!0===a||!1===a||"[object Boolean]"===l.call(a)},r.isNull=function(a){return null===a},r.isUndefined=function(a){return void 0===a},r.has=function(a,b){if(!r.isArray(b))return y(a,b);for(var c=b.length,d=0;d<c;d++){var e=b[d];if(null==a||!m.call(a,e))return!1;a=a[e]}return!!c},r.noConflict=function(){return e._=f,this},r.identity=function(a){return a},r.constant=function(a){return function(){return a}},r.noop=function(){},r.property=function(a){return r.isArray(a)?function(b){return z(b,a)}:x(a)},r.propertyOf=function(a){return null==a?function(){}:function(b){return r.isArray(b)?z(a,b):a[b]}},r.matcher=r.matches=function(a){return a=r.extendOwn({},a),function(b){return r.isMatch(b,a)}},r.times=function(a,b,c){var d=Array(Math.max(0,a));b=t(b,c,1);for(var e=0;e<a;e++)d[e]=b(e);return d},r.random=function(a,b){return null==b&&(b=a,a=0),a+Math.floor(Math.random()*(b-a+1))},r.now=Date.now||function(){return(new Date).getTime()};var S={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},T=r.invert(S),U=function(a){var b=function(b){return a[b]},c="(?:"+r.keys(a).join("|")+")",d=RegExp(c),e=RegExp(c,"g");return function(a){return a=null==a?"":""+a,d.test(a)?a.replace(e,b):a}};r.escape=U(S),r.unescape=U(T),r.result=function(a,b,c){r.isArray(b)||(b=[b]);var d=b.length;if(!d)return r.isFunction(c)?c.call(a):c;for(var e=0;e<d;e++){var f=null==a?void 0:a[b[e]];void 0===f&&(f=c,e=d),a=r.isFunction(f)?f.call(a):f}return a};var V=0;r.uniqueId=function(a){var b=++V+"";return a?a+b:b},r.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var W=/(.)^/,X={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},Y=/\\|'|\r|\n|\u2028|\u2029/g,Z=function(a){return"\\"+X[a]};r.template=function(a,b,c){!b&&c&&(b=c),b=r.defaults({},b,r.templateSettings);var d=RegExp([(b.escape||W).source,(b.interpolate||W).source,(b.evaluate||W).source].join("|")+"|$","g"),e=0,f="__p+='";a.replace(d,function(b,c,d,g,h){return f+=a.slice(e,h).replace(Y,Z),e=h+b.length,c?f+="'+\n((__t=("+c+"))==null?'':_.escape(__t))+\n'":d?f+="'+\n((__t=("+d+"))==null?'':__t)+\n'":g&&(f+="';\n"+g+"\n__p+='"),b}),f+="';\n",b.variable||(f="with(obj||{}){\n"+f+"}\n"),f="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+f+"return __p;\n";var g;try{g=new Function(b.variable||"obj","_",f)}catch(a){throw a.source=f,a}var h=function(a){return g.call(this,a,r)},i=b.variable||"obj";return h.source="function("+i+"){\n"+f+"}",h},r.chain=function(a){var b=r(a);return b._chain=!0,b};var $=function(a,b){return a._chain?r(b).chain():b};r.mixin=function(a){return r.each(r.functions(a),function(b){var c=r[b]=a[b];r.prototype[b]=function(){var a=[this._wrapped];return j.apply(a,arguments),$(this,c.apply(r,a))}}),r},r.mixin(r),r.each(["pop","push","reverse","shift","sort","splice","unshift"],function(a){var b=g[a];r.prototype[a]=function(){var c=this._wrapped;return b.apply(c,arguments),"shift"!==a&&"splice"!==a||0!==c.length||delete c[0],$(this,c)}}),r.each(["concat","join","slice"],function(a){var b=g[a];r.prototype[a]=function(){return $(this,b.apply(this._wrapped,arguments))}}),r.prototype.value=function(){return this._wrapped},r.prototype.valueOf=r.prototype.toJSON=r.prototype.value,r.prototype.toString=function(){return String(this._wrapped)},"function"==typeof a&&a.amd&&a("underscore",[],function(){return r})}()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],311:[function(a,b,c){function d(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function e(a,b,c){if(a&&j(a)&&a instanceof d)return a;var e=new d;return e.parse(a,b,c),e}function f(a){return i(a)&&(a=e(a)),a instanceof d?a.format():d.prototype.format.call(a)}function g(a,b){return e(a,!1,!0).resolve(b)}function h(a,b){return a?e(a,!1,!0).resolveObject(b):b}function i(a){return"string"==typeof a}function j(a){return"object"==typeof a&&null!==a}function k(a){return null===a}function l(a){return null==a}var m=a("punycode");c.parse=e,c.resolve=g,c.resolveObject=h,c.format=f,c.Url=d;var n=/^([a-z0-9.+-]+:)/i,o=/:[0-9]*$/,p=["<",">",'"',"`"," ","\r","\n","\t"],q=["{","}","|","\\","^","`"].concat(p),r=["'"].concat(q),s=["%","/","?",";","#"].concat(r),t=["/","?","#"],u=/^[a-z0-9A-Z_-]{0,63}$/,v=/^([a-z0-9A-Z_-]{0,63})(.*)$/,w={javascript:!0,"javascript:":!0},x={javascript:!0,"javascript:":!0},y={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},z=a("querystring");d.prototype.parse=function(a,b,c){if(!i(a))throw new TypeError("Parameter 'url' must be a string, not "+typeof a);var d=a;d=d.trim();var e=n.exec(d);if(e){e=e[0];var f=e.toLowerCase();this.protocol=f,d=d.substr(e.length)}if(c||e||d.match(/^\/\/[^@\/]+@[^@\/]+/)){var g="//"===d.substr(0,2);!g||e&&x[e]||(d=d.substr(2),this.slashes=!0)}if(!x[e]&&(g||e&&!y[e])){for(var h=-1,j=0;j<t.length;j++){var k=d.indexOf(t[j]);-1!==k&&(-1===h||k<h)&&(h=k)}var l,o;o=-1===h?d.lastIndexOf("@"):d.lastIndexOf("@",h),-1!==o&&(l=d.slice(0,o),d=d.slice(o+1),this.auth=decodeURIComponent(l)),h=-1;for(var j=0;j<s.length;j++){var k=d.indexOf(s[j]);-1!==k&&(-1===h||k<h)&&(h=k)}-1===h&&(h=d.length),this.host=d.slice(0,h),d=d.slice(h),this.parseHost(),this.hostname=this.hostname||"";var p="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!p)for(var q=this.hostname.split(/\./),j=0,A=q.length;j<A;j++){var B=q[j];if(B&&!B.match(u)){for(var C="",D=0,E=B.length;D<E;D++)B.charCodeAt(D)>127?C+="x":C+=B[D];if(!C.match(u)){var F=q.slice(0,j),G=q.slice(j+1),H=B.match(v);H&&(F.push(H[1]),G.unshift(H[2])),G.length&&(d="/"+G.join(".")+d),this.hostname=F.join(".");break}}}if(this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),!p){for(var I=this.hostname.split("."),J=[],j=0;j<I.length;++j){var K=I[j];J.push(K.match(/[^A-Za-z0-9_-]/)?"xn--"+m.encode(K):K)}this.hostname=J.join(".")}var L=this.port?":"+this.port:"",M=this.hostname||"";this.host=M+L,this.href+=this.host,p&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==d[0]&&(d="/"+d))}if(!w[f])for(var j=0,A=r.length;j<A;j++){var N=r[j],O=encodeURIComponent(N);O===N&&(O=escape(N)),d=d.split(N).join(O)}var P=d.indexOf("#");-1!==P&&(this.hash=d.substr(P),d=d.slice(0,P));var Q=d.indexOf("?");if(-1!==Q?(this.search=d.substr(Q),this.query=d.substr(Q+1),b&&(this.query=z.parse(this.query)),d=d.slice(0,Q)):b&&(this.search="",this.query={}),d&&(this.pathname=d),y[f]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var L=this.pathname||"",K=this.search||"";this.path=L+K}return this.href=this.format(),this},d.prototype.format=function(){var a=this.auth||"";a&&(a=encodeURIComponent(a),a=a.replace(/%3A/i,":"),a+="@");var b=this.protocol||"",c=this.pathname||"",d=this.hash||"",e=!1,f="";this.host?e=a+this.host:this.hostname&&(e=a+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(e+=":"+this.port)),this.query&&j(this.query)&&Object.keys(this.query).length&&(f=z.stringify(this.query));var g=this.search||f&&"?"+f||"";return b&&":"!==b.substr(-1)&&(b+=":"),this.slashes||(!b||y[b])&&!1!==e?(e="//"+(e||""),c&&"/"!==c.charAt(0)&&(c="/"+c)):e||(e=""),d&&"#"!==d.charAt(0)&&(d="#"+d),g&&"?"!==g.charAt(0)&&(g="?"+g),c=c.replace(/[?#]/g,function(a){return encodeURIComponent(a)}),g=g.replace("#","%23"),b+e+c+g+d},d.prototype.resolve=function(a){return this.resolveObject(e(a,!1,!0)).format()},d.prototype.resolveObject=function(a){if(i(a)){var b=new d;b.parse(a,!1,!0),a=b}var c=new d;if(Object.keys(this).forEach(function(a){c[a]=this[a]},this),c.hash=a.hash,""===a.href)return c.href=c.format(),c;if(a.slashes&&!a.protocol)return Object.keys(a).forEach(function(b){"protocol"!==b&&(c[b]=a[b])}),y[c.protocol]&&c.hostname&&!c.pathname&&(c.path=c.pathname="/"),c.href=c.format(),c;if(a.protocol&&a.protocol!==c.protocol){if(!y[a.protocol])return Object.keys(a).forEach(function(b){c[b]=a[b]}),c.href=c.format(),c;if(c.protocol=a.protocol,a.host||x[a.protocol])c.pathname=a.pathname;else{for(var e=(a.pathname||"").split("/");e.length&&!(a.host=e.shift()););a.host||(a.host=""),a.hostname||(a.hostname=""),""!==e[0]&&e.unshift(""),e.length<2&&e.unshift(""),c.pathname=e.join("/")}if(c.search=a.search,c.query=a.query,c.host=a.host||"",c.auth=a.auth,c.hostname=a.hostname||a.host,c.port=a.port,c.pathname||c.search){var f=c.pathname||"",g=c.search||"";c.path=f+g}return c.slashes=c.slashes||a.slashes,c.href=c.format(),c}var h=c.pathname&&"/"===c.pathname.charAt(0),j=a.host||a.pathname&&"/"===a.pathname.charAt(0),m=j||h||c.host&&a.pathname,n=m,o=c.pathname&&c.pathname.split("/")||[],e=a.pathname&&a.pathname.split("/")||[],p=c.protocol&&!y[c.protocol];if(p&&(c.hostname="",c.port=null,c.host&&(""===o[0]?o[0]=c.host:o.unshift(c.host)),c.host="",a.protocol&&(a.hostname=null,a.port=null,a.host&&(""===e[0]?e[0]=a.host:e.unshift(a.host)),a.host=null),m=m&&(""===e[0]||""===o[0])),j)c.host=a.host||""===a.host?a.host:c.host,c.hostname=a.hostname||""===a.hostname?a.hostname:c.hostname,c.search=a.search,c.query=a.query,o=e;else if(e.length)o||(o=[]),o.pop(),o=o.concat(e),c.search=a.search,c.query=a.query;else if(!l(a.search)){if(p){c.hostname=c.host=o.shift();var q=!!(c.host&&c.host.indexOf("@")>0)&&c.host.split("@");q&&(c.auth=q.shift(),c.host=c.hostname=q.shift())}return c.search=a.search,c.query=a.query,k(c.pathname)&&k(c.search)||(c.path=(c.pathname?c.pathname:"")+(c.search?c.search:"")),c.href=c.format(),c}if(!o.length)return c.pathname=null,c.search?c.path="/"+c.search:c.path=null,c.href=c.format(),c;for(var r=o.slice(-1)[0],s=(c.host||a.host)&&("."===r||".."===r)||""===r,t=0,u=o.length;u>=0;u--)r=o[u],"."==r?o.splice(u,1):".."===r?(o.splice(u,1),t++):t&&(o.splice(u,1),t--);if(!m&&!n)for(;t--;t)o.unshift("..");!m||""===o[0]||o[0]&&"/"===o[0].charAt(0)||o.unshift(""),s&&"/"!==o.join("/").substr(-1)&&o.push("");var v=""===o[0]||o[0]&&"/"===o[0].charAt(0);if(p){c.hostname=c.host=v?"":o.length?o.shift():"";var q=!!(c.host&&c.host.indexOf("@")>0)&&c.host.split("@");q&&(c.auth=q.shift(),c.host=c.hostname=q.shift())}return m=m||c.host&&o.length,m&&!v&&o.unshift(""),o.length?c.pathname=o.join("/"):(c.pathname=null,c.path=null),k(c.pathname)&&k(c.search)||(c.path=(c.pathname?c.pathname:"")+(c.search?c.search:"")),c.auth=a.auth||c.auth,c.slashes=c.slashes||a.slashes,c.href=c.format(),c},d.prototype.parseHost=function(){var a=this.host,b=o.exec(a);b&&(b=b[0],":"!==b&&(this.port=b.substr(1)),a=a.substr(0,a.length-b.length)),a&&(this.hostname=a)}},{punycode:253,querystring:294}],312:[function(a,b,c){b.exports=function(a){return a&&"object"==typeof a&&"function"==typeof a.copy&&"function"==typeof a.fill&&"function"==typeof a.readUInt8}},{}],313:[function(a,b,c){(function(b,d){function e(a,b){var d={seen:[],stylize:g};return arguments.length>=3&&(d.depth=arguments[2]),
arguments.length>=4&&(d.colors=arguments[3]),p(b)?d.showHidden=b:b&&c._extend(d,b),v(d.showHidden)&&(d.showHidden=!1),v(d.depth)&&(d.depth=2),v(d.colors)&&(d.colors=!1),v(d.customInspect)&&(d.customInspect=!0),d.colors&&(d.stylize=f),i(d,a,d.depth)}function f(a,b){var c=e.styles[b];return c?"["+e.colors[c][0]+"m"+a+"["+e.colors[c][1]+"m":a}function g(a,b){return a}function h(a){var b={};return a.forEach(function(a,c){b[a]=!0}),b}function i(a,b,d){if(a.customInspect&&b&&A(b.inspect)&&b.inspect!==c.inspect&&(!b.constructor||b.constructor.prototype!==b)){var e=b.inspect(d,a);return t(e)||(e=i(a,e,d)),e}var f=j(a,b);if(f)return f;var g=Object.keys(b),p=h(g);if(a.showHidden&&(g=Object.getOwnPropertyNames(b)),z(b)&&(g.indexOf("message")>=0||g.indexOf("description")>=0))return k(b);if(0===g.length){if(A(b)){var q=b.name?": "+b.name:"";return a.stylize("[Function"+q+"]","special")}if(w(b))return a.stylize(RegExp.prototype.toString.call(b),"regexp");if(y(b))return a.stylize(Date.prototype.toString.call(b),"date");if(z(b))return k(b)}var r="",s=!1,u=["{","}"];if(o(b)&&(s=!0,u=["[","]"]),A(b)){r=" [Function"+(b.name?": "+b.name:"")+"]"}if(w(b)&&(r=" "+RegExp.prototype.toString.call(b)),y(b)&&(r=" "+Date.prototype.toUTCString.call(b)),z(b)&&(r=" "+k(b)),0===g.length&&(!s||0==b.length))return u[0]+r+u[1];if(d<0)return w(b)?a.stylize(RegExp.prototype.toString.call(b),"regexp"):a.stylize("[Object]","special");a.seen.push(b);var v;return v=s?l(a,b,d,p,g):g.map(function(c){return m(a,b,d,p,c,s)}),a.seen.pop(),n(v,r,u)}function j(a,b){if(v(b))return a.stylize("undefined","undefined");if(t(b)){var c="'"+JSON.stringify(b).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return a.stylize(c,"string")}return s(b)?a.stylize(""+b,"number"):p(b)?a.stylize(""+b,"boolean"):q(b)?a.stylize("null","null"):void 0}function k(a){return"["+Error.prototype.toString.call(a)+"]"}function l(a,b,c,d,e){for(var f=[],g=0,h=b.length;g<h;++g)F(b,String(g))?f.push(m(a,b,c,d,String(g),!0)):f.push("");return e.forEach(function(e){e.match(/^\d+$/)||f.push(m(a,b,c,d,e,!0))}),f}function m(a,b,c,d,e,f){var g,h,j;if(j=Object.getOwnPropertyDescriptor(b,e)||{value:b[e]},j.get?h=j.set?a.stylize("[Getter/Setter]","special"):a.stylize("[Getter]","special"):j.set&&(h=a.stylize("[Setter]","special")),F(d,e)||(g="["+e+"]"),h||(a.seen.indexOf(j.value)<0?(h=q(c)?i(a,j.value,null):i(a,j.value,c-1),h.indexOf("\n")>-1&&(h=f?h.split("\n").map(function(a){return"  "+a}).join("\n").substr(2):"\n"+h.split("\n").map(function(a){return"   "+a}).join("\n"))):h=a.stylize("[Circular]","special")),v(g)){if(f&&e.match(/^\d+$/))return h;g=JSON.stringify(""+e),g.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(g=g.substr(1,g.length-2),g=a.stylize(g,"name")):(g=g.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),g=a.stylize(g,"string"))}return g+": "+h}function n(a,b,c){var d=0;return a.reduce(function(a,b){return d++,b.indexOf("\n")>=0&&d++,a+b.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?c[0]+(""===b?"":b+"\n ")+" "+a.join(",\n  ")+" "+c[1]:c[0]+b+" "+a.join(", ")+" "+c[1]}function o(a){return Array.isArray(a)}function p(a){return"boolean"==typeof a}function q(a){return null===a}function r(a){return null==a}function s(a){return"number"==typeof a}function t(a){return"string"==typeof a}function u(a){return"symbol"==typeof a}function v(a){return void 0===a}function w(a){return x(a)&&"[object RegExp]"===C(a)}function x(a){return"object"==typeof a&&null!==a}function y(a){return x(a)&&"[object Date]"===C(a)}function z(a){return x(a)&&("[object Error]"===C(a)||a instanceof Error)}function A(a){return"function"==typeof a}function B(a){return null===a||"boolean"==typeof a||"number"==typeof a||"string"==typeof a||"symbol"==typeof a||void 0===a}function C(a){return Object.prototype.toString.call(a)}function D(a){return a<10?"0"+a.toString(10):a.toString(10)}function E(){var a=new Date,b=[D(a.getHours()),D(a.getMinutes()),D(a.getSeconds())].join(":");return[a.getDate(),J[a.getMonth()],b].join(" ")}function F(a,b){return Object.prototype.hasOwnProperty.call(a,b)}var G=/%[sdj%]/g;c.format=function(a){if(!t(a)){for(var b=[],c=0;c<arguments.length;c++)b.push(e(arguments[c]));return b.join(" ")}for(var c=1,d=arguments,f=d.length,g=String(a).replace(G,function(a){if("%%"===a)return"%";if(c>=f)return a;switch(a){case"%s":return String(d[c++]);case"%d":return Number(d[c++]);case"%j":try{return JSON.stringify(d[c++])}catch(a){return"[Circular]"}default:return a}}),h=d[c];c<f;h=d[++c])q(h)||!x(h)?g+=" "+h:g+=" "+e(h);return g},c.deprecate=function(a,e){function f(){if(!g){if(b.throwDeprecation)throw new Error(e);b.traceDeprecation?console.trace(e):console.error(e),g=!0}return a.apply(this,arguments)}if(v(d.process))return function(){return c.deprecate(a,e).apply(this,arguments)};if(!0===b.noDeprecation)return a;var g=!1;return f};var H,I={};c.debuglog=function(a){if(v(H)&&(H=b.env.NODE_DEBUG||""),a=a.toUpperCase(),!I[a])if(new RegExp("\\b"+a+"\\b","i").test(H)){var d=b.pid;I[a]=function(){var b=c.format.apply(c,arguments);console.error("%s %d: %s",a,d,b)}}else I[a]=function(){};return I[a]},c.inspect=e,e.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},e.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},c.isArray=o,c.isBoolean=p,c.isNull=q,c.isNullOrUndefined=r,c.isNumber=s,c.isString=t,c.isSymbol=u,c.isUndefined=v,c.isRegExp=w,c.isObject=x,c.isDate=y,c.isError=z,c.isFunction=A,c.isPrimitive=B,c.isBuffer=a("./support/isBuffer");var J=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];c.log=function(){console.log("%s - %s",E(),c.format.apply(c,arguments))},c.inherits=a("inherits"),c._extend=function(a,b){if(!b||!x(b))return a;for(var c=Object.keys(b),d=c.length;d--;)a[c[d]]=b[c[d]];return a}}).call(this,a("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":312,_process:291,inherits:278}]},{},[15])(15)});